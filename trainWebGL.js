!function(t){"use strict";var e,i={},n=function(){return yA.__string_rec(this,"")},s=s||{};function r(t,e){var i=Object.create(t);for(var n in e)i[n]=e[n];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}var a=function(t,e){this.r=new RegExp(t,e.split("u").join(""))};i.EReg=a,a.__name__="EReg",a.prototype={match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},matched:function(t){if(null!=this.r.m&&t>=0&&t<this.r.m.length)return this.r.m[t];throw kn.thrown("EReg::matched")},__class__:a};var A=function(t){this.blendMode=et.Alpha,this.alpha=1,this.visible=!0,this.rotation=0,this.scaleY=1,this.scaleX=1,this.y=0,this.x=0,this.matA=1,this.matB=0,this.matC=0,this.matD=1,this.absX=0,this.absY=0,this.posChanged=null!=t,this.children=[],null!=t&&t.addChild(this)};i["h2d.Object"]=A,A.__name__="h2d.Object",A.prototype={getBounds:function(t,e){return null==e?e=new gt:(e.xMin=1e20,e.yMin=1e20,e.xMax=-1e20,e.yMax=-1e20),null!=t&&t.syncPos(),t!=this&&this.syncPos(),this.getBoundsRec(t,e,!1),(e.xMax<=e.xMin||e.yMax<=e.yMin)&&(this.addBounds(t,e,-1,-1,2,2),e.xMax=e.xMin=.5*(e.xMax+e.xMin),e.yMax=e.yMin=.5*(e.yMax+e.yMin)),e},getSize:function(t){null==t?t=new gt:(t.xMin=1e20,t.yMin=1e20,t.xMax=-1e20,t.yMax=-1e20),this.syncPos(),this.getBoundsRec(this.parent,t,!0),(t.xMax<=t.xMin||t.yMax<=t.yMin)&&(this.addBounds(this.parent,t,-1,-1,2,2),t.xMax=t.xMin=.5*(t.xMax+t.xMin),t.yMax=t.yMin=.5*(t.yMax+t.yMin));var e=-this.x,i=-this.y;return t.xMin+=e,t.xMax+=e,t.yMin+=i,t.yMax+=i,t},getAbsPos:function(){this.syncPos();var t=new Bt;return t.a=this.matA,t.b=this.matB,t.c=this.matC,t.d=this.matD,t.x=this.absX,t.y=this.absY,t},contains:function(t){for(;null!=t;)if((t=t.parent)==this)return!0;return!1},find:function(t){if(null!=(n=t(this)))return n;for(var e=0,i=this.children;e<i.length;){var n,s=i[e];if(++e,null!=(n=s.find(t)))return n}return null},findAll:function(t,e){null==e&&(e=[]);var i=t(this);null!=i&&e.push(i);for(var n=0,s=this.children;n<s.length;){var r=s[n];++n,r.findAll(t,e)}return e},set_filter:function(t){return null!=this.filter&&this.allocated&&this.filter.unbind(this),this.filter=t,null!=t&&this.allocated&&t.bind(this),t},getBoundsRec:function(t,e,i){if(this.posChanged){this.calcAbsPos();for(var n=0,s=this.children;n<s.length;){var r=s[n];++n,r.posChanged=!0}this.posChanged=!1}var a=this.children.length;if(0==a)return e.xMin=1e20,e.yMin=1e20,e.xMax=-1e20,void(e.yMax=-1e20);if(1!=a){var A=1/0,h=1/0,o=-1/0,l=-1/0;for(n=0,s=this.children;n<s.length;){r=s[n];++n,r.visible&&(r.getBoundsRec(t,e,i),e.xMin<A&&(A=e.xMin),e.yMin<h&&(h=e.yMin),e.xMax>o&&(o=e.xMax),e.yMax>l&&(l=e.yMax))}e.xMin=A,e.yMin=h,e.xMax=o,e.yMax=l}else{(r=this.children[0]).visible?r.getBoundsRec(t,e,i):(e.xMin=1e20,e.yMin=1e20,e.xMax=-1e20,e.yMax=-1e20)}},addBounds:function(t,e,i,n,s,r){if(!(s<=0||r<=0)){if(null==t){var a=i*this.matA+n*this.matC+this.absX,A=i*this.matB+n*this.matD+this.absY;a<e.xMin&&(e.xMin=a),a>e.xMax&&(e.xMax=a),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A);a=(i+s)*this.matA+n*this.matC+this.absX,A=(i+s)*this.matB+n*this.matD+this.absY;a<e.xMin&&(e.xMin=a),a>e.xMax&&(e.xMax=a),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A);a=i*this.matA+(n+r)*this.matC+this.absX,A=i*this.matB+(n+r)*this.matD+this.absY;a<e.xMin&&(e.xMin=a),a>e.xMax&&(e.xMax=a),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A);a=(i+s)*this.matA+(n+r)*this.matC+this.absX,A=(i+s)*this.matB+(n+r)*this.matD+this.absY;return a<e.xMin&&(e.xMin=a),a>e.xMax&&(e.xMax=a),A<e.yMin&&(e.yMin=A),void(A>e.yMax&&(e.yMax=A))}if(t==this)return e.xMin>i&&(e.xMin=i),e.yMin>n&&(e.yMin=n),e.xMax<i+s&&(e.xMax=i+s),void(e.yMax<n+r&&(e.yMax=n+r));var h=t.matA*t.matD-t.matB*t.matC;if(0!=h){var o=1/h,l=t.matD*o,u=-t.matB*o,_=-t.matC*o,c=t.matA*o,d=this.absX-t.absX,f=this.absY-t.absY,x=(a=i*this.matA+n*this.matC+d)*u+(A=i*this.matB+n*this.matD+f)*c;(p=a*l+A*_)<e.xMin&&(e.xMin=p),p>e.xMax&&(e.xMax=p),x<e.yMin&&(e.yMin=x),x>e.yMax&&(e.yMax=x);x=(a=(i+s)*this.matA+n*this.matC+d)*u+(A=(i+s)*this.matB+n*this.matD+f)*c;(p=a*l+A*_)<e.xMin&&(e.xMin=p),p>e.xMax&&(e.xMax=p),x<e.yMin&&(e.yMin=x),x>e.yMax&&(e.yMax=x);x=(a=i*this.matA+(n+r)*this.matC+d)*u+(A=i*this.matB+(n+r)*this.matD+f)*c;(p=a*l+A*_)<e.xMin&&(e.xMin=p),p>e.xMax&&(e.xMax=p),x<e.yMin&&(e.yMin=x),x>e.yMax&&(e.yMax=x);var p;x=(a=(i+s)*this.matA+(n+r)*this.matC+d)*u+(A=(i+s)*this.matB+(n+r)*this.matD+f)*c;(p=a*l+A*_)<e.xMin&&(e.xMin=p),p>e.xMax&&(e.xMax=p),x<e.yMin&&(e.yMin=x),x>e.yMax&&(e.yMax=x)}}},getObjectsCount:function(){for(var t=0,e=0,i=this.children;e<i.length;){var n=i[e];++e,t+=n.getObjectsCount()+1}return t},localToGlobal:function(t){this.syncPos(),null==t&&(t=new Ct);var e=t.x*this.matA+t.y*this.matC+this.absX,i=t.x*this.matB+t.y*this.matD+this.absY;return t.x=e,t.y=i,t},globalToLocal:function(t){this.syncPos(),t.x-=this.absX,t.y-=this.absY;var e=1/(this.matA*this.matD-this.matB*this.matC),i=(t.x*this.matD-t.y*this.matC)*e,n=(-t.x*this.matB+t.y*this.matA)*e;return t.x=i,t.y=n,t},getScene:function(){for(var t=this;null!=t.parent;)t=t.parent;return t instanceof _t?t:null},set_visible:function(t){return this.visible==t||(this.visible=t,null!=this.parentContainer&&this.parentContainer.contentChanged(this)),t},addChild:function(t){this.addChildAt(t,this.children.length)},addChildAt:function(t,e){e<0&&(e=0),e>this.children.length&&(e=this.children.length);for(var i=this;null!=i;){if(i==t)throw kn.thrown("Recursive addChild");i=i.parent}if(null!=t.parent){var n=t.allocated;t.allocated=!1,t.parent.removeChild(t),t.allocated=n}this.children.splice(e,0,t),!this.allocated&&t.allocated&&t.onRemove(),t.parent=this,t.parentContainer=this.parentContainer,t.posChanged=!0,this.allocated&&(t.allocated?t.onHierarchyMoved(!0):t.onAdd()),null!=this.parentContainer&&this.parentContainer.contentChanged(this)},onContentChanged:function(){null!=this.parentContainer&&this.parentContainer.contentChanged(this)},onHierarchyMoved:function(t){for(var e=0,i=this.children;e<i.length;){var n=i[e];++e,n.onHierarchyMoved(t)}},onAdd:function(){this.allocated=!0,null!=this.filter&&this.filter.bind(this);for(var t=0,e=this.children;t<e.length;){var i=e[t];++t,i.onAdd()}},onRemove:function(){this.allocated=!1,null!=this.filter&&this.filter.unbind(this);for(var t=0,e=this.children;t<e.length;){var i=e[t];++t,i.onRemove()}},getMatrix:function(t){t.a=this.matA,t.b=this.matB,t.c=this.matC,t.d=this.matD,t.x=this.absX,t.y=this.absY},removeChild:function(t){l.remove(this.children,t)&&(t.allocated&&t.onRemove(),t.parent=null,null!=t.parentContainer&&t.setParentContainer(null),t.posChanged=!0,null!=this.parentContainer&&this.parentContainer.contentChanged(this))},setParentContainer:function(t){this.parentContainer=t;for(var e=0,i=this.children;e<i.length;){var n=i[e];++e,n.setParentContainer(t)}},removeChildren:function(){for(;this.children.length>0;)this.removeChild(this.children[0])},remove:function(){null!=this.parent&&this.parent.removeChild(this)},drawTo:function(t){var e=this.getScene(),i=null==e;null==e&&(e=new _t),e.drawImplTo(this,[t]),i&&(e.dispose(),this.onRemove())},drawToTextures:function(t,e){var i=this.getScene(),n=null==i;null==i&&(i=new _t),i.drawImplTo(this,t,e),n&&(i.dispose(),this.onRemove())},draw:function(t){},sync:function(t){var e=this.posChanged;e&&(this.calcAbsPos(),this.posChanged=!1),this.lastFrame=t.frame;for(var i=0,n=this.children.length;i<n;){var s=this.children[i];if(null==s)break;s.lastFrame!=t.frame&&(e&&(s.posChanged=!0),s.sync(t)),this.children[i]!=s?(i=0,n=this.children.length):++i}},syncPos:function(){if(null!=this.parent&&this.parent.syncPos(),this.posChanged){this.calcAbsPos();for(var t=0,e=this.children;t<e.length;){var i=e[t];++t,i.posChanged=!0}this.posChanged=!1}},calcAbsPos:function(){if(null==this.parent){0==this.rotation?(t=1,e=0,this.matA=this.scaleX,this.matB=0,this.matC=0,this.matD=this.scaleY):(t=Math.cos(this.rotation),e=Math.sin(this.rotation),this.matA=this.scaleX*t,this.matB=this.scaleX*e,this.matC=this.scaleY*-e,this.matD=this.scaleY*t),this.absX=this.x,this.absY=this.y}else{if(0==this.rotation)this.matA=this.scaleX*this.parent.matA,this.matB=this.scaleX*this.parent.matB,this.matC=this.scaleY*this.parent.matC,this.matD=this.scaleY*this.parent.matD;else{var t=Math.cos(this.rotation),e=Math.sin(this.rotation),i=this.scaleX*t,n=this.scaleX*e,s=this.scaleY*-e,r=this.scaleY*t;this.matA=i*this.parent.matA+n*this.parent.matC,this.matB=i*this.parent.matB+n*this.parent.matD,this.matC=s*this.parent.matA+r*this.parent.matC,this.matD=s*this.parent.matB+r*this.parent.matD}this.absX=this.x*this.parent.matA+this.y*this.parent.matC+this.parent.absX,this.absY=this.x*this.parent.matB+this.y*this.parent.matD+this.parent.absY}},emitTile:function(t,e){null==A.nullDrawable&&(A.nullDrawable=new $(null)),A.nullDrawable.absX=this.absX,A.nullDrawable.absY=this.absY,A.nullDrawable.matA=this.matA,A.nullDrawable.matB=this.matB,A.nullDrawable.matC=this.matC,A.nullDrawable.matD=this.matD,t.drawTile(A.nullDrawable,e)},clipBounds:function(t,e){var i,n,s,r,a,A,h=t.tmpBounds;if(null!=t.inFilter){var o=t.baseShader.filterMatrixA__,l=t.baseShader.filterMatrixB__,u=this.matA*o.x+this.matB*o.y,_=this.matA*l.x+this.matB*l.y,c=this.matC*o.x+this.matD*o.y,d=this.matC*l.x+this.matD*l.y,f=this.absX*o.x+this.absY*o.y+o.z,x=this.absX*l.x+this.absY*l.y+l.z;i=u*t.viewA+_*t.viewC,n=u*t.viewB+_*t.viewD,s=c*t.viewA+d*t.viewC,r=c*t.viewB+d*t.viewD,a=f*t.viewA+x*t.viewC+t.viewX,A=f*t.viewB+x*t.viewD+t.viewY}else i=this.matA*t.viewA+this.matB*t.viewC,n=this.matA*t.viewB+this.matB*t.viewD,s=this.matC*t.viewA+this.matD*t.viewC,r=this.matC*t.viewB+this.matD*t.viewD,a=this.absX*t.viewA+this.absY*t.viewC+t.viewX,A=this.absX*t.viewB+this.absY*t.viewD+t.viewY;h.xMin=1e20,h.yMin=1e20,h.xMax=-1e20,h.yMax=-1e20;var p=(w=e.xMin)*n+(M=e.yMin)*r+A;(B=w*i+M*s+a)<h.xMin&&(h.xMin=B),B>h.xMax&&(h.xMax=B),p<h.yMin&&(h.yMin=p),p>h.yMax&&(h.yMax=p);p=(w=e.xMax)*n+(M=e.yMin)*r+A;(B=w*i+M*s+a)<h.xMin&&(h.xMin=B),B>h.xMax&&(h.xMax=B),p<h.yMin&&(h.yMin=p),p>h.yMax&&(h.yMax=p);p=(w=e.xMin)*n+(M=e.yMax)*r+A;(B=w*i+M*s+a)<h.xMin&&(h.xMin=B),B>h.xMax&&(h.xMax=B),p<h.yMin&&(h.yMin=p),p>h.yMax&&(h.yMax=p);p=(w=e.xMax)*n+(M=e.yMax)*r+A;(B=w*i+M*s+a)<h.xMin&&(h.xMin=B),B>h.xMax&&(h.xMax=B),p<h.yMin&&(h.yMin=p),p>h.yMax&&(h.yMax=p),h.xMin<-1&&(h.xMin=-1),h.yMin<-1&&(h.yMin=-1),h.xMax>1&&(h.xMax=1),h.yMax>1&&(h.yMax=1);var g=1/(i*r-n*s),m=h.xMin,v=h.yMin,y=h.xMax,b=h.yMax;h.xMin=1e20,h.yMin=1e20,h.xMax=-1e20,h.yMax=-1e20;var w=m,M=v;p=(-(w-=a)*n+(M-=A)*i)*g;(B=(w*r-M*s)*g)<h.xMin&&(h.xMin=B),B>h.xMax&&(h.xMax=B),p<h.yMin&&(h.yMin=p),p>h.yMax&&(h.yMax=p);w=y,M=v,p=(-(w-=a)*n+(M-=A)*i)*g;(B=(w*r-M*s)*g)<h.xMin&&(h.xMin=B),B>h.xMax&&(h.xMax=B),p<h.yMin&&(h.yMin=p),p>h.yMax&&(h.yMax=p);w=m,M=b,p=(-(w-=a)*n+(M-=A)*i)*g;(B=(w*r-M*s)*g)<h.xMin&&(h.xMin=B),B>h.xMax&&(h.xMax=B),p<h.yMin&&(h.yMin=p),p>h.yMax&&(h.yMax=p);var B;w=y,M=b,p=(-(w-=a)*n+(M-=A)*i)*g;(B=(w*r-M*s)*g)<h.xMin&&(h.xMin=B),B>h.xMax&&(h.xMax=B),p<h.yMin&&(h.yMin=p),p>h.yMax&&(h.yMax=p);var C=e.xMin,S=h.xMin;e.xMin=C<S?S:C;C=e.yMin,S=h.yMin;e.yMin=C<S?S:C;C=e.xMax,S=h.xMax;e.xMax=C>S?S:C;C=e.yMax,S=h.yMax;e.yMax=C>S?S:C},drawFilters:function(t){if(t.pushFilter(this)){var e=t.tmpBounds,i=new gt,n=-1;this.filter.sync(t,this),this.filter.autoBounds?n=this.filter.boundsExtend:(this.filter.getBounds(this,e),e.xMin<i.xMin&&(i.xMin=e.xMin),e.xMax>i.xMax&&(i.xMax=e.xMax),e.yMin<i.yMin&&(i.yMin=e.yMin),e.yMax>i.yMax&&(i.yMax=e.yMax)),n>=0&&(this.getBounds(this,e),e.xMin-=n,e.yMin-=n,e.xMax+=n,e.yMax+=n,e.xMin<i.xMin&&(i.xMin=e.xMin),e.xMax>i.xMax&&(i.xMax=e.xMax),e.yMin<i.yMin&&(i.yMin=e.yMin),e.yMax>i.yMax&&(i.yMax=e.yMax)),this.clipBounds(t,i);var s=Math.floor(i.xMin+1e-10),r=Math.floor(i.yMin+1e-10),a=Math.ceil(i.xMax-s-1e-10),A=Math.ceil(i.yMax-r-1e-10);if(a<=0||A<=0||i.xMax<i.xMin)t.popFilter();else{var h=t.textures.allocTarget("filterTemp",a,A,!1);t.pushTarget(h,s,r,a,A),t.engine.clear(0);var o=t.globalAlpha,l=t.baseShader,u=(F=l.filterMatrixA__).x,_=F.y,c=F.z;null==(d=F.w)&&(d=1),null==c&&(c=0),null==_&&(_=0),null==u&&(u=0);var d,f=u,x=_,p=c,g=d;u=(F=l.filterMatrixB__).x,_=F.y,c=F.z;null==(d=F.w)&&(d=1),null==c&&(c=0),null==_&&(_=0),null==u&&(u=0);var m=u,v=_,y=c,b=d,w=1/(this.matA*this.matD-this.matB*this.matC),M=this.matD*w,B=-this.matB*w,C=-this.matC*w,S=this.matA*w,I=-(this.absX*M+this.absY*C),k=-(this.absX*B+this.absY*S);null==(c=I)&&(c=0),null==(_=C)&&(_=0),null==(u=M)&&(u=0),(F=l.filterMatrixA__).x=u,F.y=_,F.z=c,F.w=1,null==(c=k)&&(c=0),null==(_=S)&&(_=0),null==(u=B)&&(u=0),(F=l.filterMatrixB__).x=u,F.y=_,F.z=c,F.w=1,t.globalAlpha=1,this.drawContent(t);var E=ct.fromTexture(h);E.dx=s,E.dy=r;var F,T=E;(E=this.filter.draw(t,E))!=T&&null!=E&&(E.dx+=s,E.dy+=r),(F=l.filterMatrixA__).x=f,F.y=x,F.z=p,F.w=g,(F=l.filterMatrixB__).x=m,F.y=v,F.z=y,F.w=b,t.popTarget(),t.popFilter(),t.globalAlpha=o,null!=E&&this.drawFiltered(t,E)}}},drawFiltered:function(t,e){var i=t.globalAlpha;t.currentBlend=null,t.inFilterBlend=this.blendMode,t.globalAlpha*=this.alpha,this.emitTile(t,e),t.globalAlpha=i,t.inFilterBlend=null,t.currentBlend=null},drawRec:function(t){if(this.visible){if(this.posChanged){this.calcAbsPos();for(var e=0,i=this.children;e<i.length;){var n=i[e];++e,n.posChanged=!0}this.posChanged=!1}if(null!=this.filter&&this.filter.get_enable())this.drawFilters(t);else{var s=t.globalAlpha;t.globalAlpha*=this.alpha,this.drawContent(t),t.globalAlpha=s}}},drawContent:function(t){if(t.front2back){for(var e=this.children.length;e-- >0;)this.children[e].drawRec(t);this.draw(t)}else{this.draw(t);for(var i=0,n=this.children;i<n.length;){var s=n[i];++i,s.drawRec(t)}}},set_x:function(t){return this.posChanged=!0,this.x=t},set_y:function(t){return this.posChanged=!0,this.y=t},set_scaleX:function(t){return this.posChanged=!0,this.scaleX=t},set_scaleY:function(t){return this.posChanged=!0,this.scaleY=t},set_rotation:function(t){return this.posChanged=!0,this.rotation=t},move:function(t,e){var i=this.x+t*Math.cos(this.rotation);this.posChanged=!0,this.x=i;i=this.y+e*Math.sin(this.rotation);this.posChanged=!0,this.y=i},setPosition:function(t,e){this.posChanged=!0,this.x=t,this.posChanged=!0,this.y=e},rotate:function(t){this.posChanged=!0,this.rotation+=t},scale:function(t){this.posChanged=!0,this.scaleX*=t,this.posChanged=!0,this.scaleY*=t},setScale:function(t){this.posChanged=!0,this.scaleX=t,this.posChanged=!0,this.scaleY=t},getChildAt:function(t){return this.children[t]},getChildIndex:function(t){for(var e=0,i=this.children.length;e<i;){var n=e++;if(this.children[n]==t)return n}return-1},getObjectByName:function(t){if(this.name==t)return this;for(var e=0,i=this.children;e<i.length;){var n=i[e];++e;var s=n.getObjectByName(t);if(null!=s)return s}return null},get_numChildren:function(){return this.children.length},iterator:function(){return new Hr(this.children)},toString:function(){var t=yA.getClass(this).__name__;return null==this.name?t:this.name+"("+t+")"},contentChanged:function(t){},constraintSize:function(t,e){},__class__:A};var h=function(t,e,i,n,s,r,a){null==r&&(r=254),null==s&&(s=144),null==e&&(e=0),null==t&&(t=0),this.ytra=0,this.xtra=0,this.imageWidth=0,A.call(this,a),this.posChanged=!0,this.x=t,this.posChanged=!0,this.y=e,this.imageWidth=i.width;var h=new tt(n.sub(48,19,2,3),this),l=new tt(n.sub(48,23,2,12),this),u=new tt(n.sub(48,17,2,1),this);u.posChanged=!0,u.x=3,u.posChanged=!0,u.y=i.height+2,l.posChanged=!0,l.x=3,l.posChanged=!0,l.y=r-e-12-5,h.posChanged=!0,h.x=3,h.posChanged=!0,h.y=i.height+3,h.set_width(2),h.set_height(r-e-12-5-i.height-3);var _=new tt(n.sub(48,19,2,3),this),c=new tt(n.sub(48,23,2,12),this),d=new tt(n.sub(48,17,2,1),this);d.posChanged=!0,d.x=i.width-5,d.posChanged=!0,d.y=i.height+2,c.posChanged=!0,c.x=i.width-5,c.posChanged=!0,c.y=r-e-12-5,_.posChanged=!0,_.x=i.width-5,_.posChanged=!0,_.y=i.height+3,_.set_width(2),_.set_height(r-e-12-5-i.height-3),this.gearLeft=new o(4,r-3-e,2,n.sub(43,2,36,10),this),this.gearRight=new o(i.width-4,r-3-e,2,n.sub(43,2,36,10),this),this.gearLeft.update(t+4),this.gearRight.update(t+this.imageWidth-4);var f=new tt(n.sub(43,32,2,3),this),x=new tt(n.sub(43,17,2,Math.min(e-s,14)),this);x.posChanged=!0,x.x=3,x.posChanged=!0,x.y=s-e,f.posChanged=!0,f.x=3;var p=Math.min(s-e+14,-4);f.posChanged=!0,f.y=p,f.set_height(Math.max(e-s-14,3)),f.set_width(2);var g=new tt(n.sub(43,32,2,3),this),m=new tt(n.sub(43,17,2,Math.min(e-s,14)),this);m.posChanged=!0,m.x=i.width-5,m.posChanged=!0,m.y=s-e,g.posChanged=!0,g.x=i.width-5;p=Math.min(s-e+14,-4);g.posChanged=!0,g.y=p,g.set_height(Math.max(e-s-14,3)),g.set_width(2),new tt(i,this);var v=new tt(n.sub(25,1,2,2),this),y=new tt(n.sub(36,22,2,2),this),b=new tt(n.sub(1,22,2,2),this),w=new tt(n.sub(12,39,2,2),this),M=new tt(n.sub(15,25,23,16),this),B=new tt(n.sub(28,1,10,20),this),C=new tt(n.sub(1,25,10,16),this),S=new tt(n.sub(1,1,23,20),this);v.posChanged=!0,v.x=21,v.posChanged=!0,v.y=-2,v.set_width(i.width-8-21),v.set_height(2),y.posChanged=!0,y.x=i.width,y.posChanged=!0,y.y=18,y.set_width(2),y.set_height(i.height-14-18),b.posChanged=!0,b.x=-2,b.posChanged=!0,b.y=18,b.set_width(2),b.set_height(i.height-14-18),w.posChanged=!0,w.x=8,w.posChanged=!0,w.y=i.height,w.set_width(i.width-8-21),w.set_height(2),S.posChanged=!0,S.x=-2,S.posChanged=!0,S.y=-2,B.posChanged=!0,B.x=i.width-8,B.posChanged=!0,B.y=-2,C.posChanged=!0,C.x=-2,C.posChanged=!0,C.y=i.height-14,M.posChanged=!0,M.x=i.width-21,M.posChanged=!0,M.y=i.height-14};i.FrameCart=h,h.__name__="FrameCart",h.__super__=A,h.prototype=r(A.prototype,{moveX:function(t){this.xtra+=t,this.posChanged=!0,this.x+=0|this.xtra,this.xtra%=1,this.update()},update:function(){this.gearLeft.update(this.x+4),this.gearRight.update(this.x+this.imageWidth-4)},__class__:h});var o=function(t,e,i,n,s){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.offset=0,A.call(this,s),this.posChanged=!0,this.x=t,this.posChanged=!0,this.y=e,this.offset=i;var r,a=n.sub(0,0,10,10),h=n.sub(13,0,10,10),o=n.sub(26,0,10,10);this.gearTiles=[o,h,a],this.ix=Math.floor(t),this.img=new tt(this.gearTiles[(this.ix+i)%3|0],this),(r=this.img).posChanged=!0,r.x=-5,(r=this.img).posChanged=!0,r.y=-5};i.Gear=o,o.__name__="Gear",o.__super__=A,o.prototype=r(A.prototype,{update:function(t){this.ix=Math.floor(t),this.img.set_tile(this.gearTiles[(this.ix+this.offset)%3|0])},__class__:o});var l=function(){};i.HxOverrides=l,l.__name__="HxOverrides",l.strDate=function(t){switch(t.length){case 8:var e=t.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(e[0]),i.setUTCMinutes(e[1]),i.setUTCSeconds(e[2]),i;case 10:e=t.split("-");return new Date(e[0],e[1]-1,e[2],0,0,0);case 19:var n=(e=t.split(" "))[0].split("-"),s=e[1].split(":");return new Date(n[0],n[1]-1,n[2],s[0],s[1],s[2]);default:throw kn.thrown("Invalid date format : "+t)}},l.cca=function(t,e){var i=t.charCodeAt(e);if(i==i)return i},l.substr=function(t,e,i){if(null==i)i=t.length;else if(i<0){if(0!=e)return"";i=t.length+i}return t.substr(e,i)},l.remove=function(t,e){var i=t.indexOf(e);return-1!=i&&(t.splice(i,1),!0)},l.now=function(){return Date.now()};var u=function(){};i.Lambda=u,u.__name__="Lambda",u.array=function(t){for(var e=[],i=YA(t);i.hasNext();){var n=i.next();e.push(n)}return e};var _=function(){};i["h3d.IDrawable"]=_,_.__name__="h3d.IDrawable",_.__isInterface__=!0,_.prototype={__class__:_};var c=function(){var t=this,e=Ut.CURRENT;null!=e?(this.engine=e,e.onReady=XA(this,this.setup),Pn.delay(XA(this,this.setup),0)):Os.start((function(){e=new Ut,t.engine=e,e.onReady=XA(t,t.setup),e.init()}))};i["hxd.App"]=c,c.__name__="hxd.App",c.__interfaces__=[_],c.staticHandler=function(){},c.prototype={onResize:function(){},setScene:function(t,e){null==e&&(e=!0);var i=t instanceof _t?t:null,n=t instanceof Zi?t:null;if(null!=i?(this.sevents.removeScene(this.s2d),this.sevents.addScene(t,0)):(null!=n&&this.sevents.removeScene(this.s3d),this.sevents.addScene(t)),e)if(null!=i)this.s2d.dispose();else{if(null==n)throw kn.thrown("Can't dispose previous scene");this.s3d.dispose()}null!=i&&(this.s2d=i),null!=n&&(this.s3d=n)},setCurrent:function(){var t=this;this.engine=Ut.CURRENT,this.isDisposed=!1,this.engine.onReady=c.staticHandler,this.engine.onResized=function(){null!=t.s2d&&(t.s2d.checkResize(),t.onResize())},Os.setLoop(XA(this,this.mainLoop))},setScene2D:function(t,e){null==e&&(e=!0),this.sevents.removeScene(this.s2d),this.sevents.addScene(t,0),e&&this.s2d.dispose(),this.s2d=t},setScene3D:function(t,e){null==e&&(e=!0),this.sevents.removeScene(this.s3d),this.sevents.addScene(t),e&&this.s3d.dispose(),this.s3d=t},render:function(t){this.s3d.render(t),this.s2d.render(t)},setup:function(){var t=this,e=!1;this.engine.onReady=c.staticHandler,this.engine.onResized=function(){null!=t.s2d&&(t.s2d.checkResize(),e&&t.onResize())},this.s3d=new Zi,this.s2d=new _t,this.sevents=new Rs,this.sevents.addScene(this.s2d),this.sevents.addScene(this.s3d),this.loadAssets((function(){e=!0,t.init(),Qs.skip(),t.mainLoop(),Os.setLoop(XA(t,t.mainLoop)),ks.initialize()}))},dispose:function(){this.engine.onResized=c.staticHandler,this.engine.onContextLost=c.staticHandler,this.isDisposed=!0,null!=this.s2d&&this.s2d.dispose(),null!=this.s3d&&this.s3d.dispose(),null!=this.sevents&&this.sevents.dispose()},loadAssets:function(t){t()},init:function(){},mainLoop:function(){if(Qs.update(),this.sevents.checkEvents(),!this.isDisposed&&(this.update(Qs.dt),!this.isDisposed)){var t=Qs.dt;null!=this.s2d&&this.s2d.setElapsedTime(t),null!=this.s3d&&this.s3d.setElapsedTime(t),this.engine.render(this)}},update:function(t){},__class__:c},Math.__name__="Math";var d=function(){this.mouseDown=!1,this.prevMouseX=0,this.scale=3,this.carts=[],this.imgs=["airship.png","moon 2.png","blaauw observatory.png","torus world.png","taurus.png","cancer.png","gemini.png","leo.png","virgo.png","tanjiro kamado.png","joust.png","bill cipher.gif","char side.png","char.png","barrel.png","nimbatus.png","lavander.png","aerial screw.png","puffbird.png","desertRainFrog.png","wolf.png","hazmatSuit.png","slime.png","hermit.png","blackhole.png","boba fett.png","buffalo skull.png","nautilus.png","the qu.png","Steam locomotive.png","x-mas tree.png"],c.call(this)};i.Main=d,d.__name__="Main",d.main=function(){zs.set_loader(new la(new Qr(Rn.run("oy7:galleryoy5:trainoy9:slime.pngty11:airship.pngty7:leo.pngty10:barrel.pngty10:taurus.pngty20:tanjiro%20kamado.pngty15:char%20side.pngty8:wolf.pngty18:aerial%20screw.pngty15:boba%20fett.pngty10:cancer.pngty12:nimbatus.pngty9:.DS_Storety12:moon%202.pngty22:Steam%20locomotive.pngty9:virgo.pngty12:nautilus.pngty8:char.pngty10:hermit.pngty12:puffbird.pngty17:torus%20world.pngty12:the%20qu.pngty14:hazmatSuit.pngty19:buffalo%20skull.pngty10:gemini.pngty17:bill%20cipher.gifty9:joust.pngty24:blaauw%20observatory.pngty12:lavander.pngty13:blackhole.pngty16:x-mas%20tree.pngty18:desertRainFrog.pngtgR14ty9:tiles.pngtgR14tg")))),new d},d.__super__=c,d.prototype=r(c.prototype,{scroll:function(t){var e=t.wheelDelta;if(this.carts[this.carts.length-1].x+e>this.cartsXClamp&&this.carts[0].x+e<this.cartsXClamp)for(var i=0,n=this.carts;i<n.length;){var s=n[i];++i,s.moveX(e)}},drag:function(t){this.mouseDown&&(t.wheelDelta=t.relX-this.prevMouseX,this.scroll(t)),this.prevMouseX=t.relX},push:function(t){this.prevMouseX=t.relX,this.mouseDown=!0},release:function(t){this.prevMouseX=t.relX,this.mouseDown=!1},onResize:function(){this.scale=this.s2d.height/106;var t=this.s2d,e=this.scale;t.posChanged=!0,t.scaleX=e,t.posChanged=!0,t.scaleY=e;var i=Math.ceil(this.s2d.width/this.scale);this.cartsXClamp=i/2,this.scrollGalleryArea.width=i,this.patternDraw(0,d.railY-5,i,this.galleryTileMap.sub(67,46,16,5));var n=new tt(this.galleryTileMap.sub(46,39,1,2),this.s2d);n.posChanged=!0,n.y=d.railY,n.set_width(i),n.set_height(2),this.patternDraw(0,d.trackY,i,this.galleryTileMap.sub(1,46,63,5)),this.patternDraw(0,d.trackY+5,i,this.galleryTileMap.sub(67,46,16,5))},init:function(){this.engine.backgroundColor=2565942;var t=this.s2d,e=this.scale;t.posChanged=!0,t.scaleX=e,t.posChanged=!0,t.scaleY=e,this.cartsXClamp=this.s2d.width/(2*this.scale);var i=zs.get_loader();this.galleryTileMap=i.loadCache("gallery/tiles.png",oa).toTile(),this.scrollGalleryArea=new st(this.s2d.width,d.trackY-d.railY+4,this.s2d),(t=this.scrollGalleryArea).posChanged=!0,t.y=d.railY,this.scrollGalleryArea.onWheel=XA(this,this.scroll),this.scrollGalleryArea.set_cursor(bs.Default),this.scrollGalleryArea.onMove=XA(this,this.drag),this.scrollGalleryArea.onPush=XA(this,this.push),this.scrollGalleryArea.onRelease=XA(this,this.release),this.scrollGalleryArea.onOut=XA(this,this.release),this.onResize();for(var n=0,s=this.imgs;n<s.length;){var r=s[n];++n;var a=zs.load("gallery/train/"+r).toTile(),A=Math.ceil(a.height+a.y)-Math.floor(a.y);a.height>d.maxHeight&&(a.setSize(a.width,d.maxHeight),a.setPosition(0,(A-d.maxHeight)/2));var o=d.middleY-Math.floor(a.height/2),l=new h(d.xOffset,o,a,this.galleryTileMap,d.railY,d.trackY,this.s2d);d.xOffset+=Math.ceil(a.width+a.x)-Math.floor(a.x)+d.xSpacing,this.carts.push(l)}},patternDraw:function(t,e,i,n){for(var s=new pt(n,this.s2d),r=n.width,a=0,A=Math.ceil(i/r);a<A;){var h=a++;s.content.add(h*r+t,e,s.curColor.x,s.curColor.y,s.curColor.z,s.curColor.w,n)}},__class__:d});var f=function(){};i.Reflect=f,f.__name__="Reflect",f.field=function(t,e){try{return t[e]}catch(t){return null}},f.fields=function(t){var e=[];if(null!=t){var i=Object.prototype.hasOwnProperty;for(var n in t)"__id__"!=n&&"hx__closures__"!=n&&i.call(t,n)&&e.push(n)}return e},f.isFunction=function(t){return"function"==typeof t&&!(t.__name__||t.__ename__)},f.compare=function(t,e){return t==e?0:t>e?1:-1},f.compareMethods=function(t,e){return t==e||!(!f.isFunction(t)||!f.isFunction(e))&&(t.scope==e.scope&&t.method==e.method&&null!=t.method)},f.isEnumValue=function(t){return null!=t&&null!=t.__enum__},f.deleteField=function(t,e){return!!Object.prototype.hasOwnProperty.call(t,e)&&(delete t[e],!0)};var x=function(){};i.Std=x,x.__name__="Std",x.string=function(t){return yA.__string_rec(t,"")},x.parseInt=function(t){if(null!=t)for(var e=0,i=t.length;e<i;){var n=e++,s=t.charCodeAt(n);if(s<=8||s>=14&&32!=s&&45!=s){var r=t.charCodeAt(n+1),a=parseInt(t,120==r||88==r?16:10);return isNaN(a)?null:a}}return null},x.random=function(t){return t<=0?0:Math.floor(Math.random()*t)};var p=function(){this.b=""};i.StringBuf=p,p.__name__="StringBuf",p.prototype={__class__:p};var g=function(){};i.StringTools=g,g.__name__="StringTools",g.startsWith=function(t,e){return t.length>=e.length&&0==t.lastIndexOf(e,0)},g.isSpace=function(t,e){var i=l.cca(t,e);return i>8&&i<14||32==i},g.ltrim=function(t){for(var e=t.length,i=0;i<e&&g.isSpace(t,i);)++i;return i>0?l.substr(t,i,e-i):t},g.rtrim=function(t){for(var e=t.length,i=0;i<e&&g.isSpace(t,e-i-1);)++i;return i>0?l.substr(t,0,e-i):t},g.trim=function(t){return g.ltrim(g.rtrim(t))},g.replace=function(t,e,i){return t.split(e).join(i)},g.hex=function(t,e){for(var i="";i="0123456789ABCDEF".charAt(15&t)+i,(t>>>=4)>0;);if(null!=e)for(;i.length<e;)i="0"+i;return i};var m=function(){};i.Type=m,m.__name__="Type",m.createInstance=function(t,e){return new(Function.prototype.bind.apply(t,[null].concat(e)))},m.createEnum=function(t,e,i){var n=f.field(t,e);if(null==n)throw kn.thrown("No such constructor "+e);if(f.isFunction(n)){if(null==i)throw kn.thrown("Constructor "+e+" need parameters");return n.apply(t,i)}if(null!=i&&0!=i.length)throw kn.thrown("Constructor "+e+" does not need parameters");return n},m.createEnumIndex=function(t,e,i){var n,s=t.__constructs__[e];null==s?n=null:n=s._hx_name;if(null==n)throw kn.thrown(e+" is not a valid enum constructor index");return m.createEnum(t,n,i)},m.enumEq=function(t,e){if(t==e)return!0;try{var i=t.__enum__;if(null==i||i!=e.__enum__)return!1;if(t._hx_index!=e._hx_index)return!1;for(var n=s[i].__constructs__[t._hx_index].__params__,r=0;r<n.length;){var a=n[r];if(++r,!m.enumEq(t[a],e[a]))return!1}}catch(r){return!1}return!0},m.enumParameters=function(t){var e=s[t.__enum__].__constructs__[t._hx_index].__params__;if(null!=e){for(var i=[],n=0;n<e.length;){var r=e[n];++n,i.push(t[r])}return i}return[]};var v=s["format.gif.Block"]={__ename__:!0,__constructs__:null,BFrame:(e=function(t){return{_hx_index:0,frame:t,__enum__:"format.gif.Block",toString:n}},e._hx_name="BFrame",e.__params__=["frame"],e),BExtension:(e=function(t){return{_hx_index:1,extension:t,__enum__:"format.gif.Block",toString:n}},e._hx_name="BExtension",e.__params__=["extension"],e),BEOF:{_hx_name:"BEOF",_hx_index:2,__enum__:"format.gif.Block",toString:n}};v.__constructs__=[v.BFrame,v.BExtension,v.BEOF],v.__empty_constructs__=[v.BEOF];var y=s["format.gif.Extension"]={__ename__:!0,__constructs__:null,EGraphicControl:(e=function(t){return{_hx_index:0,gce:t,__enum__:"format.gif.Extension",toString:n}},e._hx_name="EGraphicControl",e.__params__=["gce"],e),EComment:(e=function(t){return{_hx_index:1,text:t,__enum__:"format.gif.Extension",toString:n}},e._hx_name="EComment",e.__params__=["text"],e),EText:(e=function(t){return{_hx_index:2,pte:t,__enum__:"format.gif.Extension",toString:n}},e._hx_name="EText",e.__params__=["pte"],e),EApplicationExtension:(e=function(t){return{_hx_index:3,ext:t,__enum__:"format.gif.Extension",toString:n}},e._hx_name="EApplicationExtension",e.__params__=["ext"],e),EUnknown:(e=function(t,e){return{_hx_index:4,id:t,data:e,__enum__:"format.gif.Extension",toString:n}},e._hx_name="EUnknown",e.__params__=["id","data"],e)};y.__constructs__=[y.EGraphicControl,y.EComment,y.EText,y.EApplicationExtension,y.EUnknown],y.__empty_constructs__=[];var b=s["format.gif.ApplicationExtension"]={__ename__:!0,__constructs__:null,AENetscapeLooping:(e=function(t){return{_hx_index:0,loops:t,__enum__:"format.gif.ApplicationExtension",toString:n}},e._hx_name="AENetscapeLooping",e.__params__=["loops"],e),AEUnknown:(e=function(t,e,i){return{_hx_index:1,name:t,version:e,data:i,__enum__:"format.gif.ApplicationExtension",toString:n}},e._hx_name="AEUnknown",e.__params__=["name","version","data"],e)};b.__constructs__=[b.AENetscapeLooping,b.AEUnknown],b.__empty_constructs__=[];var w=s["format.gif.Version"]={__ename__:!0,__constructs__:null,GIF87a:{_hx_name:"GIF87a",_hx_index:0,__enum__:"format.gif.Version",toString:n},GIF89a:{_hx_name:"GIF89a",_hx_index:1,__enum__:"format.gif.Version",toString:n},Unknown:(e=function(t){return{_hx_index:2,version:t,__enum__:"format.gif.Version",toString:n}},e._hx_name="Unknown",e.__params__=["version"],e)};w.__constructs__=[w.GIF87a,w.GIF89a,w.Unknown],w.__empty_constructs__=[w.GIF87a,w.GIF89a];var M=s["format.gif.DisposalMethod"]={__ename__:!0,__constructs__:null,UNSPECIFIED:{_hx_name:"UNSPECIFIED",_hx_index:0,__enum__:"format.gif.DisposalMethod",toString:n},NO_ACTION:{_hx_name:"NO_ACTION",_hx_index:1,__enum__:"format.gif.DisposalMethod",toString:n},FILL_BACKGROUND:{_hx_name:"FILL_BACKGROUND",_hx_index:2,__enum__:"format.gif.DisposalMethod",toString:n},RENDER_PREVIOUS:{_hx_name:"RENDER_PREVIOUS",_hx_index:3,__enum__:"format.gif.DisposalMethod",toString:n},UNDEFINED:(e=function(t){return{_hx_index:4,index:t,__enum__:"format.gif.DisposalMethod",toString:n}},e._hx_name="UNDEFINED",e.__params__=["index"],e)};M.__constructs__=[M.UNSPECIFIED,M.NO_ACTION,M.FILL_BACKGROUND,M.RENDER_PREVIOUS,M.UNDEFINED],M.__empty_constructs__=[M.UNSPECIFIED,M.NO_ACTION,M.FILL_BACKGROUND,M.RENDER_PREVIOUS];var B=function(t){this.i=t,t.set_bigEndian(!1)};i["format.gif.Reader"]=B,B.__name__="format.gif.Reader",B.prototype={read:function(){var t=71;if(this.i.readByte()!=t)throw kn.thrown("Invalid header");t=73;if(this.i.readByte()!=t)throw kn.thrown("Invalid header");t=70;if(this.i.readByte()!=t)throw kn.thrown("Invalid header");var e=this.i.readString(3),i=w.GIF89a;switch(e){case"87a":i=w.GIF87a;break;case"89a":i=w.GIF89a;break;default:i=w.Unknown(e)}var n=this.i.readUInt16(),s=this.i.readUInt16(),r=this.i.readByte(),a=this.i.readByte(),A=this.i.readByte(),h={width:n,height:s,hasGlobalColorTable:128==(128&r),colorResolution:(112&r)>>>4,sorted:8==(8&r),globalColorTableSize:2<<(7&r),backgroundColorIndex:a,pixelAspectRatio:A=0!=A?(A+15)/64:1},o=null;h.hasGlobalColorTable&&(o=this.readColorTable(h.globalColorTableSize));for(var l=new Zn;;){t=this.readBlock();if(l.add(t),t==v.BEOF)break}return{version:i,logicalScreenDescriptor:h,globalColorTable:o,blocks:l}},readBlock:function(){switch(this.i.readByte()){case 33:return this.readExtension();case 44:return this.readImage();case 59:return v.BEOF}return v.BEOF},readImage:function(){var t=this.i.readUInt16(),e=this.i.readUInt16(),i=this.i.readUInt16(),n=this.i.readUInt16(),s=this.i.readByte(),r=128==(128&s),a=64==(64&s),A=32==(32&s),h=2<<(7&s),o=null;return r&&(o=this.readColorTable(h)),v.BFrame({x:t,y:e,width:i,height:n,localColorTable:r,interlaced:a,sorted:A,localColorTableSize:h,pixels:this.readPixels(i,n,a),colorTable:o})},readPixels:function(t,e,i){for(var n=this.i,s=t*e,r=new Qn(new ArrayBuffer(s)),a=n.readByte(),A=n.readByte()-1,h=n.readByte(),o=8,l=1<<a,u=l+1,_=a+1,c=1<<_,d=c-1,f=[],x=0,p=l;x<p;){f[b=x++]=[b]}for(var g,m,v=[],y=l+2,b=0,w=0;b<s;){for(m=w;o<_&&0!=A;)h|=n.readByte()<<o,o+=8,0==--A&&(A=n.readByte());if(w=h&d,h>>=_,o-=_,w!=l){if(w==u)break;if(w<y)m!=l&&((g=v[m].slice()).push(v[w][0]),v[y++]=g);else{if(w!=y)throw kn.thrown("Invalid LZW code. Excepted: "+y+", got: "+w);(g=v[m].slice()).push(g[0]),v[y++]=g}g=v[w];for(x=0;x<g.length;){var M=g[x];++x,r.b[b++]=M}y==c&&_<12&&(d=(c=1<<++_)-1)}else v=f.slice(),y=l+2,d=(c=1<<(_=a+1))-1}for(;A>0;)n.readByte(),0==--A&&(A=n.readByte());for(;b<s;)r.b[b++]=0;if(i){var B=new Qn(new ArrayBuffer(s)),C=this.deinterlace(r,B,8,0,0,t,e);C=this.deinterlace(r,B,8,4,C,t,e),C=this.deinterlace(r,B,4,2,C,t,e),this.deinterlace(r,B,2,1,C,t,e),r=B}return r},deinterlace:function(t,e,i,n,s,r,a){for(;n<a;)e.blit(n*r,t,s,r),s+=r,n+=i;return s},readExtension:function(){var t=this.i.readByte();switch(t){case 1:if(12!=this.i.readByte())throw kn.thrown("Incorrect size of Plain Text Extension introducer block.");for(var e=this.i.readUInt16(),i=this.i.readUInt16(),n=this.i.readUInt16(),s=this.i.readUInt16(),r=this.i.readByte(),a=this.i.readByte(),A=this.i.readByte(),h=this.i.readByte(),o=new as,l=new Qn(new ArrayBuffer(255)),u=this.i.readByte();0!=u;)this.i.readBytes(l,0,u),o.writeBytes(l,0,u),u=this.i.readByte();return o.flush(),l=o.getBytes(),o.close(),v.BExtension(y.EText({textGridX:e,textGridY:i,textGridWidth:n,textGridHeight:s,charCellWidth:r,charCellHeight:a,textForegroundColorIndex:A,textBackgroundColorIndex:h,text:l.toString()}));case 249:if(4!=this.i.readByte())throw kn.thrown("Incorrect Graphic Control Extension block size!");var _,c=this.i.readByte();switch((28&c)>>2){case 0:_=M.UNSPECIFIED;break;case 1:_=M.NO_ACTION;break;case 2:_=M.FILL_BACKGROUND;break;case 3:_=M.RENDER_PREVIOUS;break;default:_=M.UNDEFINED((28&c)>>2)}var d=v.BExtension(y.EGraphicControl({disposalMethod:_,userInput:2==(2&c),hasTransparentColor:1==(1&c),delay:this.i.readUInt16(),transparentIndex:this.i.readByte()}));return this.i.readByte(),d;case 254:for(o=new as,l=new Qn(new ArrayBuffer(255)),u=this.i.readByte();0!=u;)this.i.readBytes(l,0,u),o.writeBytes(l,0,u),u=this.i.readByte();return o.flush(),l=o.getBytes(),o.close(),v.BExtension(y.EComment(l.toString()));case 255:return this.readApplicationExtension();default:for(o=new as,l=new Qn(new ArrayBuffer(255)),u=this.i.readByte();0!=u;)this.i.readBytes(l,0,u),o.writeBytes(l,0,u),u=this.i.readByte();return o.flush(),l=o.getBytes(),o.close(),v.BExtension(y.EUnknown(t,l))}},readApplicationExtension:function(){if(11!=this.i.readByte())throw kn.thrown("Incorrect size of Application Extension introducer block.");for(var t=this.i.readString(8),e=this.i.readString(3),i=new as,n=new Qn(new ArrayBuffer(255)),s=this.i.readByte();0!=s;)this.i.readBytes(n,0,s),i.writeBytes(n,0,s),s=this.i.readByte();i.flush(),n=i.getBytes(),i.close();var r=n;return"NETSCAPE"==t&&"2.0"==e&&1==r.b[0]?v.BExtension(y.EApplicationExtension(b.AENetscapeLooping(r.b[1]|r.b[2]<<8))):v.BExtension(y.EApplicationExtension(b.AEUnknown(t,e,r)))},readBlocks:function(){for(var t=new as,e=new Qn(new ArrayBuffer(255)),i=this.i.readByte();0!=i;)this.i.readBytes(e,0,i),t.writeBytes(e,0,i),i=this.i.readByte();return t.flush(),e=t.getBytes(),t.close(),e},readColorTable:function(t){t*=3;for(var e=new Qn(new ArrayBuffer(t)),i=0;i<t;){var n=this.i.readByte();e.b[i]=n;var s=this.i.readByte();e.b[i+1]=s;var r=this.i.readByte();e.b[i+2]=r,i+=3}return e},__class__:B};var C=function(){};i["format.gif.Tools"]=C,C.__name__="format.gif.Tools",C.framesCount=function(t){for(var e=0,i=t.blocks.h;null!=i;){var n=i.item;i=i.next;var s=n;if(0==s._hx_index){s.frame;++e}}return e},C.frame=function(t,e){for(var i=0,n=t.blocks.h;null!=n;){var s=n.item;n=n.next;var r=s;if(0==r._hx_index){var a=r.frame;if(i==e)return a;++i}}return null},C.graphicControl=function(t,e){for(var i=0,n=null,s=t.blocks.h;null!=s;){var r=s.item;s=s.next;var a=r;switch(a._hx_index){case 0:a.frame;if(i==e)return n;n=null,++i;break;case 1:var A=a.extension;if(0==A._hx_index)n=A.gce}}return null},C.extractBGRA=function(t,e){for(var i=null,n=0,s=t.blocks.h;null!=s;){var r=s.item;s=s.next;var a=r;switch(a._hx_index){case 0:var A=a.frame;if(n==e){var h=new Qn(new ArrayBuffer(A.width*A.height*4)),o=A.localColorTable?A.colorTable:t.globalColorTable;if(null==o)throw kn.thrown("Frame does not have a color table!");for(var l=null!=i&&i.hasTransparentColor?3*i.transparentIndex:-1,u=0,_=0,c=A.pixels.length;_<c;){var d=_++,f=3*A.pixels.b[d];h.b[u]=o.b[f+2],h.b[u+1]=o.b[f+1],h.b[u+2]=o.b[f],h.b[u+3]=l==f?0:255,u+=4}return h}++n,i=null;break;case 1:var x=a.extension;if(0==x._hx_index)i=x.gce}}return null},C.extractRGBA=function(t,e){for(var i=null,n=0,s=t.blocks.h;null!=s;){var r=s.item;s=s.next;var a=r;switch(a._hx_index){case 0:var A=a.frame;if(n==e){var h=new Qn(new ArrayBuffer(A.width*A.height*4)),o=A.localColorTable?A.colorTable:t.globalColorTable;if(null==o)throw kn.thrown("Frame does not have a color table!");for(var l=null!=i&&i.hasTransparentColor?3*i.transparentIndex:-1,u=0,_=0,c=A.pixels.length;_<c;){var d=_++,f=3*A.pixels.b[d];h.b[u]=o.b[f],h.b[u+1]=o.b[f+1],h.b[u+2]=o.b[f+2],h.b[u+3]=l==f?0:255,u+=4}return h}++n,i=null;break;case 1:var x=a.extension;if(0==x._hx_index)i=x.gce}}return null},C.extractFullBGRA=function(t,e){for(var i=null,n=0,s=new Qn(new ArrayBuffer(t.logicalScreenDescriptor.width*t.logicalScreenDescriptor.height*4)),r=t.blocks.h;null!=r;){var a=r.item;r=r.next;var A=a;switch(A._hx_index){case 0:var h=A.frame,o=h.localColorTable?h.colorTable:t.globalColorTable;if(null==o)throw kn.thrown("Frame does not have a color table!");var l=null!=i&&i.hasTransparentColor?3*i.transparentIndex:-1,u=h.pixels,_=0,c=4*(h.y*t.logicalScreenDescriptor.width+h.x),d=4*(t.logicalScreenDescriptor.width-h.width)+4;switch((n!=e&&null!=i?i.disposalMethod:M.NO_ACTION)._hx_index){case 2:for(var f=0,x=u.length;f<x;){f++;s.b[c]=0,s.b[c+1]=0,s.b[c+2]=0,s.b[c+3]=0,++_==h.width?(_=0,c+=d):c+=4}break;case 3:break;default:for(var p=0,g=u.length;p<g;){var m=p++,v=3*u.b[m];l!=v&&(s.b[c]=o.b[v+2],s.b[c+1]=o.b[v+1],s.b[c+2]=o.b[v],s.b[c+3]=255),++_==h.width?(_=0,c+=d):c+=4}}if(n==e)return s;++n,i=null;break;case 1:var y=A.extension;if(0==y._hx_index)i=y.gce}}return s},C.extractFullRGBA=function(t,e){for(var i=null,n=0,s=new Qn(new ArrayBuffer(t.logicalScreenDescriptor.width*t.logicalScreenDescriptor.height*4)),r=t.blocks.h;null!=r;){var a=r.item;r=r.next;var A=a;switch(A._hx_index){case 0:var h=A.frame,o=h.localColorTable?h.colorTable:t.globalColorTable;if(null==o)throw kn.thrown("Frame does not have a color table!");var l=null!=i&&i.hasTransparentColor?3*i.transparentIndex:-1,u=h.pixels,_=0,c=4*(h.y*t.logicalScreenDescriptor.width+h.x),d=4*(t.logicalScreenDescriptor.width-h.width)+4;switch((n!=e&&null!=i?i.disposalMethod:M.NO_ACTION)._hx_index){case 2:for(var f=0,x=u.length;f<x;){f++;s.b[c]=0,s.b[c+1]=0,s.b[c+2]=0,s.b[c+3]=0,++_==h.width?(_=0,c+=d):c+=4}break;case 3:break;default:for(var p=0,g=u.length;p<g;){var m=p++,v=3*u.b[m];l!=v&&(s.b[c]=o.b[v],s.b[c+1]=o.b[v+1],s.b[c+2]=o.b[v+2],s.b[c+3]=255),++_==h.width?(_=0,c+=d):c+=4}}if(n==e)return s;++n,i=null;break;case 1:var y=A.extension;if(0==y._hx_index)i=y.gce}}return s},C.loopCount=function(t){for(var e=t.blocks.h;null!=e;){var i=e.item;e=e.next;var n=i;if(1==n._hx_index){var s=n.extension;if(3==s._hx_index){var r=s.ext;if(0==r._hx_index)return r.loops}}}return 1},C.log2=function(t){return Math.log(t)/C.LN2};var S=s["format.mp3.SamplingRate"]={__ename__:!0,__constructs__:null,SR_8000:{_hx_name:"SR_8000",_hx_index:0,__enum__:"format.mp3.SamplingRate",toString:n},SR_11025:{_hx_name:"SR_11025",_hx_index:1,__enum__:"format.mp3.SamplingRate",toString:n},SR_12000:{_hx_name:"SR_12000",_hx_index:2,__enum__:"format.mp3.SamplingRate",toString:n},SR_22050:{_hx_name:"SR_22050",_hx_index:3,__enum__:"format.mp3.SamplingRate",toString:n},SR_24000:{_hx_name:"SR_24000",_hx_index:4,__enum__:"format.mp3.SamplingRate",toString:n},SR_32000:{_hx_name:"SR_32000",_hx_index:5,__enum__:"format.mp3.SamplingRate",toString:n},SR_44100:{_hx_name:"SR_44100",_hx_index:6,__enum__:"format.mp3.SamplingRate",toString:n},SR_48000:{_hx_name:"SR_48000",_hx_index:7,__enum__:"format.mp3.SamplingRate",toString:n},SR_Bad:{_hx_name:"SR_Bad",_hx_index:8,__enum__:"format.mp3.SamplingRate",toString:n}};S.__constructs__=[S.SR_8000,S.SR_11025,S.SR_12000,S.SR_22050,S.SR_24000,S.SR_32000,S.SR_44100,S.SR_48000,S.SR_Bad],S.__empty_constructs__=[S.SR_8000,S.SR_11025,S.SR_12000,S.SR_22050,S.SR_24000,S.SR_32000,S.SR_44100,S.SR_48000,S.SR_Bad];var I=s["format.mp3.Bitrate"]={__ename__:!0,__constructs__:null,BR_8:{_hx_name:"BR_8",_hx_index:0,__enum__:"format.mp3.Bitrate",toString:n},BR_16:{_hx_name:"BR_16",_hx_index:1,__enum__:"format.mp3.Bitrate",toString:n},BR_24:{_hx_name:"BR_24",_hx_index:2,__enum__:"format.mp3.Bitrate",toString:n},BR_32:{_hx_name:"BR_32",_hx_index:3,__enum__:"format.mp3.Bitrate",toString:n},BR_40:{_hx_name:"BR_40",_hx_index:4,__enum__:"format.mp3.Bitrate",toString:n},BR_48:{_hx_name:"BR_48",_hx_index:5,__enum__:"format.mp3.Bitrate",toString:n},BR_56:{_hx_name:"BR_56",_hx_index:6,__enum__:"format.mp3.Bitrate",toString:n},BR_64:{_hx_name:"BR_64",_hx_index:7,__enum__:"format.mp3.Bitrate",toString:n},BR_80:{_hx_name:"BR_80",_hx_index:8,__enum__:"format.mp3.Bitrate",toString:n},BR_96:{_hx_name:"BR_96",_hx_index:9,__enum__:"format.mp3.Bitrate",toString:n},BR_112:{_hx_name:"BR_112",_hx_index:10,__enum__:"format.mp3.Bitrate",toString:n},BR_128:{_hx_name:"BR_128",_hx_index:11,__enum__:"format.mp3.Bitrate",toString:n},BR_144:{_hx_name:"BR_144",_hx_index:12,__enum__:"format.mp3.Bitrate",toString:n},BR_160:{_hx_name:"BR_160",_hx_index:13,__enum__:"format.mp3.Bitrate",toString:n},BR_176:{_hx_name:"BR_176",_hx_index:14,__enum__:"format.mp3.Bitrate",toString:n},BR_192:{_hx_name:"BR_192",_hx_index:15,__enum__:"format.mp3.Bitrate",toString:n},BR_224:{_hx_name:"BR_224",_hx_index:16,__enum__:"format.mp3.Bitrate",toString:n},BR_256:{_hx_name:"BR_256",_hx_index:17,__enum__:"format.mp3.Bitrate",toString:n},BR_288:{_hx_name:"BR_288",_hx_index:18,__enum__:"format.mp3.Bitrate",toString:n},BR_320:{_hx_name:"BR_320",_hx_index:19,__enum__:"format.mp3.Bitrate",toString:n},BR_352:{_hx_name:"BR_352",_hx_index:20,__enum__:"format.mp3.Bitrate",toString:n},BR_384:{_hx_name:"BR_384",_hx_index:21,__enum__:"format.mp3.Bitrate",toString:n},BR_416:{_hx_name:"BR_416",_hx_index:22,__enum__:"format.mp3.Bitrate",toString:n},BR_448:{_hx_name:"BR_448",_hx_index:23,__enum__:"format.mp3.Bitrate",toString:n},BR_Free:{_hx_name:"BR_Free",_hx_index:24,__enum__:"format.mp3.Bitrate",toString:n},BR_Bad:{_hx_name:"BR_Bad",_hx_index:25,__enum__:"format.mp3.Bitrate",toString:n}};I.__constructs__=[I.BR_8,I.BR_16,I.BR_24,I.BR_32,I.BR_40,I.BR_48,I.BR_56,I.BR_64,I.BR_80,I.BR_96,I.BR_112,I.BR_128,I.BR_144,I.BR_160,I.BR_176,I.BR_192,I.BR_224,I.BR_256,I.BR_288,I.BR_320,I.BR_352,I.BR_384,I.BR_416,I.BR_448,I.BR_Free,I.BR_Bad],I.__empty_constructs__=[I.BR_8,I.BR_16,I.BR_24,I.BR_32,I.BR_40,I.BR_48,I.BR_56,I.BR_64,I.BR_80,I.BR_96,I.BR_112,I.BR_128,I.BR_144,I.BR_160,I.BR_176,I.BR_192,I.BR_224,I.BR_256,I.BR_288,I.BR_320,I.BR_352,I.BR_384,I.BR_416,I.BR_448,I.BR_Free,I.BR_Bad];var k=function(){};i["format.mp3.MPEG"]=k,k.__name__="format.mp3.MPEG",k.enum2Num=function(t){switch(t._hx_index){case 0:return 3;case 1:return 2;case 2:return 0;case 3:return k.Reserved}},k.num2Enum=function(t){switch(t){case 0:return D.MPEG_V25;case 2:return D.MPEG_V2;case 3:return D.MPEG_V1;default:return D.MPEG_Reserved}},k.srNum2Enum=function(t){switch(t){case 8e3:return S.SR_8000;case 11025:return S.SR_11025;case 12e3:return S.SR_12000;case 22050:return S.SR_22050;case 24e3:return S.SR_24000;case 32e3:return S.SR_32000;case 44100:return S.SR_44100;case 48e3:return S.SR_48000;default:return S.SR_Bad}},k.srEnum2Num=function(t){switch(t._hx_index){case 0:return 8e3;case 1:return 11025;case 2:return 12e3;case 3:return 22050;case 4:return 24e3;case 5:return 32e3;case 6:return 44100;case 7:return 48e3;case 8:return-1}},k.getBitrateIdx=function(t,e,i){var n=(e==D.MPEG_V1?k.V1_Bitrates:k.V2_Bitrates)[E.enum2Num(i)];if(n[0]==t)return 0;if(n[1]==t)return 1;if(n[2]==t)return 2;if(n[3]==t)return 3;if(n[4]==t)return 4;if(n[5]==t)return 5;if(n[6]==t)return 6;if(n[7]==t)return 7;if(n[8]==t)return 8;if(n[9]==t)return 9;if(n[10]==t)return 10;if(n[11]==t)return 11;if(n[12]==t)return 12;if(n[13]==t)return 13;if(n[14]==t)return 14;if(n[15]==t)return 15;throw kn.thrown("Bitrate index not found")},k.getSamplingRateIdx=function(t,e){var i=k.SamplingRates[k.enum2Num(e)];if(i[0]==t)return 0;if(i[1]==t)return 1;if(i[2]==t)return 2;if(i[3]==t)return 3;throw kn.thrown("Sampling rate index not found")},k.bitrateEnum2Num=function(t){switch(t._hx_index){case 0:return 8;case 1:return 16;case 2:return 24;case 3:return 32;case 4:return 40;case 5:return 48;case 6:return 56;case 7:return 64;case 8:return 80;case 9:return 96;case 10:return 112;case 11:return 128;case 12:return 144;case 13:return 160;case 14:return 176;case 15:return 192;case 16:return 224;case 17:return 256;case 18:return 288;case 19:return 320;case 20:return 352;case 21:return 384;case 22:return 416;case 23:return 448;case 24:return 0;case 25:return-1}},k.bitrateNum2Enum=function(t){switch(t){case 0:return I.BR_Free;case 8:return I.BR_8;case 16:return I.BR_16;case 24:return I.BR_24;case 32:return I.BR_32;case 40:return I.BR_40;case 48:return I.BR_48;case 56:return I.BR_56;case 64:return I.BR_64;case 80:return I.BR_80;case 96:return I.BR_96;case 112:return I.BR_112;case 128:return I.BR_128;case 144:return I.BR_144;case 160:return I.BR_160;case 176:return I.BR_176;case 192:return I.BR_192;case 224:return I.BR_224;case 256:return I.BR_256;case 288:return I.BR_288;case 320:return I.BR_320;case 352:return I.BR_352;case 384:return I.BR_384;case 416:return I.BR_416;case 448:return I.BR_448;default:return I.BR_Bad}};var E=function(){};i["format.mp3.CLayer"]=E,E.__name__="format.mp3.CLayer",E.enum2Num=function(t){switch(t._hx_index){case 0:return E.LReserved;case 1:return E.LLayer3;case 2:return E.LLayer2;case 3:return E.LLayer1}},E.num2Enum=function(t){switch(t){case 1:return P.Layer3;case 2:return P.Layer2;case 3:return P.Layer1;default:return P.LayerReserved}};var F=function(){};i["format.mp3.CChannelMode"]=F,F.__name__="format.mp3.CChannelMode",F.enum2Num=function(t){switch(t._hx_index){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3}},F.num2Enum=function(t){switch(t){case 0:return z.Stereo;case 1:return z.JointStereo;case 2:return z.DualChannel;case 3:return z.Mono;default:throw kn.thrown("assert")}};var T=function(){};i["format.mp3.CEmphasis"]=T,T.__name__="format.mp3.CEmphasis",T.enum2Num=function(t){switch(t._hx_index){case 0:return 0;case 1:return 1;case 2:return 3;case 3:return 2}},T.num2Enum=function(t){switch(t){case 0:return R.NoEmphasis;case 1:return R.Ms50_15;case 2:return R.InvalidEmphasis;case 3:return R.CCIT_J17;default:throw kn.thrown("assert")}};var D=s["format.mp3.MPEGVersion"]={__ename__:!0,__constructs__:null,MPEG_V1:{_hx_name:"MPEG_V1",_hx_index:0,__enum__:"format.mp3.MPEGVersion",toString:n},MPEG_V2:{_hx_name:"MPEG_V2",_hx_index:1,__enum__:"format.mp3.MPEGVersion",toString:n},MPEG_V25:{_hx_name:"MPEG_V25",_hx_index:2,__enum__:"format.mp3.MPEGVersion",toString:n},MPEG_Reserved:{_hx_name:"MPEG_Reserved",_hx_index:3,__enum__:"format.mp3.MPEGVersion",toString:n}};D.__constructs__=[D.MPEG_V1,D.MPEG_V2,D.MPEG_V25,D.MPEG_Reserved],D.__empty_constructs__=[D.MPEG_V1,D.MPEG_V2,D.MPEG_V25,D.MPEG_Reserved];var P=s["format.mp3.Layer"]={__ename__:!0,__constructs__:null,LayerReserved:{_hx_name:"LayerReserved",_hx_index:0,__enum__:"format.mp3.Layer",toString:n},Layer3:{_hx_name:"Layer3",_hx_index:1,__enum__:"format.mp3.Layer",toString:n},Layer2:{_hx_name:"Layer2",_hx_index:2,__enum__:"format.mp3.Layer",toString:n},Layer1:{_hx_name:"Layer1",_hx_index:3,__enum__:"format.mp3.Layer",toString:n}};P.__constructs__=[P.LayerReserved,P.Layer3,P.Layer2,P.Layer1],P.__empty_constructs__=[P.LayerReserved,P.Layer3,P.Layer2,P.Layer1];var z=s["format.mp3.ChannelMode"]={__ename__:!0,__constructs__:null,Stereo:{_hx_name:"Stereo",_hx_index:0,__enum__:"format.mp3.ChannelMode",toString:n},JointStereo:{_hx_name:"JointStereo",_hx_index:1,__enum__:"format.mp3.ChannelMode",toString:n},DualChannel:{_hx_name:"DualChannel",_hx_index:2,__enum__:"format.mp3.ChannelMode",toString:n},Mono:{_hx_name:"Mono",_hx_index:3,__enum__:"format.mp3.ChannelMode",toString:n}};z.__constructs__=[z.Stereo,z.JointStereo,z.DualChannel,z.Mono],z.__empty_constructs__=[z.Stereo,z.JointStereo,z.DualChannel,z.Mono];var R=s["format.mp3.Emphasis"]={__ename__:!0,__constructs__:null,NoEmphasis:{_hx_name:"NoEmphasis",_hx_index:0,__enum__:"format.mp3.Emphasis",toString:n},Ms50_15:{_hx_name:"Ms50_15",_hx_index:1,__enum__:"format.mp3.Emphasis",toString:n},CCIT_J17:{_hx_name:"CCIT_J17",_hx_index:2,__enum__:"format.mp3.Emphasis",toString:n},InvalidEmphasis:{_hx_name:"InvalidEmphasis",_hx_index:3,__enum__:"format.mp3.Emphasis",toString:n}};R.__constructs__=[R.NoEmphasis,R.Ms50_15,R.CCIT_J17,R.InvalidEmphasis],R.__empty_constructs__=[R.NoEmphasis,R.Ms50_15,R.CCIT_J17,R.InvalidEmphasis];var L=s["format.mp3.FrameType"]={__ename__:!0,__constructs__:null,FT_MP3:{_hx_name:"FT_MP3",_hx_index:0,__enum__:"format.mp3.FrameType",toString:n},FT_NONE:{_hx_name:"FT_NONE",_hx_index:1,__enum__:"format.mp3.FrameType",toString:n}};L.__constructs__=[L.FT_MP3,L.FT_NONE],L.__empty_constructs__=[L.FT_MP3,L.FT_NONE];var V=function(t){this.i=t,t.set_bigEndian(!0),this.bits=new W(t),this.samples=0,this.sampleSize=0,this.any_read=!1};i["format.mp3.Reader"]=V,V.__name__="format.mp3.Reader",V.prototype={skipID3v2:function(){this.id3v2_version=this.i.readUInt16(),this.id3v2_flags=this.i.readByte();var t=127&this.i.readByte();t=(t=(t=t<<7|127&this.i.readByte())<<7|127&this.i.readByte())<<7|127&this.i.readByte(),this.id3v2_data=this.i.read(t)},seekFrame:function(){try{for(var t;;)if(t=this.i.readByte(),this.any_read||(this.any_read=!0,73==t&&68==(t=this.i.readByte())&&51==(t=this.i.readByte())&&this.skipID3v2()),255==t&&(this.bits.nbits=0,7==(t=this.bits.readBits(3))))return L.FT_MP3}catch(t){if(kn.caught(t).unwrap()instanceof As)return L.FT_NONE;throw t}},readFrames:function(){for(var t,e=[];(t=this.seekFrame())!=L.FT_NONE;)if(0===t._hx_index){var i=this.readFrame();null!=i&&e.push(i)}return e},readFrameHeader:function(){var t=this.bits.readBits(2),e=this.bits.readBits(2),i=!this.bits.readBit();if(t==k.Reserved||e==E.LReserved)return null;var n=this.bits.readBits(4),s=Q.getBitrate(t,e,n),r=this.bits.readBits(2),a=Q.getSamplingRate(t,r),A=this.bits.readBit(),h=this.bits.readBit();if(s==I.BR_Bad||s==I.BR_Free||a==S.SR_Bad)return null;var o=this.bits.readBits(2),l=this.bits.readBit(),u=this.bits.readBit(),_=this.bits.readBit(),c=this.bits.readBit(),d=this.bits.readBits(2),f=0;return i&&(f=this.i.readUInt16()),{version:k.num2Enum(t),layer:E.num2Enum(e),hasCrc:i,crc16:f,bitrate:s,samplingRate:a,isPadded:A,privateBit:h,channelMode:F.num2Enum(o),isIntensityStereo:l,isMSStereo:u,isCopyrighted:_,isOriginal:c,emphasis:T.num2Enum(d)}},readFrame:function(){var t=this.readFrameHeader();if(null==t||Q.isInvalidFrameHeader(t))return null;try{var e=this.i.read(Q.getSampleDataSizeHdr(t));return this.samples+=Q.getSampleCountHdr(t),this.sampleSize+=e.length,{header:t,data:e}}catch(t){if(kn.caught(t).unwrap()instanceof As)return null;throw t}},read:function(){return{frames:this.readFrames(),sampleCount:this.samples,sampleSize:this.sampleSize,id3v2:null==this.id3v2_data?null:{versionBytes:this.id3v2_version,flagByte:this.id3v2_flags,data:this.id3v2_data}}},__class__:V};var Q=function(){};i["format.mp3.Tools"]=Q,Q.__name__="format.mp3.Tools",Q.getBitrate=function(t,e,i){return t==k.Reserved||e==E.LReserved?I.BR_Bad:(3==t?k.V1_Bitrates:k.V2_Bitrates)[e][i]},Q.getSamplingRate=function(t,e){return k.SamplingRates[t][e]},Q.isInvalidFrameHeader=function(t){return t.version==D.MPEG_Reserved||t.layer==P.LayerReserved||t.bitrate==I.BR_Bad||t.bitrate==I.BR_Free||t.samplingRate==S.SR_Bad},Q.getSampleDataSize=function(t,e,i,n,s){return((3==t?144:72)*e*1e3/i|0)+(n?1:0)-(s?2:0)-4},Q.getSampleDataSizeHdr=function(t){return Q.getSampleDataSize(k.enum2Num(t.version),k.bitrateEnum2Num(t.bitrate),k.srEnum2Num(t.samplingRate),t.isPadded,t.hasCrc)},Q.getSampleCount=function(t){return 3==t?1152:576},Q.getSampleCountHdr=function(t){return Q.getSampleCount(k.enum2Num(t.version))},Q.getFrameInfo=function(t){return x.string(t.header.version)+", "+x.string(t.header.layer)+", "+x.string(t.header.channelMode)+", "+x.string(t.header.samplingRate)+" Hz, "+x.string(t.header.bitrate)+" kbps Emphasis: "+x.string(t.header.emphasis)+", "+(t.header.hasCrc?"(CRC) ":"")+(t.header.isPadded?"(Padded) ":"")+(t.header.isIntensityStereo?"(Intensity Stereo) ":"")+(t.header.isMSStereo?"(MS Stereo) ":"")+(t.header.isCopyrighted?"(Copyrighted) ":"")+(t.header.isOriginal?"(Original) ":"")};var U=s["format.png.Color"]={__ename__:!0,__constructs__:null,ColGrey:(e=function(t){return{_hx_index:0,alpha:t,__enum__:"format.png.Color",toString:n}},e._hx_name="ColGrey",e.__params__=["alpha"],e),ColTrue:(e=function(t){return{_hx_index:1,alpha:t,__enum__:"format.png.Color",toString:n}},e._hx_name="ColTrue",e.__params__=["alpha"],e),ColIndexed:{_hx_name:"ColIndexed",_hx_index:2,__enum__:"format.png.Color",toString:n}};U.__constructs__=[U.ColGrey,U.ColTrue,U.ColIndexed],U.__empty_constructs__=[U.ColIndexed];var O=s["format.png.Chunk"]={__ename__:!0,__constructs__:null,CEnd:{_hx_name:"CEnd",_hx_index:0,__enum__:"format.png.Chunk",toString:n},CHeader:(e=function(t){return{_hx_index:1,h:t,__enum__:"format.png.Chunk",toString:n}},e._hx_name="CHeader",e.__params__=["h"],e),CData:(e=function(t){return{_hx_index:2,b:t,__enum__:"format.png.Chunk",toString:n}},e._hx_name="CData",e.__params__=["b"],e),CPalette:(e=function(t){return{_hx_index:3,b:t,__enum__:"format.png.Chunk",toString:n}},e._hx_name="CPalette",e.__params__=["b"],e),CUnknown:(e=function(t,e){return{_hx_index:4,id:t,data:e,__enum__:"format.png.Chunk",toString:n}},e._hx_name="CUnknown",e.__params__=["id","data"],e)};O.__constructs__=[O.CEnd,O.CHeader,O.CData,O.CPalette,O.CUnknown],O.__empty_constructs__=[O.CEnd];var G=function(t){this.i=t,t.set_bigEndian(!0),this.checkCRC=!0};i["format.png.Reader"]=G,G.__name__="format.png.Reader",G.prototype={read:function(){var t=137;if(this.i.readByte()!=t)throw kn.thrown("Invalid header");t=80;if(this.i.readByte()!=t)throw kn.thrown("Invalid header");t=78;if(this.i.readByte()!=t)throw kn.thrown("Invalid header");t=71;if(this.i.readByte()!=t)throw kn.thrown("Invalid header");t=13;if(this.i.readByte()!=t)throw kn.thrown("Invalid header");t=10;if(this.i.readByte()!=t)throw kn.thrown("Invalid header");t=26;if(this.i.readByte()!=t)throw kn.thrown("Invalid header");t=10;if(this.i.readByte()!=t)throw kn.thrown("Invalid header");for(var e=new Zn;;){var i=this.readChunk();if(e.add(i),i==O.CEnd)break}return e},readHeader:function(t){t.set_bigEndian(!0);var e,i=t.readInt32(),n=t.readInt32(),s=t.readByte(),r=t.readByte();switch(r){case 0:e=U.ColGrey(!1);break;case 2:e=U.ColTrue(!1);break;case 3:e=U.ColIndexed;break;case 4:e=U.ColGrey(!0);break;case 6:e=U.ColTrue(!0);break;default:throw kn.thrown("Unknown color model "+r+":"+s)}var a=t.readByte(),A=t.readByte();if(0!=a||0!=A)throw kn.thrown("Invalid header");var h=t.readByte();if(0!=h&&1!=h)throw kn.thrown("Invalid header");return{width:i,height:n,colbits:s,color:e,interlaced:1==h}},readChunk:function(){var t=this.i.readInt32(),e=this.i.readString(4),i=this.i.read(t),n=this.i.readInt32();if(this.checkCRC){var s=-1;h=(h=255&((s=s>>>8^(h=(h=(h=(h=(h=(h=(h=(h=(h=255&(s^l.cca(e,0)))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h)))^l.cca(e,1)))>>>1^-306674912&-(1&h),h=(h=255&((s=s>>>8^(h=(h=(h=(h=(h=(h=(h=h>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h)))^l.cca(e,2)))>>>1^-306674912&-(1&h),s=(s=s>>>8^(h=(h=(h=(h=(h=(h=(h=h>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h)))>>>8^(h=(h=(h=(h=(h=(h=(h=(h=(h=255&(s^l.cca(e,3)))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h));for(var r=i.b.bufferValue,a=0,A=i.length;a<A;){var h,o=a++;s=s>>>8^(h=(h=(h=(h=(h=(h=(h=(h=(h=255&(s^r.bytes[o]))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))>>>1^-306674912&-(1&h))}if((-1^s)!=n)throw kn.thrown("CRC check failure")}switch(e){case"IDAT":return O.CData(i);case"IEND":return O.CEnd;case"IHDR":return O.CHeader(this.readHeader(new ss(i)));case"PLTE":return O.CPalette(i);default:return O.CUnknown(e,i)}},__class__:G};var N=function(){};i["format.png.Tools"]=N,N.__name__="format.png.Tools",N.getHeader=function(t){for(var e=t.h;null!=e;){var i=e.item;e=e.next;var n=i;if(1==n._hx_index)return n.h}throw kn.thrown("Header not found")},N.getPalette=function(t){for(var e=t.h;null!=e;){var i=e.item;e=e.next;var n=i;if(3==n._hx_index)return n.b}return null},N.filter=function(t,e,i,n,s,r,a){null==a&&(a=4);var A=0==i?0:t.b[r-n],h=0==e||0==i?0:t.b[r-n-a],o=s+A-h,l=o-s;l<0&&(l=-l);var u=o-A;u<0&&(u=-u);var _=o-h;return _<0&&(_=-_),l<=u&&l<=_?s:u<=_?A:h},N.reverseBytes=function(t){for(var e=0,i=0,n=t.length>>2;i<n;){i++;var s=t.b[e],r=t.b[e+1],a=t.b[e+2],A=t.b[e+3];t.b[e++]=A,t.b[e++]=a,t.b[e++]=r,t.b[e++]=s}},N.extractGrey=function(t){for(var e=N.getHeader(t),i=new Qn(new ArrayBuffer(e.width*e.height)),n=null,s=null,r=t.h;null!=r;){var a=r.item;if(r=r.next,2==(L=a)._hx_index){var A=L.b;null!=s?s.add(A):null==n?n=A:((s=new is).add(n),s.add(A),n=null)}}if(null!=s&&(n=s.getBytes()),null==n)throw kn.thrown("Data not found");n=J.run(n);var h=0,o=0;if(0!=(d=e.color)._hx_index)throw kn.thrown("Unsupported color mode");var l=d.alpha;if(8!=e.colbits)throw kn.thrown("Unsupported color mode");var u=e.width,_=(l?2:1)*u+1;if(n.length<e.height*_)throw kn.thrown("Not enough data");for(var c=l?2:1,d=0,f=e.height;d<f;){var x=d++,p=n.b[h++];switch(p){case 0:for(var g=0,m=u;g<m;){g++;var v=n.b[h];h+=c,i.b[o++]=v}break;case 1:for(var y=0,b=0,w=u;b<w;){b++;y+=n.b[h],h+=c,i.b[o++]=y}break;case 2:_=0==x?0:u;for(var M=0,B=u;M<B;){M++;var C=n.b[h]+i.b[o-_];h+=c,i.b[o++]=C}break;case 3:for(var S=0,I=0==x?0:u,k=0,E=u;k<E;){k++;S=n.b[h]+(S+i.b[o-I]>>1)&255,h+=c,i.b[o++]=S}break;case 4:for(var F=u,T=0,D=0,P=u;D<P;){var z=D++,R=1;null==R&&(R=4);var L,V=T+(A=0==x?0:i.b[o-F])-(L=0==z||0==x?0:i.b[o-F-R]),Q=V-T;Q<0&&(Q=-Q);var U=V-A;U<0&&(U=-U);var O=V-L;O<0&&(O=-O),T=(Q<=U&&Q<=O?T:U<=O?A:L)+n.b[h]&255,h+=c,i.b[o++]=T}break;default:throw kn.thrown("Invalid filter "+p)}}return i},N.extract32=function(t,e,i){for(var n=N.getHeader(t),s=null==e?new Qn(new ArrayBuffer(n.width*n.height*4)):e,r=null,a=null,A=t.h;null!=A;){var h=A.item;if(A=A.next,2==(te=h)._hx_index){var o=te.b;null!=a?a.add(o):null==r?r=o:((a=new is).add(r),a.add(o),r=null)}}if(null!=a&&(r=a.getBytes()),null==r)throw kn.thrown("Data not found");r=J.run(r);var l=0,u=0,_=0;i&&(_=8*-n.width,u=(n.height-1)*(4*n.width));var c=i?-1:1;switch((ct=n.color)._hx_index){case 0:var d=ct.alpha;if(8!=n.colbits)throw kn.thrown("Unsupported color mode");var f=(d?2:1)*(qt=n.width)+1;if(r.length<n.height*f)throw kn.thrown("Not enough data");var x=-1;if(!d)for(var p=t.h;null!=p;){h=p.item;if(p=p.next,4==(Wt=h)._hx_index&&"tRNS"==Wt.id){(Zt=Wt.data).length>=2&&(x=Zt.b[1]);break}}for(var g=0,m=n.height;g<m;){var v=g++;switch($t=r.b[l++]){case 0:if(d)for(var y=0,b=qt;y<b;){y++;var w=r.b[l++];s.b[u++]=w,s.b[u++]=w,s.b[u++]=w,s.b[u++]=r.b[l++]}else for(var M=0,B=qt;M<B;){M++;var C=r.b[l++];s.b[u++]=C,s.b[u++]=C,s.b[u++]=C,s.b[u++]=C==x?0:255}break;case 1:var S=0,I=0;if(d)for(var k=0,E=qt;k<E;){k++;S+=r.b[l++],s.b[u++]=S,s.b[u++]=S,s.b[u++]=S,I+=r.b[l++],s.b[u++]=I}else for(var F=0,T=qt;F<T;){var D=F++;S+=r.b[l++],s.b[u++]=S,s.b[u++]=S,s.b[u++]=S,s.b[u++]=S==x?0:255}break;case 2:f=0==v?0:4*qt*c;if(d)for(var P=0,z=qt;P<z;){P++;var R=r.b[l++]+s.b[u-f];s.b[u++]=R,s.b[u++]=R,s.b[u++]=R,s.b[u++]=r.b[l++]+s.b[u-f]}else for(var L=0,V=qt;L<V;){L++;var Q=r.b[l++]+s.b[u-f];s.b[u++]=Q,s.b[u++]=Q,s.b[u++]=Q,s.b[u++]=Q==x?0:255}break;case 3:var U=0,O=0,G=0==v?0:4*qt*c;if(d)for(var Y=0,X=qt;Y<X;){Y++;U=r.b[l++]+(U+s.b[u-G]>>1)&255,s.b[u++]=U,s.b[u++]=U,s.b[u++]=U,O=r.b[l++]+(O+s.b[u-G]>>1)&255,s.b[u++]=O}else for(var j=0,H=qt;j<H;){j++;U=r.b[l++]+(U+s.b[u-G]>>1)&255,s.b[u++]=U,s.b[u++]=U,s.b[u++]=U,s.b[u++]=U==x?0:255}break;case 4:var W=4*qt*c,Z=0,q=0;if(d)for(var K=0,$=qt;K<$;){var tt=K++;(re=(se=Z+(o=0==v?0:s.b[u-W])-(te=0==tt||0==v?0:s.b[u-W-4]))-Z)<0&&(re=-re),(ae=se-o)<0&&(ae=-ae),(Ae=se-te)<0&&(Ae=-Ae);var et=l++;Z=(re<=ae&&re<=Ae?Z:ae<=Ae?o:te)+r.b[et]&255,s.b[u++]=Z,s.b[u++]=Z,s.b[u++]=Z,(xt=(ft=q+(dt=0==v?0:s.b[u-W])-(ee=0==tt||0==v?0:s.b[u-W-4]))-q)<0&&(xt=-xt),(pt=ft-dt)<0&&(pt=-pt),(gt=ft-ee)<0&&(gt=-gt);var it=l++;q=(xt<=pt&&xt<=gt?q:pt<=gt?dt:ee)+r.b[it]&255,s.b[u++]=q}else for(var nt=0,st=qt;nt<st;){var rt=nt++;(yt=(vt=Z+(mt=0==v?0:s.b[u-W])-(ie=0==rt||0==v?0:s.b[u-W-4]))-Z)<0&&(yt=-yt),(bt=vt-mt)<0&&(bt=-bt),(wt=vt-ie)<0&&(wt=-wt);var at=l++;Z=(yt<=bt&&yt<=wt?Z:bt<=wt?mt:ie)+r.b[at]&255,s.b[u++]=Z,s.b[u++]=Z,s.b[u++]=Z,s.b[u++]=Z==x?0:255}break;default:throw kn.thrown("Invalid filter "+$t)}u+=_}break;case 1:d=ct.alpha;if(8!=n.colbits)throw kn.thrown("Unsupported color mode");f=(d?4:3)*(qt=n.width)+1;if(r.length<n.height*f)throw kn.thrown("Not enough data");var At=-1,ht=-1,ot=-1;if(!d)for(p=t.h;null!=p;){h=p.item;if(p=p.next,4==(Wt=h)._hx_index&&"tRNS"==Wt.id){(Zt=Wt.data).length>=6&&(At=Zt.b[1],ht=Zt.b[3],ot=Zt.b[5]);break}}var lt=0,ut=0,_t=0,ct=(I=0,0);for(g=n.height;ct<g;){v=ct++;switch($t=r.b[l++]){case 0:if(d)for(m=0,y=qt;m<y;){m++;s.b[u++]=r.b[l+2],s.b[u++]=r.b[l+1],s.b[u++]=r.b[l],s.b[u++]=r.b[l+3],l+=4}else for(b=0,M=qt;b<M;){b++;_t=r.b[l+2],s.b[u++]=_t,ut=r.b[l+1],s.b[u++]=ut,lt=r.b[l],s.b[u++]=lt,s.b[u++]=lt==At&&ut==ht&&_t==ot?0:255,l+=3}break;case 1:if(lt=ut=_t=I=0,d)for(B=0,k=qt;B<k;){B++;_t+=r.b[l+2],s.b[u++]=_t,ut+=r.b[l+1],s.b[u++]=ut,lt+=r.b[l],s.b[u++]=lt,I+=r.b[l+3],s.b[u++]=I,l+=4}else for(E=0,F=qt;E<F;){D=E++;_t+=r.b[l+2],s.b[u++]=_t,ut+=r.b[l+1],s.b[u++]=ut,lt+=r.b[l],s.b[u++]=lt,s.b[u++]=lt==At&&ut==ht&&_t==ot?0:255,l+=3}break;case 2:f=0==v?0:4*qt*c;if(d)for(T=0,P=qt;T<P;){T++;s.b[u]=r.b[l+2]+s.b[u-f],++u,s.b[u]=r.b[l+1]+s.b[u-f],++u,s.b[u]=r.b[l]+s.b[u-f],++u,s.b[u]=r.b[l+3]+s.b[u-f],++u,l+=4}else for(z=0,L=qt;z<L;){z++;_t=r.b[l+2]+s.b[u-f],s.b[u]=_t,++u,ut=r.b[l+1]+s.b[u-f],s.b[u]=ut,++u,lt=r.b[l]+s.b[u-f],s.b[u]=lt,++u,s.b[u++]=lt==At&&ut==ht&&_t==ot?0:255,l+=3}break;case 3:lt=ut=_t=I=0;G=0==v?0:4*qt*c;if(d)for(V=0,Y=qt;V<Y;){V++;_t=r.b[l+2]+(_t+s.b[u-G]>>1)&255,s.b[u++]=_t,ut=r.b[l+1]+(ut+s.b[u-G]>>1)&255,s.b[u++]=ut,lt=r.b[l]+(lt+s.b[u-G]>>1)&255,s.b[u++]=lt,I=r.b[l+3]+(I+s.b[u-G]>>1)&255,s.b[u++]=I,l+=4}else for(X=0,j=qt;X<j;){X++;_t=r.b[l+2]+(_t+s.b[u-G]>>1)&255,s.b[u++]=_t,ut=r.b[l+1]+(ut+s.b[u-G]>>1)&255,s.b[u++]=ut,lt=r.b[l]+(lt+s.b[u-G]>>1)&255,s.b[u++]=lt,s.b[u++]=lt==At&&ut==ht&&_t==ot?0:255,l+=3}break;case 4:W=4*qt*c;if(lt=ut=_t=I=0,d)for(H=0,K=qt;H<K;){var dt,ft,xt,pt,gt,mt,vt,yt,bt,wt;tt=H++;(re=(se=_t+(o=0==v?0:s.b[u-W])-(te=0==tt||0==v?0:s.b[u-W-4]))-_t)<0&&(re=-re),(ae=se-o)<0&&(ae=-ae),(Ae=se-te)<0&&(Ae=-Ae),_t=(re<=ae&&re<=Ae?_t:ae<=Ae?o:te)+r.b[l+2]&255,s.b[u++]=_t,(xt=(ft=ut+(dt=0==v?0:s.b[u-W])-(ee=0==tt||0==v?0:s.b[u-W-4]))-ut)<0&&(xt=-xt),(pt=ft-dt)<0&&(pt=-pt),(gt=ft-ee)<0&&(gt=-gt),ut=(xt<=pt&&xt<=gt?ut:pt<=gt?dt:ee)+r.b[l+1]&255,s.b[u++]=ut,(yt=(vt=lt+(mt=0==v?0:s.b[u-W])-(ie=0==tt||0==v?0:s.b[u-W-4]))-lt)<0&&(yt=-yt),(bt=vt-mt)<0&&(bt=-bt),(wt=vt-ie)<0&&(wt=-wt),lt=(yt<=bt&&yt<=wt?lt:bt<=wt?mt:ie)+r.b[l]&255,s.b[u++]=lt;var Mt=0==v?0:s.b[u-W],Bt=I+Mt-(ne=0==tt||0==v?0:s.b[u-W-4]),Ct=Bt-I;Ct<0&&(Ct=-Ct);var St=Bt-Mt;St<0&&(St=-St);var It=Bt-ne;It<0&&(It=-It),I=(Ct<=St&&Ct<=It?I:St<=It?Mt:ne)+r.b[l+3]&255,s.b[u++]=I,l+=4}else for($=0,nt=qt;$<nt;){rt=$++;var kt=0==v?0:s.b[u-W],Et=0==rt||0==v?0:s.b[u-W-4],Ft=_t+kt-Et,Tt=Ft-_t;Tt<0&&(Tt=-Tt);var Dt=Ft-kt;Dt<0&&(Dt=-Dt);var Pt=Ft-Et;Pt<0&&(Pt=-Pt),_t=(Tt<=Dt&&Tt<=Pt?_t:Dt<=Pt?kt:Et)+r.b[l+2]&255,s.b[u++]=_t;var zt=0==v?0:s.b[u-W],Rt=0==rt||0==v?0:s.b[u-W-4],Lt=ut+zt-Rt,Vt=Lt-ut;Vt<0&&(Vt=-Vt);var Qt=Lt-zt;Qt<0&&(Qt=-Qt);var Ut=Lt-Rt;Ut<0&&(Ut=-Ut),ut=(Vt<=Qt&&Vt<=Ut?ut:Qt<=Ut?zt:Rt)+r.b[l+1]&255,s.b[u++]=ut;var Ot=0==v?0:s.b[u-W],Gt=0==rt||0==v?0:s.b[u-W-4],Nt=lt+Ot-Gt,Yt=Nt-lt;Yt<0&&(Yt=-Yt);var Xt=Nt-Ot;Xt<0&&(Xt=-Xt);var jt=Nt-Gt;jt<0&&(jt=-jt),lt=(Yt<=Xt&&Yt<=jt?lt:Xt<=jt?Ot:Gt)+r.b[l]&255,s.b[u++]=lt,s.b[u++]=lt==At&&ut==ht&&_t==ot?0:255,l+=3}break;default:throw kn.thrown("Invalid filter "+$t)}u+=_}break;case 2:var Ht=N.getPalette(t);if(null==Ht)throw kn.thrown("PNG Palette is missing");for(d=null,p=t.h;null!=p;){var Wt;h=p.item;if(p=p.next,4==(Wt=h)._hx_index&&"tRNS"==Wt.id){var Zt;d=Zt=Wt.data;break}}if(null!=d&&d.length<1<<n.colbits){var Jt=new Qn(new ArrayBuffer(1<<n.colbits));Jt.blit(0,d,0,d.length),Jt.fill(d.length,Jt.length-d.length,255),d=Jt}var qt=n.width;f=Math.ceil(qt*n.colbits/8)+1;if(r.length<n.height*f)throw kn.thrown("Not enough data");var Kt=n.width*n.colbits>>3;for(ct=0,g=n.height;ct<g;){var $t;v=ct++;if(0!=($t=r.b[l++]))switch($t){case 1:var te=0;for(m=0,y=qt;m<y;){m++;te+=w=r.b[l],r.b[l++]=255&te}break;case 2:for(f=0==v?0:Kt+1,b=0,M=qt;b<M;){b++,C=r.b[l];r.b[l]=C+r.b[l-f],++l}break;case 3:var ee=0;for(G=0==v?0:Kt+1,B=0,k=qt;B<k;){B++;ee=(R=r.b[l])+(ee+r.b[l-G]>>1)&255,r.b[l++]=ee}break;case 4:W=Kt+1;var ie=0;for(E=0,F=qt;E<F;){D=E++,Q=r.b[l];var ne,se,re,ae,Ae,he=1;null==he&&(he=4),(re=(se=ie+(o=0==v?0:r.b[l-W])-(ne=0==D||0==v?0:r.b[l-W-he]))-ie)<0&&(re=-re),(ae=se-o)<0&&(ae=-ae),(Ae=se-ne)<0&&(Ae=-Ae),ie=(re<=ae&&re<=Ae?ie:ae<=Ae?o:ne)+Q&255,r.b[l++]=ie}break;default:throw kn.thrown("Invalid filter "+$t)}else l+=Kt}l=0;if(8==n.colbits)for(ct=0,g=n.height;ct<g;){v=ct++;++l;for(m=0,y=n.width;m<y;){m++,te=r.b[l++];s.b[u++]=Ht.b[3*te+2],s.b[u++]=Ht.b[3*te+1],s.b[u++]=Ht.b[3*te],s.b[u++]=null!=d?d.b[te]:255}u+=_}else{if(!(n.colbits<8))throw kn.thrown(n.colbits+" indexed bits per pixel not supported");var oe=n.colbits,le=(1<<oe)-1;for(ct=0,g=n.height;ct<g;){v=ct++;++l;var ue=0,_e=0;for(m=0,y=n.width;m<y;){m++;_e<oe&&(ue=ue<<8|r.b[l++],_e+=8);te=ue>>>_e-oe&le;_e-=oe,s.b[u++]=Ht.b[3*te+2],s.b[u++]=Ht.b[3*te+1],s.b[u++]=Ht.b[3*te],s.b[u++]=null!=d?d.b[te]:255}u+=_}}}return s},N.buildGrey=function(t,e,i,n){null==n&&(n=9);for(var s=new Qn(new ArrayBuffer(t*e+e)),r=0,a=0,A=0,h=e;A<h;){A++;s.b[r++]=0;for(var o=0,l=t;o<l;){o++;s.b[r++]=i.b[a++]}}var u=new Zn;return u.add(O.CHeader({width:t,height:e,colbits:8,color:U.ColGrey(!1),interlaced:!1})),u.add(O.CData(Z.run(s,n))),u.add(O.CEnd),u},N.buildIndexed=function(t,e,i,n,s){null==s&&(s=9);for(var r=new Qn(new ArrayBuffer(t*e+e)),a=0,A=0,h=0,o=e;h<o;){h++;r.b[a++]=0;for(var l=0,u=t;l<u;){l++;r.b[a++]=i.b[A++]}}var _=new Zn;return _.add(O.CHeader({width:t,height:e,colbits:8,color:U.ColIndexed,interlaced:!1})),_.add(O.CPalette(n)),_.add(O.CData(Z.run(r,s))),_.add(O.CEnd),_},N.buildRGB=function(t,e,i,n){null==n&&(n=9);for(var s=new Qn(new ArrayBuffer(t*e*3+e)),r=0,a=0,A=0,h=e;A<h;){A++;s.b[r++]=0;for(var o=0,l=t;o<l;){o++;s.b[r++]=i.b[a+2],s.b[r++]=i.b[a+1],s.b[r++]=i.b[a],a+=3}}var u=new Zn;return u.add(O.CHeader({width:t,height:e,colbits:8,color:U.ColTrue(!1),interlaced:!1})),u.add(O.CData(Z.run(s,n))),u.add(O.CEnd),u},N.build32ARGB=function(t,e,i,n){null==n&&(n=9);for(var s=new Qn(new ArrayBuffer(t*e*4+e)),r=0,a=0,A=0,h=e;A<h;){A++;s.b[r++]=0;for(var o=0,l=t;o<l;){o++;s.b[r++]=i.b[a+1],s.b[r++]=i.b[a+2],s.b[r++]=i.b[a+3],s.b[r++]=i.b[a],a+=4}}var u=new Zn;return u.add(O.CHeader({width:t,height:e,colbits:8,color:U.ColTrue(!0),interlaced:!1})),u.add(O.CData(Z.run(s,n))),u.add(O.CEnd),u},N.build32BGRA=function(t,e,i,n){null==n&&(n=9);for(var s=new Qn(new ArrayBuffer(t*e*4+e)),r=0,a=0,A=0,h=e;A<h;){A++;s.b[r++]=0;for(var o=0,l=t;o<l;){o++;s.b[r++]=i.b[a+2],s.b[r++]=i.b[a+1],s.b[r++]=i.b[a],s.b[r++]=i.b[a+3],a+=4}}var u=new Zn;return u.add(O.CHeader({width:t,height:e,colbits:8,color:U.ColTrue(!0),interlaced:!1})),u.add(O.CData(Z.run(s,n))),u.add(O.CEnd),u};var Y=function(t){this.o=t,t.set_bigEndian(!0)};i["format.png.Writer"]=Y,Y.__name__="format.png.Writer",Y.prototype={write:function(t){var e=137;this.o.writeByte(e);e=80;this.o.writeByte(e);e=78;this.o.writeByte(e);e=71;this.o.writeByte(e);e=13;this.o.writeByte(e);e=10;this.o.writeByte(e);e=26;this.o.writeByte(e);e=10;this.o.writeByte(e);for(var i=t.h;null!=i;){var n=i.item;i=i.next;var s=n;switch(s._hx_index){case 0:this.writeChunk("IEND",new Qn(new ArrayBuffer(0)));break;case 1:var r=s.h;(e=new as).set_bigEndian(!0),e.writeInt32(r.width),e.writeInt32(r.height),e.writeByte(r.colbits);var a,A=r.color;switch(A._hx_index){case 0:a=A.alpha?4:0;break;case 1:a=A.alpha?6:2;break;case 2:a=3}e.writeByte(a),e.writeByte(0),e.writeByte(0),e.writeByte(r.interlaced?1:0),this.writeChunk("IHDR",e.getBytes());break;case 2:var h=s.b;this.writeChunk("IDAT",h);break;case 3:var o=s.b;this.writeChunk("PLTE",o);break;case 4:var l=s.id,u=s.data;this.writeChunk(l,u)}}},writeChunk:function(t,e){this.o.writeInt32(e.length),this.o.writeString(t),this.o.write(e);var i=-1;a=(a=255&((i=i>>>8^(a=(a=(a=(a=(a=(a=(a=(a=(a=255&(i^l.cca(t,0)))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a)))^l.cca(t,1)))>>>1^-306674912&-(1&a),a=(a=255&((i=i>>>8^(a=(a=(a=(a=(a=(a=(a=a>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a)))^l.cca(t,2)))>>>1^-306674912&-(1&a),i=(i=i>>>8^(a=(a=(a=(a=(a=(a=(a=a>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a)))>>>8^(a=(a=(a=(a=(a=(a=(a=(a=(a=255&(i^l.cca(t,3)))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a));for(var n=e.b.bufferValue,s=0,r=e.length;s<r;){var a,A=s++;i=i>>>8^(a=(a=(a=(a=(a=(a=(a=(a=(a=255&(i^n.bytes[A]))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))>>>1^-306674912&-(1&a))}this.o.writeInt32(-1^i)},__class__:Y};var X=s["format.tga.ImageOrigin"]={__ename__:!0,__constructs__:null,BottomLeft:{_hx_name:"BottomLeft",_hx_index:0,__enum__:"format.tga.ImageOrigin",toString:n},BottomRight:{_hx_name:"BottomRight",_hx_index:1,__enum__:"format.tga.ImageOrigin",toString:n},TopLeft:{_hx_name:"TopLeft",_hx_index:2,__enum__:"format.tga.ImageOrigin",toString:n},TopRight:{_hx_name:"TopRight",_hx_index:3,__enum__:"format.tga.ImageOrigin",toString:n}};X.__constructs__=[X.BottomLeft,X.BottomRight,X.TopLeft,X.TopRight],X.__empty_constructs__=[X.BottomLeft,X.BottomRight,X.TopLeft,X.TopRight];var j=s["format.tga.ImageType"]={__ename__:!0,__constructs__:null,NoImage:{_hx_name:"NoImage",_hx_index:0,__enum__:"format.tga.ImageType",toString:n},UncompressedColorMapped:{_hx_name:"UncompressedColorMapped",_hx_index:1,__enum__:"format.tga.ImageType",toString:n},UncompressedTrueColor:{_hx_name:"UncompressedTrueColor",_hx_index:2,__enum__:"format.tga.ImageType",toString:n},UncompressedBlackAndWhite:{_hx_name:"UncompressedBlackAndWhite",_hx_index:3,__enum__:"format.tga.ImageType",toString:n},RunLengthColorMapped:{_hx_name:"RunLengthColorMapped",_hx_index:4,__enum__:"format.tga.ImageType",toString:n},RunLengthTrueColor:{_hx_name:"RunLengthTrueColor",_hx_index:5,__enum__:"format.tga.ImageType",toString:n},RunLengthBlackAndWhite:{_hx_name:"RunLengthBlackAndWhite",_hx_index:6,__enum__:"format.tga.ImageType",toString:n},Unknown:(e=function(t){return{_hx_index:7,type:t,__enum__:"format.tga.ImageType",toString:n}},e._hx_name="Unknown",e.__params__=["type"],e)};j.__constructs__=[j.NoImage,j.UncompressedColorMapped,j.UncompressedTrueColor,j.UncompressedBlackAndWhite,j.RunLengthColorMapped,j.RunLengthTrueColor,j.RunLengthBlackAndWhite,j.Unknown],j.__empty_constructs__=[j.NoImage,j.UncompressedColorMapped,j.UncompressedTrueColor,j.UncompressedBlackAndWhite,j.RunLengthColorMapped,j.RunLengthTrueColor,j.RunLengthBlackAndWhite];var H=function(t){this.i=t,t.set_bigEndian(!1)};i["format.tga.Reader"]=H,H.__name__="format.tga.Reader",H.prototype={read:function(){var t=this.i.readByte(),e=this.readHeader(),i=0==t?"":this.i.readString(t),n=this.readColorMapData(e);return{header:e,imageId:i,colorMapData:n,imageData:this.readImageData(e,n),developerData:null}},readHeader:function(){var t,e=this.i.readByte(),i=this.i.readByte();switch(i){case 0:t=j.NoImage;break;case 1:t=j.UncompressedColorMapped;break;case 2:t=j.UncompressedTrueColor;break;case 3:t=j.UncompressedBlackAndWhite;break;case 9:t=j.RunLengthColorMapped;break;case 10:t=j.RunLengthTrueColor;break;case 11:t=j.RunLengthBlackAndWhite;break;default:t=j.Unknown(i)}var n,s=this.i.readInt16(),r=this.i.readInt16(),a=this.i.readByte(),A=this.i.readInt16(),h=this.i.readInt16(),o=this.i.readInt16(),l=this.i.readInt16(),u=this.i.readByte(),_=this.i.readByte();switch(48&_){case 16:n=X.BottomRight;break;case 32:n=X.TopLeft;break;case 48:n=X.TopRight;break;default:n=X.BottomLeft}return{colorMapType:e,imageType:t,colorMapFirstIndex:s,colorMapLength:r,colorMapEntrySize:a,xOrigin:A,yOrigin:h,width:o,height:l,bitsPerPixel:u,alphaChannelBits:15&_,imageOrigin:n}},readColorMapData:function(t){return 0==t.colorMapType?null:this.readPixels(t.colorMapEntrySize,t.colorMapLength,t.alphaChannelBits,!1)},readImageData:function(t,e){switch(t.imageType._hx_index){case 0:return null;case 1:return this.readIndexes(t.bitsPerPixel,t.width*t.height,e,t.colorMapFirstIndex,!1);case 2:return this.readPixels(t.bitsPerPixel,t.width*t.height,t.alphaChannelBits,!1);case 3:return this.readMono(t.bitsPerPixel,t.width*t.height,t.alphaChannelBits,!1);case 4:return this.readIndexes(t.bitsPerPixel,t.width*t.height,e,t.colorMapFirstIndex,!0);case 5:return this.readPixels(t.bitsPerPixel,t.width*t.height,t.alphaChannelBits,!0);case 6:return this.readMono(t.bitsPerPixel,t.width*t.height,t.alphaChannelBits,!0);default:throw kn.thrown("Unsupported image data type!")}},readPixels:function(t,i,n,s){var r,a,A=new Array(i),h=0!=n,o=t/3|0;switch(o>8&&(o=8),t){case 8:a=XA(e=this.i,e.readByte),r=XA(this,this.parsePixel1);break;case 16:a=XA(e=this.i,e.readUInt16),r=XA(this,this.parsePixel2);break;case 24:a=XA(e=this.i,e.readUInt24),r=XA(this,this.parsePixel3);break;case 32:a=XA(e=this.i,e.readInt32),r=XA(this,this.parsePixel4);break;default:throw kn.thrown("Unsupported bits per pixels amount!")}if(s)for(var l,u=0;u<i;)if(0!=(128&(l=this.i.readByte()))){l&=127;for(var _=r(a(),h);l>=0;)A[u++]=_,--l}else for(l&=127;l>=0;)A[u++]=r(a(),h),--l;else for(var c=0,d=i;c<d;){A[u=c++]=r(a(),h)}return A},readMono:function(t,i,n,s){var r,a,A=new Array(i),h=0!=n;switch(t){case 8:a=XA(e=this.i,e.readByte),r=XA(this,this.parsePixel1);break;case 16:a=XA(e=this.i,e.readUInt16),r=XA(this,this.parsePixelGreyAlpha);break;default:throw kn.thrown("Unsupported bits per pixels amount!")}if(s)for(var o,l=0;l<i;)if(0!=(128&(o=this.i.readByte()))){o&=127;for(var u=r(a(),h);o>=0;)A[l++]=u,--o}else for(o&=127;o>=0;)A[l++]=r(a(),h),--o;else for(var _=0,c=i;_<c;){A[l=_++]=r(a(),h)}return A},readIndexes:function(t,i,n,s,r){var a,A=new Array(i);switch(t){case 8:a=XA(e=this.i,e.readByte);break;case 16:a=XA(e=this.i,e.readUInt16);break;case 24:a=XA(e=this.i,e.readUInt24);break;case 32:a=XA(e=this.i,e.readInt32);break;default:throw kn.thrown("Unsupported bits per pixels amount!")}if(r)for(var h,o=0;o<i;)if(0!=(128&(h=this.i.readByte()))){h&=127;for(var l=n[s+a()];h>=0;)A[o++]=l,--h}else for(h&=127;h>=0;)A[o++]=n[s+a()],--h;else for(var u=0,_=i;u<_;){A[o=u++]=n[s+a()]}return A},parsePixel1:function(t,e){return t<<16|t<<8|t},parsePixelGreyAlpha:function(t,e){return(e?(65280&t)<<16:0)|this.parsePixel1(255&t,!1)},parsePixel2:function(t,e){return(e&&1==(32768&t)?-16777216:0)|(((31744&t)>>10)/31*255|0)<<16|(((992&t)>>5)/31*255|0)<<8|(31&t)/31*255|0},parsePixel3:function(t,e){return t},parsePixel4:function(t,e){return t},__class__:H};var W=function(t){this.i=t,this.nbits=0,this.bits=0};i["format.tools.BitsInput"]=W,W.__name__="format.tools.BitsInput",W.prototype={readBits:function(t){if(this.nbits>=t){var e=this.nbits-t,i=this.bits>>>e&(1<<t)-1;return this.nbits=e,i}i=this.i.readByte();if(this.nbits>=24){if(t>31)throw kn.thrown("Bits error");e=8+this.nbits-t;var n=this.bits&(1<<this.nbits)-1;return n=n<<8-e|i<<e,this.bits=i,this.nbits=e,n}return this.bits=this.bits<<8|i,this.nbits+=8,this.readBits(t)},readBit:function(){return 0==this.nbits&&(this.bits=this.i.readByte(),this.nbits=8),this.nbits--,1==(this.bits>>>this.nbits&1)},reset:function(){this.nbits=0},__class__:W};var Z=function(){};i["format.tools.Deflate"]=Z,Z.__name__="format.tools.Deflate",Z.run=function(t,e){return null==e&&(e=9),ds.run(t,e)};var J=function(){};i["format.tools.Inflate"]=J,J.__name__="format.tools.Inflate",J.run=function(t){return vs.run(t)};var q=s["format.wav.WAVEFormat"]={__ename__:!0,__constructs__:null,WF_PCM:{_hx_name:"WF_PCM",_hx_index:0,__enum__:"format.wav.WAVEFormat",toString:n}};q.__constructs__=[q.WF_PCM],q.__empty_constructs__=[q.WF_PCM];var K=function(t){this.i=t,t.set_bigEndian(!1)};i["format.wav.Reader"]=K,K.__name__="format.wav.Reader",K.prototype={readInt:function(){return this.i.readInt32()},read:function(){if("RIFF"!=this.i.readString(4))throw kn.thrown("RIFF header expected");this.i.readInt32();if("WAVE"!=this.i.readString(4))throw kn.thrown("WAVE signature not found");var t=this.i.readString(4);t:for(;"fmt "!=t;)switch(t){case"JUNK":var e=this.i.readInt32();this.i.read(e),t=this.i.readString(4);break;case"bext":var i=this.i.readInt32();this.i.read(i),t=this.i.readString(4);break;default:break t}if("fmt "!=t)throw kn.thrown("unsupported wave chunk "+t);var n,s=this.i.readInt32();switch(this.i.readUInt16()){case 1:case 3:n=q.WF_PCM;break;default:throw kn.thrown("only PCM (uncompressed) WAV files are supported")}var r=this.i.readUInt16(),a=this.i.readInt32(),A=this.i.readInt32(),h=this.i.readUInt16(),o=this.i.readUInt16();s>16&&this.i.read(s-16);for(var l=this.i.readString(4);"data"!=l;)this.i.read(this.i.readInt32()),l=this.i.readString(4);if("data"!=l)throw kn.thrown("expected data subchunk");var u,_=this.i.readInt32();try{u=this.i.read(_)}catch(f){throw kn.caught(f).unwrap()instanceof As?kn.thrown("Invalid chunk data length"):f}var c=[];try{for(;;){if("cue "==(l=this.i.readString(4))){this.i.readInt32();for(var d=this.i.readInt32(),f=0,x=d;f<x;){f++;var p=this.i.readInt32();this.i.readInt32(),this.i.readString(4),this.i.readInt32(),this.i.readInt32();var g=this.i.readInt32();c.push({id:p,sampleOffset:g})}}else this.i.read(this.i.readInt32())}}catch(f){if(!(kn.caught(f).unwrap()instanceof As))throw f}return{header:{format:n,channels:r,samplingRate:a,byteRate:A,blockAlign:h,bitsPerSample:o},data:u,cuePoints:c}},__class__:K};var $=function(t){A.call(this,t),this.color=new Yt(1,1,1,1)};i["h2d.Drawable"]=$,$.__name__="h2d.Drawable",$.__super__=A,$.prototype=r(A.prototype,{set_tileWrap:function(t){return this.tileWrap=t},get_colorAdd:function(){var t=this.getShader(on);return null==t?null:t.color__},set_colorAdd:function(t){var e=this.getShader(on);return null==e?null!=t&&((e=this.addShader(new on)).color__=t):null==t?this.removeShader(e):e.color__=t,t},drawFiltered:function(t,e){var i=this.shaders;this.shaders=null,A.prototype.drawFiltered.call(this,t,e),this.shaders=i},set_colorKey:function(t){var e=this.getShader(ln);if(null==e)null!=t&&(e=this.addShader(new ln(-16777216|t)));else if(null==t)this.removeShader(e);else{var i=e.colorKey__,n=-16777216|t;i.x=(n>>16&255)/255,i.y=(n>>8&255)/255,i.z=(255&n)/255,i.w=(n>>>24)/255}return this.colorKey=t},adjustColor:function(t){if(null==t)this.set_colorMatrix(null);else{var e=this.get_colorMatrix();null==e&&(e=new Gt,this.set_colorMatrix(e)),e.identity(),e.adjustColor(t)}},get_colorMatrix:function(){var t=this.getShader(un);return null==t?null:t.matrix__},set_colorMatrix:function(t){var e=this.getShader(un);return null==e?null!=t&&((e=this.addShader(new un)).matrix__=t):null==t?this.removeShader(e):e.matrix__=t,t},getDebugShaderCode:function(t){null==t&&(t=!0);var e=this.getScene().ctx,i=e.manager.compileShaders(new PA(e.baseShader,this.shaders));if(t){var n=function(t){return SA.shaderToString(t,true)};return"// vertex:\n"+n(i.vertex.data)+"\n\nfragment:\n"+n(i.fragment.data)}return Ut.CURRENT.driver.getNativeShaderCode(i)},getShader:function(t){if(null!=this.shaders)for(var e=this.shaders;null!=e;){var i=e.s;e=e.next;var n=i,s=yA.__downcastCheck(n,t)?n:null;if(null!=s)return s}return null},getShaders:function(){return new zA(this.shaders,null)},addShader:function(t){if(null==t)throw kn.thrown("Can't add null shader");return this.shaders=PA.addSort(t,this.shaders),t},removeShader:function(t){for(var e=null,i=this.shaders;null!=i;){if(i.s==t)return null==e?this.shaders=i.next:e.next=i.next,!0;e=i,i=i.next}return!1},emitTile:function(t,e){null==e&&(e=new ct(null,0,0,5,5)),t.drawTile(this,e)},__class__:$});var tt=function(t,e){$.call(this,e),this.set_tile(t)};i["h2d.Bitmap"]=tt,tt.__name__="h2d.Bitmap",tt.__super__=$,tt.prototype=r($.prototype,{getBoundsRec:function(t,e,i){$.prototype.getBoundsRec.call(this,t,e,i),null!=this.tile&&(null==this.width&&null==this.height?this.addBounds(t,e,this.tile.dx,this.tile.dy,this.tile.width,this.tile.height):this.addBounds(t,e,this.tile.dx,this.tile.dy,null!=this.width?this.width:this.tile.width*this.height/this.tile.height,null!=this.height?this.height:this.tile.height*this.width/this.tile.width))},set_width:function(t){return this.width==t||(this.width=t,null!=this.parentContainer&&this.parentContainer.contentChanged(this)),t},set_height:function(t){return this.height==t||(this.height=t,null!=this.parentContainer&&this.parentContainer.contentChanged(this)),t},set_tile:function(t){return this.tile==t||(this.tile=t,null!=this.parentContainer&&this.parentContainer.contentChanged(this)),t},draw:function(t){if(null!=this.width||null!=this.height){null==this.tile&&this.set_tile(ct.fromColor(16711935));var e=this.tile.width,i=this.tile.height;this.tile.width=null!=this.width?this.width:e*this.height/i,this.tile.height=null!=this.height?this.height:i*this.width/e,this.emitTile(t,this.tile),this.tile.width=e,this.tile.height=i}else this.emitTile(t,this.tile)},__class__:tt});var et=s["h2d.BlendMode"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"h2d.BlendMode",toString:n},Alpha:{_hx_name:"Alpha",_hx_index:1,__enum__:"h2d.BlendMode",toString:n},Add:{_hx_name:"Add",_hx_index:2,__enum__:"h2d.BlendMode",toString:n},AlphaAdd:{_hx_name:"AlphaAdd",_hx_index:3,__enum__:"h2d.BlendMode",toString:n},SoftAdd:{_hx_name:"SoftAdd",_hx_index:4,__enum__:"h2d.BlendMode",toString:n},Multiply:{_hx_name:"Multiply",_hx_index:5,__enum__:"h2d.BlendMode",toString:n},AlphaMultiply:{_hx_name:"AlphaMultiply",_hx_index:6,__enum__:"h2d.BlendMode",toString:n},Erase:{_hx_name:"Erase",_hx_index:7,__enum__:"h2d.BlendMode",toString:n},Screen:{_hx_name:"Screen",_hx_index:8,__enum__:"h2d.BlendMode",toString:n},Sub:{_hx_name:"Sub",_hx_index:9,__enum__:"h2d.BlendMode",toString:n},Max:{_hx_name:"Max",_hx_index:10,__enum__:"h2d.BlendMode",toString:n},Min:{_hx_name:"Min",_hx_index:11,__enum__:"h2d.BlendMode",toString:n}};et.__constructs__=[et.None,et.Alpha,et.Add,et.AlphaAdd,et.SoftAdd,et.Multiply,et.AlphaMultiply,et.Erase,et.Screen,et.Sub,et.Max,et.Min],et.__empty_constructs__=[et.None,et.Alpha,et.Add,et.AlphaAdd,et.SoftAdd,et.Multiply,et.AlphaMultiply,et.Erase,et.Screen,et.Sub,et.Max,et.Min];var it=function(t){this.followRotation=!1,this.posChanged=!0,this.x=0,this.posChanged=!0,this.y=0,this.posChanged=!0,this.scaleX=1,this.posChanged=!0,this.scaleY=1,this.posChanged=!0,this.rotation=0,this.posChanged=!0,this.anchorX=0,this.posChanged=!0,this.anchorY=0,this.viewX=0,this.viewY=0,this.viewW=1,this.viewH=1,this.visible=!0,null!=t&&t.addCamera(this)};i["h2d.Camera"]=it,it.__name__="h2d.Camera",it.prototype={remove:function(){null!=this.scene&&this.scene.removeCamera(this)},layerVisible:function(t){return!0},enter:function(t){if(t.pushCamera(this),this.clipViewport){var e=t.inFilter;t.inFilter=null,t.pushRenderZone(this.viewX*this.scene.width,this.viewY*this.scene.height,this.viewW*this.scene.width,this.viewH*this.scene.height),t.inFilter=e}},exit:function(t){if(this.clipViewport){var e=t.inFilter;t.inFilter=null,t.popRenderZone(),t.inFilter=e}t.popCamera()},sync:function(t,e){if(null==e&&(e=!1),null!=this.scene&&(null!=this.follow&&(this.posChanged=!0,this.x=this.follow.absX,this.posChanged=!0,this.y=this.follow.absY,this.followRotation&&(this.posChanged=!0,this.rotation=-this.follow.rotation)),this.posChanged||e)){if(0==this.rotation)this.matA=this.scaleX,this.matB=0,this.matC=0,this.matD=this.scaleY;else{var i=Math.cos(this.rotation),n=Math.sin(this.rotation);this.matA=this.scaleX*i,this.matB=this.scaleX*n,this.matC=this.scaleY*-n,this.matD=this.scaleY*i}this.absX=Math.round(-(this.x*this.matA+this.y*this.matC)+this.scene.width*this.anchorX*this.viewW+this.scene.width*this.viewX),this.absY=Math.round(-(this.x*this.matB+this.y*this.matD)+this.scene.height*this.anchorY*this.viewH+this.scene.height*this.viewY),this.invDet=1/(this.matA*this.matD-this.matB*this.matC),this.posChanged=!1}},setScale:function(t,e){this.posChanged=!0,this.scaleX=t,this.posChanged=!0,this.scaleY=e},scale:function(t,e){this.posChanged=!0,this.scaleX*=t,this.posChanged=!0,this.scaleY*=e},setPosition:function(t,e){this.posChanged=!0,this.x=t,this.posChanged=!0,this.y=e},move:function(t,e){this.posChanged=!0,this.x+=t,this.posChanged=!0,this.y+=e},rotate:function(t){this.posChanged=!0,this.rotation+=t},setAnchor:function(t,e){this.posChanged=!0,this.anchorX=t,this.posChanged=!0,this.anchorY=e},setViewport:function(t,e,i,n){if(null==n&&(n=0),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");if(this.posChanged=!0,this.viewX=Math.floor(t)/this.scene.width,null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");this.posChanged=!0,this.viewY=Math.floor(e)/this.scene.height;var s=0==i?this.scene.width:i;if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");this.posChanged=!0,this.viewW=Math.ceil(s)/this.scene.width;s=0==n?this.scene.height:n;if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");this.posChanged=!0,this.viewH=Math.ceil(s)/this.scene.height},setRawViewport:function(t,e,i,n){null==n&&(n=1),null==i&&(i=1),null==e&&(e=0),null==t&&(t=0),this.viewX=t,this.viewY=e,this.viewW=i,this.viewH=n,this.posChanged=!0},screenXToCamera:function(t,e){return(((t-this.scene.offsetX)/this.scene.viewportScaleX-this.absX)*this.matD-((e-this.scene.offsetY)/this.scene.viewportScaleY-this.absY)*this.matC)*this.invDet},screenYToCamera:function(t,e){return(-((t-this.scene.offsetX)/this.scene.viewportScaleX-this.absX)*this.matB+((e-this.scene.offsetY)/this.scene.viewportScaleY-this.absY)*this.matA)*this.invDet},cameraXToScreen:function(t,e){return(t*this.matA+e*this.matC+this.absX)*this.scene.viewportScaleX+this.scene.offsetX},cameraYToScreen:function(t,e){return(t*this.matB+e*this.matD+this.absY)*this.scene.viewportScaleY+this.scene.offsetY},sceneXToCamera:function(t,e){return((t-this.absX)*this.matD-(e-this.absY)*this.matC)*this.invDet},sceneYToCamera:function(t,e){return(-(t-this.absX)*this.matB+(e-this.absY)*this.matA)*this.invDet},cameraXToScene:function(t,e){return t*this.matA+e*this.matC+this.absX},cameraYToScene:function(t,e){return t*this.matB+e*this.matD+this.absY},eventToCamera:function(t){var e=(t.relX-this.scene.offsetX)/this.scene.viewportScaleX-this.absX,i=(t.relY-this.scene.offsetY)/this.scene.viewportScaleY-this.absY;t.relX=(e*this.matD-i*this.matC)*this.invDet,t.relY=(-e*this.matB+i*this.matA)*this.invDet},screenToCamera:function(t){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");var e=(t.x-this.scene.offsetX)/this.scene.viewportScaleX-this.absX,i=(t.y-this.scene.offsetY)/this.scene.viewportScaleY-this.absY;t.x=(e*this.matD-i*this.matC)*this.invDet,t.y=(-e*this.matB+i*this.matA)*this.invDet},cameraToScreen:function(t){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");var e=t.x,i=t.y;t.x=(e*this.matA+i*this.matC+this.absX)*this.scene.viewportScaleX+this.scene.offsetX,t.y=(e*this.matB+i*this.matD+this.absY)*this.scene.viewportScaleY+this.scene.offsetY},sceneToCamera:function(t){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");var e=t.x-this.absX,i=t.y-this.absY;t.x=(e*this.matD-i*this.matC)*this.invDet,t.y=(-e*this.matB+i*this.matA)*this.invDet},cameraToScene:function(t){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");var e=t.x,i=t.y;t.x=e*this.matA+i*this.matC+this.absX,t.y=e*this.matB+i*this.matD+this.absY},checkScene:function(){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene")},set_x:function(t){return this.posChanged=!0,this.x=t},set_y:function(t){return this.posChanged=!0,this.y=t},set_scaleX:function(t){return this.posChanged=!0,this.scaleX=t},set_scaleY:function(t){return this.posChanged=!0,this.scaleY=t},set_rotation:function(t){return this.posChanged=!0,this.rotation=t},get_viewportX:function(){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");return this.viewX*this.scene.width},set_viewportX:function(t){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");return this.posChanged=!0,this.viewX=Math.floor(t)/this.scene.width,t},get_viewportY:function(){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");return this.viewY*this.scene.height},set_viewportY:function(t){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");return this.posChanged=!0,this.viewY=Math.floor(t)/this.scene.height,t},get_viewportWidth:function(){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");return this.viewW*this.scene.width},set_viewportWidth:function(t){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");return this.posChanged=!0,this.viewW=Math.ceil(t)/this.scene.width,t},get_viewportHeight:function(){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");return this.viewH*this.scene.height},set_viewportHeight:function(t){if(null==this.scene)throw kn.thrown("This method requires Camera to be added to the Scene");return this.posChanged=!0,this.viewH=Math.ceil(t)/this.scene.height,t},set_anchorX:function(t){return this.posChanged=!0,this.anchorX=t},set_anchorY:function(t){return this.posChanged=!0,this.anchorY=t},__class__:it};var nt=function(){};i["hxd.Interactive"]=nt,nt.__name__="hxd.Interactive",nt.__isInterface__=!0,nt.prototype={__class__:nt};var st=function(t,e,i,n){this.shapeY=0,this.shapeX=0,this.mouseDownButton=-1,this.enableRightButton=!1,this.propagateEvents=!1,this.cancelEvents=!1,this.cursor=bs.Button,$.call(this,i),this.width=t,this.height=e,this.shape=n};i["h2d.Interactive"]=st,st.__name__="h2d.Interactive",st.__interfaces__=[nt],st.__super__=$,st.prototype=r($.prototype,{onAdd:function(){this.scene=this.getScene(),null!=this.scene&&this.scene.addEventTarget(this),this.updateMask(),$.prototype.onAdd.call(this)},draw:function(t){null!=this.backgroundColor&&this.emitTile(t,ct.fromColor(this.backgroundColor,0|this.width,0|this.height,(this.backgroundColor>>>24)/255))},getBoundsRec:function(t,e,i){$.prototype.getBoundsRec.call(this,t,e,i),(null!=this.backgroundColor||i)&&this.addBounds(t,e,0,0,0|this.width,0|this.height)},onHierarchyMoved:function(t){$.prototype.onHierarchyMoved.call(this,t),null!=this.scene&&(this.scene.removeEventTarget(this),this.scene=this.getScene(),null!=this.scene&&this.scene.addEventTarget(this)),t&&this.updateMask()},updateMask:function(){this.parentMask=null;for(var t=this.parent;null!=t;){var e=t instanceof at?t:null;if(null!=e){this.parentMask=e;break}t=t.parent}},onRemove:function(){null!=this.scene&&(this.scene.removeEventTarget(this,!0),this.scene=null),$.prototype.onRemove.call(this)},checkBounds:function(t){switch(t.kind._hx_index){case 4:case 6:case 7:case 10:return!1;default:return!0}},preventClick:function(){this.mouseDownButton=-1},getInteractiveScene:function(){return this.scene},handleEvent:function(t){if(null!=this.parentMask&&this.checkBounds(t)){var e=this.parentMask,i=new Ct(t.relX,t.relY);this.localToGlobal(i);for(var n=i.x,s=i.y;null!=e;){i.x=n,i.y=s;var r=e.globalToLocal(i);if(r.x<0||r.y<0||r.x>e.width||r.y>e.height)return void(t.cancel=!0);e=e.parentMask}}if(null==this.shape&&this.isEllipse&&this.checkBounds(t)){var a=.5*this.width,A=.5*this.height,h=(t.relX-a)/a,o=(t.relY-A)/A;if(h*h+o*o>1)return void(t.cancel=!0)}switch(this.propagateEvents&&(t.propagate=!0),this.cancelEvents&&(t.cancel=!0),t.kind._hx_index){case 0:(this.enableRightButton||0==t.button)&&(this.mouseDownButton=t.button,this.onPush(t),t.cancel&&(this.mouseDownButton=-1));break;case 1:(this.enableRightButton||0==t.button)&&(this.onRelease(t),this.mouseDownButton==t.button&&this.onClick(t)),this.mouseDownButton=-1;break;case 2:this.onMove(t);break;case 3:this.onOver(t);break;case 4:this.onOut(t);break;case 5:this.onWheel(t);break;case 6:this.onFocus(t);break;case 7:this.onFocusLost(t);break;case 8:this.onKeyDown(t);break;case 9:this.onKeyUp(t);break;case 10:(this.enableRightButton||0==t.button)&&(this.onRelease(t),this.mouseDownButton==t.button&&this.onReleaseOutside(t)),this.mouseDownButton=-1;break;case 11:this.onTextInput(t);break;case 12:this.onCheck(t)}},calcAbsPos:function(){$.prototype.calcAbsPos.call(this),this.invDet=1/(this.matA*this.matD-this.matB*this.matC)},set_cursor:function(t){return this.cursor=t,null!=this.scene&&null!=this.scene.events&&this.scene.events.updateCursor(this),t},eventToLocal:function(t){var e=this,i=t.relX-e.absX,n=t.relY-e.absY;t.relX=(i*e.matD-n*e.matC)*e.invDet,t.relY=(-i*e.matB+n*e.matA)*e.invDet},startCapture:function(t,e,i){var n=this;this.scene.startCapture((function(e){var i=e.relX,s=e.relY;n.eventToLocal(e),t(e),e.relX=i,e.relY=s}),e,i)},stopCapture:function(){this.scene.stopCapture()},startDrag:function(t,e){this.startCapture(t,e)},stopDrag:function(){this.stopCapture()},focus:function(){null!=this.scene&&null!=this.scene.events&&this.scene.events.focus(this)},blur:function(){this.hasFocus()&&this.scene.events.blur()},isOver:function(){return null!=this.scene&&null!=this.scene.events&&-1!=this.scene.events.overList.indexOf(this)},hasFocus:function(){return null!=this.scene&&null!=this.scene.events&&this.scene.events.currentFocus==this},onOver:function(t){},onOut:function(t){},onPush:function(t){},onRelease:function(t){},onReleaseOutside:function(t){},onClick:function(t){},onMove:function(t){},onWheel:function(t){},onFocus:function(t){},onFocusLost:function(t){},onKeyUp:function(t){},onKeyDown:function(t){},onCheck:function(t){},onTextInput:function(t){},__class__:st});var rt=function(t){A.call(this,t),this.layersIndexes=[],this.layerCount=0};i["h2d.Layers"]=rt,rt.__name__="h2d.Layers",rt.__super__=A,rt.prototype=r(A.prototype,{addChild:function(t){this.addChildAt(t,0)},add:function(t,e){this.addChildAt(t,e)},addChildAt:function(t,e){if(t.parent==this){var i=t.allocated;t.allocated=!1,this.removeChild(t),t.allocated=i}for(;e>=this.layerCount;)this.layersIndexes[this.layerCount++]=this.children.length;A.prototype.addChildAt.call(this,t,this.layersIndexes[e]);for(var n=e,s=this.layerCount;n<s;){var r=n++;this.layersIndexes[r]++}},removeChild:function(t){for(var e=0,i=this.children.length;e<i;){var n=e++;if(this.children[n]==t){this.children.splice(n,1),t.allocated&&t.onRemove(),t.parent=null,t.posChanged=!0,null!=t.parentContainer&&t.setParentContainer(null);for(var s=this.layerCount-1;s>=0&&this.layersIndexes[s]>n;)this.layersIndexes[s]--,--s;null!=this.parentContainer&&this.parentContainer.contentChanged(this);break}}},under:function(t){for(var e=0,i=this.children.length;e<i;){var n=e++;if(this.children[n]==t){for(var s=0,r=0,a=this.layersIndexes;r<a.length;){var A=a[r];if(++r,A>n)break;s=A}for(var h=n;h>s;)this.children[h]=this.children[h-1],--h;return this.children[s]=t,void(t.allocated&&t.onHierarchyMoved(!1))}}},over:function(t){for(var e=0,i=this.children.length;e<i;){var n=e++;if(this.children[n]==t){for(var s=0,r=this.layersIndexes;s<r.length;){var a=r[s];if(++s,a>n){for(var A=n,h=a-1;A<h;){var o=A++;this.children[o]=this.children[o+1]}return this.children[a-1]=t,void(t.allocated&&t.onHierarchyMoved(!1))}}return}}},getLayer:function(t){var e;if(t>=this.layerCount)e=[];else{var i=0==t?0:this.layersIndexes[t-1],n=this.layersIndexes[t];e=this.children.slice(i,n)}return new Hr(e)},getChildLayer:function(t){if(t.parent!=this)return-1;for(var e=this.children.indexOf(t),i=0,n=this.layerCount;i<n;){var s=i++;if(this.layersIndexes[s]>e)return s}return-1},drawLayer:function(t,e){if(!(e>=this.layerCount)){var i=t.globalAlpha;t.globalAlpha*=this.alpha;var n=0==e?0:this.layersIndexes[e-1],s=this.layersIndexes[e];if(t.front2back)for(var r=n,a=s;r<a;){var A=r++;this.children[s-1-A].drawRec(t)}else for(r=n,a=s;r<a;){A=r++;this.children[A].drawRec(t)}t.globalAlpha=i}},ysort:function(t){if(!(t>=this.layerCount)){var e=0==t?0:this.layersIndexes[t-1],i=this.layersIndexes[t];if(e!=i)for(var n=e,s=this.children[n++].y;n<i;){var r=this.children[n];if(r.y<s){for(var a=n-1;a>=e;){var A=this.children[a];if(r.y>=A.y)break;this.children[a+1]=A,--a}this.children[a+1]=r,r.allocated&&r.onHierarchyMoved(!1)}else s=r.y;++n}}},__class__:rt});var at=function(t,e,i){this.scrollY=0,this.scrollX=0,A.call(this,i),this.width=t,this.height=e};i["h2d.Mask"]=at,at.__name__="h2d.Mask",at.maskWith=function(t,e,i,n,s,r){null==r&&(r=0),null==s&&(s=0);var a,A=e.absX+s,h=e.absY+r,o=i*e.matA+n*e.matC+A,l=i*e.matB+n*e.matD+h;A>o&&(a=A,A=o,o=a),h>l&&(a=h,h=l,l=a),t.pushRenderZone(A,h,o-A,l-h)},at.unmask=function(t){t.popRenderZone()},at.__super__=A,at.prototype=r(A.prototype,{scrollTo:function(t,e){this.set_scrollX(t),this.set_scrollY(e)},scrollBy:function(t,e){this.set_scrollX(this.scrollX+t),this.set_scrollY(this.scrollY+e)},onHierarchyMoved:function(t){A.prototype.onHierarchyMoved.call(this,t),t&&this.updateMask()},onAdd:function(){A.prototype.onAdd.call(this),this.updateMask()},updateMask:function(){this.parentMask=null;for(var t=this.parent;null!=t;){var e=t instanceof at?t:null;if(null!=e){this.parentMask=e;break}t=t.parent}},set_scrollX:function(t){if(null!=this.scrollBounds){var e=this.scrollBounds.xMin,i=this.scrollBounds.xMax-this.width;null==i&&(i=1),null==e&&(e=0),t<e?t=e:t>i&&(t=i)}return this.posChanged=!0,this.scrollX=t},set_scrollY:function(t){if(null!=this.scrollBounds){var e=this.scrollBounds.yMin,i=this.scrollBounds.yMax-this.height;null==i&&(i=1),null==e&&(e=0),t<e?t=e:t>i&&(t=i)}return this.posChanged=!0,this.scrollY=t},calcAbsPos:function(){A.prototype.calcAbsPos.call(this),this.absX-=this.scrollX,this.absY-=this.scrollY},getBoundsRec:function(t,e,i){var n=e.xMin,s=e.yMin,r=e.xMax,a=e.yMax;if(e.xMin=1e20,e.yMin=1e20,e.xMax=-1e20,e.yMax=-1e20,this.posChanged){this.calcAbsPos();for(var h=0,o=this.children;h<o.length;){var l=o[h];++h,l.posChanged=!0}this.posChanged=!1}this.addBounds(t,e,this.scrollX,this.scrollY,this.width,this.height);var u=e.xMin,_=e.yMin,c=e.xMax,d=e.yMax;e.xMin=n,e.xMax=r,e.yMin=s,e.yMax=a,A.prototype.getBoundsRec.call(this,t,e,i),e.xMin<u&&(e.xMin=n>u?u:n),e.yMin<_&&(e.yMin=s>_?_:s),e.xMax>c&&(e.xMax=r<c?c:r),e.yMax>d&&(e.yMax=a<d?d:a)},drawRec:function(t){at.maskWith(t,this,this.width,this.height,this.scrollX,this.scrollY),A.prototype.drawRec.call(this,t),at.unmask(t)},__class__:at});var At=function(){this.engine=Ut.CURRENT,this.frame=0,this.time=0,this.elapsedTime=1/Os.getDefaultFrameRate(),this.textures=new De(this)};i["h3d.impl.RenderContext"]=At,At.__name__="h3d.impl.RenderContext",At.prototype={dispose:function(){this.textures.dispose()},__class__:At};var ht=function(t){this.renderZoneIndex=0,this.renderZoneStack=[],this.tmpBounds=new gt,this.defaultSmooth=!1,this.globalAlpha=1,At.call(this),this.scene=t,this.bufPos=0,this.manager=new Mi,this.pass=new qe("",null),this.pass.depth(!0,Ve.Always),this.pass.set_culling(Re.None),this.baseShader=new sn,this.baseShader.setPriority(100),this.baseShader.zValue__=0,this.baseShaderList=new PA(this.baseShader),this.targetsStack=[],this.targetsStackIndex=0,this.cameraStack=[],this.cameraStackIndex=0,this.filterStack=[]};i["h2d.RenderContext"]=ht,ht.__name__="h2d.RenderContext",ht.__super__=At,ht.prototype=r(At.prototype,{dispose:function(){At.prototype.dispose.call(this),null!=this.fixedBuffer&&this.fixedBuffer.dispose()},hasBuffering:function(){return!1},begin:function(){this.texture=null,this.currentObj=null,this.bufPos=0,this.stride=0,this.viewA=this.scene.viewportA,this.viewB=0,this.viewC=0,this.viewD=this.scene.viewportD,this.viewX=this.scene.viewportX,this.viewY=this.scene.viewportY,this.targetFlipY=this.engine.driver.hasFeature(ge.BottomLeftCoords)?-1:1,this.baseFlipY=null!=this.engine.getCurrentTarget()?this.targetFlipY:1,this.inFilter=null,this.manager.globals.set("time",this.time),this.manager.globals.set("global.time",this.time),(t=this.baseShader).constModified=!0,t.pixelAlign__=!1;var t=this.baseShader.halfPixelInverse__,e=.5/this.engine.width;null==(i=.5/this.engine.height)&&(i=0),null==e&&(e=0),t.x=e,t.y=i,t.z=0,t.w=1;t=this.baseShader.viewportA__,e=this.scene.viewportA;var i=0;null==(n=this.scene.viewportX)&&(n=0),null==i&&(i=0),null==e&&(e=0),t.x=e,t.y=i,t.z=n,t.w=1;var n;t=this.baseShader.viewportB__,e=0,i=this.scene.viewportD*-this.baseFlipY;null==(n=this.scene.viewportY*-this.baseFlipY)&&(n=0),null==i&&(i=0),null==e&&(e=0),t.x=e,t.y=i,t.z=n,t.w=1,null==(n=0)&&(n=0),null==(i=0)&&(i=0),null==(e=1)&&(e=0),(t=this.baseShader.filterMatrixA__).x=e,t.y=i,t.z=n,t.w=1,null==(n=0)&&(n=0),null==(i=1)&&(i=0),null==(e=0)&&(e=0),(t=this.baseShader.filterMatrixB__).x=e,t.y=i,t.z=n,t.w=1,this.baseShaderList.next=null,this.initShaders(this.baseShaderList),this.engine.selectMaterial(this.pass),this.textures.begin()},allocTarget:function(t,e){null==e&&(e=!1);var i=this.textures.allocTarget(t,this.scene.width,this.scene.height,!1);return i.set_filter(e?Oe.Linear:Oe.Nearest),i},clear:function(t){this.engine.clear(t)},initShaders:function(t){if(this.currentShaders=t,this.compiledShader=this.manager.compileShaders(t),null==this.buffers)this.buffers=new hn(this.compiledShader);else{var e=this.buffers,i=this.compiledShader;e.vertex.grow(i.vertex),e.fragment.grow(i.fragment)}this.manager.fillGlobals(this.buffers,this.compiledShader),this.engine.selectShader(this.compiledShader),this.engine.uploadShaderBuffers(this.buffers,0)},end:function(){if(this.texture=null,this.currentObj=null,this.baseShaderList.next=null,0!=this.targetsStackIndex)throw kn.thrown("Missing popTarget()");if(0!=this.cameraStackIndex)throw kn.thrown("Missing popCamera()")},pushCamera:function(t){var e=this.cameraStack[this.cameraStackIndex++];null==e&&(e={va:0,vb:0,vc:0,vd:0,vx:0,vy:0},this.cameraStack.push(e));var i=this.viewA,n=this.viewB,s=this.viewC,r=this.viewD;e.va=i,e.vb=n,e.vc=s,e.vd=r,e.vx=this.viewX,e.vy=this.viewY,this.viewA=t.matA*i+t.matB*s,this.viewB=t.matA*n+t.matB*r,this.viewC=t.matC*i+t.matD*s,this.viewD=t.matC*n+t.matD*r,this.viewX=t.absX*i+t.absY*s+this.viewX,this.viewY=t.absX*n+t.absY*r+this.viewY;var a=null!=this.curTarget?-this.targetFlipY:-this.baseFlipY,A=this.baseShader.viewportA__,h=this.viewA,o=this.viewC;null==(l=this.viewX)&&(l=0),null==o&&(o=0),null==h&&(h=0),A.x=h,A.y=o,A.z=l,A.w=1;var l;A=this.baseShader.viewportB__,h=this.viewB*a,o=this.viewD*a;null==(l=this.viewY*a)&&(l=0),null==o&&(o=0),null==h&&(h=0),A.x=h,A.y=o,A.z=l,A.w=1},popCamera:function(){if(0==this.cameraStackIndex)throw kn.thrown("Too many popCamera()");var t=this.cameraStack[--this.cameraStackIndex];this.viewA=t.va,this.viewB=t.vb,this.viewC=t.vc,this.viewD=t.vd,this.viewX=t.vx,this.viewY=t.vy;var e=null!=this.curTarget?-this.targetFlipY:-this.baseFlipY,i=this.baseShader.viewportA__,n=this.viewA,s=this.viewC;null==(r=this.viewX)&&(r=0),null==s&&(s=0),null==n&&(n=0),i.x=n,i.y=s,i.z=r,i.w=1;var r;i=this.baseShader.viewportB__,n=this.viewB*e,s=this.viewD*e;null==(r=this.viewY*e)&&(r=0),null==s&&(s=0),null==n&&(n=0),i.x=n,i.y=s,i.z=r,i.w=1},pushFilter:function(t){return!(0==this.filterStack.length&&null!=this.onEnterFilter&&!this.onEnterFilter(t))&&(this.filterStack.push(t),this.inFilter=t,!0)},popFilter:function(){var t=this.filterStack.pop();this.filterStack.length>0?this.inFilter=this.filterStack[this.filterStack.length-1]:(this.inFilter=null,null!=this.onLeaveFilter&&this.onLeaveFilter(t))},pushTarget:function(t,e,i,n,s){null==s&&(s=-1),null==n&&(n=-1),null==i&&(i=0),null==e&&(e=0),this.engine.pushTarget(t),this.initShaders(this.baseShaderList);var r=this.targetsStack[this.targetsStackIndex++];null==r&&(r={t:null,va:0,vb:0,vc:0,vd:0,vx:0,vy:0,hasRZ:!1,rzX:0,rzY:0,rzW:0,rzH:0},this.targetsStack.push(r)),r.t=this.curTarget,r.va=this.viewA,r.vb=this.viewB,r.vc=this.viewC,r.vd=this.viewD,r.vx=this.viewX,r.vy=this.viewY,r.hasRZ=this.hasRenderZone,r.rzX=this.renderX,r.rzY=this.renderY,r.rzW=this.renderW,r.rzH=this.renderH,n<0&&(n=null==t?this.scene.width:t.width),s<0&&(s=null==t?this.scene.height:t.height),this.viewA=2/n,this.viewB=0,this.viewC=0,this.viewD=2/s,this.viewX=-1-e*this.viewA,this.viewY=-1-i*this.viewD;var a=this.baseShader.halfPixelInverse__,A=.5/(null==t?this.engine.width:t.width);null==(h=.5/(null==t?this.engine.height:t.height))&&(h=0),null==A&&(A=0),a.x=A,a.y=h,a.z=0,a.w=1;a=this.baseShader.viewportA__,A=this.viewA;var h=this.viewC;null==(o=this.viewX)&&(o=0),null==h&&(h=0),null==A&&(A=0),a.x=A,a.y=h,a.z=o,a.w=1;var o;a=this.baseShader.viewportB__,A=this.viewB*-this.targetFlipY,h=this.viewD*-this.targetFlipY;null==(o=this.viewY*-this.targetFlipY)&&(o=0),null==h&&(h=0),null==A&&(A=0),a.x=A,a.y=h,a.z=o,a.w=1,this.curTarget=t,this.currentBlend=null,this.hasRenderZone&&(this.hasRenderZone=!1,this.engine.setRenderZone())},pushTargets:function(t){this.pushTarget(t[0]),t.length>1&&(this.engine.popTarget(),this.engine.pushTargets(t))},popTarget:function(){if(this.targetsStackIndex<=0)throw kn.thrown("Too many popTarget()");this.engine.popTarget();var t=this.targetsStack[--this.targetsStackIndex],e=this.curTarget=t.t;this.viewA=t.va,this.viewB=t.vb,this.viewC=t.vc,this.viewD=t.vd,this.viewX=t.vx,this.viewY=t.vy;var i=null==e?-this.baseFlipY:-this.targetFlipY;this.initShaders(this.baseShaderList);var n=this.baseShader.halfPixelInverse__,s=.5/(null==e?this.engine.width:e.width);null==(r=.5/(null==e?this.engine.height:e.height))&&(r=0),null==s&&(s=0),n.x=s,n.y=r,n.z=0,n.w=1;n=this.baseShader.viewportA__,s=this.viewA;var r=this.viewC;null==(a=this.viewX)&&(a=0),null==r&&(r=0),null==s&&(s=0),n.x=s,n.y=r,n.z=a,n.w=1;var a;n=this.baseShader.viewportB__,s=this.viewB*i,r=this.viewD*i;null==(a=this.viewY*i)&&(a=0),null==r&&(r=0),null==s&&(s=0),n.x=s,n.y=r,n.z=a,n.w=1,t.hasRZ&&this.setRZ(t.rzX,t.rzY,t.rzW,t.rzH)},pushRenderZone:function(t,e,i,n){var s=this.renderZoneStack[this.renderZoneIndex++];null==s?(s={hasRZ:this.hasRenderZone,x:this.renderX,y:this.renderY,w:this.renderW,h:this.renderH},this.renderZoneStack[this.renderZoneIndex-1]=s):this.hasRenderZone?(s.hasRZ=!0,s.x=this.renderX,s.y=this.renderY,s.w=this.renderW,s.h=this.renderH):s.hasRZ=!1,this.setRZ(t,e,i,n)},popRenderZone:function(){if(0==this.renderZoneIndex)throw kn.thrown("Too many popRenderZone()");var t=this.renderZoneStack[--this.renderZoneIndex];t.hasRZ?this.setRZ(t.x,t.y,t.w,t.h):(this.hasRenderZone=!1,this.engine.setRenderZone())},clipRenderZone:function(t,e,i,n){if(this.hasRenderZone){t=Math.max(t,this.renderX),e=Math.max(e,this.renderY);var s=Math.min(t+i,this.renderX+this.renderW),r=Math.min(e+n,this.renderY+this.renderH);s<t&&(s=t),r<e&&(r=e),this.pushRenderZone(t,e,s-t,r-e)}else this.pushRenderZone(t,e,i,n)},setRZ:function(t,e,i,n){this.hasRenderZone=!0,this.renderX=t,this.renderY=e,this.renderW=i,this.renderH=n;var s=this.scene.viewportA*this.engine.width/2,r=this.scene.viewportD*this.engine.height/2;if(null!=this.inFilter){var a=this.baseShader.filterMatrixA__,A=this.baseShader.filterMatrixB__,h=t+i,o=e+n,l=t*a.x+e*a.y+a.z,u=t*A.x+e*A.y+A.z;t=l,e=u,i=h*a.x+o*a.y+a.z-l,n=h*A.x+o*A.y+A.z-u}this.engine.setRenderZone(t*s+(this.scene.viewportX+1)*(this.engine.width/2)+1e-10|0,e*r+(this.scene.viewportY+1)*(this.engine.height/2)+1e-10|0,i*s+1e-10|0,n*r+1e-10|0)},clearRZ:function(){this.hasRenderZone=!1,this.engine.setRenderZone()},setRenderZone:function(t,e,i,n){this.pushRenderZone(t,e,i,n)},clearRenderZone:function(){this.popRenderZone()},drawLayer:function(t){this.scene.drawLayer(this,t)},drawScene:function(){this.scene.drawRec(this)},flush:function(){},_flush:function(){if(0!=this.bufPos){this.beforeDraw();var t=this.bufPos/this.stride|0,e=new Rt(t,this.stride,[zt.Quads,zt.Dynamic,zt.RawFormat]);e.uploadVector(this.buffer,0,t);var i=this.engine;i.renderBuffer(e,i.mem.quadIndexes,2,0,-1),e.dispose(),this.bufPos=0,this.texture=null}},beforeDraw:function(){null==this.texture&&(this.texture=ti.fromColor(16711935)),this.baseShader.texture__=this.texture,this.texture.set_filter((null==this.currentObj.smooth?this.defaultSmooth:this.currentObj.smooth)?Oe.Linear:Oe.Nearest),this.texture.set_wrap(!this.currentObj.tileWrap||null!=this.currentObj.filter&&null==this.inFilter?Ge.Clamp:Ge.Repeat);var t=this.currentObj.blendMode;this.inFilter==this.currentObj&&t==et.Erase&&(t=et.Add),null!=this.inFilterBlend&&(t=this.inFilterBlend),t!=this.currentBlend&&(this.currentBlend=t,this.pass.setBlendMode(t),t!=et.Alpha&&t!=et.Add||(this.pass.set_blendAlphaSrc(Le.One),null!=this.inFilterBlend&&this.pass.set_blendSrc(Le.One))),this.manager.fillParams(this.buffers,this.compiledShader,this.currentShaders),this.engine.selectMaterial(this.pass),this.engine.uploadShaderBuffers(this.buffers,1),this.engine.uploadShaderBuffers(this.buffers,2),this.engine.uploadShaderBuffers(this.buffers,3)},setupColor:function(t){if(this.inFilter==t){var e=this.baseShader.color__,i=t.color.x,n=t.color.y,s=t.color.z;null==(r=t.color.w)&&(r=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0),e.x=i,e.y=n,e.z=s,e.w=r}else if(null!=this.inFilterBlend){e=this.baseShader.color__,i=this.globalAlpha,n=this.globalAlpha,s=this.globalAlpha;null==(r=this.globalAlpha)&&(r=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0),e.x=i,e.y=n,e.z=s,e.w=r}else{var r;e=this.baseShader.color__,i=t.color.x,n=t.color.y,s=t.color.z;null==(r=t.color.w*this.globalAlpha)&&(r=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0),e.x=i,e.y=n,e.z=s,e.w=r}},beginDrawBatchState:function(t){if(!this.beginDraw(t,null,!0))return!1;if(this.inFilter==t){var e=this.baseShader.color__,i=t.color.x,n=t.color.y,s=t.color.z;null==(r=t.color.w)&&(r=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0),e.x=i,e.y=n,e.z=s,e.w=r}else if(null!=this.inFilterBlend){e=this.baseShader.color__,i=this.globalAlpha,n=this.globalAlpha,s=this.globalAlpha;null==(r=this.globalAlpha)&&(r=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0),e.x=i,e.y=n,e.z=s,e.w=r}else{var r;e=this.baseShader.color__,i=t.color.x,n=t.color.y,s=t.color.z;null==(r=t.color.w*this.globalAlpha)&&(r=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0),e.x=i,e.y=n,e.z=s,e.w=r}e=this.baseShader.absoluteMatrixA__,i=t.matA,n=t.matC;null==(s=t.absX)&&(s=0),null==n&&(n=0),null==i&&(i=0),e.x=i,e.y=n,e.z=s,e.w=1;e=this.baseShader.absoluteMatrixB__,i=t.matB,n=t.matD;return null==(s=t.absY)&&(s=0),null==n&&(n=0),null==i&&(i=0),e.x=i,e.y=n,e.z=s,e.w=1,!0},swapTexture:function(t){this.texture=t,this.beforeDraw()},beginDrawObject:function(t,e){if(!this.beginDraw(t,e,!0))return!1;if(this.inFilter==t){var i=this.baseShader.color__,n=t.color.x,s=t.color.y,r=t.color.z;null==(a=t.color.w)&&(a=1),null==r&&(r=0),null==s&&(s=0),null==n&&(n=0),i.x=n,i.y=s,i.z=r,i.w=a}else if(null!=this.inFilterBlend){i=this.baseShader.color__,n=this.globalAlpha,s=this.globalAlpha,r=this.globalAlpha;null==(a=this.globalAlpha)&&(a=1),null==r&&(r=0),null==s&&(s=0),null==n&&(n=0),i.x=n,i.y=s,i.z=r,i.w=a}else{var a;i=this.baseShader.color__,n=t.color.x,s=t.color.y,r=t.color.z;null==(a=t.color.w*this.globalAlpha)&&(a=1),null==r&&(r=0),null==s&&(s=0),null==n&&(n=0),i.x=n,i.y=s,i.z=r,i.w=a}i=this.baseShader.absoluteMatrixA__,n=t.matA,s=t.matC;null==(r=t.absX)&&(r=0),null==s&&(s=0),null==n&&(n=0),i.x=n,i.y=s,i.z=r,i.w=1;i=this.baseShader.absoluteMatrixB__,n=t.matB,s=t.matD;return null==(r=t.absY)&&(r=0),null==s&&(s=0),null==n&&(n=0),i.x=n,i.y=s,i.z=r,i.w=1,this.beforeDraw(),!0},beginDrawBatch:function(t,e){return this.beginDraw(t,e,!1)},drawTile:function(t,e){var i,n,s,r,a,A;if(null!=this.inFilter){var h=this.baseShader.filterMatrixA__,o=this.baseShader.filterMatrixB__,l=t.matA*h.x+t.matB*h.y,u=t.matA*o.x+t.matB*o.y,_=t.matC*h.x+t.matD*h.y,c=t.matC*o.x+t.matD*o.y,d=t.absX*h.x+t.absY*h.y+h.z,f=t.absX*o.x+t.absY*o.y+o.z;i=l*this.viewA+u*this.viewC,n=l*this.viewB+u*this.viewD,s=_*this.viewA+c*this.viewC,r=_*this.viewB+c*this.viewD,a=d*this.viewA+f*this.viewC+this.viewX,A=d*this.viewB+f*this.viewD+this.viewY}else i=t.matA*this.viewA+t.matB*this.viewC,n=t.matA*this.viewB+t.matB*this.viewD,s=t.matC*this.viewA+t.matD*this.viewC,r=t.matC*this.viewB+t.matD*this.viewD,a=t.absX*this.viewA+t.absY*this.viewC+this.viewX,A=t.absX*this.viewB+t.absY*this.viewD+this.viewY;if(0==n&&0==s){var x=e.dx+.5*e.width,p=e.dy+.5*e.height,g=i<0?-i:i,m=r<0?-r:r,v=1.5*(e.width>e.height?e.width:e.height)*(g<m?m:g),y=a+x*i,b=A+p*r;if(y+v<-1||y-v>1||b+v<-1||b-v>1)return!1}else{var w=1e20,M=1e20,B=-1e20,C=-1e20;e.width,e.height;(I=e.dx*i+e.dy*s)<w&&(w=I),I>B&&(B=I),(k=e.dx*n+e.dy*r)<M&&(M=k),k>C&&(C=k),(I=((E=e.width)+e.dx)*i+e.dy*s)<w&&(w=I),I>B&&(B=I),(k=(E+e.dx)*n+e.dy*r)<M&&(M=k),k>C&&(C=k);var S=e.height;(I=e.dx*i+(S+e.dy)*s)<w&&(w=I),I>B&&(B=I),(k=e.dx*n+(S+e.dy)*r)<M&&(M=k),k>C&&(C=k);var I,k,E=e.width;S=e.height;if((I=(E+e.dx)*i+(S+e.dy)*s)<w&&(w=I),I>B&&(B=I),(k=(E+e.dx)*n+(S+e.dy)*r)<M&&(M=k),k>C&&(C=k),a+B<-1||A+C<-1||a+w>1||A+M>1)return!1}if(!this.beginDraw(t,e.innerTex,!0,!0))return!1;if(this.inFilter==t){var F=this.baseShader.color__,T=(E=t.color.x,S=t.color.y,t.color.z);null==(D=t.color.w)&&(D=1),null==T&&(T=0),null==S&&(S=0),null==E&&(E=0),F.x=E,F.y=S,F.z=T,F.w=D}else if(null!=this.inFilterBlend){F=this.baseShader.color__,E=this.globalAlpha,S=this.globalAlpha,T=this.globalAlpha;null==(D=this.globalAlpha)&&(D=1),null==T&&(T=0),null==S&&(S=0),null==E&&(E=0),F.x=E,F.y=S,F.z=T,F.w=D}else{F=this.baseShader.color__,E=t.color.x,S=t.color.y,T=t.color.z;null==(D=t.color.w*this.globalAlpha)&&(D=1),null==T&&(T=0),null==S&&(S=0),null==E&&(E=0),F.x=E,F.y=S,F.z=T,F.w=D}F=this.baseShader.absoluteMatrixA__,E=e.width*t.matA,S=e.height*t.matC;null==(T=t.absX+e.dx*t.matA+e.dy*t.matC)&&(T=0),null==S&&(S=0),null==E&&(E=0),F.x=E,F.y=S,F.z=T,F.w=1;F=this.baseShader.absoluteMatrixB__,E=e.width*t.matB,S=e.height*t.matD;null==(T=t.absY+e.dx*t.matB+e.dy*t.matD)&&(T=0),null==S&&(S=0),null==E&&(E=0),F.x=E,F.y=S,F.z=T,F.w=1;var D,P;F=this.baseShader.uvPos__,E=e.u,S=e.v,T=e.u2-e.u;(null==(D=e.v2-e.v)&&(D=1),null==T&&(T=0),null==S&&(S=0),null==E&&(E=0),F.x=E,F.y=S,F.z=T,F.w=D,this.beforeDraw(),null!=this.fixedBuffer)?P=null==(F=this.fixedBuffer).buffer||null==F.buffer.vbuf:P=!0;if(P){this.fixedBuffer=new Rt(4,8,[zt.Quads,zt.RawFormat]);var z=Cs._new(0),R=0;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=0;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=0;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=0;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=0;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=0;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=0;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=0;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R;var L,V;R=1;if(z.pos==z.array.length)(L=z.array.length<<1)<128&&(L=128),(V=new Float32Array(L)).set(z.array),z.array=V;z.array[z.pos++]=R,this.fixedBuffer.uploadVector(z,0,4)}return(F=this.engine).renderBuffer(this.fixedBuffer,F.mem.quadIndexes,2,0,-1),!0},beginDraw:function(t,e,i,n){if(null==n&&(n=!1),null!=this.onBeginDraw&&!this.onBeginDraw(t))return!1;for(var s,r=!1,a=!1,A=t.shaders,h=this.currentShaders.next;null!=A&&null!=h;){var o=A.s,l=h.s;A=A.next,h=h.next;var u=l.instance;o!=l&&(a=!0),o.updateConstants(this.manager.globals),o.instance!=u&&(r=!0)}if(null==A&&null==h&&this.baseShader.isRelative__==i&&this.baseShader.hasUVPos__==n&&this.baseShader.killAlpha__==this.killAlpha||(r=!0),r)(s=this.baseShader).constModified=!0,s.hasUVPos__=n,(s=this.baseShader).constModified=!0,s.isRelative__=i,(s=this.baseShader).constModified=!0,s.killAlpha__=this.killAlpha,this.baseShader.updateConstants(this.manager.globals),this.baseShaderList.next=t.shaders,this.initShaders(this.baseShaderList);else if(a){if(this.currentShaders!=this.baseShaderList)throw kn.thrown("!");this.currentShaders.next=t.shaders}return this.texture=e,this.stride=8,this.currentObj=t,!0},__class__:ht});var ot=s["h2d.ScaleModeAlign"]={__ename__:!0,__constructs__:null,Left:{_hx_name:"Left",_hx_index:0,__enum__:"h2d.ScaleModeAlign",toString:n},Right:{_hx_name:"Right",_hx_index:1,__enum__:"h2d.ScaleModeAlign",toString:n},Center:{_hx_name:"Center",_hx_index:2,__enum__:"h2d.ScaleModeAlign",toString:n},Top:{_hx_name:"Top",_hx_index:3,__enum__:"h2d.ScaleModeAlign",toString:n},Bottom:{_hx_name:"Bottom",_hx_index:4,__enum__:"h2d.ScaleModeAlign",toString:n}};ot.__constructs__=[ot.Left,ot.Right,ot.Center,ot.Top,ot.Bottom],ot.__empty_constructs__=[ot.Left,ot.Right,ot.Center,ot.Top,ot.Bottom];var lt=s["h2d.ScaleMode"]={__ename__:!0,__constructs__:null,Resize:{_hx_name:"Resize",_hx_index:0,__enum__:"h2d.ScaleMode",toString:n},Stretch:(e=function(t,e){return{_hx_index:1,width:t,height:e,__enum__:"h2d.ScaleMode",toString:n}},e._hx_name="Stretch",e.__params__=["width","height"],e),LetterBox:(e=function(t,e,i,s,r){return{_hx_index:2,width:t,height:e,integerScale:i,horizontalAlign:s,verticalAlign:r,__enum__:"h2d.ScaleMode",toString:n}},e._hx_name="LetterBox",e.__params__=["width","height","integerScale","horizontalAlign","verticalAlign"],e),Fixed:(e=function(t,e,i,s,r){return{_hx_index:3,width:t,height:e,zoom:i,horizontalAlign:s,verticalAlign:r,__enum__:"h2d.ScaleMode",toString:n}},e._hx_name="Fixed",e.__params__=["width","height","zoom","horizontalAlign","verticalAlign"],e),Zoom:(e=function(t){return{_hx_index:4,level:t,__enum__:"h2d.ScaleMode",toString:n}},e._hx_name="Zoom",e.__params__=["level"],e),AutoZoom:(e=function(t,e,i){return{_hx_index:5,minWidth:t,minHeight:e,integerScaling:i,__enum__:"h2d.ScaleMode",toString:n}},e._hx_name="AutoZoom",e.__params__=["minWidth","minHeight","integerScaling"],e)};lt.__constructs__=[lt.Resize,lt.Stretch,lt.LetterBox,lt.Fixed,lt.Zoom,lt.AutoZoom],lt.__empty_constructs__=[lt.Resize];var ut=function(){};i["hxd.InteractiveScene"]=ut,ut.__name__="hxd.InteractiveScene",ut.__isInterface__=!0,ut.prototype={__class__:ut};var _t=function(){this.scaleMode=lt.Resize,rt.call(this,null);var t=Ut.CURRENT;this.ctx=new ht(this),this._cameras=[],new it(this),this.set_interactiveCamera(this._cameras[0]),this.width=t.width,this.height=t.height,this.viewportA=2/t.width,this.viewportD=2/t.height,this.viewportX=-1,this.viewportY=-1,this.viewportScaleX=1,this.viewportScaleY=1,this.offsetX=0,this.offsetY=0,this.interactive=[],this.eventListeners=[],this.shapePoint=new Ct,this.window=Us.getInstance(),this.posChanged=!0};i["h2d.Scene"]=_t,_t.__name__="h2d.Scene",_t.__interfaces__=[ut,_],_t.__super__=rt,_t.prototype=r(rt.prototype,{get_defaultSmooth:function(){return this.ctx.defaultSmooth},set_defaultSmooth:function(t){return this.ctx.defaultSmooth=t},setEvents:function(t){this.events=t},get_zoom:function(){var t=this.scaleMode;return 4==t._hx_index?0|t.level:0},set_zoom:function(t){return this.set_scaleMode(lt.Zoom(t)),t},set_scaleMode:function(t){return this.scaleMode=t,this.checkResize(),t},get_renderer:function(){return this.ctx},set_renderer:function(t){return this.ctx=t,t},get_camera:function(){return this._cameras[0]},get_cameras:function(){return this._cameras},set_interactiveCamera:function(t){if(null==t)throw kn.thrown("Interactive cammera cannot be null!");return t.scene!=this&&this.addCamera(t),this.interactiveCamera=t},addCamera:function(t,e){null!=t.scene&&t.scene.removeCamera(t),t.scene=this,t.posChanged=!0,null!=e?this._cameras.splice(e,0,t):this._cameras.push(t)},removeCamera:function(t){if(t==this.interactiveCamera)throw kn.thrown("Current interactive Camera cannot be removed from camera list!");t.scene=null,l.remove(this._cameras,t)},setFixedSize:function(t,e){this.set_scaleMode(lt.Stretch(t,e))},checkResize:function(){var t=this,e=Ut.CURRENT,i=this.scaleMode;switch(i._hx_index){case 0:var n=e.width,s=e.height;n==t.width&&s==t.height||(t.width=n,t.height=s,t.posChanged=!0),t.viewportScaleX=1,t.viewportScaleY=1,t.viewportA=2/t.width,t.viewportD=2/t.height,t.viewportX=-1,t.viewportY=-1;break;case 1:var r=i.width,a=i.height;r==t.width&&a==t.height||(t.width=r,t.height=a,t.posChanged=!0),t.viewportScaleX=e.width/r,t.viewportScaleY=e.height/a,t.viewportA=2/t.width,t.viewportD=2/t.height,t.viewportX=-1,t.viewportY=-1;break;case 2:r=i.width,a=i.height;var A=i.integerScale,h=i.horizontalAlign,o=i.verticalAlign;r==t.width&&a==t.height||(t.width=r,t.height=a,t.posChanged=!0);var l=(d=e.width/r)>(f=e.height/a)?f:d;A&&0==(l|=0)&&(l=1);var u=h,_=o;switch(t.viewportA=2*l/e.width,t.viewportD=2*l/e.height,t.viewportScaleX=l,t.viewportScaleY=l,null==u&&(u=ot.Center),u._hx_index){case 0:t.viewportX=-1,t.offsetX=0;break;case 1:t.viewportX=1-t.width*t.viewportA,t.offsetX=e.width-t.width*l;break;default:t.viewportX=Math.floor((e.width-t.width*l)/(2*l))*t.viewportA-1,t.offsetX=Math.floor((e.width-t.width*l)/2)}switch(null==_&&(_=ot.Center),_._hx_index){case 3:t.viewportY=-1,t.offsetY=0;break;case 4:t.viewportY=1-t.height*t.viewportD,t.offsetY=e.height-t.height*l;break;default:t.viewportY=Math.floor((e.height-t.height*l)/(2*l))*t.viewportD-1,t.offsetY=Math.floor((e.height-t.height*l)/2)}break;case 3:r=i.width,a=i.height,l=i.zoom,h=i.horizontalAlign,o=i.verticalAlign;r==t.width&&a==t.height||(t.width=r,t.height=a,t.posChanged=!0);u=h,_=o;switch(t.viewportA=2*l/e.width,t.viewportD=2*l/e.height,t.viewportScaleX=l,t.viewportScaleY=l,null==u&&(u=ot.Center),u._hx_index){case 0:t.viewportX=-1,t.offsetX=0;break;case 1:t.viewportX=1-t.width*t.viewportA,t.offsetX=e.width-t.width*l;break;default:t.viewportX=Math.floor((e.width-t.width*l)/(2*l))*t.viewportA-1,t.offsetX=Math.floor((e.width-t.width*l)/2)}switch(null==_&&(_=ot.Center),_._hx_index){case 3:t.viewportY=-1,t.offsetY=0;break;case 4:t.viewportY=1-t.height*t.viewportD,t.offsetY=e.height-t.height*l;break;default:t.viewportY=Math.floor((e.height-t.height*l)/(2*l))*t.viewportD-1,t.offsetY=Math.floor((e.height-t.height*l)/2)}break;case 4:var c=i.level;n=Math.ceil(e.width/c),s=Math.ceil(e.height/c);n==t.width&&s==t.height||(t.width=n,t.height=s,t.posChanged=!0),t.viewportScaleX=c,t.viewportScaleY=c,t.viewportA=2/t.width,t.viewportD=2/t.height,t.viewportX=-1,t.viewportY=-1;break;case 5:var d,f,x=i.minWidth,p=i.minHeight,g=i.integerScaling;l=(d=e.width/x)>(f=e.height/p)?f:d;g&&0==(l|=0)&&(l=1);n=Math.ceil(e.width/l),s=Math.ceil(e.height/l);n==t.width&&s==t.height||(t.width=n,t.height=s,t.posChanged=!0),t.viewportScaleX=l,t.viewportScaleY=l,t.viewportA=2/t.width,t.viewportD=2/t.height,t.viewportX=-1,t.viewportY=-1}},screenXToViewport:function(t){var e=this.interactiveCamera,i=(t=this.window.get_mouseX(),this.window.get_mouseY());return(((t-e.scene.offsetX)/e.scene.viewportScaleX-e.absX)*e.matD-((i-e.scene.offsetY)/e.scene.viewportScaleY-e.absY)*e.matC)*e.invDet},screenYToViewport:function(t){var e=this.interactiveCamera,i=this.window.get_mouseX();t=this.window.get_mouseY();return(-((i-e.scene.offsetX)/e.scene.viewportScaleX-e.absX)*e.matB+((t-e.scene.offsetY)/e.scene.viewportScaleY-e.absY)*e.matA)*e.invDet},get_mouseX:function(){this.syncPos();var t=this.window.get_mouseX(),e=this.interactiveCamera,i=(t=this.window.get_mouseX(),this.window.get_mouseY()),n=(((t-e.scene.offsetX)/e.scene.viewportScaleX-e.absX)*e.matD-((i-e.scene.offsetY)/e.scene.viewportScaleY-e.absY)*e.matC)*e.invDet-this.absX;if(0==this.matC)return n/this.matA;i=this.window.get_mouseY(),e=this.interactiveCamera,t=this.window.get_mouseX(),i=this.window.get_mouseY();var s=(-((t-e.scene.offsetX)/e.scene.viewportScaleX-e.absX)*e.matB+((i-e.scene.offsetY)/e.scene.viewportScaleY-e.absY)*e.matA)*e.invDet-this.absY;return(n*this.matD-s*this.matC)/(this.matA*this.matD-this.matB*this.matC)},get_mouseY:function(){this.syncPos();var t=this.window.get_mouseY(),e=this.interactiveCamera,i=this.window.get_mouseX(),n=(t=this.window.get_mouseY(),(-((i-e.scene.offsetX)/e.scene.viewportScaleX-e.absX)*e.matB+((t-e.scene.offsetY)/e.scene.viewportScaleY-e.absY)*e.matA)*e.invDet-this.absY);if(0==this.matB)return n/this.matD;i=this.window.get_mouseX(),e=this.interactiveCamera,i=this.window.get_mouseX(),t=this.window.get_mouseY();var s=(((i-e.scene.offsetX)/e.scene.viewportScaleX-e.absX)*e.matD-((t-e.scene.offsetY)/e.scene.viewportScaleY-e.absY)*e.matC)*e.invDet-this.absX;return(n*this.matA-s*this.matB)/(this.matA*this.matD-this.matB*this.matC)},dispatchListeners:function(t){this.screenToViewport(t);for(var e=0,i=this.eventListeners;e<i.length;){var n=i[e];if(++e,n(t),!t.propagate)break}},isInteractiveVisible:function(t){for(var e=t;e!=this;){if(null==e||!e.visible)return!1;e=e.parent}return!0},getInteractive:function(t,e){for(var i=this.shapePoint,n=0,s=this.interactive;n<s.length;){var r=s[n];++n,r.posChanged&&r.syncPos();var a=t-r.absX,A=e-r.absY,h=(a*r.matD-A*r.matC)*r.invDet,o=(A*r.matA-a*r.matB)*r.invDet;if(null!=r.shape){var l=h+r.shapeX,u=o+r.shapeY;if(null==u&&(u=0),null==l&&(l=0),i.x=l,i.y=u,!r.shape.contains(i))continue}else if(o<0||h<0||h>=r.width||o>=r.height)continue;for(var _=!0,c=r;null!=c;){if(!c.visible){_=!1;break}c=c.parent}if(_)return r}return null},screenToViewport:function(t){this.interactiveCamera.eventToCamera(t)},dispatchEvent:function(t,e){var i=e;this.screenToViewport(t);var n=t.relX-i.absX,s=t.relY-i.absY,r=(n*i.matD-s*i.matC)*i.invDet,a=(s*i.matA-n*i.matB)*i.invDet;t.relX=r,t.relY=a,i.handleEvent(t)},handleEvent:function(t,e){this.screenToViewport(t);for(var i=t.relX,n=t.relY,s=null==e?0:this.interactive.indexOf(e)+1,r=this.shapePoint,a=s,A=this.interactive.length;a<A;){var h=a++,o=this.interactive[h];if(null==o)break;if(0!=o.invDet){var l=i-o.absX,u=n-o.absY,_=(l*o.matD-u*o.matC)*o.invDet,c=(u*o.matA-l*o.matB)*o.invDet;if(null!=o.shape){var d=_+o.shapeX,f=c+o.shapeY;if(null==f&&(f=0),null==d&&(d=0),r.x=d,r.y=f,!o.shape.contains(r))continue}else if(c<0||_<0||_>=o.width||c>=o.height)continue;for(var x=!0,p=o;null!=p;){if(!p.visible){x=!1;break}p=p.parent}if(x){if(t.relX=_,t.relY=c,o.handleEvent(t),!t.cancel)return o;t.cancel=!1,t.propagate=!1}}}return null},addEventListener:function(t){this.eventListeners.push(t)},removeEventListener:function(t){for(var e=0,i=this.eventListeners;e<i.length;){var n=i[e];if(++e,f.compareMethods(n,t))return l.remove(this.eventListeners,n),!0}return!1},startCapture:function(t,e,i){var n=this;this.events.startCapture((function(e){n.screenToViewport(e),t(e)}),e,i)},stopCapture:function(){this.events.stopCapture()},startDrag:function(t,e,i){this.startCapture(t,e,null!=i?i.touchId:null)},stopDrag:function(){this.stopCapture()},getFocus:function(){if(null==this.events)return null;var t=this.events.getFocus();if(null==t)return null;var e=t instanceof st?t:null;return null==e?null:this.interactive[this.interactive.indexOf(e)]},addEventTarget:function(t){for(var e=t,i=0;null!=e;)e=e.parent,++i;for(var n=i,s=0,r=this.interactive.length;s<r;){var a=s++,A=(e=t,this.interactive[a]),h=n,o=A;for(i=0;null!=o;)o=o.parent,++i;for(var l=i,u=e,_=A;h>l;)e=u,u=u.parent,--h;for(;l>h;)A=_,_=_.parent,--l;for(;u!=_;)e=u,u=u.parent,A=_,_=_.parent;for(var c=-1,d=0,f=u.children.length;d<f;){var x=d++;if(u.children[x]==e){c=x;break}}for(var p=c,g=-1,m=0,v=_.children.length;m<v;){var y=m++;if(_.children[y]==A){g=y;break}}if(p>g)return void this.interactive.splice(a,0,t)}this.interactive.push(t)},removeEventTarget:function(t,e){null==e&&(e=!1),l.remove(this.interactive,t),e&&null!=this.events&&this.events.onRemove(t)},dispose:function(){this.allocated&&this.onRemove(),this.ctx.dispose()},setElapsedTime:function(t){this.ctx.elapsedTime=t},drawImplTo:function(t,e,i){for(var n=0;n<e.length;){var s=e[n];if(++n,0==(s.flags&1<<Ye.Target._hx_index))throw kn.thrown("Can only draw to texture created with Target flag")}this.ctx.engine=Ut.CURRENT;var r=this.ctx.engine.backgroundColor;this.ctx.engine.backgroundColor=null,this.ctx.engine.inRender||this.ctx.begin(),this.ctx.globalAlpha=this.alpha,this.ctx.begin(),this.ctx.pushTargets(e),null!=i&&this.ctx.manager.setOutput(i),t.drawRec(this.ctx),null!=i&&this.ctx.manager.setOutput(),this.ctx.popTarget(),this.ctx.engine.backgroundColor=r},syncOnly:function(t){var e=Ut.CURRENT;this.setElapsedTime(t),this.ctx.engine=e,this.ctx.frame++,this.ctx.time+=this.ctx.elapsedTime,this.ctx.globalAlpha=this.alpha,this.sync(this.ctx)},render:function(t){this.ctx.engine=t,this.ctx.frame++,this.ctx.time+=this.ctx.elapsedTime,this.ctx.globalAlpha=this.alpha,this.sync(this.ctx),0!=this.children.length&&(this.ctx.begin(),this.ctx.drawScene(),this.ctx.end())},sync:function(t){var e=this.posChanged;this.allocated||this.onAdd(),rt.prototype.sync.call(this,t);for(var i=0,n=this._cameras;i<n.length;){var s=n[i];++i,s.sync(t,e)}},clipBounds:function(t,e){var i=this;if(0==this.rotation){var n=-this.absX,s=-this.absY;n<e.xMin&&(e.xMin=n),n>e.xMax&&(e.xMax=n),s<e.yMin&&(e.yMin=s),s>e.yMax&&(e.yMax=s);n=this.window.get_width()/this.matA-this.absX,s=this.window.get_height()/this.matD-this.absY;n<e.xMin&&(e.xMin=n),n>e.xMax&&(e.xMax=n),s<e.yMin&&(e.yMin=s),s>e.yMax&&(e.yMax=s)}else{var r=this.window.get_width()/this.matA-this.absX,a=this.window.get_height()/this.matD-this.absY,A=(n=-this.absX,s=-this.absY,n*i.matA+s*i.matC),h=n*i.matB+s*i.matD;A<e.xMin&&(e.xMin=A),A>e.xMax&&(e.xMax=A),h<e.yMin&&(e.yMin=h),h>e.yMax&&(e.yMax=h);n=r-this.absX,s=-this.absY,A=n*i.matA+s*i.matC,h=n*i.matB+s*i.matD;A<e.xMin&&(e.xMin=A),A>e.xMax&&(e.xMax=A),h<e.yMin&&(e.yMin=h),h>e.yMax&&(e.yMax=h);n=-this.absX,s=a-this.absY,A=n*i.matA+s*i.matC,h=n*i.matB+s*i.matD;A<e.xMin&&(e.xMin=A),A>e.xMax&&(e.xMax=A),h<e.yMin&&(e.yMin=h),h>e.yMax&&(e.yMax=h);n=r-this.absX,s=a-this.absY,A=n*i.matA+s*i.matC,h=n*i.matB+s*i.matD;A<e.xMin&&(e.xMin=A),A>e.xMax&&(e.xMax=A),h<e.yMin&&(e.yMin=h),h>e.yMax&&(e.yMax=h)}rt.prototype.clipBounds.call(this,t,e)},drawContent:function(t){if(t.front2back){for(var e=0,i=this._cameras;e<i.length;){var n=i[e];if(++e,n.visible){var s=this.children.length,r=this.layerCount;for(n.enter(t);r-- >0;){var a=0==r?0:this.layersIndexes[r-1];if(n.layerVisible(r))for(;s>=a;)this.children[s--].drawRec(t);else s=a-1}n.exit(t)}}this.draw(t)}else{this.draw(t);for(e=0,i=this._cameras;e<i.length;){n=i[e];if(++e,n.visible){s=0,r=0;for(n.enter(t);r<this.layerCount;){a=this.layersIndexes[r++];if(n.layerVisible(r-1))for(;s<a;)this.children[s++].drawRec(t);else s=a}n.exit(t)}}}},onAdd:function(){this.checkResize(),rt.prototype.onAdd.call(this),this.window.addResizeEvent(XA(this,this.checkResize))},onRemove:function(){rt.prototype.onRemove.call(this),this.window.removeResizeEvent(XA(this,this.checkResize))},captureBitmap:function(t){var e=Ut.CURRENT;if(null==t){var i=new ti(this.width,this.height,[Ye.Target]);t=new ct(i,0,0,this.width,this.height)}e.begin(),e.setRenderZone(0|t.x,0|t.y,Math.ceil(t.width),Math.ceil(t.height));i=t.innerTex;e.pushTarget(i);var n=this.width,s=this.height,r=this.viewportA,a=this.viewportD,A=this.viewportX,h=this.viewportY;return this.width=i.width,this.height=i.height,this.viewportA=2/this.width,this.viewportD=2/this.height,this.viewportX=-1,this.viewportY=-1,this.posChanged=!0,this.render(e),e.popTarget(),this.width=n,this.height=s,this.viewportA=r,this.viewportD=a,this.viewportX=A,this.viewportY=h,this.posChanged=!0,e.setRenderZone(),e.end(),new tt(t)},__class__:_t});var ct=function(t,e,i,n,s,r,a){null==a&&(a=0),null==r&&(r=0),this.innerTex=t,this.x=e,this.y=i,this.width=n,this.height=s,this.dx=r,this.dy=a,null!=t&&this.setTexture(t)};i["h2d.Tile"]=ct,ct.__name__="h2d.Tile",ct.fromColor=function(t,e,i,n){null==n&&(n=1),null==i&&(i=1),null==e&&(e=1);var s=new ct(ti.fromColor(t,n),0,0,1,1);return s.width=e,s.height=i,s},ct.fromBitmap=function(t){var e=ti.fromBitmap(t);return new ct(e,0,0,t.ctx.canvas.width,t.ctx.canvas.height)},ct.autoCut=function(t,e,i){t.lock(),null==i&&(i=e);for(var n=t.getPixel(t.ctx.canvas.width-1,t.ctx.canvas.height-1),s=[],r=1,a=1;r<t.ctx.canvas.width;)r<<=1;for(;a<t.ctx.canvas.height;)a<<=1;for(var A=new ti(r,a),h=0,o=t.ctx.canvas.height/i|0;h<o;){var l=h++,u=[];s[l]=u;for(var _=0,c=t.ctx.canvas.width/e|0;_<c;){var d=_++,f=ct.isEmpty(t,d*e,l*i,e,i,n);if(null==f)break;u.push(new ct(A,d*e+f.dx,l*i+f.dy,f.w,f.h,f.dx,f.dy))}}t.unlock();var x=new ct(A,0,0,t.ctx.canvas.width,t.ctx.canvas.height);return x.upload(t),{main:x,tiles:s}},ct.fromTexture=function(t){return new ct(t,0,0,t.width,t.height)},ct.fromPixels=function(t){var e=t.makeSquare(!0),i=ti.fromPixels(e);return e!=t&&e.dispose(),new ct(i,0,0,t.width,t.height)},ct.isEmpty=function(t,e,i,n,s,r){for(var a=!0,A=n,h=s,o=0,l=0,u=0,_=n;u<_;)for(var c=u++,d=0,f=s;d<f;){var x=d++,p=t.getPixel(c+e,x+i);0!=(-16777216&p)?(p!=r&&(a=!1,c<A&&(A=c),x<h&&(h=x),c>o&&(o=c),x>l&&(l=x)),p==r&&0!=p&&t.setPixel(c+e,x+i,0)):0!=p&&t.setPixel(c+e,x+i,0)}return a?null:{dx:A,dy:h,w:o-A+1,h:l-h+1}},ct.prototype={get_ix:function(){return Math.floor(this.x)},get_iy:function(){return Math.floor(this.y)},get_iwidth:function(){return Math.ceil(this.width+this.x)-Math.floor(this.x)},get_iheight:function(){return Math.ceil(this.height+this.y)-Math.floor(this.y)},getTexture:function(){return this.innerTex},isDisposed:function(){if(null!=this.innerTex){var t=this.innerTex;return null==t.t&&null==t.realloc}return!0},setTexture:function(t){this.innerTex=t,null!=t&&(this.u=this.x/t.width,this.v=this.y/t.height,this.u2=(this.x+this.width)/t.width,this.v2=(this.y+this.height)/t.height)},switchTexture:function(t){this.setTexture(t.innerTex)},sub:function(t,e,i,n,s,r){return null==r&&(r=0),null==s&&(s=0),new ct(this.innerTex,this.x+t,this.y+e,i,n,s,r)},center:function(){return this.sub(0,0,this.width,this.height,-.5*this.width,-.5*this.height)},setCenterRatio:function(t,e){null==e&&(e=.5),null==t&&(t=.5),this.dx=-t*this.width,this.dy=-e*this.height},flipX:function(){var t=this.u;this.u=this.u2,this.u2=t,this.dx=-this.dx-this.width},flipY:function(){var t=this.v;this.v=this.v2,this.v2=t,this.dy=-this.dy-this.height},setPosition:function(t,e){this.x=t,this.y=e;var i=this.innerTex;null!=i&&(this.u=t/i.width,this.v=e/i.height,this.u2=(t+this.width)/i.width,this.v2=(e+this.height)/i.height)},setSize:function(t,e){this.width=t,this.height=e;var i=this.innerTex;null!=i&&(this.u2=(this.x+t)/i.width,this.v2=(this.y+e)/i.height)},scaleToSize:function(t,e){this.width=t,this.height=e},scrollDiscrete:function(t,e){var i=this.innerTex;this.u+=t/i.width,this.v-=e/i.height,this.u2+=t/i.width,this.v2-=e/i.height,this.x=this.u*i.width,this.y=this.v*i.height},dispose:function(){null!=this.innerTex&&this.innerTex.dispose(),this.innerTex=null},clone:function(){var t=new ct(null,this.x,this.y,this.width,this.height,this.dx,this.dy);return t.innerTex=this.innerTex,t.u=this.u,t.u2=this.u2,t.v=this.v,t.v2=this.v2,t},get_xFlip:function(){return this.u2<this.u},get_yFlip:function(){return this.v2<this.v},set_xFlip:function(t){return t!=this.get_xFlip()&&this.flipX(),t},set_yFlip:function(t){return t!=this.get_yFlip()&&this.flipY(),t},split:function(t,e,i){null==i&&(i=!1),null==e&&(e=!1),null==t&&(t=0);var n=[];if(e){0==t&&(t=this.height/this.width|0);for(var s=i?this.height/t:this.height/t|0,r=0,a=t;r<a;){var A=r++;n.push(this.sub(0,A*s,this.width,s))}}else{0==t&&(t=this.width/this.height|0);for(s=i?this.width/t:this.width/t|0,r=0,a=t;r<a;){A=r++;n.push(this.sub(A*s,0,s,this.height))}}return n},gridFlatten:function(t,e,i){null==i&&(i=0),null==e&&(e=0);for(var n=[],s=0,r=this.height/t|0;s<r;)for(var a=s++,A=0,h=this.width/t|0;A<h;){var o=A++;n.push(this.sub(o*t,a*t,t,t,e,i))}return n},grid:function(t,e,i){null==i&&(i=0),null==e&&(e=0);for(var n=[],s=0,r=this.width/t|0;s<r;){for(var a=s++,A=[],h=0,o=this.height/t|0;h<o;){var l=h++;A.push(this.sub(a*t,l*t,t,t,e,i))}n.push(A)}return n},toString:function(){return"Tile("+this.x+","+this.y+","+this.width+"x"+this.height+(0!=this.dx||0!=this.dy?","+this.dx+":"+this.dy:"")+")"},upload:function(t){this.innerTex.width,this.innerTex.height;this.innerTex.uploadBitmap(t)},__class__:ct};var dt=function(){};i["hxd.impl._Serializable.NoSerializeSupport"]=dt,dt.__name__="hxd.impl._Serializable.NoSerializeSupport",dt.__isInterface__=!0;var ft=function(){this.refCount=0};i["h3d.prim.Primitive"]=ft,ft.__name__="h3d.prim.Primitive",ft.__interfaces__=[dt],ft.prototype={triCount:function(){return null!=this.indexes?this.indexes.count/3|0:null==this.buffer?0:this.buffer.totalVertices()/3|0},vertexCount:function(){return 0},getCollider:function(){throw kn.thrown("not implemented for "+x.string(this))},getBounds:function(){throw kn.thrown("not implemented for "+x.string(this))},incref:function(){this.refCount++},decref:function(){this.refCount--,this.refCount<=0&&(this.refCount=0,this.dispose())},alloc:function(t){throw kn.thrown("not implemented")},selectMaterial:function(t){},buildNormalsDisplay:function(){throw kn.thrown("not implemented for "+x.string(this))},render:function(t){var e;if(null!=this.buffer){var i=this.buffer;e=null==i.buffer||null==i.buffer.vbuf}else e=!0;e&&this.alloc(t),null==this.indexes?0!=(this.buffer.flags&1<<zt.Quads._hx_index)?t.renderBuffer(this.buffer,t.mem.quadIndexes,2,0,-1):t.renderBuffer(this.buffer,t.mem.triIndexes,3,0,-1):t.renderIndexed(this.buffer,this.indexes)},dispose:function(){null!=this.buffer&&(this.buffer.dispose(),this.buffer=null),null!=this.indexes&&(this.indexes.dispose(),this.indexes=null)},toString:function(){return yA.getClass(this).__name__.split(".").pop()},__class__:ft};var xt=function(){this.useAllocator=!1,ft.call(this),this.state=new Dt,this.clear()};i["h2d.TileLayerContent"]=xt,xt.__name__="h2d.TileLayerContent",xt.__super__=ft,xt.prototype=r(ft.prototype,{clear:function(){var t=Cs._new(0);this.tmp=t,null!=this.buffer&&(this.useAllocator?Yr.get().disposeBuffer(this.buffer):this.buffer.dispose()),this.buffer=null,this.xMin=1/0,this.yMin=1/0,this.xMax=-1/0,this.yMax=-1/0,this.state.clear()},isEmpty:function(){return 0==this.triCount()},triCount:function(){return null==this.buffer?this.tmp.pos>>4:this.buffer.totalVertices()>>1},addColor:function(t,e,i,n){this.add(t,e,i.x,i.y,i.z,i.w,n)},add:function(t,e,i,n,s,r,a){var A=t+a.dx,h=e+a.dy;(o=this.tmp).pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=A,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=h;var o=this.tmp,l=a.u;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=l;o=this.tmp,l=a.v;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=l,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=i,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=n,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=s,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=r;o=this.tmp,l=A+a.width;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=l,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=h;o=this.tmp,l=a.u2;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=l;o=this.tmp,l=a.v;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=l,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=i,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=n,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=s,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=r,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=A;o=this.tmp,l=h+a.height;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=l;o=this.tmp,l=a.u;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=l;o=this.tmp,l=a.v2;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=l,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=i,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=n,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=s,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=r;o=this.tmp,l=A+a.width;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=l;o=this.tmp,l=h+a.height;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=l;o=this.tmp,l=a.u2;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=l;var u,_;o=this.tmp,l=a.v2;o.pos==o.array.length&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=l,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=i,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=n,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);(o.array[o.pos++]=s,(o=this.tmp).pos==o.array.length)&&((u=o.array.length<<1)<128&&(u=128),(_=new Float32Array(u)).set(o.array),o.array=_);o.array[o.pos++]=r;var c=t+a.dx,d=e+a.dy;c<this.xMin&&(this.xMin=c),d<this.yMin&&(this.yMin=d),c+=a.width,d+=a.height,c>this.xMax&&(this.xMax=c),d>this.yMax&&(this.yMax=d),null!=a&&this.state.setTexture(a.innerTex);var f=this.state;f.tail.count+=4,f.totalCount+=4},addTransform:function(t,e,i,n,s,r,a){var A=this,h=Math.cos(s),o=Math.sin(s),l=a.width,u=a.height,_=(x=a.dx*i)*h-(p=a.dy*n)*o+t,c=p*h+x*o+e;(d=this.tmp).pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);(d.array[d.pos++]=_,(d=this.tmp).pos==d.array.length)&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=c;var d=this.tmp,f=a.u;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=a.v;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.x;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.y;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.z;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.w;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f,_<A.xMin&&(A.xMin=_),c<A.yMin&&(A.yMin=c),_>A.xMax&&(A.xMax=_),c>A.yMax&&(A.yMax=c);_=(x=(a.dx+l)*i)*h-(p=a.dy*n)*o+t,c=p*h+x*o+e;(d=this.tmp).pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);(d.array[d.pos++]=_,(d=this.tmp).pos==d.array.length)&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=c;d=this.tmp,f=a.u2;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=a.v;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.x;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.y;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.z;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.w;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f,_<A.xMin&&(A.xMin=_),c<A.yMin&&(A.yMin=c),_>A.xMax&&(A.xMax=_),c>A.yMax&&(A.yMax=c);_=(x=a.dx*i)*h-(p=(a.dy+u)*n)*o+t,c=p*h+x*o+e;(d=this.tmp).pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);(d.array[d.pos++]=_,(d=this.tmp).pos==d.array.length)&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=c;d=this.tmp,f=a.u;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=a.v2;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.x;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.y;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.z;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.w;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f,_<A.xMin&&(A.xMin=_),c<A.yMin&&(A.yMin=c),_>A.xMax&&(A.xMax=_),c>A.yMax&&(A.yMax=c);var x,p;_=(x=(a.dx+l)*i)*h-(p=(a.dy+u)*n)*o+t,c=p*h+x*o+e;(d=this.tmp).pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);(d.array[d.pos++]=_,(d=this.tmp).pos==d.array.length)&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=c;d=this.tmp,f=a.u2;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=a.v2;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.x;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.y;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;d=this.tmp,f=r.z;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f;var g,m;d=this.tmp,f=r.w;d.pos==d.array.length&&((g=d.array.length<<1)<128&&(g=128),(m=new Float32Array(g)).set(d.array),d.array=m);d.array[d.pos++]=f,_<A.xMin&&(A.xMin=_),c<A.yMin&&(A.yMin=c),_>A.xMax&&(A.xMax=_),c>A.yMax&&(A.yMax=c),null!=a&&this.state.setTexture(a.innerTex);var v=this.state;v.tail.count+=4,v.totalCount+=4},addPoint:function(t,e,i){var n,s,r;(n=this.tmp).pos==n.array.length&&((s=n.array.length<<1)<128&&(s=128),(r=new Float32Array(s)).set(n.array),n.array=r);(n.array[n.pos++]=t,(n=this.tmp).pos==n.array.length)&&((s=n.array.length<<1)<128&&(s=128),(r=new Float32Array(s)).set(n.array),n.array=r);(n.array[n.pos++]=e,(n=this.tmp).pos==n.array.length)&&((s=n.array.length<<1)<128&&(s=128),(r=new Float32Array(s)).set(n.array),n.array=r);(n.array[n.pos++]=0,(n=this.tmp).pos==n.array.length)&&((s=n.array.length<<1)<128&&(s=128),(r=new Float32Array(s)).set(n.array),n.array=r);(n.array[n.pos++]=0,(n=this.tmp).pos==n.array.length)&&((s=n.array.length<<1)<128&&(s=128),(r=new Float32Array(s)).set(n.array),n.array=r);(n.array[n.pos++]=(i>>16&255)/255,(n=this.tmp).pos==n.array.length)&&((s=n.array.length<<1)<128&&(s=128),(r=new Float32Array(s)).set(n.array),n.array=r);(n.array[n.pos++]=(i>>8&255)/255,(n=this.tmp).pos==n.array.length)&&((s=n.array.length<<1)<128&&(s=128),(r=new Float32Array(s)).set(n.array),n.array=r);(n.array[n.pos++]=(255&i)/255,(n=this.tmp).pos==n.array.length)&&((s=n.array.length<<1)<128&&(s=128),(r=new Float32Array(s)).set(n.array),n.array=r);n.array[n.pos++]=(i>>>24)/255,t<this.xMin&&(this.xMin=t),e<this.yMin&&(this.yMin=e),t>this.xMax&&(this.xMax=t),e>this.yMax&&(this.yMax=e)},insertColor:function(t){var e,i,n;(e=this.tmp).pos==e.array.length&&((i=e.array.length<<1)<128&&(i=128),(n=new Float32Array(i)).set(e.array),e.array=n);(e.array[e.pos++]=(t>>16&255)/255,(e=this.tmp).pos==e.array.length)&&((i=e.array.length<<1)<128&&(i=128),(n=new Float32Array(i)).set(e.array),e.array=n);(e.array[e.pos++]=(t>>8&255)/255,(e=this.tmp).pos==e.array.length)&&((i=e.array.length<<1)<128&&(i=128),(n=new Float32Array(i)).set(e.array),e.array=n);(e.array[e.pos++]=(255&t)/255,(e=this.tmp).pos==e.array.length)&&((i=e.array.length<<1)<128&&(i=128),(n=new Float32Array(i)).set(e.array),e.array=n);e.array[e.pos++]=(t>>>24)/255},rectColor:function(t,e,i,n,s){var r,a,A;(r=this.tmp).pos==r.array.length&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=t,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=e,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=0,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=0,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(s>>16&255)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(s>>8&255)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(255&s)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(s>>>24)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=t+i,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=e,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=1,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=0,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(s>>16&255)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(s>>8&255)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(255&s)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(s>>>24)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=t,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=e+n,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=0,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=1,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(s>>16&255)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(s>>8&255)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(255&s)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(s>>>24)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=t+i,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=e+n,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=1,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=1,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(s>>16&255)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(s>>8&255)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);(r.array[r.pos++]=(255&s)/255,(r=this.tmp).pos==r.array.length)&&((a=r.array.length<<1)<128&&(a=128),(A=new Float32Array(a)).set(r.array),r.array=A);r.array[r.pos++]=(s>>>24)/255,t<this.xMin&&(this.xMin=t),e<this.yMin&&(this.yMin=e),e+=n,(t+=i)>this.xMax&&(this.xMax=t),e>this.yMax&&(this.yMax=e);var h=this.state;h.tail.count+=4,h.totalCount+=4},rectGradient:function(t,e,i,n,s,r,a,A){var h,o,l;(h=this.tmp).pos==h.array.length&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=t,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=e,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=0,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=0,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(s>>16&255)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(s>>8&255)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(255&s)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(s>>>24)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=t+i,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=e,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=1,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=0,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(r>>16&255)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(r>>8&255)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(255&r)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(r>>>24)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=t,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=e+n,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=0,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=1,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(a>>16&255)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(a>>8&255)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(255&a)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(a>>>24)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=t+i,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=e+n,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=1,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=1,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(A>>16&255)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(A>>8&255)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);(h.array[h.pos++]=(255&A)/255,(h=this.tmp).pos==h.array.length)&&((o=h.array.length<<1)<128&&(o=128),(l=new Float32Array(o)).set(h.array),h.array=l);h.array[h.pos++]=(A>>>24)/255,t<this.xMin&&(this.xMin=t),e<this.yMin&&(this.yMin=e),e+=n,(t+=i)>this.xMax&&(this.xMax=t),e>this.yMax&&(this.yMax=e);var u=this.state;u.tail.count+=4,u.totalCount+=4},fillArc:function(t,e,i,n,s,r){if(!(r<=s)){var a=r-s,A=Math.ceil(3.14*i*2/4);A<4&&(A=4);for(var h=a/A,o=-1/0,l=-1/0,u=0,_=0,c=0,d=0;c<A;){var f=s+c*h;u=t+Math.cos(f)*i,_=e+Math.sin(f)*i,o!=-1/0&&(this.addPoint(t,e,n),this.addPoint(u,_,n),this.addPoint(o,l,n),this.addPoint(o,l,n),d+=4),o=u,l=_,++c}f=r;u=t+Math.cos(f)*i,_=e+Math.sin(f)*i,this.addPoint(t,e,n),this.addPoint(u,_,n),this.addPoint(o,l,n),this.addPoint(o,l,n);var x=this.state,p=d+4;x.tail.count+=p,x.totalCount+=p}},fillCircle:function(t,e,i,n){var s=Math.ceil(3.14*i*2/2);s<3&&(s=3);for(var r=2*Math.PI/s,a=-1/0,A=-1/0,h=-1/0,o=-1/0,l=0,u=0,_=0,c=0,d=s;c<d;){var f=c++*r;l=t+Math.cos(f)*i,u=e+Math.sin(f)*i,a!=-1/0&&(this.addPoint(t,e,n),this.addPoint(l,u,n),this.addPoint(a,A,n),this.addPoint(t,e,n),_+=4),h==-1/0&&(h=l,o=u),a=l,A=u}this.addPoint(t,e,n),this.addPoint(l,u,n),this.addPoint(h,o,n),this.addPoint(t,e,n);var x=this.state,p=_+4;x.tail.count+=p,x.totalCount+=p},circle:function(t,e,i,n,s){if(!(n>i)){var r=Math.ceil(3.14*i*2/2);r<3&&(r=3);for(var a=i-n,A=2*Math.PI/r,h=-1/0,o=-1/0,l=-1/0,u=-1/0,_=0,c=0,d=r;c<d;){var f=c++*A,x=t+Math.cos(f)*i,p=e+Math.sin(f)*i,g=t+Math.cos(f)*a,m=e+Math.sin(f)*a;h!=-1/0&&(this.addPoint(x,p,s),this.addPoint(h,o,s),this.addPoint(g,m,s),this.addPoint(l,u,s),_+=4),h=x,o=p,l=g,u=m}var v=this.state;v.tail.count+=_,v.totalCount+=_}},arc:function(t,e,i,n,s,r,a){if(!(n>i||r<=s)){var A=r-s,h=Math.ceil(3.14*i*2/4);h<3&&(h=3);for(var o=i-n,l=A/h,u=-1/0,_=-1/0,c=-1/0,d=-1/0,f=0,x=0,p=0,g=0,m=0,v=0,y=h;v<y;){var b=s+v++*l;f=t+Math.cos(b)*i,x=e+Math.sin(b)*i,p=t+Math.cos(b)*o,g=e+Math.sin(b)*o,u!=-1/0&&(this.addPoint(f,x,a),this.addPoint(u,_,a),this.addPoint(p,g,a),this.addPoint(c,d,a),m+=4),u=f,_=x,c=p,d=g}b=r;f=t+Math.cos(b)*i,x=e+Math.sin(b)*i,p=t+Math.cos(b)*o,g=e+Math.sin(b)*o,this.addPoint(f,x,a),this.addPoint(u,_,a),this.addPoint(p,g,a),this.addPoint(c,d,a);var w=this.state,M=m+4;w.tail.count+=M,w.totalCount+=M}},alloc:function(t){null==this.tmp&&this.clear(),this.tmp.pos>0&&(this.buffer=this.useAllocator?Yr.get().ofFloats(this.tmp,8,3):Rt.ofFloats(this.tmp,8,[zt.Quads,zt.RawFormat]))},dispose:function(){null!=this.buffer&&(this.useAllocator?Yr.get().disposeBuffer(this.buffer):this.buffer.dispose(),this.buffer=null),ft.prototype.dispose.call(this)},flush:function(){var t;if(null!=this.buffer){var e=this.buffer;t=null==e.buffer||null==e.buffer.vbuf}else t=!0;t&&this.alloc(Ut.CURRENT)},doRender:function(t,e,i){var n;if(null!=this.buffer){var s=this.buffer;n=null==s.buffer||null==s.buffer.vbuf}else n=!0;n&&this.alloc(Ut.CURRENT),this.state.drawQuads(t,this.buffer,e,i)},__class__:xt});var pt=function(t,e){$.call(this,e),this.tile=t,this.rangeMin=this.rangeMax=-1,this.curColor=new Yt(1,1,1,1),this.content=new xt};i["h2d.TileGroup"]=pt,pt.__name__="h2d.TileGroup",pt.__super__=$,pt.prototype=r($.prototype,{getBoundsRec:function(t,e,i){$.prototype.getBoundsRec.call(this,t,e,i),this.addBounds(t,e,this.content.xMin,this.content.yMin,this.content.xMax-this.content.xMin,this.content.yMax-this.content.yMin)},clear:function(){this.content.clear()},invalidate:function(){this.content.dispose()},count:function(){return this.content.triCount()>>1},onRemove:function(){this.content.dispose(),$.prototype.onRemove.call(this)},setDefaultColor:function(t,e){null==e&&(e=1),this.curColor.x=(t>>16&255)/255,this.curColor.y=(t>>8&255)/255,this.curColor.z=(255&t)/255,this.curColor.w=e},add:function(t,e,i){this.content.add(t,e,this.curColor.x,this.curColor.y,this.curColor.z,this.curColor.w,i)},addColor:function(t,e,i,n,s,r,a){this.content.add(t,e,i,n,s,r,a)},addAlpha:function(t,e,i,n){this.content.add(t,e,this.curColor.x,this.curColor.y,this.curColor.z,i,n)},addTransform:function(t,e,i,n,s,r){this.content.addTransform(t,e,i,n,s,this.curColor,r)},draw:function(t){this.drawWith(t,this)},sync:function(t){if($.prototype.sync.call(this,t),this.visible){var e,i=this.content;if(null!=i.buffer){var n=i.buffer;e=null==n.buffer||null==n.buffer.vbuf}else e=!0;e&&i.alloc(Ut.CURRENT)}},drawWith:function(t,e){var i=this.content.triCount();if(0!=i&&t.beginDrawBatchState(e)){var n=this.rangeMin<0?0:2*this.rangeMin;this.rangeMax>0&&this.rangeMax<2*i&&(i=2*this.rangeMax);var s,r=this.content;if(null!=r.buffer){var a=r.buffer;s=null==a.buffer||null==a.buffer.vbuf}else s=!0;s&&r.alloc(Ut.CURRENT),r.state.drawQuads(t,r.buffer,n,i-n)}},__class__:pt});var gt=function(){this.xMin=1e20,this.yMin=1e20,this.xMax=-1e20,this.yMax=-1e20};i["h2d.col.Bounds"]=gt,gt.__name__="h2d.col.Bounds",gt.fromValues=function(t,e,i,n){var s=new gt;return s.xMin=t,s.yMin=e,s.xMax=t+i,s.yMax=e+n,s},gt.fromPoints=function(t,e){var i=new gt;return i.xMin=t.x,i.yMin=t.y,i.xMax=e.x,i.yMax=e.y,i},gt.prototype={toIBounds:function(t){null==t&&(t=1);var e=Math.floor(this.xMin*t),i=Math.floor(this.yMin*t),n=Math.ceil(this.xMax*t)-e,s=Math.ceil(this.yMax*t)-i,r=new yt;return r.xMin=e,r.yMin=i,r.xMax=e+n,r.yMax=i+s,r},intersects:function(t){return!(this.xMin>t.xMax||this.yMin>t.yMax||this.xMax<t.xMin||this.yMax<t.yMin)},contains:function(t){return t.x>=this.xMin&&t.x<this.xMax&&t.y>=this.yMin&&t.y<this.yMax},distanceSq:function(t){var e=t.x<this.xMin?this.xMin-t.x:t.x>this.xMax?t.x-this.xMax:0,i=t.y<this.yMin?this.yMin-t.y:t.y>this.yMax?t.y-this.yMax:0;return e*e+i*i},distance:function(t){var e=t.x<this.xMin?this.xMin-t.x:t.x>this.xMax?t.x-this.xMax:0,i=t.y<this.yMin?this.yMin-t.y:t.y>this.yMax?t.y-this.yMax:0;return Math.sqrt(e*e+i*i)},addBounds:function(t){t.xMin<this.xMin&&(this.xMin=t.xMin),t.xMax>this.xMax&&(this.xMax=t.xMax),t.yMin<this.yMin&&(this.yMin=t.yMin),t.yMax>this.yMax&&(this.yMax=t.yMax)},addPoint:function(t){t.x<this.xMin&&(this.xMin=t.x),t.x>this.xMax&&(this.xMax=t.x),t.y<this.yMin&&(this.yMin=t.y),t.y>this.yMax&&(this.yMax=t.y)},addPos:function(t,e){t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),e<this.yMin&&(this.yMin=e),e>this.yMax&&(this.yMax=e)},set:function(t,e,i,n){this.xMin=t,this.yMin=e,this.xMax=t+i,this.yMax=e+n},setMin:function(t){this.xMin=t.x,this.yMin=t.y},setMax:function(t){this.xMax=t.x,this.yMax=t.y},doIntersect:function(t){var e=this.xMin,i=t.xMin;this.xMin=e<i?i:e;e=this.yMin,i=t.yMin;this.yMin=e<i?i:e;e=this.xMax,i=t.xMax;this.xMax=e>i?i:e;e=this.yMax,i=t.yMax;this.yMax=e>i?i:e},doUnion:function(t){var e=this.xMin,i=t.xMin;this.xMin=e>i?i:e;e=this.yMin,i=t.yMin;this.yMin=e>i?i:e;e=this.xMax,i=t.xMax;this.xMax=e<i?i:e;e=this.yMax,i=t.yMax;this.yMax=e<i?i:e},intersection:function(t){var e=new gt,i=this.xMin,n=t.xMin;e.xMin=i<n?n:i;i=this.yMin,n=t.yMin;e.yMin=i<n?n:i;i=this.xMax,n=t.xMax;e.xMax=i>n?n:i;i=this.yMax,n=t.yMax;return e.yMax=i>n?n:i,e.xMax<e.xMin&&(e.xMax=e.xMin),e.yMax<e.yMin&&(e.yMax=e.yMin),e},union:function(t){var e=new gt,i=this.xMin,n=t.xMin;e.xMin=i>n?n:i;i=this.yMin,n=t.yMin;e.yMin=i>n?n:i;i=this.xMax,n=t.xMax;e.xMax=i<n?n:i;i=this.yMax,n=t.yMax;return e.yMax=i<n?n:i,e},load:function(t){this.xMin=t.xMin,this.yMin=t.yMin,this.xMax=t.xMax,this.yMax=t.yMax},scalePivot:function(t){this.xMin*=t,this.yMin*=t,this.xMax*=t,this.yMax*=t},scaleCenter:function(t){var e=.5*(this.xMax-this.xMin)*t,i=.5*(this.yMax-this.yMin)*t,n=.5*(this.xMax+this.xMin),s=.5*(this.yMax+this.yMin);this.xMin=n-e,this.yMin=s-i,this.xMax=n+e,this.yMax=s+i},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.xMin,s=this.yMin,r=this.xMax,a=this.yMax;this.xMin=1e20,this.yMin=1e20,this.xMax=-1e20,this.yMax=-1e20;var A=n*i+s*e;(h=n*e-s*i)<this.xMin&&(this.xMin=h),h>this.xMax&&(this.xMax=h),A<this.yMin&&(this.yMin=A),A>this.yMax&&(this.yMax=A);A=r*i+s*e;(h=r*e-s*i)<this.xMin&&(this.xMin=h),h>this.xMax&&(this.xMax=h),A<this.yMin&&(this.yMin=A),A>this.yMax&&(this.yMax=A);A=n*i+a*e;(h=n*e-a*i)<this.xMin&&(this.xMin=h),h>this.xMax&&(this.xMax=h),A<this.yMin&&(this.yMin=A),A>this.yMax&&(this.yMax=A);var h;A=r*i+a*e;(h=r*e-a*i)<this.xMin&&(this.xMin=h),h>this.xMax&&(this.xMax=h),A<this.yMin&&(this.yMin=A),A>this.yMax&&(this.yMax=A)},offset:function(t,e){this.xMin+=t,this.xMax+=t,this.yMin+=e,this.yMax+=e},getMin:function(){return new Ct(this.xMin,this.yMin)},getCenter:function(){return new Ct(.5*(this.xMin+this.xMax),.5*(this.yMin+this.yMax))},getSize:function(){return new Ct(this.xMax-this.xMin,this.yMax-this.yMin)},getMax:function(){return new Ct(this.xMax,this.yMax)},isEmpty:function(){return this.xMax<=this.xMin||this.yMax<=this.yMin},empty:function(){this.xMin=1e20,this.yMin=1e20,this.xMax=-1e20,this.yMax=-1e20},all:function(){this.xMin=-1e20,this.yMin=-1e20,this.xMax=1e20,this.yMax=1e20},clone:function(){var t=new gt;return t.xMin=this.xMin,t.yMin=this.yMin,t.xMax=this.xMax,t.yMax=this.yMax,t},get_x:function(){return this.xMin},get_y:function(){return this.yMin},set_x:function(t){return this.xMax+=t-this.xMin,this.xMin=t},set_y:function(t){return this.yMax+=t-this.yMin,this.yMin=t},get_width:function(){return this.xMax-this.xMin},get_height:function(){return this.yMax-this.yMin},set_width:function(t){return this.xMax=this.xMin+t,t},set_height:function(t){return this.yMax=this.yMin+t,t},toString:function(){return"{"+x.string(new Ct(this.xMin,this.yMin))+","+x.string(new Ct(this.xMax-this.xMin,this.yMax-this.yMin))+"}"},toCircle:function(){var t=this.xMax-this.xMin,e=this.yMax-this.yMin;return new vt(.5*(this.xMin+this.xMax),.5*(this.yMin+this.yMax),.5*Math.sqrt(t*t+e*e))},__class__:gt};var mt=function(){};i["h2d.col.Collider"]=mt,mt.__name__="h2d.col.Collider",mt.__isInterface__=!0,mt.prototype={__class__:mt};var vt=function(t,e,i){this.x=t,this.y=e,this.ray=i};i["h2d.col.Circle"]=vt,vt.__name__="h2d.col.Circle",vt.__interfaces__=[mt],vt.prototype={distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,n=e*e+i*i-this.ray*this.ray;return n<0?0:n},side:function(t){var e=t.x-this.x,i=t.y-this.y;return this.ray*this.ray-(e*e+i*i)},collideCircle:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i<(this.ray+t.ray)*(this.ray+t.ray)},collideBounds:function(t){if(this.x<t.xMin-this.ray)return!1;if(this.x>t.xMax+this.ray)return!1;if(this.y<t.yMin-this.ray)return!1;if(this.y>t.yMax+this.ray)return!1;var e,i,n;this.x<t.xMin&&this.y<t.yMin?e=(i=this.x-t.xMin)*i+(n=this.y-t.yMin)*n>this.ray*this.ray:e=!1;if(e)return!1;this.x>t.xMax&&this.y<t.yMin?e=(i=this.x-t.xMax)*i+(n=this.y-t.yMin)*n>this.ray*this.ray:e=!1;if(e)return!1;this.x<t.xMin&&this.y>t.yMax?e=(i=this.x-t.xMin)*i+(n=this.y-t.yMax)*n>this.ray*this.ray:e=!1;if(e)return!1;this.x>t.xMax&&this.y>t.yMax?e=(i=this.x-t.xMax)*i+(n=this.y-t.yMax)*n>this.ray*this.ray:e=!1;return!e},lineIntersect:function(t,e){var i=e.x-t.x,n=e.y-t.y,s=i*i+n*n;if(s<1e-8)return null;var r=2*(i*(t.x-this.x)+n*(t.y-this.y)),a=t.x-this.x,A=t.y-this.y,h=r*r-4*s*(a*a+A*A-this.ray*this.ray);if(h<0)return null;if(0==h){var o=-r/(2*s);return[new Ct(t.x+o*i,t.y+o*n)]}var l=(-r-Math.sqrt(h))/(2*s),u=(-r+Math.sqrt(h))/(2*s);return[new Ct(t.x+l*i,t.y+l*n),new Ct(t.x+u*i,t.y+u*n)]},toString:function(){return"{"+Es.fmt(this.x)+","+Es.fmt(this.y)+","+Es.fmt(this.ray)+"}"},contains:function(t){var e=t.x-this.x,i=t.y-this.y,n=e*e+i*i-this.ray*this.ray;return 0==(n<0?0:n)},__class__:vt};var yt=function(){this.xMin=2147483647,this.yMin=2147483647,this.xMax=-2147483648,this.yMax=-2147483648};i["h2d.col.IBounds"]=yt,yt.__name__="h2d.col.IBounds",yt.fromValues=function(t,e,i,n){var s=new yt;return s.xMin=t,s.yMin=e,s.xMax=t+i,s.yMax=e+n,s},yt.fromPoints=function(t,e){var i=new yt;return i.xMin=t.x,i.yMin=t.y,i.xMax=e.x,i.yMax=e.y,i},yt.prototype={toBounds:function(t){null==t&&(t=1);var e=this.xMin*t,i=this.yMin*t,n=(this.xMax-this.xMin)*t,s=(this.yMax-this.yMin)*t,r=new gt;return r.xMin=e,r.yMin=i,r.xMax=e+n,r.yMax=i+s,r},intersects:function(t){return!(this.xMin>t.xMax||this.yMin>t.yMax||this.xMax<t.xMin||this.yMax<t.yMin)},contains:function(t){return t.x>=this.xMin&&t.x<this.xMax&&t.y>=this.yMin&&t.y<this.yMax},addBounds:function(t){t.xMin<this.xMin&&(this.xMin=t.xMin),t.xMax>this.xMax&&(this.xMax=t.xMax),t.yMin<this.yMin&&(this.yMin=t.yMin),t.yMax>this.yMax&&(this.yMax=t.yMax)},addPoint:function(t){t.x<this.xMin&&(this.xMin=t.x),t.x>this.xMax&&(this.xMax=t.x),t.y<this.yMin&&(this.yMin=t.y),t.y>this.yMax&&(this.yMax=t.y)},addPos:function(t,e){t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),e<this.yMin&&(this.yMin=e),e>this.yMax&&(this.yMax=e)},set:function(t,e,i,n){this.xMin=t,this.yMin=e,this.xMax=t+i,this.yMax=e+n},setMin:function(t){this.xMin=t.x,this.yMin=t.y},setMax:function(t){this.xMax=t.x,this.yMax=t.y},doIntersect:function(t){var e=this.xMin,i=t.xMin;this.xMin=e<i?i:e;e=this.yMin,i=t.yMin;this.yMin=e<i?i:e;e=this.xMax,i=t.xMax;this.xMax=e>i?i:e;e=this.yMax,i=t.yMax;this.yMax=e>i?i:e},doUnion:function(t){var e=this.xMin,i=t.xMin;this.xMin=e>i?i:e;e=this.yMin,i=t.yMin;this.yMin=e>i?i:e;e=this.xMax,i=t.xMax;this.xMax=e<i?i:e;e=this.yMax,i=t.yMax;this.yMax=e<i?i:e},intersection:function(t){var e=new yt,i=this.xMin,n=t.xMin;e.xMin=i<n?n:i;i=this.yMin,n=t.yMin;e.yMin=i<n?n:i;i=this.xMax,n=t.xMax;e.xMax=i>n?n:i;i=this.yMax,n=t.yMax;return e.yMax=i>n?n:i,e.xMax<e.xMin&&(e.xMax=e.xMin),e.yMax<e.yMin&&(e.yMax=e.yMin),e},union:function(t){var e=new yt,i=this.xMin,n=t.xMin;e.xMin=i>n?n:i;i=this.yMin,n=t.yMin;e.yMin=i>n?n:i;i=this.xMax,n=t.xMax;e.xMax=i<n?n:i;i=this.yMax,n=t.yMax;return e.yMax=i<n?n:i,e},load:function(t){this.xMin=t.xMin,this.yMin=t.yMin,this.xMax=t.xMax,this.yMax=t.yMax},offset:function(t,e){this.xMin+=t,this.xMax+=t,this.yMin+=e,this.yMax+=e},getMin:function(){return new bt(this.xMin,this.yMin)},getCenter:function(){return new bt(this.xMin+this.xMax>>1,this.yMin+this.yMax>>1)},getSize:function(){return new bt(this.xMax-this.xMin,this.yMax-this.yMin)},getMax:function(){return new bt(this.xMax,this.yMax)},isEmpty:function(){return!(this.xMax>this.xMin)||this.yMax<=this.yMin},empty:function(){this.xMin=2147483647,this.yMin=2147483647,this.xMax=-2147483648,this.yMax=-2147483648},all:function(){this.xMin=-2147483648,this.yMin=-2147483648,this.xMax=2147483647,this.yMax=2147483647},clone:function(){var t=new yt;return t.xMin=this.xMin,t.yMin=this.yMin,t.xMax=this.xMax,t.yMax=this.yMax,t},get_x:function(){return this.xMin},get_y:function(){return this.yMin},set_x:function(t){return this.xMax+=t-this.xMin,this.xMin=t},set_y:function(t){return this.yMax+=t-this.yMin,this.yMin=t},get_width:function(){return this.xMax-this.xMin},get_height:function(){return this.yMax-this.yMin},set_width:function(t){return this.xMax=this.xMin+t,t},set_height:function(t){return this.yMax=this.yMin+t,t},toString:function(){return"{"+x.string(new bt(this.xMin,this.yMin))+","+x.string(new bt(this.xMax-this.xMin,this.yMax-this.yMin))+"}"},__class__:yt};var bt=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};i["h2d.col.IPoint"]=bt,bt.__name__="h2d.col.IPoint",bt.prototype={load:function(t){this.x=t.x,this.y=t.y},scale:function(t){this.x*=t,this.y*=t},multiply:function(t){return new bt(this.x*t,this.y*t)},distanceSq:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},distance:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},toString:function(){return"{"+this.x+","+this.y+"}"},sub:function(t){return new bt(this.x-t.x,this.y-t.y)},add:function(t){return new bt(this.x+t.x,this.y+t.y)},equals:function(t){return this.x==t.x&&this.y==t.y},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set:function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e},clone:function(){return new bt(this.x,this.y)},cross:function(t){return this.x*t.y-this.y*t.x},toPoint:function(t){return null==t&&(t=1),new Ct(this.x*t,this.y*t)},__class__:bt};var wt=s["h2d.col.OffsetKind"]={__ename__:!0,__constructs__:null,Square:{_hx_name:"Square",_hx_index:0,__enum__:"h2d.col.OffsetKind",toString:n},Miter:{_hx_name:"Miter",_hx_index:1,__enum__:"h2d.col.OffsetKind",toString:n},Round:(e=function(t){return{_hx_index:2,arc:t,__enum__:"h2d.col.OffsetKind",toString:n}},e._hx_name="Round",e.__params__=["arc"],e)};wt.__constructs__=[wt.Square,wt.Miter,wt.Round],wt.__empty_constructs__=[wt.Square,wt.Miter];var Mt={get_length:function(t){return t.length},get_points:function(t){return t},_new:function(t){return null==t?[]:t},iterator:function(t){return new Wr(t)},toPolygon:function(t,e){null==e&&(e=1);for(var i=[],n=0,s=t;n<s.length;){var r=s[n];++n;var a=e;null==a&&(a=1),i.push(new Ct(r.x*a,r.y*a))}return i},getBounds:function(t,e){null==e&&(e=new yt);for(var i=0,n=t;i<n.length;){var s=n[i];++i,s.x<e.xMin&&(e.xMin=s.x),s.x>e.xMax&&(e.xMax=s.x),s.y<e.yMin&&(e.yMin=s.y),s.y>e.yMax&&(e.yMax=s.y)}return e},union:function(t,e,i){null==i&&(i=!0);var n=new rr;return i||(n.resultKind=sr.NoHoles),n.addPolygon(t,lr.Clip),n.addPolygon(e,lr.Clip),n.execute(Ns.Union,or.NonZero,or.NonZero)},intersection:function(t,e,i){return null==i&&(i=!0),Mt.clipperOp(t,e,Ns.Intersection,i)},subtraction:function(t,e,i){return null==i&&(i=!0),Mt.clipperOp(t,e,Ns.Difference,i)},offset:function(t,e,i,n){null==n&&(n=!0);var s=new ar;switch(i._hx_index){case 0:s.addPolygon(t,hr.Square,Ar.ClosedPol);break;case 1:s.addPolygon(t,hr.Miter,Ar.ClosedPol);break;case 2:var r=i.arc;s.ArcTolerance=r,s.addPolygon(t,hr.Round,Ar.ClosedPol)}return n||(s.resultKind=sr.NoHoles),s.execute(e)},clipperOp:function(t,e,i,n){var s=new rr;return n||(s.resultKind=sr.NoHoles),s.addPolygon(t,lr.Subject),s.addPolygon(e,lr.Clip),s.execute(i,or.NonZero,or.NonZero)},convexHull:function(t){var e=t.length;if(e<3)throw kn.thrown("convexHull() needs at least 3 points");for(var i=0,n=t[i].x,s=1,r=t.length;s<r;){var a=t[l=s++].x;a<n&&(i=l,n=a)}for(var A=[],h=i,o=0;;){A.push(t[h]),o=(h+1)%e;for(s=0,r=e;s<r;){var l,u=t[l=s++],_=t[h],c=t[o];(_.x-u.x)*(c.y-u.y)-(_.y-u.y)*(c.x-u.x)<0&&(o=l)}if((h=o)==i)break}return A},isClockwise:function(t){for(var e=0,i=t[t.length-1],n=0,s=t;n<s.length;){var r=s[n];++n,e+=(r.x-i.x)*(r.y+i.y),i=r}return e<0},area:function(t){for(var e=0,i=t[t.length-1],n=0,s=t;n<s.length;){var r=s[n];++n,e+=i.x*r.y-r.x*i.y,i=r}return.5*(e<0?-e:e)},side:function(t,e,i,n){return(i.x-e.x)*(n.y-e.y)-(i.y-e.y)*(n.x-e.x)},isConvex:function(t){for(var e=t[t.length-2],i=t[t.length-1],n=t[0],s=(i.x-e.x)*(n.y-e.y)-(i.y-e.y)*(n.x-e.x)>0,r=1,a=t.length;r<a;){if(e=i,i=n,n=t[r++],(i.x-e.x)*(n.y-e.y)-(i.y-e.y)*(n.x-e.x)>0!=s)return!1}return!0},reverse:function(t){t.reverse()},contains:function(t,e,i){if(null==i&&(i=!1),i){for(var n=t[t.length-1],s=0,r=t;s<r.length;){var a=r[s];if(++s,(a.x-n.x)*(e.y-n.y)-(a.y-n.y)*(e.x-n.x)<0)return!1;n=a}return!0}var A=0;for(n=t[t.length-1],s=0,r=t;s<r.length;){a=r[s];++s,a.y<=e.y?n.y>e.y&&(n.x-a.x)*(e.y-a.y)-(n.y-a.y)*(e.x-a.x)>0&&++A:n.y<=e.y&&(n.x-a.x)*(e.y-a.y)-(n.y-a.y)*(e.x-a.x)<0&&--A,n=a}return 0!=A},optimize:function(t,e){var i=[];return Mt.optimizeRec(t,0,t.length,i,e),i},optimizeRec:function(t,e,i,n,s){for(var r=0,a=t[e],A=t[i-1],h=e+1,o=i-1;h<o;){var l,u,_=h++,c=t[_],d=c.x-a.x,f=c.y-a.y,x=A.x-a.x,p=A.y-a.y,g=x*x+p*p,m=-1;0!=g&&(m=(d*x+f*p)/g),m<0?(l=a.x,u=a.y):m>1?(l=A.x,u=A.y):(l=a.x+m*x,u=a.y+m*p);var v=c.x-l,y=c.y-u,b=v*v+y*y;b>r&&(e=_,r=b)}r>=s?(Mt.optimizeRec(t,0,e,n,s),n.pop(),Mt.optimizeRec(t,e,i,n,s)):(n.push(t[e]),n.push(t[i-1]))}},Bt=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.x=0,this.y=0};i["h2d.col.Matrix"]=Bt,Bt.__name__="h2d.col.Matrix",Bt.prototype={identity:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.x=0,this.y=0},initTranslate:function(t,e){this.a=1,this.b=0,this.c=0,this.d=1,this.x=t,this.y=e},initScale:function(t,e){this.a=t,this.b=0,this.c=0,this.d=e,this.x=0,this.y=0},initRotate:function(t){var e=Math.cos(t),i=Math.sin(t);this.a=e,this.b=i,this.c=-i,this.d=e,this.x=0,this.y=0},initSkew:function(t,e){var i=Math.tan(t),n=Math.tan(e);this.a=1,this.b=n,this.c=i,this.d=1,this.x=0,this.y=0},invert:function(){this.inverse(this)},getDeterminant:function(){return this.a*this.d-this.b*this.c},inverse:function(t){var e=t.a,i=t.b,n=t.c,s=t.d,r=t.x,a=t.y,A=1/(this.a*this.d-this.b*this.c);this.a=s*A,this.b=-i*A,this.c=-n*A,this.d=e*A,this.x=(-r*s+n*a)*A,this.y=(r*i-e*a)*A},transform:function(t){return new Ct(t.x*this.a+t.y*this.c+this.x,t.x*this.b+t.y*this.d+this.y)},translate:function(t,e){this.x+=t,this.y+=e},translateX:function(t){this.x+=t},translateY:function(t){this.y+=t},prependTranslate:function(t,e){this.x+=this.a*t+this.c*e,this.y+=this.b*t+this.d*e},prependTranslateX:function(t){this.x+=this.a*t},prependTranslateY:function(t){this.y+=this.d*t},multiply:function(t,e){var i=t.a,n=t.b,s=t.c,r=t.d,a=t.x,A=t.y,h=e.a,o=e.b,l=e.c,u=e.d,_=e.x,c=e.y;this.a=i*h+n*l,this.b=i*o+n*u,this.c=s*h+r*l,this.d=s*o+r*u,this.x=a*h+A*l+_,this.y=a*o+A*u+c},getScale:function(t){return null==t&&(t=new Ct),t.x=Math.sqrt(this.a*this.a+this.b*this.b),t.y=Math.sqrt(this.c*this.c+this.d*this.d),this.a*this.d-this.b*this.c<0&&(t.x*=-1,t.y*=-1),t},scale:function(t,e){this.a*=t,this.c*=t,this.x*=t,this.b*=e,this.d*=e,this.y*=e},scaleX:function(t){this.a*=t,this.c*=t,this.x*=t},scaleY:function(t){this.b*=t,this.d*=t,this.y*=t},rotate:function(t){var e=Bt.tmp,i=Math.cos(t),n=Math.sin(t);e.a=i,e.b=n,e.c=-n,e.d=i,e.x=0,e.y=0,this.multiply(this,Bt.tmp)},skew:function(t,e){var i=this.a,n=this.b,s=this.c,r=this.d,a=this.x,A=this.y,h=Math.tan(e),o=Math.tan(t);this.a=i+n*o,this.b=i*h+n,this.c=s+r*o,this.d=s*h+r,this.x=a+A*o,this.y=a*h+A},skewX:function(t){var e=Math.tan(t);this.a+=this.b*e,this.c+=this.d*e,this.x+=this.y*e},skewY:function(t){var e=Math.tan(t);this.b=this.a*e+this.b,this.d=this.c*e+this.d,this.y=this.x*e+this.y},clone:function(){var t=new Bt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.x=this.x,t.y=this.y,t},getPosition:function(t){null==t&&(t=new Ct);var e=this.x,i=this.y;return null==i&&(i=0),null==e&&(e=0),t.x=e,t.y=i,t},toString:function(){return"MAT=[\n  [ "+Es.fmt(this.a)+", "+Es.fmt(this.b)+" ]\n  [ "+Es.fmt(this.c)+", "+Es.fmt(this.d)+" ]\n  [ "+Es.fmt(this.x)+", "+Es.fmt(this.y)+" ]\n]"},__class__:Bt};var Ct=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};i["h2d.col.Point"]=Ct,Ct.__name__="h2d.col.Point",Ct.prototype={distanceSq:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},distance:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},toString:function(){return"{"+Es.fmt(this.x)+","+Es.fmt(this.y)+"}"},sub:function(t){return new Ct(this.x-t.x,this.y-t.y)},add:function(t){return new Ct(this.x+t.x,this.y+t.y)},multiply:function(t){return new Ct(this.x*t,this.y*t)},equals:function(t){return this.x==t.x&&this.y==t.y},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var t=this.x*this.x+this.y*this.y;t=t<1e-10?0:1/Math.sqrt(t),this.x*=t,this.y*=t},normalized:function(){var t=this.x*this.x+this.y*this.y;return t=t<1e-10?0:1/Math.sqrt(t),new Ct(this.x*t,this.y*t)},set:function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e},load:function(t){this.x=t.x,this.y=t.y},scale:function(t){this.x*=t,this.y*=t},clone:function(){return new Ct(this.x,this.y)},cross:function(t){return this.x*t.y-this.y*t.x},lerp:function(t,e,i){var n=t.x;this.x=n+i*(e.x-n);n=t.y;this.y=n+i*(t.y-n)},transform:function(t){var e=t.a*this.x+t.c*this.y+t.x,i=t.b*this.x+t.d*this.y+t.y;this.x=e,this.y=i},transformed:function(t){var e=t.a*this.x+t.c*this.y+t.x,i=t.b*this.x+t.d*this.y+t.y;return new Ct(e,i)},transform2x2:function(t){var e=t.a*this.x+t.c*this.y,i=t.b*this.x+t.d*this.y;this.x=e,this.y=i},transformed2x2:function(t){var e=t.a*this.x+t.c*this.y,i=t.b*this.x+t.d*this.y;return new Ct(e,i)},toIPoint:function(t){return null==t&&(t=1),new bt(Math.round(this.x*t),Math.round(this.y*t))},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.x*e-this.y*i,s=this.x*i+this.y*e;this.x=n,this.y=s},__class__:Ct};var St={get_length:function(t){return t.length},get_points:function(t){return t},_new:function(t){return null==t?[]:t},iterator:function(t){return new Jr(t)},fastTriangulate:function(t){return(new cr).triangulate_h2d_col_Point(t)},toSegments:function(t){for(var e=[],i=t[t.length-1],n=0,s=t;n<s.length;){var r=s[n];++n;var a=new Ft(i,r);e.push(a),i=r}return e},toIPolygon:function(t,e){null==e&&(e=1);for(var i=[],n=0,s=t;n<s.length;){var r=s[n];++n;var a=e;null==a&&(a=1),i.push(new bt(Math.round(r.x*a),Math.round(r.y*a)))}return i},getBounds:function(t,e){null==e&&(e=new gt);for(var i=0,n=t;i<n.length;){var s=n[i];++i,s.x<e.xMin&&(e.xMin=s.x),s.x>e.xMax&&(e.xMax=s.x),s.y<e.yMin&&(e.yMin=s.y),s.y>e.yMax&&(e.yMax=s.y)}return e},getCollider:function(t,e){return null==e&&(e=!1),new It([t],e)},xSort:function(t,e,i){return e.x==i.x?e.y<i.y?-1:1:e.x<i.x?-1:1},convexHull:function(t){var e=t.length;if(t.length<3)return t;t.sort((function(t,e){return t.x==e.x?t.y<e.y?-1:1:t.x<e.x?-1:1}));for(var i=[],n=0,s=0,r=t;s<r.length;){var a=r[s];for(++s;;){if(n>=2){var A=i[n-2];o=((l=i[n-1]).x-A.x)*(a.y-A.y)-(l.y-A.y)*(a.x-A.x)<=0}else o=!1;if(!o)break;--n}i[n++]=a}var h=t.length-2;for(e=n+1;h>=0;){for(a=t[h];;){var o;if(n>=e){var l;A=i[n-2];o=((l=i[n-1]).x-A.x)*(a.y-A.y)-(l.y-A.y)*(a.x-A.x)<=0}else o=!1;if(!o)break;--n}i[n++]=a,--h}for(;i.length>=n;)i.pop();return i},isClockwise:function(t){for(var e=0,i=t[t.length-1],n=0,s=t;n<s.length;){var r=s[n];++n,e+=(r.x-i.x)*(r.y+i.y),i=r}return e<0},area:function(t){for(var e=0,i=t[t.length-1],n=0,s=t;n<s.length;){var r=s[n];++n,e+=r.x*i.y-i.x*r.y,i=r}return.5*(e<0?-e:e)},centroid:function(t){for(var e=0,i=0,n=0,s=t[t.length-1],r=0,a=t;r<a.length;){var A=a[r];++r;var h=s.x*A.y-A.x*s.y;i+=(s.x+A.x)*h,n+=(s.y+A.y)*h,e+=h,s=A}return new Ct(i*=1/(6*(e*=.5)),n*=1/(6*e))},side:function(t,e,i,n){return(i.x-e.x)*(n.y-e.y)-(i.y-e.y)*(n.x-e.x)},isConvex:function(t){if(t.length<4)return!0;for(var e=t[t.length-2],i=t[t.length-1],n=t[0],s=(i.x-e.x)*(n.y-e.y)-(i.y-e.y)*(n.x-e.x)>0,r=1,a=t.length;r<a;){if(e=i,i=n,n=t[r++],(i.x-e.x)*(n.y-e.y)-(i.y-e.y)*(n.x-e.x)>0!=s)return!1}return!0},reverse:function(t){t.reverse()},transform:function(t,e){for(var i=0,n=t.length;i<n;){var s=i++,r=t[s];t[s]=new Ct(r.x*e.a+r.y*e.c+e.x,r.x*e.b+r.y*e.d+e.y)}},contains:function(t,e,i){if(null==i&&(i=!1),i){for(var n=t[t.length-1],s=0,r=t;s<r.length;){var a=r[s];if(++s,(a.x-n.x)*(e.y-n.y)-(a.y-n.y)*(e.x-n.x)<0)return!1;n=a}return!0}var A=0;for(n=t[t.length-1],s=0,r=t;s<r.length;){a=r[s];++s,a.y<=e.y?n.y>e.y&&(n.x-a.x)*(e.y-a.y)-(n.y-a.y)*(e.x-a.x)>0&&++A:n.y<=e.y&&(n.x-a.x)*(e.y-a.y)-(n.y-a.y)*(e.x-a.x)<0&&--A,n=a}return 0!=A},findClosestPoint:function(t,e,i){for(var n=null,s=i*i,r=0,a=t;r<a.length;){var A=a[r];++r;var h=A.x-e.x,o=A.y-e.y,l=h*h+o*o;l<s&&(n=A,s=l)}return n},projectPoint:function(t,e){for(var i=t[t.length-1],n=null,s=1e10,r=0,a=t;r<a.length;){var A=a[r];++r;var h,o=i,l=A,u=o.x,_=o.y,c=l.x-u,d=l.y-_,f=c*c+d*d,x=1/f,p=(e.x-u)*c+(e.y-_)*d;if(p<0)h=new Ct(u,_);else if(p>f)h=new Ct(u+c,_+d);else{var g=p*x;h=new Ct(u+g*c,_+g*d)}var m=h.x-e.x,v=h.y-e.y,y=m*m+v*v;y<s&&(n=h,s=y),i=A}return n},distance:function(t,e,i){return Math.sqrt(St.distanceSq(t,e,i))},distanceSq:function(t,e,i){for(var n=t[t.length-1],s=1e10,r=0,a=t;r<a.length;){var A=a[r];++r;var h=n,o=A,l=h.x,u=h.y,_=o.x-l,c=o.y-u,d=_*_+c*c,f=1/d;if(null==i||_*(e.y-u)-c*(e.x-l)<0==i){var x,p=e.x-l,g=e.y-u,m=p*_+g*c;if(m<0)x=p*p+g*g;else if(m>d){var v=e.x-(l+_),y=e.y-(u+c);x=v*v+y*y}else{var b=m*f,w=l+b*_-e.x,M=u+b*c-e.y;x=w*w+M*M}x<s&&(s=x)}n=A}return 1e10==s?0:s},rayIntersection:function(t,e,i){for(var n=-1,s=t[t.length-1],r=0,a=t;r<a.length;){var A=a[r];if(++r,(e.lx*(s.y-e.py)-e.ly*(s.x-e.px))*(e.lx*(A.y-e.py)-e.ly*(A.x-e.px))>0)s=A;else{var h=(e.lx*(s.y-e.py)-e.ly*(s.x-e.px))/(e.ly*(A.x-s.x)-e.lx*(A.y-s.y)),o=s.x+h*(A.x-s.x),l=s.y+h*(A.y-s.y),u=o-e.px,_=l-e.py,c=u*u+_*_;if(c<n||n<0){if(!i)return Math.sqrt(c);n=c}s=A}}return n<0?n:Math.sqrt(n)},orientation:function(t,e,i,n){var s=(i.x-e.x)*(n.y-e.y)-(i.y-e.y)*(n.x-e.x);return 0==s?0:s>0?1:-1},onSegment:function(t,e,i,n){var s=e.x,r=i.x;if(n.x>(s<r?r:s))return!1;s=e.x,r=i.x;if(n.x<(s>r?r:s))return!1;s=e.y,r=i.y;if(n.y>(s<r?r:s))return!1;s=e.y,r=i.y;return!(n.y<(s>r?r:s))},intersect:function(t,e,i,n,s){var r,a,A,h,o,l=0==(r=(i.x-e.x)*(n.y-e.y)-(i.y-e.y)*(n.x-e.x))?0:r>0?1:-1,u=0==(r=(i.x-e.x)*(s.y-e.y)-(i.y-e.y)*(s.x-e.x))?0:r>0?1:-1,_=0==(r=(s.x-n.x)*(e.y-n.y)-(s.y-n.y)*(e.x-n.x))?0:r>0?1:-1,c=0==(r=(s.x-n.x)*(i.y-n.y)-(s.y-n.y)*(i.x-n.x))?0:r>0?1:-1;if(l!=u&&_!=c)return!0;if(0==l){var d=e.x,f=i.x;if(n.x>(d<f?f:d))o=!1;else{d=e.x,f=i.x;if(n.x<(d>f?f:d))o=!1;else{d=e.y,f=i.y;if(n.y>(d<f?f:d))o=!1;else{d=e.y,f=i.y;o=!(n.y<(d>f?f:d))}}}}else o=!1;if(o)h=!0;else if(0==u){d=e.x,f=i.x;if(s.x>(d<f?f:d))h=!1;else{d=e.x,f=i.x;if(s.x<(d>f?f:d))h=!1;else{d=e.y,f=i.y;if(s.y>(d<f?f:d))h=!1;else{d=e.y,f=i.y;h=!(s.y<(d>f?f:d))}}}}else h=!1;if(h)A=!0;else if(0==_){d=n.x,f=s.x;if(e.x>(d<f?f:d))A=!1;else{d=n.x,f=s.x;if(e.x<(d>f?f:d))A=!1;else{d=n.y,f=s.y;if(e.y>(d<f?f:d))A=!1;else{d=n.y,f=s.y;A=!(e.y<(d>f?f:d))}}}}else A=!1;if(A)a=!0;else if(0==c){d=n.x,f=s.x;if(i.x>(d<f?f:d))a=!1;else{d=n.x,f=s.x;if(i.x<(d>f?f:d))a=!1;else{d=n.y,f=s.y;if(i.y>(d<f?f:d))a=!1;else{d=n.y,f=s.y;a=!(i.y<(d>f?f:d))}}}}else a=!1;return!!a},selfIntersecting:function(t){if(t.length<4)return!1;for(var e=0,i=t.length-2;e<i;)for(var n=e++,s=t[n],r=t[n+1],a=n+2,A=t.length;a<A;){var h=a++,o=t[h],l=t[(h+1)%t.length];if(l!=s&&St.intersect(t,s,r,o,l))return!0}return!1},optimize:function(t,e){var i=[];return St.optimizeRec(t,0,t.length-1,i,e),i},optimizeRec:function(t,e,i,n,s){for(var r=0,a=t[e],A=t[i],h=0,o=e+1,l=i;o<l;){var u,_,c=o++,d=t[c],f=d.x-a.x,x=d.y-a.y,p=A.x-a.x,g=A.y-a.y,m=p*p+g*g,v=-1;0!=m&&(v=(f*p+x*g)/m),v<0?(u=a.x,_=a.y):v>1?(u=A.x,_=A.y):(u=a.x+v*p,_=a.y+v*g);var y=d.x-u,b=d.y-_,w=y*y+b*b;w>r&&(h=c,r=w)}r>=s*s?(St.optimizeRec(t,e,h,n,s),n.pop(),St.optimizeRec(t,h,i,n,s)):(n.push(t[e]),n.push(t[i]))},makeCircle:function(t,e,i,n){if(null==n&&(n=0),0==n){var s=3.14*i*2/4;n=Math.ceil(s<0?-s:s)}n<3&&(n=3);for(var r=6.283185307179586/n,a=[],A=0,h=n;A<h;){var o=A++*r;a.push(new Ct(Math.cos(o)*i+t,Math.sin(o)*i+e))}return null==a?[]:a}},It=function(t,e){null==e&&(e=!1),this.polygons=t,this.isConvex=e};i["h2d.col.PolygonCollider"]=It,It.__name__="h2d.col.PolygonCollider",It.__interfaces__=[mt],It.prototype={contains:function(t){return null!=this.polygons&&kt.contains(this.polygons,t,this.isConvex)},__class__:It};var kt={get_length:function(t){return t.length},get_polygons:function(t){return t},_new:function(t){return null==t?[]:t},iterator:function(t){return new qr(t)},toIPolygons:function(t,e){null==e&&(e=1);for(var i=[],n=0,s=t;n<s.length;){var r=s[n];++n,i.push(St.toIPolygon(r,e))}return i},getBounds:function(t,e){null==e&&(e=new gt);for(var i=0,n=t;i<n.length;){var s=n[i];++i,St.getBounds(s,e)}return e},getCollider:function(t,e){return null==e&&(e=!1),new It(t,e)},contains:function(t,e,i){null==i&&(i=!1);for(var n=0,s=t;n<s.length;){var r=s[n];if(++n,St.contains(r,e,i))return!0}return!1},optimize:function(t,e){for(var i=[],n=0,s=t;n<s.length;){var r=s[n];++n,i.push(St.optimize(r,e))}return i}},Et=function(){};i["h2d.col.Ray"]=Et,Et.__name__="h2d.col.Ray",Et.fromPoints=function(t,e){var i=new Et;return i.px=t.x,i.py=t.y,i.lx=e.x-t.x,i.ly=e.y-t.y,i.normalize(),i},Et.fromValues=function(t,e,i,n){var s=new Et;return s.px=t,s.py=e,s.lx=i,s.ly=n,s.normalize(),s},Et.prototype={side:function(t){return this.lx*(t.y-this.py)-this.ly*(t.x-this.px)},getPoint:function(t){return new Ct(this.px+t*this.lx,this.py+t*this.ly)},getPos:function(){return new Ct(this.px,this.py)},getDir:function(){return new Ct(this.lx,this.ly)},normalize:function(){var t=this.lx*this.lx+this.ly*this.ly;1!=t&&(t=t<1e-10?0:1/Math.sqrt(t),this.lx*=t,this.ly*=t)},__class__:Et};var Ft=function(t,e){this.x=t.x,this.y=t.y,this.dx=e.x-this.x,this.dy=e.y-this.y,this.lenSq=this.dx*this.dx+this.dy*this.dy,this.invLenSq=1/this.lenSq};i["h2d.col.Segment"]=Ft,Ft.__name__="h2d.col.Segment",Ft.prototype={setPoints:function(t,e){this.x=t.x,this.y=t.y,this.dx=e.x-this.x,this.dy=e.y-this.y,this.lenSq=this.dx*this.dx+this.dy*this.dy,this.invLenSq=1/this.lenSq},side:function(t){return this.dx*(t.y-this.y)-this.dy*(t.x-this.x)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,n=e*this.dx+i*this.dy;if(n<0)return e*e+i*i;if(n>this.lenSq){var s=t.x-(this.x+this.dx),r=t.y-(this.y+this.dy);return s*s+r*r}var a=n*this.invLenSq,A=this.x+a*this.dx-t.x,h=this.y+a*this.dy-t.y;return A*A+h*h},distance:function(t){var e,i=t.x-this.x,n=t.y-this.y,s=i*this.dx+n*this.dy;if(s<0)e=i*i+n*n;else if(s>this.lenSq){var r=t.x-(this.x+this.dx),a=t.y-(this.y+this.dy);e=r*r+a*a}else{var A=s*this.invLenSq,h=this.x+A*this.dx-t.x,o=this.y+A*this.dy-t.y;e=h*h+o*o}return Math.sqrt(e)},project:function(t){var e=t.x-this.x,i=t.y-this.y,n=e*this.dx+i*this.dy;if(n<0)return new Ct(this.x,this.y);if(n>this.lenSq)return new Ct(this.x+this.dx,this.y+this.dy);var s=n*this.invLenSq;return new Ct(this.x+s*this.dx,this.y+s*this.dy)},lineIntersection:function(t,e){var i=this.x;null==(n=this.y)&&(n=0),null==i&&(i=0);var n,s=i,r=n;i=this.x+this.dx;null==(n=this.y+this.dy)&&(n=0),null==i&&(i=0);var a=i,A=n;if((t.lx*(r-t.py)-t.ly*(s-t.px))*(t.lx*(A-t.py)-t.ly*(a-t.px))>0)return null;var h=(t.lx*(this.y-t.py)-t.ly*(this.x-t.px))/(t.ly*this.dx-t.lx*this.dy);return h<0||h>1?null:(null==e&&(e=new Ct),e.x=this.x+h*this.dx,e.y=this.y+h*this.dy,e)},__class__:Ft};var Tt=function(){this.enable=!0,this.smooth=!1,this.boundsExtend=0,this.autoBounds=!0};i["h2d.filter.Filter"]=Tt,Tt.__name__="h2d.filter.Filter",Tt.prototype={get_enable:function(){return this.enable},set_enable:function(t){return this.enable=t},sync:function(t,e){},bind:function(t){},unbind:function(t){},getBounds:function(t,e){t.getBounds(t,e),e.xMin-=this.boundsExtend,e.yMin-=this.boundsExtend,e.xMax+=this.boundsExtend,e.yMax+=this.boundsExtend},draw:function(t,e){return e},__class__:Tt};var Dt=function(){this.head=this.tail=new Pt(null),this.totalCount=0};i["h2d.impl.BatchDrawState"]=Dt,Dt.__name__="h2d.impl.BatchDrawState",Dt.prototype={setTile:function(t){null!=t&&this.setTexture(t.innerTex)},setTexture:function(t){if(null!=t)if(null==this.tail.texture)this.tail.texture=t;else if(this.tail.texture!=t){var e=this.tail;null==e.next?e.next=this.tail=new Pt(t):this.tail=e.next.set(t)}},add:function(t){this.tail.count+=t,this.totalCount+=t},clear:function(){for(var t=this.head;t.texture=null,null!=(t=t.next););this.tail=this.head,this.tail.count=0,this.totalCount=0},drawQuads:function(t,e,i,n){null==n&&(n=-1),null==i&&(i=0);var s,r=this.head,a=this.tail.next,A=t.engine;if(0==i&&-1==n)for(;;){if(t.texture=r.texture,t.beforeDraw(),null==(l=s=r.count>>1)&&(l=-1),null==(o=i)&&(o=0),A.renderBuffer(e,A.mem.quadIndexes,2,o,l),i+=s,(r=r.next)==a)break}else{-1==n&&(n=(this.totalCount>>1)-i);for(var h=0;;){if(h+(s=r.count>>1)>=i){var o,l,u=i>=h?i:h,_=n>s?s:n;if(t.texture=r.texture,t.beforeDraw(),null==(l=_)&&(l=-1),null==(o=u)&&(o=0),A.renderBuffer(e,A.mem.quadIndexes,2,o,l),0==(n-=_))break}if(h+=s,(r=r.next)==a)break}}},drawIndexed:function(t,e,i,n,s){null==s&&(s=-1),null==n&&(n=0);var r,a=this.head,A=this.tail.next,h=t.engine;if(0==n&&-1==s)for(;t.texture=a.texture,t.beforeDraw(),r=a.count/3|0,h.renderIndexed(e,i,n,r),n+=r,(a=a.next)!=A;);else{-1==s&&(s=this.totalCount/3|0);for(var o=0;;){if(o+(r=a.count/3|0)>=n){var l=n>=o?n:o,u=s>r?r:s;if(t.texture=a.texture,t.beforeDraw(),h.renderIndexed(e,i,l,u),0==(s-=u))break}if(o+=r,(a=a.next)==A)break}}},get_currentTexture:function(){return this.tail.texture},__class__:Dt};var Pt=function(t){this.texture=t,this.count=0};i["h2d.impl._BatchDrawState.StateEntry"]=Pt,Pt.__name__="h2d.impl._BatchDrawState.StateEntry",Pt.prototype={set:function(t){return this.texture=t,this.count=0,this},__class__:Pt};var zt=s["h3d.BufferFlag"]={__ename__:!0,__constructs__:null,Dynamic:{_hx_name:"Dynamic",_hx_index:0,__enum__:"h3d.BufferFlag",toString:n},Triangles:{_hx_name:"Triangles",_hx_index:1,__enum__:"h3d.BufferFlag",toString:n},Quads:{_hx_name:"Quads",_hx_index:2,__enum__:"h3d.BufferFlag",toString:n},Managed:{_hx_name:"Managed",_hx_index:3,__enum__:"h3d.BufferFlag",toString:n},RawFormat:{_hx_name:"RawFormat",_hx_index:4,__enum__:"h3d.BufferFlag",toString:n},NoAlloc:{_hx_name:"NoAlloc",_hx_index:5,__enum__:"h3d.BufferFlag",toString:n},UniformBuffer:{_hx_name:"UniformBuffer",_hx_index:6,__enum__:"h3d.BufferFlag",toString:n},LargeBuffer:{_hx_name:"LargeBuffer",_hx_index:7,__enum__:"h3d.BufferFlag",toString:n}};zt.__constructs__=[zt.Dynamic,zt.Triangles,zt.Quads,zt.Managed,zt.RawFormat,zt.NoAlloc,zt.UniformBuffer,zt.LargeBuffer],zt.__empty_constructs__=[zt.Dynamic,zt.Triangles,zt.Quads,zt.Managed,zt.RawFormat,zt.NoAlloc,zt.UniformBuffer,zt.LargeBuffer];var Rt=function(t,e,i){this.id=Rt.GUID++,this.vertices=t;if(this.flags=0,null!=i)for(var n=0;n<i.length;){var s=i[n];++n,this.flags|=1<<s._hx_index}0==(this.flags&1<<zt.NoAlloc._hx_index)&&Ut.CURRENT.mem.allocBuffer(this,e)};i["h3d.Buffer"]=Rt,Rt.__name__="h3d.Buffer",Rt.ofFloats=function(t,e,i){var n=t.pos/e|0,s=new Rt(n,e,i);return s.uploadVector(t,0,n),s},Rt.ofSubFloats=function(t,e,i,n){var s=new Rt(i,e,n);return s.uploadVector(t,0,i),s},Rt.prototype={isDisposed:function(){return null==this.buffer||null==this.buffer.vbuf},dispose:function(){null!=this.buffer&&(this.buffer.freeBuffer(this),this.buffer=null,null!=this.next&&this.next.dispose())},totalVertices:function(){for(var t=0,e=this;null!=e;)t+=e.vertices,e=e.next;return t},uploadVector:function(t,e,i,n){null==n&&(n=0);for(var s=this;null!=s&&n>=s.vertices;)n-=s.vertices,s=s.next;for(;i>0;){if(null==s)throw kn.thrown("Too many vertices");var r=i+n>s.vertices?s.vertices-n:i;s.buffer.uploadVertexBuffer(s.position+n,r,t,e),n=0,e+=r*this.buffer.stride,i-=r,s=s.next}},uploadBytes:function(t,e,i){for(var n=this;i>0;){if(null==n)throw kn.thrown("Too many vertices");var s=i>n.vertices?n.vertices:i;n.buffer.uploadVertexBytes(n.position,s,t,e),e+=s*this.buffer.stride*4,i-=s,n=n.next}},readBytes:function(t,e,i,n){null==n&&(n=0);for(var s=this;null!=s&&n>=s.vertices;)n-=s.vertices,s=s.next;for(;i>0;){if(null==s)throw kn.thrown("Too many vertices");var r=i+n>s.vertices?s.vertices-n:i;s.buffer.readVertexBytes(s.position+n,r,t,e),n=0,e+=r*this.buffer.stride*4,i-=r,s=s.next}},__class__:Rt};var Lt=function(t,e){this.buffer=t,this.offset=e};i["h3d.BufferOffset"]=Lt,Lt.__name__="h3d.BufferOffset",Lt.prototype={clone:function(){return new Lt(this.buffer,this.offset)},dispose:function(){null!=this.buffer&&(this.buffer.dispose(),this.buffer=null),this.next=null},__class__:Lt};var Vt=function(t,e,i,n,s,r){null==r&&(r=!1),null==s&&(s=4e3),null==n&&(n=.02),null==i&&(i=1.333333),null==e&&(e=1),null==t&&(t=25),this.viewY=0,this.viewX=0,this.fovY=t,this.zoom=e,this.screenRatio=i,this.zNear=n,this.zFar=s,this.rightHanded=r,this.pos=new Yt(2,3,4),this.up=new Yt(0,0,1),this.target=new Yt(0,0,0),this.m=new Gt,this.mcam=new Gt,this.mproj=new Gt,this.frustum=new he,this.update()};i["h3d.Camera"]=Vt,Vt.__name__="h3d.Camera",Vt.prototype={setFovX:function(t,e){var i=Math.PI/180;this.fovY=2*Math.atan(Math.tan(.5*t*i)/e)/i},getFovX:function(){var t=Math.PI/180;return 2*Math.atan(Math.tan(.5*this.fovY*t)*this.screenRatio)/t},clone:function(){var t=new Vt(this.fovY,this.zoom,this.screenRatio,this.zNear,this.zFar,this.rightHanded),e=this.pos;t.pos=new Yt(e.x,e.y,e.z,e.w);e=this.up;t.up=new Yt(e.x,e.y,e.z,e.w);e=this.target;return t.target=new Yt(e.x,e.y,e.z,e.w),t.update(),t},getInverseViewProj:function(){return null==this.minv&&(this.minv=new Gt),this.needInv&&(this.minv.initInverse(this.m),this.needInv=!1),this.minv},getInverseProj:function(){return null==this.mprojInv&&(this.mprojInv=new Gt,this.mprojInv._44=0),0==this.mprojInv._44&&this.mprojInv.initInverse(this.mproj),this.mprojInv},getInverseView:function(){return null==this.mcamInv&&(this.mcamInv=new Gt,this.mcamInv._44=0),0==this.mcamInv._44&&this.mcamInv.initInverse(this.mcam),this.mcamInv},setCubeMap:function(t,e){var i=0,n=0,s=0;switch(t){case 0:i=1,null==(r=0)&&(r=0),null==(h=1)&&(h=0),null==(A=0)&&(A=0),(a=this.up).x=A,a.y=h,a.z=r,a.w=1;break;case 1:i=-1,null==(r=0)&&(r=0),null==(h=1)&&(h=0),null==(A=0)&&(A=0),(a=this.up).x=A,a.y=h,a.z=r,a.w=1;break;case 2:n=1,null==(r=-1)&&(r=0),null==(h=0)&&(h=0),null==(A=0)&&(A=0),(a=this.up).x=A,a.y=h,a.z=r,a.w=1;break;case 3:n=-1,null==(r=1)&&(r=0),null==(h=0)&&(h=0),null==(A=0)&&(A=0),(a=this.up).x=A,a.y=h,a.z=r,a.w=1;break;case 4:s=1,null==(r=0)&&(r=0),null==(h=1)&&(h=0),null==(A=0)&&(A=0),(a=this.up).x=A,a.y=h,a.z=r,a.w=1;break;case 5:s=-1,null==(r=0)&&(r=0),null==(h=1)&&(h=0),null==(A=0)&&(A=0),(a=this.up).x=A,a.y=h,a.z=r,a.w=1}null!=e&&((a=this.pos).x=e.x,a.y=e.y,a.z=e.z,a.w=e.w);var r,a=this.target,A=this.pos.x+i,h=this.pos.y+n;null==(r=this.pos.z+s)&&(r=0),null==h&&(h=0),null==A&&(A=0),a.x=A,a.y=h,a.z=r,a.w=1},unproject:function(t,e,i){var n=new Yt(t,e,i),s=this.getInverseViewProj(),r=n.x*s._11+n.y*s._21+n.z*s._31+n.w*s._41,a=n.x*s._12+n.y*s._22+n.z*s._32+n.w*s._42,A=n.x*s._13+n.y*s._23+n.z*s._33+n.w*s._43,h=1/(n.x*s._14+n.y*s._24+n.z*s._34+n.w*s._44);return n.x=r*h,n.y=a*h,n.z=A*h,n.w=1,n},rayFromScreen:function(t,e,i,n){null==n&&(n=-1),null==i&&(i=-1);var s=Ut.CURRENT;i<0&&(i=s.width),n<0&&(n=s.height);var r=2*(t/i-.5),a=2*(.5-e/n),A=(o=this.unproject(r,a,0)).x,h=o.y;null==(l=o.z)&&(l=0),null==h&&(h=0),null==A&&(A=0);var o,l,u=A,_=h,c=l;A=(o=this.unproject(r,a,1)).x,h=o.y;null==(l=o.z)&&(l=0),null==h&&(h=0),null==A&&(A=0);var d=A,f=h,x=l,p=new oe;return p.px=u,p.py=_,p.pz=c,p.lx=d-u,p.ly=f-_,p.lz=x-c,p.normalize(),p},update:function(){if(null!=this.follow){var t=this.follow.pos.localToGlobal(),e=this.follow.target.localToGlobal(),i=this.pos,n=t.x,s=t.y;null==(r=t.z)&&(r=0),null==s&&(s=0),null==n&&(n=0),i.x=n,i.y=s,i.z=r,i.w=1;var r;i=this.target,n=e.x,s=e.y;if(null==(r=e.z)&&(r=0),null==s&&(s=0),null==n&&(n=0),i.x=n,i.y=s,i.z=r,i.w=1,null!=this.follow.pos.name)for(var a=this.follow.pos;null!=a;){if(null!=a.currentAnimation){var A=a.currentAnimation.getPropValue(this.follow.pos.name,"FOVY");if(null!=A){this.fovY=A;break}}a=a.parent}}this.makeCameraMatrix(this.mcam),this.makeFrustumMatrix(this.mproj),this.m.multiply(this.mcam,this.mproj),this.needInv=!0,null!=this.mcamInv&&(this.mcamInv._44=0),null!=this.mprojInv&&(this.mprojInv._44=0),this.frustum.loadMatrix(this.m)},getFrustumCorners:function(t,e){return null==e&&(e=0),null==t&&(t=1),[this.unproject(-1,1,e),this.unproject(1,1,e),this.unproject(1,-1,e),this.unproject(-1,-1,e),this.unproject(-1,1,t),this.unproject(1,1,t),this.unproject(1,-1,t),this.unproject(-1,-1,t)]},lostUp:function(){var t=this.pos,e=t.x,i=t.y,n=t.z,s=t.w;null==s&&(s=1),null==n&&(n=0),null==i&&(i=0),null==e&&(e=0);var r=e,a=i,A=n,h=r*r+a*a+A*A;r*=h=h<1e-10?0:1/Math.sqrt(h),a*=h,A*=h;var o=this.up;return Math.abs(r*o.x+a*o.y+A*o.z)>.999},getViewDirection:function(t,e,i){null==i&&(i=0);var n=new _e(t,e,i),s=this.mcam,r=n.x*s._11+n.y*s._21+n.z*s._31,a=n.x*s._12+n.y*s._22+n.z*s._32,A=n.x*s._13+n.y*s._23+n.z*s._33;n.x=r,n.y=a,n.z=A;var h=n.x*n.x+n.y*n.y+n.z*n.z;return h=h<1e-10?0:1/Math.sqrt(h),n.x*=h,n.y*=h,n.z*=h,n},movePosAxis:function(t,e,i){null==i&&(i=0);var n=t,s=e,r=i;null==r&&(r=0),null==s&&(s=0),null==n&&(n=0);var a=n,A=s,h=r,o=this.mcam,l=a*o._11+A*o._21+h*o._31,u=a*o._12+A*o._22+h*o._32,_=a*o._13+A*o._23+h*o._33;a=l,A=u,h=_,this.pos.x+=a,this.pos.y+=A,this.pos.z+=h},moveTargetAxis:function(t,e,i){null==i&&(i=0);var n=t,s=e,r=i;null==r&&(r=0),null==s&&(s=0),null==n&&(n=0);var a=n,A=s,h=r,o=this.mcam,l=a*o._11+A*o._21+h*o._31,u=a*o._12+A*o._22+h*o._32,_=a*o._13+A*o._23+h*o._33;a=l,A=u,h=_,this.target.x+=a,this.target.y+=A,this.target.z+=h},forward:function(t){null==t&&(t=1);var e=1-.025*t,i=this.pos,n=this.target.x+(this.pos.x-this.target.x)*e,s=this.target.y+(this.pos.y-this.target.y)*e,r=this.target.z+(this.pos.z-this.target.z)*e;null==r&&(r=0),null==s&&(s=0),null==n&&(n=0),i.x=n,i.y=s,i.z=r,i.w=1},backward:function(t){null==t&&(t=1);var e=1+.025*t,i=this.pos,n=this.target.x+(this.pos.x-this.target.x)*e,s=this.target.y+(this.pos.y-this.target.y)*e,r=this.target.z+(this.pos.z-this.target.z)*e;null==r&&(r=0),null==s&&(s=0),null==n&&(n=0),i.x=n,i.y=s,i.z=r,i.w=1},makeCameraMatrix:function(t){var e=this.target,i=this.pos,n=e.x-i.x,s=e.y-i.y,r=e.z-i.z;e.w,i.w,null==r&&(r=0),null==s&&(s=0),null==n&&(n=0);var a=n,A=s,h=r;this.rightHanded&&(a*=-1,A*=-1,h*=-1),a*=o=(o=a*a+A*A+h*h)<1e-10?0:1/Math.sqrt(o),A*=o,h*=o;n=(e=this.up).y*h-e.z*A,s=e.z*a-e.x*h;null==(r=e.x*A-e.y*a)&&(r=0),null==s&&(s=0),null==n&&(n=0);var o,l=n,u=s,_=r;l*=o=(o=l*l+u*u+_*_)<1e-10?0:1/Math.sqrt(o),u*=o,_*=o,0==Math.sqrt(l*l+u*u+_*_)&&(l=A,u=h,_=a),null==(r=a*u-A*l)&&(r=0),null==(s=h*l-a*_)&&(s=0),null==(n=A*_-h*u)&&(n=0);var c=n,d=s,f=r;t._11=l,t._12=c,t._13=a,t._14=0,t._21=u,t._22=d,t._23=A,t._24=0,t._31=_,t._32=f,t._33=h,t._34=0;i=this.pos;t._41=-(l*i.x+u*i.y+_*i.z);i=this.pos;t._42=-(c*i.x+d*i.y+f*i.z);i=this.pos;t._43=-(a*i.x+A*i.y+h*i.z),t._44=1},setTransform:function(t){var e=this.pos,i=t._41,n=t._42;null==(a=t._43)&&(a=0),null==n&&(n=0),null==i&&(i=0),e.x=i,e.y=n,e.z=a,e.w=1;e=this.target;var s=this.pos,r=t.getDirection(),a=(i=s.x+r.x,n=s.y+r.y,s.z+r.z),A=s.w+r.w;null==A&&(A=1),null==a&&(a=0),null==n&&(n=0),null==i&&(i=0);var h=i,o=n,l=a,u=A;e.x=h,e.y=o,e.z=l,e.w=u},makeFrustumMatrix:function(t){t.zero();var e=this.orthoBounds;if(null!=e){var i=1/(e.xMax-e.xMin),n=1/(e.yMax-e.yMin),s=1/(e.zMax-e.zMin);t._11=2*i,t._22=2*n,t._33=s,t._41=-(e.xMin+e.xMax)*i,t._42=-(e.yMin+e.yMax)*n,t._43=-e.zMin*s,t._44=1}else{var r=Math.PI/180,a=Math.atan(Math.tan(.5*this.fovY*r)*this.screenRatio),A=this.zoom/Math.tan(a);t._11=A,t._22=A*this.screenRatio,t._33=this.zFar/(this.zFar-this.zNear),t._34=1,t._43=-this.zNear*this.zFar/(this.zFar-this.zNear)}t._11+=this.viewX*t._14,t._21+=this.viewX*t._24,t._31+=this.viewX*t._34,t._41+=this.viewX*t._44,t._12+=this.viewY*t._14,t._22+=this.viewY*t._24,t._32+=this.viewY*t._34,t._42+=this.viewY*t._44,this.rightHanded&&(t._33*=-1,t._34*=-1)},project:function(t,e,i,n,s,r){null==r&&(r=!0);var a=new Yt(t,e,i),A=this.m,h=a.x*A._11+a.y*A._21+a.z*A._31+a.w*A._41,o=a.x*A._12+a.y*A._22+a.z*A._32+a.w*A._42,l=a.x*A._13+a.y*A._23+a.z*A._33+a.w*A._43,u=1/(a.x*A._14+a.y*A._24+a.z*A._34+a.w*A._44);return a.x=h*u,a.y=o*u,a.z=l*u,a.w=1,a.x=.5*(a.x+1)*n,a.y=.5*(1-a.y)*s,r&&(a.x=Math.round(a.x),a.y=Math.round(a.y)),a},load:function(t){var e=this.pos,i=t.pos;e.x=i.x,e.y=i.y,e.z=i.z,e.w=i.w;e=this.target,i=t.target;e.x=i.x,e.y=i.y,e.z=i.z,e.w=i.w;e=this.up,i=t.up;e.x=i.x,e.y=i.y,e.z=i.z,e.w=i.w,null!=t.orthoBounds?(this.orthoBounds=new se,this.orthoBounds.load(t.orthoBounds)):this.orthoBounds=null,this.fovY=t.fovY,this.screenRatio=t.screenRatio,this.zoom=t.zoom,this.zNear=t.zNear,this.zFar=t.zFar,null!=t.follow?this.follow={pos:t.follow.pos,target:t.follow.target}:this.follow=null,this.viewX=t.viewX,this.viewY=t.viewY,this.update()},__class__:Vt};var Qt=function(t,e,i,n){this.t=t,this.next=e,this.layer=i,this.mipLevel=n};i["h3d._Engine.TargetTmp"]=Qt,Qt.__name__="h3d._Engine.TargetTmp",Qt.prototype={__class__:Qt};var Ut=function(){this.resCache=new qn,this.ready=!1,this.inRender=!1,this.textureColorCache=new Wn,this.tmpVector=new Yt,this.backgroundColor=-16777216,this.hardware=!Ut.SOFTWARE_DRIVER,this.antiAlias=Ut.ANTIALIASING,this.autoResize=!0,this.set_fullScreen(!Os.getValue(Vs.IsWindowed)),this.window=Us.getInstance(),this.realFps=Os.getDefaultFrameRate(),this.lastTime=l.now()/1e3,this.window.addResizeEvent(XA(this,this.onWindowResize)),this.driver=new Ce(this.antiAlias),Ut.CURRENT=this};i["h3d.Engine"]=Ut,Ut.__name__="h3d.Engine",Ut.getCurrent=function(){return Ut.CURRENT},Ut.prototype={setDriver:function(t){this.driver=t,null!=this.mem&&(this.mem.driver=t)},setCurrent:function(){Ut.CURRENT=this},init:function(){this.driver.init(XA(this,this.onCreate),!this.hardware)},driverName:function(t){return null==t&&(t=!1),this.driver.getDriverName(t)},selectShader:function(t){this.needFlushTarget&&this.doFlushTarget(),this.driver.selectShader(t)&&this.shaderSwitches++},selectMaterial:function(t){this.driver.selectMaterial(t)},uploadShaderBuffers:function(t,e){this.driver.uploadShaderBuffers(t,e)},selectBuffer:function(t){return null!=t.buffer&&null!=t.buffer.vbuf&&(this.needFlushTarget&&this.doFlushTarget(),this.driver.selectBuffer(t),!0)},renderTriBuffer:function(t,e,i){null==i&&(i=-1),null==e&&(e=0),this.renderBuffer(t,this.mem.triIndexes,3,e,i)},renderQuadBuffer:function(t,e,i){null==i&&(i=-1),null==e&&(e=0),this.renderBuffer(t,this.mem.quadIndexes,2,e,i)},renderBuffer:function(t,e,i,n,s){if(null==s&&(s=-1),null==n&&(n=0),!e.isDisposed())for(;;){var r=t.vertices/i|0,a=t.position/i|0;if(n>0){if(n>=r){if(n-=r,null==(t=t.next))break;continue}a+=n,r-=n,n=0}if(s>=0){if(0==s)return;(s-=r)<0&&(r+=s,s=0)}if(r>0&&this.selectBuffer(t)&&(this.driver.draw(e.ibuf,3*a,r),this.drawTriangles+=r,this.drawCalls++),null==(t=t.next))break}},renderIndexed:function(t,e,i,n){if(null==n&&(n=-1),null==i&&(i=0),null!=t.next)throw kn.thrown("Buffer is split");if(!e.isDisposed()){var s=e.count/3|0;n<0&&(n=s-i),n>0&&this.selectBuffer(t)&&(this.driver.draw(e.ibuf,3*i,n),this.drawTriangles+=n,this.drawCalls++)}},renderMultiBuffers:function(t,e,i,n){null==n&&(n=-1),null==i&&(i=0);var s=e.count/3|0;s<=0||(this.needFlushTarget&&this.doFlushTarget(),this.driver.selectMultiBuffers(t),e.isDisposed()||(n<0&&(n=s-i),n>0&&(this.driver.draw(e.ibuf,3*i,n),this.drawTriangles+=n,this.drawCalls++)))},renderInstanced:function(t,e,i){this.needFlushTarget&&this.doFlushTarget(),this.driver.selectMultiBuffers(t),e.isDisposed()||i.commandCount>0&&(this.driver.drawInstanced(e.ibuf,i),this.drawTriangles+=i.triCount,this.drawCalls++)},set_debug:function(t){return this.debug=t,this.driver.setDebug(this.debug),t},onCreate:function(t){Ut.CURRENT=this,this.autoResize&&(this.width=this.window.get_width(),this.height=this.window.get_height()),t?(Yr.get().onContextLost(),this.mem.onContextLost()):(this.mem=new Ee(this.driver),this.mem.init(),this.nullTexture=new ti(0,0,[Ye.NoAlloc])),this.hardware=this.driver.hasFeature(ge.HardwareAccelerated),this.set_debug(this.debug),this.set_fullScreen(this.fullScreen),this.resize(this.width,this.height),t?this.onContextLost():this.onReady(),this.ready=!0},onContextLost:function(){},onReady:function(){},onWindowResize:function(){if(this.autoResize&&!this.driver.isDisposed()){var t=this.window.get_width(),e=this.window.get_height();t==this.width&&e==this.height||this.resize(t,e),this.onResized()}},set_fullScreen:function(t){return this.fullScreen=t,null!=this.mem&&Os.getValue(Vs.IsWindowed)&&this.window.set_displayMode(t?Gs.Borderless:Gs.Windowed),t},onResized:function(){},resize:function(t,e){t<32&&(t=32),e<32&&(e=32),this.width=t,this.height=e,this.driver.isDisposed()||this.driver.resize(t,e)},begin:function(){return!this.driver.isDisposed()&&(this.inRender=!0,this.drawTriangles=0,this.shaderSwitches=0,this.drawCalls=0,this.targetStack=null,this.needFlushTarget=null!=this.currentTargetTex,this.driver.begin(Qs.frameCount),null!=this.backgroundColor&&this.clear(this.backgroundColor,1,0),!0)},hasFeature:function(t){return this.driver.hasFeature(t)},end:function(){this.inRender=!1,this.driver.end()},getCurrentTarget:function(){return null==this.targetStack?null:this.targetStack.t==this.nullTexture?this.targetStack.textures[0]:this.targetStack.t},pushTarget:function(t,e,i){null==i&&(i=0),null==e&&(e=0);var n=this.targetTmp;null==n?n=new Qt(t,this.targetStack,e,i):(this.targetTmp=n.next,n.t=t,n.next=this.targetStack,n.mipLevel=i,n.layer=e),this.targetStack=n,this.updateNeedFlush()},updateNeedFlush:function(){var t=this.targetStack;this.needFlushTarget=null==t?null!=this.currentTargetTex:this.currentTargetTex!=t.t||this.currentTargetLayer!=t.layer||this.currentTargetMip!=t.mipLevel||null!=t.textures},pushTargets:function(t){this.pushTarget(this.nullTexture),this.targetStack.textures=t,this.needFlushTarget=!0},popTarget:function(){var t=this.targetStack;if(null==t)throw kn.thrown("popTarget() with no matching pushTarget()");this.targetStack=t.next,this.updateNeedFlush(),t.t=null,t.textures=null,t.next=this.targetTmp,this.targetTmp=t},flushTarget:function(){this.needFlushTarget&&this.doFlushTarget()},doFlushTarget:function(){var t=this.targetStack;null==t?(this.driver.setRenderTarget(null),this.currentTargetTex=null):(null!=t.textures?this.driver.setRenderTargets(t.textures):this.driver.setRenderTarget(t.t,t.layer,t.mipLevel),this.currentTargetTex=t.t,this.currentTargetLayer=t.layer,this.currentTargetMip=t.mipLevel),this.needFlushTarget=!1},clearF:function(t,e,i){this.needFlushTarget&&this.doFlushTarget(),this.driver.clear(t,e,i)},clear:function(t,e,i){if(null!=t){var n=this.tmpVector;n.x=(t>>16&255)/255,n.y=(t>>8&255)/255,n.z=(255&t)/255,n.w=(t>>>24)/255}this.needFlushTarget&&this.doFlushTarget(),this.driver.clear(null==t?null:this.tmpVector,e,i)},setRenderZone:function(t,e,i,n){null==n&&(n=-1),null==i&&(i=-1),null==e&&(e=0),null==t&&(t=0),this.needFlushTarget&&this.doFlushTarget(),this.driver.setRenderZone(t,e,i,n)},render:function(t){if(!this.begin())return!1;t.render(this),this.end();var e=l.now()/1e3-this.lastTime;if(this.lastTime+=e,e>0){var i=1/e;i>2*this.realFps?i=2*this.realFps:i<.5*this.realFps&&(i=.5*this.realFps);var n=e/.5;n>.3&&(n=.3),this.realFps=this.realFps*(1-n)+i*n}return!0},dispose:function(){this.driver.dispose(),this.window.removeResizeEvent(XA(this,this.onWindowResize))},get_fps:function(){return Math.ceil(100*this.realFps)/100},__class__:Ut};var Ot=function(t,e){null==e&&(e=!1),this.mem=Ut.CURRENT.mem,this.count=t,this.is32=e,this.mem.allocIndexes(this)};i["h3d.Indexes"]=Ot,Ot.__name__="h3d.Indexes",Ot.alloc=function(t,e,i){null==i&&(i=-1),null==e&&(e=0),i<0&&(i=t.length);var n=new Ot(i);return n.upload(t,0,i),n},Ot.prototype={isDisposed:function(){return null==this.ibuf},upload:function(t,e,i,n){null==n&&(n=0),this.mem.driver.uploadIndexBuffer(this.ibuf,e,i,t,n)},uploadBytes:function(t,e,i){this.mem.driver.uploadIndexBytes(this.ibuf,0,i,t,e)},readBytes:function(t,e,i,n){null==n&&(n=0),this.mem.driver.readIndexBytes(this.ibuf,n,i,t,e)},dispose:function(){null!=this.ibuf&&this.mem.deleteIndexes(this)},__class__:Ot};var Gt=function(){};i["h3d.Matrix"]=Gt,Gt.__name__="h3d.Matrix",Gt.I=function(){var t=new Gt;return t.identity(),t},Gt.L=function(t){var e=new Gt;return e.loadValues(t),e},Gt.T=function(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0);var n=new Gt;return n.initTranslation(t,e,i),n},Gt.R=function(t,e,i){var n=new Gt;return n.initRotation(t,e,i),n},Gt.S=function(t,e,i){null==i&&(i=1),null==e&&(e=1),null==t&&(t=1);var n=new Gt;return n.initScale(t,e,i),n},Gt.lookAtX=function(t,e,i){null==e&&(e=new Yt(0,0,1)),null==i&&(i=new Gt),h=(h=t.x*t.x+t.y*t.y+t.z*t.z)<1e-10?0:1/Math.sqrt(h);var n=t.x*h,s=t.y*h;null==(u=t.z*h)&&(u=0),null==s&&(s=0),null==n&&(n=0);var r=n,a=s,A=u;n=e.y*A-e.z*a,s=e.z*r-e.x*A;null==(u=e.x*a-e.y*r)&&(u=0),null==s&&(s=0),null==n&&(n=0);var h,o=n,l=s;null==(u=u*(h=(h=o*o+l*l+u*u)<1e-10?0:1/Math.sqrt(h)))&&(u=0),null==(s=l*h)&&(s=0),null==(n=o*h)&&(n=0);var u,_=n,c=s,d=u;_*_+c*c+d*d<1e-10&&(_=a,c=A,d=r),null==(u=r*c-a*_)&&(u=0),null==(s=A*_-r*d)&&(s=0),null==(n=a*d-A*c)&&(n=0);var f=n,x=s,p=u;return i._11=r,i._12=a,i._13=A,i._14=0,i._21=_,i._22=c,i._23=d,i._24=0,i._31=f,i._32=x,i._33=p,i._34=0,i._41=0,i._42=0,i._43=0,i._44=1,i},Gt.prototype={get_tx:function(){return this._41},get_ty:function(){return this._42},get_tz:function(){return this._43},set_tx:function(t){return this._41=t},set_ty:function(t){return this._42=t},set_tz:function(t){return this._43=t},equal:function(t){return this._11==t._11&&this._12==t._12&&this._13==t._13&&this._14==t._14&&this._21==t._21&&this._22==t._22&&this._23==t._23&&this._24==t._24&&this._31==t._31&&this._32==t._32&&this._33==t._33&&this._34==t._34&&this._41==t._41&&this._42==t._42&&this._43==t._43&&this._44==t._44},zero:function(){this._11=0,this._12=0,this._13=0,this._14=0,this._21=0,this._22=0,this._23=0,this._24=0,this._31=0,this._32=0,this._33=0,this._34=0,this._41=0,this._42=0,this._43=0,this._44=0},identity:function(){this._11=1,this._12=0,this._13=0,this._14=0,this._21=0,this._22=1,this._23=0,this._24=0,this._31=0,this._32=0,this._33=1,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},isIdentity:function(){return 0==this._41&&0==this._42&&0==this._43&&(1==this._11&&1==this._22&&1==this._33&&(0==this._12&&0==this._13&&0==this._14&&(0==this._21&&0==this._23&&0==this._24&&(0==this._31&&0==this._32&&0==this._34&&1==this._44))))},isIdentityEpsilon:function(t){var e,i,n;((n=this._41)<0?-n:n)>t?i=!0:i=((n=this._42)<0?-n:n)>t;i?e=!0:e=((n=this._43)<0?-n:n)>t;if(e)return!1;((n=this._11-1)<0?-n:n)>t?i=!0:i=((n=this._22-1)<0?-n:n)>t;i?e=!0:e=((n=this._33-1)<0?-n:n)>t;if(e)return!1;((n=this._12)<0?-n:n)>t?i=!0:i=((n=this._13)<0?-n:n)>t;i?e=!0:e=((n=this._14)<0?-n:n)>t;if(e)return!1;((n=this._21)<0?-n:n)>t?i=!0:i=((n=this._23)<0?-n:n)>t;i?e=!0:e=((n=this._24)<0?-n:n)>t;if(e)return!1;((n=this._31)<0?-n:n)>t?i=!0:i=((n=this._32)<0?-n:n)>t;i?e=!0:e=((n=this._34)<0?-n:n)>t;return!e&&((n=this._44-1)<0?-n:n)<=t},initRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);this._11=1,this._12=0,this._13=0,this._14=0,this._21=0,this._22=e,this._23=i,this._24=0,this._31=0,this._32=-i,this._33=e,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},initRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);this._11=e,this._12=0,this._13=-i,this._14=0,this._21=0,this._22=1,this._23=0,this._24=0,this._31=i,this._32=0,this._33=e,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},initRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);this._11=e,this._12=i,this._13=0,this._14=0,this._21=-i,this._22=e,this._23=0,this._24=0,this._31=0,this._32=0,this._33=1,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},initTranslation:function(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this._11=1,this._12=0,this._13=0,this._14=0,this._21=0,this._22=1,this._23=0,this._24=0,this._31=0,this._32=0,this._33=1,this._34=0,this._41=t,this._42=e,this._43=i,this._44=1},initScale:function(t,e,i){null==i&&(i=1),null==e&&(e=1),null==t&&(t=1),this._11=t,this._12=0,this._13=0,this._14=0,this._21=0,this._22=e,this._23=0,this._24=0,this._31=0,this._32=0,this._33=i,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},initRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),s=1-i,r=-t.x,a=-t.y,A=-t.z,h=r*r,o=a*a,l=A*A,u=1/Math.sqrt(h+o+l);a*=u;var _=(r*=u)*s,c=(A*=u)*s;this._11=i+r*_,this._12=a*_-A*n,this._13=r*c+a*n,this._14=0,this._21=a*_+A*n,this._22=i+a*a*s,this._23=a*c-r*n,this._24=0,this._31=r*c-a*n,this._32=a*c+r*n,this._33=i+A*c,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},initRotation:function(t,e,i){var n=Math.cos(t),s=Math.sin(t),r=Math.cos(e),a=Math.sin(e),A=Math.cos(i),h=Math.sin(i),o=n*a,l=s*a;this._11=r*A,this._12=r*h,this._13=-a,this._14=0,this._21=l*A-n*h,this._22=l*h+n*A,this._23=s*r,this._24=0,this._31=o*A+s*h,this._32=o*h-s*A,this._33=n*r,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},translate:function(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this._11+=t*this._14,this._12+=e*this._14,this._13+=i*this._14,this._21+=t*this._24,this._22+=e*this._24,this._23+=i*this._24,this._31+=t*this._34,this._32+=e*this._34,this._33+=i*this._34,this._41+=t*this._44,this._42+=e*this._44,this._43+=i*this._44},scale:function(t,e,i){null==i&&(i=1),null==e&&(e=1),null==t&&(t=1),this._11*=t,this._21*=t,this._31*=t,this._41*=t,this._12*=e,this._22*=e,this._32*=e,this._42*=e,this._13*=i,this._23*=i,this._33*=i,this._43*=i},rotate:function(t,e,i){var n=Gt.tmp;n.initRotation(t,e,i),this.multiply(this,n)},rotateAxis:function(t,e){var i=Gt.tmp;i.initRotationAxis(t,e),this.multiply(this,i)},getPosition:function(t){null==t&&(t=new Yt);var e=this._41,i=this._42,n=this._43,s=this._44;return null==s&&(s=1),null==n&&(n=0),null==i&&(i=0),null==e&&(e=0),t.x=e,t.y=i,t.z=n,t.w=s,t},setPosition:function(t){this._41=t.x,this._42=t.y,this._43=t.z,this._44=t.w},prependTranslation:function(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0);var n=this._11*t+this._21*e+this._31*i+this._41,s=this._12*t+this._22*e+this._32*i+this._42,r=this._13*t+this._23*e+this._33*i+this._43,a=this._14*t+this._24*e+this._34*i+this._44;this._41=n,this._42=s,this._43=r,this._44=a},getScale:function(t){return null==t&&(t=new Yt),t.x=Math.sqrt(this._11*this._11+this._12*this._12+this._13*this._13),t.y=Math.sqrt(this._21*this._21+this._22*this._22+this._23*this._23),t.z=Math.sqrt(this._31*this._31+this._32*this._32+this._33*this._33),this._11*(this._22*this._33-this._23*this._32)+this._12*(this._23*this._31-this._21*this._33)+this._13*(this._21*this._32-this._22*this._31)<0&&(t.x*=-1,t.y*=-1,t.z*=-1),t},prependRotation:function(t,e,i){var n=Gt.tmp;n.initRotation(t,e,i),this.multiply(n,this)},prependRotationAxis:function(t,e){var i=Gt.tmp;i.initRotationAxis(t,e),this.multiply(i,this)},prependScale:function(t,e,i){null==i&&(i=1),null==e&&(e=1),null==t&&(t=1);var n=Gt.tmp;n.initScale(t,e,i),this.multiply(n,this)},multiply3x4:function(t,e){var i=t._11,n=t._12,s=t._13,r=t._21,a=t._22,A=t._23,h=t._31,o=t._32,l=t._33,u=t._41,_=t._42,c=t._43,d=e._11,f=e._12,x=e._13,p=e._21,g=e._22,m=e._23,v=e._31,y=e._32,b=e._33,w=e._41,M=e._42,B=e._43;this._11=i*d+n*p+s*v,this._12=i*f+n*g+s*y,this._13=i*x+n*m+s*b,this._14=0,this._21=r*d+a*p+A*v,this._22=r*f+a*g+A*y,this._23=r*x+a*m+A*b,this._24=0,this._31=h*d+o*p+l*v,this._32=h*f+o*g+l*y,this._33=h*x+o*m+l*b,this._34=0,this._41=u*d+_*p+c*v+w,this._42=u*f+_*g+c*y+M,this._43=u*x+_*m+c*b+B,this._44=1},multiply3x4inline:function(t,e){var i=t._11,n=t._12,s=t._13,r=t._21,a=t._22,A=t._23,h=t._31,o=t._32,l=t._33,u=t._41,_=t._42,c=t._43,d=e._11,f=e._12,x=e._13,p=e._21,g=e._22,m=e._23,v=e._31,y=e._32,b=e._33,w=e._41,M=e._42,B=e._43;this._11=i*d+n*p+s*v,this._12=i*f+n*g+s*y,this._13=i*x+n*m+s*b,this._14=0,this._21=r*d+a*p+A*v,this._22=r*f+a*g+A*y,this._23=r*x+a*m+A*b,this._24=0,this._31=h*d+o*p+l*v,this._32=h*f+o*g+l*y,this._33=h*x+o*m+l*b,this._34=0,this._41=u*d+_*p+c*v+w,this._42=u*f+_*g+c*y+M,this._43=u*x+_*m+c*b+B,this._44=1},multiply:function(t,e){var i=t._11,n=t._12,s=t._13,r=t._14,a=t._21,A=t._22,h=t._23,o=t._24,l=t._31,u=t._32,_=t._33,c=t._34,d=t._41,f=t._42,x=t._43,p=t._44,g=e._11,m=e._12,v=e._13,y=e._14,b=e._21,w=e._22,M=e._23,B=e._24,C=e._31,S=e._32,I=e._33,k=e._34,E=e._41,F=e._42,T=e._43,D=e._44;this._11=i*g+n*b+s*C+r*E,this._12=i*m+n*w+s*S+r*F,this._13=i*v+n*M+s*I+r*T,this._14=i*y+n*B+s*k+r*D,this._21=a*g+A*b+h*C+o*E,this._22=a*m+A*w+h*S+o*F,this._23=a*v+A*M+h*I+o*T,this._24=a*y+A*B+h*k+o*D,this._31=l*g+u*b+_*C+c*E,this._32=l*m+u*w+_*S+c*F,this._33=l*v+u*M+_*I+c*T,this._34=l*y+u*B+_*k+c*D,this._41=d*g+f*b+x*C+p*E,this._42=d*m+f*w+x*S+p*F,this._43=d*v+f*M+x*I+p*T,this._44=d*y+f*B+x*k+p*D},multiplyValue:function(t){this._11*=t,this._12*=t,this._13*=t,this._14*=t,this._21*=t,this._22*=t,this._23*=t,this._24*=t,this._31*=t,this._32*=t,this._33*=t,this._34*=t,this._41*=t,this._42*=t,this._43*=t,this._44*=t},invert:function(){this.initInverse(this)},getInverse:function(t){return null==t&&(t=new Gt),t.initInverse(this),t},getDeterminant:function(){return this._11*(this._22*this._33-this._23*this._32)+this._12*(this._23*this._31-this._21*this._33)+this._13*(this._21*this._32-this._22*this._31)},inverse3x4:function(t){var e=t._11,i=t._12,n=t._13,s=t._21,r=t._22,a=t._23,A=t._31,h=t._32,o=t._33,l=t._41,u=t._42,_=t._43;this._11=r*o-a*h,this._12=n*h-i*o,this._13=i*a-n*r,this._14=0,this._21=a*A-s*o,this._22=e*o-n*A,this._23=n*s-e*a,this._24=0,this._31=s*h-r*A,this._32=i*A-e*h,this._33=e*r-i*s,this._34=0,this._41=-s*h*_+s*o*u+A*r*_-A*a*u-l*r*o+l*a*h,this._42=e*h*_-e*o*u-A*i*_+A*n*u+l*i*o-l*n*h,this._43=-e*r*_+e*a*u+s*i*_-s*n*u-l*i*a+l*n*r,this._44=e*r*o-e*a*h-s*i*o+s*n*h+A*i*a-A*n*r,this._44=1;var c=e*this._11+i*this._21+n*this._31;if((c<0?-c:c)<1e-10)this.zero();else{var d=1/c;this._11*=d,this._12*=d,this._13*=d,this._21*=d,this._22*=d,this._23*=d,this._31*=d,this._32*=d,this._33*=d,this._41*=d,this._42*=d,this._43*=d}},initInverse:function(t){var e=t._11,i=t._12,n=t._13,s=t._14,r=t._21,a=t._22,A=t._23,h=t._24,o=t._31,l=t._32,u=t._33,_=t._34,c=t._41,d=t._42,f=t._43,x=t._44;this._11=a*u*x-a*_*f-l*A*x+l*h*f+d*A*_-d*h*u,this._12=-i*u*x+i*_*f+l*n*x-l*s*f-d*n*_+d*s*u,this._13=i*A*x-i*h*f-a*n*x+a*s*f+d*n*h-d*s*A,this._14=-i*A*_+i*h*u+a*n*_-a*s*u-l*n*h+l*s*A,this._21=-r*u*x+r*_*f+o*A*x-o*h*f-c*A*_+c*h*u,this._22=e*u*x-e*_*f-o*n*x+o*s*f+c*n*_-c*s*u,this._23=-e*A*x+e*h*f+r*n*x-r*s*f-c*n*h+c*s*A,this._24=e*A*_-e*h*u-r*n*_+r*s*u+o*n*h-o*s*A,this._31=r*l*x-r*_*d-o*a*x+o*h*d+c*a*_-c*h*l,this._32=-e*l*x+e*_*d+o*i*x-o*s*d-c*i*_+c*s*l,this._33=e*a*x-e*h*d-r*i*x+r*s*d+c*i*h-c*s*a,this._34=-e*a*_+e*h*l+r*i*_-r*s*l-o*i*h+o*s*a,this._41=-r*l*f+r*u*d+o*a*f-o*A*d-c*a*u+c*A*l,this._42=e*l*f-e*u*d-o*i*f+o*n*d+c*i*u-c*n*l,this._43=-e*a*f+e*A*d+r*i*f-r*n*d-c*i*A+c*n*a,this._44=e*a*u-e*A*l-r*i*u+r*n*l+o*i*A-o*n*a;var p=e*this._11+i*this._21+n*this._31+s*this._41;(p<0?-p:p)<1e-10?this.zero():(p=1/p,this._11*=p,this._12*=p,this._13*=p,this._14*=p,this._21*=p,this._22*=p,this._23*=p,this._24*=p,this._31*=p,this._32*=p,this._33*=p,this._34*=p,this._41*=p,this._42*=p,this._43*=p,this._44*=p)},initInverse3x3:function(t){var e=t._11,i=t._12,n=t._13,s=t._21,r=t._22,a=t._23,A=t._31,h=t._32,o=t._33;this._11=r*o-h*a,this._12=-i*o+h*n,this._13=i*a-r*n,this._21=-s*o+A*a,this._22=e*o-A*n,this._23=-e*a+s*n,this._31=s*h-A*r,this._32=-e*h+A*i,this._33=e*r-s*i;var l=e*this._11+i*this._21+n*this._31;(l<0?-l:l)<1e-10?this.zero():(l=1/l,this._11*=l,this._12*=l,this._13*=l,this._14=0,this._21*=l,this._22*=l,this._23*=l,this._24=0,this._31*=l,this._32*=l,this._33*=l,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1)},front:function(){var t=new Yt(this._11,this._12,this._13),e=t.x*t.x+t.y*t.y+t.z*t.z;return e=e<1e-10?0:1/Math.sqrt(e),t.x*=e,t.y*=e,t.z*=e,t},right:function(){var t=new Yt(this._21,this._22,this._23),e=t.x*t.x+t.y*t.y+t.z*t.z;return e=e<1e-10?0:1/Math.sqrt(e),t.x*=e,t.y*=e,t.z*=e,t},up:function(){var t=new Yt(this._31,this._32,this._33),e=t.x*t.x+t.y*t.y+t.z*t.z;return e=e<1e-10?0:1/Math.sqrt(e),t.x*=e,t.y*=e,t.z*=e,t},transpose:function(){var t=this._12;this._12=this._21,this._21=t,t=this._13,this._13=this._31,this._31=t,t=this._14,this._14=this._41,this._41=t,t=this._23,this._23=this._32,this._32=t,t=this._24,this._24=this._42,this._42=t,t=this._34,this._34=this._43,this._43=t},clone:function(){var t=new Gt;return t._11=this._11,t._12=this._12,t._13=this._13,t._14=this._14,t._21=this._21,t._22=this._22,t._23=this._23,t._24=this._24,t._31=this._31,t._32=this._32,t._33=this._33,t._34=this._34,t._41=this._41,t._42=this._42,t._43=this._43,t._44=this._44,t},load:function(t){this._11=t._11,this._12=t._12,this._13=t._13,this._14=t._14,this._21=t._21,this._22=t._22,this._23=t._23,this._24=t._24,this._31=t._31,this._32=t._32,this._33=t._33,this._34=t._34,this._41=t._41,this._42=t._42,this._43=t._43,this._44=t._44},loadValues:function(t){this._11=t[0],this._12=t[1],this._13=t[2],this._14=t[3],this._21=t[4],this._22=t[5],this._23=t[6],this._24=t[7],this._31=t[8],this._32=t[9],this._33=t[10],this._34=t[11],this._41=t[12],this._42=t[13],this._43=t[14],this._44=t[15]},getFloats:function(){return[this._11,this._12,this._13,this._14,this._21,this._22,this._23,this._24,this._31,this._32,this._33,this._34,this._41,this._42,this._43,this._44]},getDirection:function(){var t=new Nt;return t.initRotateMatrix(this),t.normalize(),new Yt(1-2*(t.y*t.y+t.z*t.z),2*(t.x*t.y+t.z*t.w),2*(t.x*t.z-t.y*t.w))},getEulerAngles:function(){var t=this.clone(),e=null;null==e&&(e=new Yt),e.x=Math.sqrt(this._11*this._11+this._12*this._12+this._13*this._13),e.y=Math.sqrt(this._21*this._21+this._22*this._22+this._23*this._23),e.z=Math.sqrt(this._31*this._31+this._32*this._32+this._33*this._33),this._11*(this._22*this._33-this._23*this._32)+this._12*(this._23*this._31-this._21*this._33)+this._13*(this._21*this._32-this._22*this._31)<0&&(e.x*=-1,e.y*=-1,e.z*=-1);var i=e;t.prependScale(1/i.x,1/i.y,1/i.z);var n=Math.sqrt(t._11*t._11+t._12*t._12);if(n>.01){var s=new Yt(Math.atan2(t._23,t._33),Math.atan2(-t._13,n),Math.atan2(t._12,t._11)),r=new Yt(Math.atan2(-t._23,-t._33),Math.atan2(-t._13,-n),Math.atan2(-t._12,-t._11));return s.x*s.x+s.y*s.y+s.z*s.z<r.x*r.x+r.y*r.y+r.z*r.z?s:r}return new Yt(Math.atan2(-t._32,t._22),Math.atan2(-t._13,n),0)},toString:function(){return"MAT=[\n  [ "+Es.fmt(this._11)+", "+Es.fmt(this._12)+", "+Es.fmt(this._13)+", "+Es.fmt(this._14)+" ]\n  [ "+Es.fmt(this._21)+", "+Es.fmt(this._22)+", "+Es.fmt(this._23)+", "+Es.fmt(this._24)+" ]\n  [ "+Es.fmt(this._31)+", "+Es.fmt(this._32)+", "+Es.fmt(this._33)+", "+Es.fmt(this._34)+" ]\n  [ "+Es.fmt(this._41)+", "+Es.fmt(this._42)+", "+Es.fmt(this._43)+", "+Es.fmt(this._44)+" ]\n]"},colorHue:function(t){if(0!=t){var e=Math.cos(-t),i=Math.sin(-t),n=(1-e)/3,s=Gt.tmp;s._11=e+n,s._12=n-.5773502691896257*i,s._13=n+.5773502691896257*i,s._21=n+.5773502691896257*i,s._22=e+n,s._23=n-.5773502691896257*i,s._31=n-.5773502691896257*i,s._32=n+.5773502691896257*i,s._33=e+n,s._34=0,s._41=0,s._42=0,s._43=0,this.multiply3x4(this,s)}},colorSaturate:function(t){var e=1-++t,i=.212671*e,n=.71516*e,s=.072169*e,r=Gt.tmp;r._11=i+t,r._12=i,r._13=i,r._21=n,r._22=n+t,r._23=n,r._31=s,r._32=s,r._33=s+t,r._41=0,r._42=0,r._43=0,this.multiply3x4(this,r)},colorContrast:function(t){var e=Gt.tmp,i=t+1;e._11=i,e._12=0,e._13=0,e._21=0,e._22=i,e._23=0,e._31=0,e._32=0,e._33=i,e._41=.5*-t,e._42=.5*-t,e._43=.5*-t,this.multiply3x4(this,e)},colorLightness:function(t){this._41+=t,this._42+=t,this._43+=t},colorGain:function(t,e){var i=Gt.tmp;i._11=1-e,i._12=0,i._13=0,i._21=0,i._22=1-e,i._23=0,i._31=0,i._32=0,i._33=1-e,i._41=(t>>16&255)/255*e,i._42=(t>>8&255)/255*e,i._43=(255&t)/255*e,this.multiply3x4(this,i)},colorBits:function(t,e){var i=0,n=0,s=0,r=0,a=0,A=0,h=0,o=0,l=0,u=t;1==(1&u)&&(i=1),1==(1&(u>>=1))&&(n=1),1==(1&(u>>=1))&&(s=1),1==(1&(u>>=1))&&(r=1),1==(1&(u>>=1))&&(a=1),1==(1&(u>>=1))&&(A=1),1==(1&(u>>=1))&&(h=1),1==(1&(u>>=1))&&(o=1),1==(1&(u>>=1))&&(l=1),u>>=1;var _=i+r+h,c=n+a+o,d=s+A+l;_>1&&(i/=_,r/=_,h/=_),c>1&&(n/=c,a/=c,o/=c),d>1&&(s/=d,A/=d,l/=d);var f=this._11*i+this._12*r+this._13*h,x=this._11*n+this._12*a+this._13*o,p=this._11*s+this._12*A+this._13*l,g=this._21*i+this._22*r+this._23*h,m=this._21*n+this._22*a+this._23*o,v=this._21*s+this._22*A+this._23*l,y=this._31*i+this._32*r+this._33*h,b=this._31*n+this._32*a+this._33*o,w=this._31*s+this._32*A+this._33*l,M=e,B=1-M;this._11=this._11*B+f*M,this._12=this._12*B+x*M,this._13=this._13*B+p*M,this._21=this._21*B+g*M,this._22=this._22*B+m*M,this._23=this._23*B+v*M,this._31=this._31*B+y*M,this._32=this._32*B+b*M,this._33=this._33*B+w*M},colorAdd:function(t){this._41+=(t>>16&255)/255,this._42+=(t>>8&255)/255,this._43+=(255&t)/255},colorSet:function(t,e){null==e&&(e=1),this.zero(),this._44=e,this._41+=(t>>16&255)/255,this._42+=(t>>8&255)/255,this._43+=(255&t)/255},adjustColor:function(t){null!=t.hue&&this.colorHue(t.hue),null!=t.saturation&&this.colorSaturate(t.saturation),null!=t.contrast&&this.colorContrast(t.contrast),null!=t.lightness&&this.colorLightness(t.lightness),null!=t.gain&&this.colorGain(t.gain.color,t.gain.alpha)},toMatrix2D:function(t){return null==t&&(t=new Bt),t.a=this._11,t.b=this._12,t.c=this._21,t.d=this._22,t.x=this._41,t.y=this._42,t},__class__:Gt};var Nt=function(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n};i["h3d.Quat"]=Nt,Nt.__name__="h3d.Quat",Nt.prototype={set:function(t,e,i,n){this.x=t,this.y=e,this.z=i,this.w=n},identity:function(){this.x=this.y=this.z=0,this.w=1},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},load:function(t){this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w},clone:function(){return new Nt(this.x,this.y,this.z,this.w)},initMoveTo:function(t,e){var i=t.x+e.x,n=t.y+e.y,s=t.z+e.z;Math.sqrt(i*i+n*n+s*s);this.x=t.y*s-t.z*n,this.y=t.z*i-t.x*s,this.z=t.x*n-t.y*i,this.w=t.x*i+t.y*n+t.z*s,this.normalize()},initDirection:function(t){var e=t.x,i=t.y,n=t.z;t.w,null==n&&(n=0),null==i&&(i=0),null==e&&(e=0);null==(n=(o=n)*(l=(l=(A=e)*A+(h=i)*h+o*o)<1e-10?0:1/Math.sqrt(l)))&&(n=0),null==(i=h*l)&&(i=0),null==(e=A*l)&&(e=0);var s=e,r=i,a=n;null==(n=0)&&(n=0),null==(i=s)&&(i=0),null==(e=-r)&&(e=0);var A,h,o,l;null==(n=(o=n)*(l=(l=(A=e)*A+(h=i)*h+o*o)<1e-10?0:1/Math.sqrt(l)))&&(n=0),null==(i=h*l)&&(i=0),null==(e=A*l)&&(e=0);var u=e,_=i,c=n;u*u+_*_+c*c<1e-10&&(u=r,_=a,c=s),null==(n=s*_-r*u)&&(n=0),null==(i=a*u-s*c)&&(i=0),null==(e=r*c-a*_)&&(e=0);var d=e,f=i,x=n,p=s+_+x;if(p>0){var g=1/(m=2*Math.sqrt(p+1));this.x=(c-f)*g,this.y=(d-a)*g,this.z=(r-u)*g,this.w=.25*m}else if(s>_&&s>x){g=1/(m=2*Math.sqrt(1+s-_-x));this.x=.25*m,this.y=(u+r)*g,this.z=(d+a)*g,this.w=(c-f)*g}else if(_>x){g=1/(m=2*Math.sqrt(1+_-s-x));this.x=(u+r)*g,this.y=.25*m,this.z=(f+c)*g,this.w=(d-a)*g}else{var m;g=1/(m=2*Math.sqrt(1+x-s-_));this.x=(d+a)*g,this.y=(f+c)*g,this.z=.25*m,this.w=(r-u)*g}},initRotateAxis:function(t,e,i,n){var s=Math.sin(n/2),r=Math.cos(n/2);this.x=t*s,this.y=e*s,this.z=i*s,this.w=r*Math.sqrt(t*t+e*e+i*i),this.normalize()},initRotateMatrix:function(t){var e=t._11+t._22+t._33;if(e>0){var i=1/(n=2*Math.sqrt(e+1));this.x=(t._23-t._32)*i,this.y=(t._31-t._13)*i,this.z=(t._12-t._21)*i,this.w=.25*n}else if(t._11>t._22&&t._11>t._33){i=1/(n=2*Math.sqrt(1+t._11-t._22-t._33));this.x=.25*n,this.y=(t._21+t._12)*i,this.z=(t._31+t._13)*i,this.w=(t._23-t._32)*i}else if(t._22>t._33){i=1/(n=2*Math.sqrt(1+t._22-t._11-t._33));this.x=(t._21+t._12)*i,this.y=.25*n,this.z=(t._32+t._23)*i,this.w=(t._31-t._13)*i}else{var n;i=1/(n=2*Math.sqrt(1+t._33-t._11-t._22));this.x=(t._31+t._13)*i,this.y=(t._32+t._23)*i,this.z=.25*n,this.w=(t._12-t._21)*i}},normalize:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;if(t<1e-10)this.x=this.y=this.z=0,this.w=1;else{var e=1/Math.sqrt(t);this.x*=e,this.y*=e,this.z*=e,this.w*=e}},initRotation:function(t,e,i){var n=Math.sin(.5*t),s=Math.cos(.5*t),r=Math.sin(.5*e),a=Math.cos(.5*e),A=Math.sin(.5*i),h=Math.cos(.5*i),o=a*h,l=r*A;this.x=n*o-s*l,this.y=s*r*h+n*a*A,this.z=s*a*A-n*r*h,this.w=s*o+n*l},multiply:function(t,e){var i=t.x*e.w+t.w*e.x+t.y*e.z-t.z*e.y,n=t.w*e.y-t.x*e.z+t.y*e.w+t.z*e.x,s=t.w*e.z+t.x*e.y-t.y*e.x+t.z*e.w,r=t.w*e.w-t.x*e.x-t.y*e.y-t.z*e.z;this.x=i,this.y=n,this.z=s,this.w=r},toEuler:function(){return this.toMatrix().getEulerAngles()},lerp:function(t,e,i,n){null==n&&(n=!1);var s=1-i;n&&t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w<0&&(i=-i);var r=t.x*s+e.x*i,a=t.y*s+e.y*i,A=t.z*s+e.z*i,h=t.w*s+e.w*i;this.x=r,this.y=a,this.z=A,this.w=h},slerp:function(t,e,i){var n=t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w;if((n<0?-n:n)>=1)return this.x=t.x,this.y=t.y,this.z=t.z,void(this.w=t.w);var s=Math.acos(n),r=1/Math.sqrt(1-n*n);if((r<0?-r:r)>1e3){var a=.5,A=!0;null==A&&(A=!1);var h=1-a;A&&t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w<0&&(a=-a);var o=t.x*h+e.x*a,l=t.y*h+e.y*a,u=t.z*h+e.z*a,_=t.w*h+e.w*a;return this.x=o,this.y=l,this.z=u,void(this.w=_)}var c=Math.sin((1-i)*s)*r,d=Math.sin(i*s)*r*(n<0?-1:1);this.x=t.x*c+e.x*d,this.y=t.y*c+e.y*d,this.z=t.z*c+e.z*d,this.w=t.w*c+e.w*d},conjugate:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},negate:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},getDirection:function(){return new Yt(1-2*(this.y*this.y+this.z*this.z),2*(this.x*this.y+this.z*this.w),2*(this.x*this.z-this.y*this.w))},toMatrix:function(t){null==t&&(t=new Gt);var e=this.x*this.x,i=this.x*this.y,n=this.x*this.z,s=this.x*this.w,r=this.y*this.y,a=this.y*this.z,A=this.y*this.w,h=this.z*this.z,o=this.z*this.w;return t._11=1-2*(r+h),t._12=2*(i+o),t._13=2*(n-A),t._14=0,t._21=2*(i-o),t._22=1-2*(e+h),t._23=2*(a+s),t._24=0,t._31=2*(n+A),t._32=2*(a-s),t._33=1-2*(e+r),t._34=0,t._41=0,t._42=0,t._43=0,t._44=1,t},toString:function(){return"{"+Es.fmt(this.x)+","+Es.fmt(this.y)+","+Es.fmt(this.z)+","+Es.fmt(this.w)+"}"},__class__:Nt};var Yt=function(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n};i["h3d.Vector"]=Yt,Yt.__name__="h3d.Vector",Yt.fromColor=function(t,e){null==e&&(e=1);var i=e/255;return new Yt((t>>16&255)*i,(t>>8&255)*i,(255&t)*i,(t>>>24)*i)},Yt.fromArray=function(t){var e=new Yt;return t.length>0&&(e.x=t[0]),t.length>1&&(e.y=t[1]),t.length>2&&(e.z=t[2]),t.length>3&&(e.w=t[3]),e},Yt.prototype={distance:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return Math.sqrt(e*e+i*i+n*n)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return e*e+i*i+n*n},sub:function(t){return new Yt(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},add:function(t){return new Yt(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},multiply:function(t){return new Yt(this.x*t,this.y*t,this.z*t,this.w)},equals:function(t){return this.x==t.x&&this.y==t.y&&this.z==t.z&&this.w==t.w},cross:function(t){return new Yt(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x,1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z;t=t<1e-10?0:1/Math.sqrt(t),this.x*=t,this.y*=t,this.z*=t},normalized:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z;return t=t<1e-10?0:1/Math.sqrt(t),new Yt(this.x*t,this.y*t,this.z*t)},set:function(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n},load:function(t){this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w},scale:function(t){this.x*=t,this.y*=t,this.z*=t},lerp:function(t,e,i){var n=t.x;this.x=n+i*(e.x-n);n=t.y;this.y=n+i*(e.y-n);n=t.z;this.z=n+i*(e.z-n);n=t.w;this.w=n+i*(e.w-n)},transform:function(t){var e=this.x*t._11+this.y*t._21+this.z*t._31+this.w*t._41,i=this.x*t._12+this.y*t._22+this.z*t._32+this.w*t._42,n=this.x*t._13+this.y*t._23+this.z*t._33+this.w*t._43,s=this.x*t._14+this.y*t._24+this.z*t._34+this.w*t._44;this.x=e,this.y=i,this.z=n,this.w=s},transformed:function(t){var e=this.x*t._11+this.y*t._21+this.z*t._31+this.w*t._41,i=this.x*t._12+this.y*t._22+this.z*t._32+this.w*t._42,n=this.x*t._13+this.y*t._23+this.z*t._33+this.w*t._43,s=this.x*t._14+this.y*t._24+this.z*t._34+this.w*t._44;return new Yt(e,i,n,s)},transform3x4:function(t){var e=this.x*t._11+this.y*t._21+this.z*t._31+this.w*t._41,i=this.x*t._12+this.y*t._22+this.z*t._32+this.w*t._42,n=this.x*t._13+this.y*t._23+this.z*t._33+this.w*t._43;this.x=e,this.y=i,this.z=n},transformed3x4:function(t){var e=this.x*t._11+this.y*t._21+this.z*t._31+this.w*t._41,i=this.x*t._12+this.y*t._22+this.z*t._32+this.w*t._42,n=this.x*t._13+this.y*t._23+this.z*t._33+this.w*t._43;return new Yt(e,i,n)},transform3x3:function(t){var e=this.x*t._11+this.y*t._21+this.z*t._31,i=this.x*t._12+this.y*t._22+this.z*t._32,n=this.x*t._13+this.y*t._23+this.z*t._33;this.x=e,this.y=i,this.z=n},transformed3x3:function(t){var e=this.x*t._11+this.y*t._21+this.z*t._31,i=this.x*t._12+this.y*t._22+this.z*t._32,n=this.x*t._13+this.y*t._23+this.z*t._33;return new Yt(e,i,n)},clone:function(){return new Yt(this.x,this.y,this.z,this.w)},toPoint:function(){return new _e(this.x,this.y,this.z)},toString:function(){return"{"+Es.fmt(this.x)+","+Es.fmt(this.y)+","+Es.fmt(this.z)+","+Es.fmt(this.w)+"}"},reflect:function(t){var e=2*(this.x*t.x+this.y*t.y+this.z*t.z);return new Yt(this.x-e*t.x,this.y-e*t.y,this.z-e*t.z,1)},dot4:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},project:function(t){var e=this.x*t._11+this.y*t._21+this.z*t._31+this.w*t._41,i=this.x*t._12+this.y*t._22+this.z*t._32+this.w*t._42,n=this.x*t._13+this.y*t._23+this.z*t._33+this.w*t._43,s=1/(this.x*t._14+this.y*t._24+this.z*t._34+this.w*t._44);this.x=e*s,this.y=i*s,this.z=n*s,this.w=1},get_r:function(){return this.x},get_g:function(){return this.y},get_b:function(){return this.z},get_a:function(){return this.w},set_r:function(t){return this.x=t},set_g:function(t){return this.y=t},set_b:function(t){return this.z=t},set_a:function(t){return this.w=t},setColor:function(t){this.x=(t>>16&255)/255,this.y=(t>>8&255)/255,this.z=(255&t)/255,this.w=(t>>>24)/255},makeColor:function(t,e,i){null==i&&(i=.5),null==e&&(e=1);var n,s=t%6.283185307179586,r=(1-((n=2*i-1)<0?-n:n))*e,a=r*(1-((n=3*(t=s>=0?s:s+6.283185307179586)/3.141592653589793%2-1)<0?-n:n)),A=i-r/2;t<1.0471975511965976?(this.x=r,this.y=a,this.z=0):t<2.0943951023931953?(this.x=a,this.y=r,this.z=0):t<3.141592653589793?(this.x=0,this.y=r,this.z=a):t<4.1887902047863905?(this.x=0,this.y=a,this.z=r):t<5.235987755982989?(this.x=a,this.y=0,this.z=r):(this.x=r,this.y=0,this.z=a),this.x+=A,this.y+=A,this.z+=A,this.w=1},toColor:function(){var t=this.w,e=this.x,i=this.y,n=this.z;return(255*(t<0?0:t>1?1:t)+.499|0)<<24|(255*(e<0?0:e>1?1:e)+.499|0)<<16|(255*(i<0?0:i>1?1:i)+.499|0)<<8|255*(n<0?0:n>1?1:n)+.499|0},toColorHSL:function(){var t,e,i,n,s,r=(e=(t=this.x)<(i=this.y)?i:t)<(i=this.z)?i:e,a=(e=(t=this.x)>(i=this.y)?i:t)>(i=this.z)?i:e,A=(r+a)/2;if(r==a)n=s=0;else{var h=r-a;s=A>.5?h/(2-r-a):h/(r+a),n=r==this.x?(this.y-this.z)/h+(this.y<this.z?6:0):r==this.y?(this.z-this.x)/h+2:(this.x-this.y)/h+4,n*=1.0471975511965976}return new Yt(n,s,A,this.w)},scale3:function(t){this.x*=t,this.y*=t,this.z*=t},dot3:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},normalizeFast:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z;t=t<1e-10?0:1/Math.sqrt(t),this.x*=t,this.y*=t,this.z*=t},__class__:Yt};var Xt=function(t){this.objectName=t};i["h3d.anim.AnimatedObject"]=Xt,Xt.__name__="h3d.anim.AnimatedObject",Xt.prototype={clone:function(){return new Xt(this.objectName)},__class__:Xt};var jt=function(t,e,i){this.name=t,this.frameCount=e,this.sampling=i,this.objects=[],this.lastEvent=-1,this.frame=0,this.speed=1,this.loop=!0,this.pause=!1};i["h3d.anim.Animation"]=jt,jt.__name__="h3d.anim.Animation",jt.__interfaces__=[dt],jt.prototype={getDuration:function(){return this.frameCount/(this.sampling*this.speed)},frameToTime:function(t){return t/(this.sampling*this.speed)},getIFrame:function(){var t=0|this.frame;return t==this.endFrame()&&--t,t},unbind:function(t){for(var e=0,i=this.objects;e<i.length;){var n=i[e];if(++e,n.objectName==t)return this.isSync=!1,n.targetObject=null,void(n.targetSkin=null)}},setEvents:function(t){for(var e=[],i=0,n=this.frameCount;i<n;){i++;e.push(null)}this.events=e;for(var s=YA(t);s.hasNext();){var r=s.next();null==this.events[r.frame]&&(this.events[r.frame]=[]),this.events[r.frame].push(r.data)}},addEvent:function(t,e){null==this.events&&(this.events=[]),null==this.events[t]?this.events[t]=[e]:this.events[t].push(e)},getEvents:function(){return this.events},getObjects:function(){return this.objects},getEventTime:function(t){if(null==this.events)return null;for(var e=0,i=this.events.length;e<i;){var n=e++,s=this.events[n];if(null!=s&&s.indexOf(t)>=0)return n/(this.sampling*this.speed)}return null},setFrame:function(t){for(this.frame=t,this.lastEvent=-1;this.frame<0;)this.frame+=this.frameCount;for(;this.frame>this.frameCount;)this.frame-=this.frameCount},clone:function(t){return null==t&&(t=new jt(this.name,this.frameCount,this.sampling)),t.objects=this.objects,t.speed=this.speed,t.loop=this.loop,t.pause=this.pause,t.events=this.events,t.resourcePath=this.resourcePath,t},initInstance:function(){this.isInstance=!0},createInstance:function(t){for(var e=[],i=0,n=this.objects;i<n.length;){var s=n[i];++i,e.push(s.clone())}var r=e;return(s=this.clone()).objects=r,s.bind(t),s.initInstance(),s},bind:function(t){for(var e=null,i=0,n=this.objects.slice();i<n.length;){var s=n[i];if(++i,null!=e){var r=e.skinData.namedJoints.h[s.objectName];if(null!=r){s.targetSkin=e,s.targetJoint=r.index;continue}}var a=t.getObjectByName(s.objectName);if(null!=a){var A=a instanceof Ji?a:null;null!=A?(e=A.parent,s.targetSkin=e,s.targetJoint=A.index):s.targetObject=a}else l.remove(this.objects,s)}this.isSync=!1},getPropValue:function(t,e){return null},sync:function(t){throw null==t&&(t=!1),kn.thrown("assert")},isPlaying:function(){return!this.pause&&(this.speed<0?-this.speed:this.speed)>1e-6},endFrame:function(){return this.frameCount},update:function(t){if(!this.isInstance)throw kn.thrown("You must instanciate this animation first");if(!this.isPlaying())return 0;if(null!=this.events&&null!=this.onEvent){var e=0|this.frame,i=this.frame+t*this.speed*this.sampling|0;i>=this.frameCount&&(i=this.frameCount-1);for(var n=e,s=i+1;n<s;){var r=n++;if(r!=this.lastEvent&&(this.lastEvent=r,null!=this.events[r])){var a=this.frame,A=t;t-=(r-this.frame)/(this.speed*this.sampling),this.frame=r;for(var h=0,o=this.events[r];h<o.length;){var l=o[h];++h,this.onEvent(l)}if(this.frame==r&&r==this.frameCount-1){this.frame=a,t=A;break}return t}}}if(null!=this.onAnimEnd){var u=this.endFrame(),_=0==this.speed?0:(u-this.frame)/(this.speed*this.sampling);if(_<=t&&_>0)return this.frame=u,t-=_,this.onAnimEnd(),this.frame==u&&this.isPlaying()&&(this.loop?this.frame=0:t=0),t}return this.frame+=t*this.speed*this.sampling,this.frame>=this.frameCount&&(this.loop?this.frame%=this.frameCount:this.frame=this.frameCount),0},initAndBind:function(t){this.bind(t),this.initInstance(),this.pause=!0},toString:function(){return this.name},__class__:jt};var Ht=s["h3d.anim.DataLayout"]={__ename__:!0,__constructs__:null,Position:{_hx_name:"Position",_hx_index:0,__enum__:"h3d.anim.DataLayout",toString:n},Rotation:{_hx_name:"Rotation",_hx_index:1,__enum__:"h3d.anim.DataLayout",toString:n},Scale:{_hx_name:"Scale",_hx_index:2,__enum__:"h3d.anim.DataLayout",toString:n},UV:{_hx_name:"UV",_hx_index:3,__enum__:"h3d.anim.DataLayout",toString:n},Alpha:{_hx_name:"Alpha",_hx_index:4,__enum__:"h3d.anim.DataLayout",toString:n},Property:{_hx_name:"Property",_hx_index:5,__enum__:"h3d.anim.DataLayout",toString:n},SingleFrame:{_hx_name:"SingleFrame",_hx_index:6,__enum__:"h3d.anim.DataLayout",toString:n}};Ht.__constructs__=[Ht.Position,Ht.Rotation,Ht.Scale,Ht.UV,Ht.Alpha,Ht.Property,Ht.SingleFrame],Ht.__empty_constructs__=[Ht.Position,Ht.Rotation,Ht.Scale,Ht.UV,Ht.Alpha,Ht.Property,Ht.SingleFrame];var Wt=function(t,e){Xt.call(this,t),this.dataOffset=e};i["h3d.anim.BufferObject"]=Wt,Wt.__name__="h3d.anim.BufferObject",Wt.__super__=Xt,Wt.prototype=r(Xt.prototype,{getStride:function(){var t=0;return 0!=(this.layout&1<<Ht.Position._hx_index)&&(t+=3),0!=(this.layout&1<<Ht.Rotation._hx_index)&&(t+=3),0!=(this.layout&1<<Ht.Scale._hx_index)&&(t+=3),0!=(this.layout&1<<Ht.UV._hx_index)&&(t+=2),0!=(this.layout&1<<Ht.Alpha._hx_index)&&++t,0!=(this.layout&1<<Ht.Property._hx_index)&&++t,t},clone:function(){var t=new Wt(this.objectName,this.dataOffset);return t.layout=this.layout,t.propName=this.propName,t},__class__:Wt});var Zt=function(t,e,i){jt.call(this,t,e,i),this.syncFrame=-1};i["h3d.anim.BufferAnimation"]=Zt,Zt.__name__="h3d.anim.BufferAnimation",Zt.__super__=jt,Zt.prototype=r(jt.prototype,{setData:function(t,e){this.data=t,this.stride=e},addObject:function(t,e){var i=new Wt(t,e);return this.objects.push(i),i},getPropValue:function(t,e){for(var i=0,n=this.objects;i<n.length;){var s=n[i];if(++i,s.objectName==t&&s.propName==e)return s.propCurrentValue}return null},getFrames:function(){return this.objects},clone:function(t){return null==t&&(t=new Zt(this.name,this.frameCount,this.sampling)),jt.prototype.clone.call(this,t),(t instanceof Zt?t:null).setData(this.data,this.stride),t},endFrame:function(){return this.loop?this.frameCount:this.frameCount-1},initInstance:function(){jt.prototype.initInstance.call(this);for(var t=this.objects,e=0;e<t.length;){var i,n=t[e];if(++e,0!=(n.layout&1<<Ht.Property._hx_index)&&(n.propCurrentValue=this.data[n.dataOffset]),0!=(n.layout&1<<Ht.Alpha._hx_index))if(null!=n.targetObject){var s=n.targetObject;i=null==(s instanceof Li?s:null)}else i=!0;else i=!1;if(i)throw kn.thrown(n.objectName+" should be a mesh (for alpha animation)");if((0!=(n.layout&1<<Ht.Position._hx_index)||0!=(n.layout&1<<Ht.Rotation._hx_index)||0!=(n.layout&1<<Ht.Scale._hx_index))&&(n.matrix=new Gt,n.matrix.identity(),0==(n.layout&1<<Ht.Position._hx_index)&&null!=n.targetSkin)){var r=n.targetSkin.getSkinData().allJoints[n.targetJoint].defMat;n.matrix._14=r._41,n.matrix._24=r._42,n.matrix._34=r._43}}t.sort(XA(this,this.sortByFrameCountDesc))},sortByFrameCountDesc:function(t,e){return(0!=(e.layout&1<<Ht.SingleFrame._hx_index)?0:1)-(0!=(t.layout&1<<Ht.SingleFrame._hx_index)?0:1)},uvLerp:function(t,e,i){return(t%=1)<(e%=1)-.5?++t:t>e+.5&&--t,t*(1-i)+e*i},sync:function(t){null==t&&(t=!1);var e=this;if(this.frame!=this.syncFrame||t){(x=0|this.frame)==this.endFrame()&&--x;var i=x,n=(i+1)%this.frameCount,s=this.frame-i,r=1-s;i<0?i=n=0:this.frame>=this.frameCount?i=n=this.frameCount-1:this.loop||0!=n||(n=this.frameCount-1),this.syncFrame=this.frame,t&&(this.isSync=!1);for(var a=0,A=this.objects;a<A.length;){var h=A[a];if(++a,null!=h.targetObject||null!=h.targetSkin){var o=h.layout,l=this.stride*i+h.dataOffset,u=this.stride*n+h.dataOffset;if(0!=(o&1<<Ht.SingleFrame._hx_index)){if(this.isSync)break;0,l=u=h.dataOffset}var _=h.matrix;if(null!=_){if(0!=(o&1<<Ht.Position._hx_index)?(_._41=e.data[l++]*r+e.data[u++]*s,_._42=e.data[l++]*r+e.data[u++]*s,_._43=e.data[l++]*r+e.data[u++]*s):(_._41=_._14,_._42=_._24,_._43=_._34),0!=(o&1<<Ht.Rotation._hx_index)){var c=this.data[l++],d=this.data[l++],f=this.data[l++],x=1-(c*c+d*d+f*f),p=Math.sqrt(x<0?-x:x),g=this.data[u++],m=this.data[u++],v=this.data[u++],y=1-(g*g+m*m+v*v),b=Math.sqrt(y<0?-y:y),w=c*g+d*m+f*v+p*b<0?-s:s,M=c*r+g*w,B=d*r+m*w,C=f*r+v*w,S=p*r+b*w,I=1/Math.sqrt(M*M+B*B+C*C+S*S);if(M*=I,B*=I,C*=I,S*=I,t)_._12=M,_._13=B,_._21=C,_._23=S,0!=(o&1<<Ht.Scale._hx_index)?(_._11=e.data[l++]*r+e.data[u++]*s,_._22=e.data[l++]*r+e.data[u++]*s,_._33=e.data[l++]*r+e.data[u++]*s):(_._11=1,_._22=1,_._33=1);else{var k=M*M,E=M*B,F=M*C,T=M*S,D=B*B,P=B*C,z=B*S,R=C*C,L=C*S;if(_._11=1-2*(D+R),_._12=2*(E+L),_._13=2*(F-z),_._21=2*(E-L),_._22=1-2*(k+R),_._23=2*(P+T),_._31=2*(F+z),_._32=2*(P-T),_._33=1-2*(k+D),0!=(o&1<<Ht.Scale._hx_index)){var V=e.data[l++]*r+e.data[u++]*s,Q=e.data[l++]*r+e.data[u++]*s,U=e.data[l++]*r+e.data[u++]*s;_._11*=V,_._12*=V,_._13*=V,_._21*=Q,_._22*=Q,_._23*=Q,_._31*=U,_._32*=U,_._33*=U}}}else _._12=0,_._13=0,_._21=0,_._23=t?1:0,0!=(o&1<<Ht.Scale._hx_index)?(_._11=e.data[l++]*r+e.data[u++]*s,_._22=e.data[l++]*r+e.data[u++]*s,_._33=e.data[l++]*r+e.data[u++]*s):(_._11=1,_._22=1,_._33=1);if(null!=h.targetSkin)h.targetSkin.currentRelPose[h.targetJoint]=_,h.targetSkin.jointsUpdated=!0;else{var O=h.targetObject;O.defaultTransform=_;O.flags|=1}}if(0!=(o&1<<Ht.UV._hx_index)){var G=h.targetObject.toMesh().material,N=G.passes.getShader(Mn);null==N&&(N=G.passes.addShader(new Mn),G.get_texture().set_wrap(Ge.Repeat));var Y=this.data[l++],X=this.data[u++];(Y%=1)<(X%=1)-.5?++Y:Y>X+.5&&--Y,N.uvDelta__.x=Y*(1-s)+X*s;var j=this.data[l++],H=this.data[u++];(j%=1)<(H%=1)-.5?++j:j>H+.5&&--j,N.uvDelta__.y=j*(1-s)+H*s}if(0!=(o&1<<Ht.Alpha._hx_index)){var W=h.targetObject.toMesh().material;W.blendMode==et.None&&W.set_blendMode(et.Alpha),W.mshader.color__.w=e.data[l++]*r+e.data[u++]*s}0!=(o&1<<Ht.Property._hx_index)&&(h.propCurrentValue=e.data[l++]*r+e.data[u++]*s)}}t||(this.isSync=!0)}},__class__:Zt});var Jt=function(){};i["h3d.anim.LinearFrame"]=Jt,Jt.__name__="h3d.anim.LinearFrame",Jt.prototype={toMatrix:function(){var t=new Gt;return new Nt(this.qx,this.qy,this.qz,this.qw).toMatrix(t),t.prependScale(this.sx,this.sy,this.sz),t.translate(this.tx,this.ty,this.tz),t},__class__:Jt};var qt=function(t){this.hasPosition=!0,Xt.call(this,t)};i["h3d.anim.LinearObject"]=qt,qt.__name__="h3d.anim.LinearObject",qt.__super__=Xt,qt.prototype=r(Xt.prototype,{clone:function(){var t=new qt(this.objectName);return t.hasPosition=this.hasPosition,t.hasRotation=this.hasRotation,t.hasScale=this.hasScale,t.frames=this.frames,t.alphas=this.alphas,t.uvs=this.uvs,t.propName=this.propName,t.propValues=this.propValues,t},__class__:qt});var Kt=function(t,e,i){jt.call(this,t,e,i),this.syncFrame=-1};i["h3d.anim.LinearAnimation"]=Kt,Kt.__name__="h3d.anim.LinearAnimation",Kt.__super__=jt,Kt.prototype=r(jt.prototype,{addCurve:function(t,e,i,n,s){var r=new qt(t);r.frames=e,r.hasPosition=i,r.hasRotation=n,r.hasScale=s,this.objects.push(r)},addAlphaCurve:function(t,e){var i=new qt(t);i.alphas=e,this.objects.push(i)},addUVCurve:function(t,e){var i=new qt(t);i.uvs=e,this.objects.push(i)},addPropCurve:function(t,e,i){var n=new qt(t);n.propName=e,n.propValues=i,this.objects.push(n)},getPropValue:function(t,e){for(var i=0,n=this.objects;i<n.length;){var s=n[i];if(++i,s.objectName==t&&s.propName==e)return s.propCurrentValue}return null},getFrames:function(){return this.objects},clone:function(t){return null==t&&(t=new Kt(this.name,this.frameCount,this.sampling)),jt.prototype.clone.call(this,t),t},endFrame:function(){return this.loop?this.frameCount:this.frameCount-1},initInstance:function(){jt.prototype.initInstance.call(this);for(var t=this.objects,e=0;e<t.length;){var i=t[e];if(++e,null==i.propValues){var n;if(null!=i.alphas)if(null!=i.targetObject){var s=i.targetObject;n=null==(s instanceof Li?s:null)}else n=!0;else n=!1;if(n)throw kn.thrown(i.objectName+" should be a mesh (for alpha animation)");null==i.uvs&&null==i.alphas&&(i.matrix=new Gt,i.matrix.identity())}else i.propCurrentValue=i.propValues[0]}t.sort(XA(this,this.sortByFrameCountDesc))},sortByFrameCountDesc:function(t,e){return(null==e.frames?10:e.frames.length)-(null==t.frames?10:t.frames.length)},uvLerp:function(t,e,i){return(t%=1)<(e%=1)-.5?++t:t>e+.5&&--t,t*(1-i)+e*i},sync:function(t){if(null==t&&(t=!1),this.frame!=this.syncFrame||t){(D=0|this.frame)==this.endFrame()&&--D;var e=D,i=(e+1)%this.frameCount,n=this.frame-e,s=1-n;e<0?e=i=0:this.frame>=this.frameCount?e=i=this.frameCount-1:this.loop||0!=i||(i=this.frameCount-1),this.syncFrame=this.frame,t&&(this.isSync=!1);for(var r=0,a=this.objects;r<a.length;){var A=a[r];if(++r,null!=A.targetObject||null!=A.targetSkin)if(null==A.alphas)if(null==A.uvs)if(null==A.propValues){var h=e,o=i;if(1==A.frames.length){if(this.isSync)break;h=o=0}var l=A.frames[h],u=A.frames[o],_=A.matrix;if(_._41=l.tx*s+u.tx*n,_._42=l.ty*s+u.ty*n,_._43=l.tz*s+u.tz*n,A.hasRotation){var c=l.qx*u.qx+l.qy*u.qy+l.qz*u.qz+l.qw*u.qw<0?-n:n,d=l.qx*s+u.qx*c,f=l.qy*s+u.qy*c,x=l.qz*s+u.qz*c,p=l.qw*s+u.qw*c,g=1/Math.sqrt(d*d+f*f+x*x+p*p);if(d*=g,f*=g,x*=g,p*=g,t)_._12=d,_._13=f,_._21=x,_._23=p,A.hasScale?(_._11=l.sx*s+u.sx*n,_._22=l.sy*s+u.sy*n,_._33=l.sz*s+u.sz*n):(_._11=1,_._22=1,_._33=1);else{var m=d*d,v=d*f,y=d*x,b=d*p,w=f*f,M=f*x,B=f*p,C=x*x,S=x*p;if(_._11=1-2*(w+C),_._12=2*(v+S),_._13=2*(y-B),_._21=2*(v-S),_._22=1-2*(m+C),_._23=2*(M+b),_._31=2*(y+B),_._32=2*(M-b),_._33=1-2*(m+w),A.hasScale){var I=l.sx*s+u.sx*n,k=l.sy*s+u.sy*n,E=l.sz*s+u.sz*n;_._11*=I,_._12*=I,_._13*=I,_._21*=k,_._22*=k,_._23*=k,_._31*=E,_._32*=E,_._33*=E}}}else _._12=0,_._13=0,_._21=0,_._23=t?1:0,A.hasScale?(_._11=l.sx*s+u.sx*n,_._22=l.sy*s+u.sy*n,_._33=l.sz*s+u.sz*n):(_._11=1,_._22=1,_._33=1);if(null!=A.targetSkin)A.targetSkin.currentRelPose[A.targetJoint]=A.matrix,A.targetSkin.jointsUpdated=!0;else{var F=A.targetObject,T=A.matrix;F.defaultTransform=T;var D=1;F.flags|=D}}else A.propCurrentValue=A.propValues[e]*s+A.propValues[i]*n;else{var P=A.targetObject.toMesh().material,z=P.passes.getShader(Mn);null==z&&(z=P.passes.addShader(new Mn),P.get_texture().set_wrap(Ge.Repeat));var R=A.uvs[e<<1],L=A.uvs[i<<1];(R%=1)<(L%=1)-.5?++R:R>L+.5&&--R,z.uvDelta__.x=R*(1-n)+L*n;var V=A.uvs[e<<1|1],Q=A.uvs[i<<1|1];(V%=1)<(Q%=1)-.5?++V:V>Q+.5&&--V,z.uvDelta__.y=V*(1-n)+Q*n}else{var U=A.targetObject.toMesh().material;U.blendMode==et.None&&U.set_blendMode(et.Alpha),U.mshader.color__.w=A.alphas[e]*s+A.alphas[i]*n}}t||(this.isSync=!0)}},__class__:Kt});var $t=function(){this.bindIndex=-1,this.splitIndex=-1,this.subs=[]};i["h3d.anim.Joint"]=$t,$t.__name__="h3d.anim.Joint",$t.prototype={__class__:$t};var te=function(){};i["h3d.anim._Skin.Permut"]=te,te.__name__="h3d.anim._Skin.Permut",te.prototype={__class__:te};var ee=function(t,e){this.j=t,this.w=e};i["h3d.anim._Skin.Influence"]=ee,ee.__name__="h3d.anim._Skin.Influence",ee.prototype={__class__:ee};var ie=function(t,e,i){if(this.name=t,this.vertexCount=e,this.bonesPerVertex=i,e>0){var n=new Array(e*i);this.vertexJoints=n;n=new Array(e*i);this.vertexWeights=n,this.envelop=[]}};i["h3d.anim.Skin"]=ie,ie.__name__="h3d.anim.Skin",ie.prototype={setJoints:function(t,e){this.rootJoints=e,this.allJoints=t,this.namedJoints=new Kn;for(var i=0;i<t.length;){var n=t[i];++i,null!=n.name&&(this.namedJoints.h[n.name]=n)}},addInfluence:function(t,e,i){var n=this.envelop[t];null==n&&(n=this.envelop[t]=[]),n.push(new ee(e,i))},sortInfluences:function(t,e){return e.w>t.w?1:-1},isSplit:function(){return null!=this.splitJoints},initWeights:function(){this.boundJoints=[];for(var t=0,e=0,i=this.vertexCount;e<i;){var n=e++,s=this.envelop[n];null==s&&(s=[]),Yn.sort(s,XA(this,this.sortInfluences)),s.length>this.bonesPerVertex&&(s=s.slice(0,this.bonesPerVertex));for(var r=0,a=0;a<s.length;){var A=s[a];++a,r+=A.w}r=1/r;for(var h=0,o=this.bonesPerVertex;h<o;){var l=s[h++];null==l?(this.vertexJoints[t]=0,this.vertexWeights[t]=0):(-1==l.j.bindIndex&&(l.j.bindIndex=this.boundJoints.length,this.boundJoints.push(l.j)),this.vertexJoints[t]=l.j.bindIndex,this.vertexWeights[t]=l.w*r),++t}}this.envelop=null},sortByBindIndex:function(t,e){return t.bindIndex-e.bindIndex},isSub:function(t,e){for(var i=0,n=e.length,s=0;s<t.length;){var r=t[s];for(++s;r!=e[i++];)if(i>=n)return!1}return!0},merge:function(t){for(var e=0;e<t.length;){var i=t[e];++e;for(var n=0;n<t.length;){var s=t[n];if(++n,i!=s&&i.material==s.material&&this.isSub(i.joints,s.joints)){for(var r=0,a=i.triangles;r<a.length;){var A=a[r];++r,s.triangles.push(A)}return l.remove(t,i),!0}}}return!1},jointsDiff:function(t,e){for(var i=0,n=0,s=0,r=t.joints.length,a=e.joints.length;n<r&&s<a;){var A=t.joints[n],h=e.joints[s];A==h?(++n,++s):(++i,A.bindIndex<h.bindIndex?++n:++s)}return i+(r-n)+(a-s)},split:function(t,e,i){if(null!=this.splitJoints)return!0;if(this.boundJoints.length<=t)return!1;this.splitJoints=[];var n=new Array(e.length/3|0);this.triangleGroups=n;for(var s=[],r=0,a=e.length/3|0;r<a;){for(var A=3*(T=r++),h=null==i?0:i[T],o=[],u=0;u<3;)for(var _=e[A+(O=u++)],c=0,d=this.bonesPerVertex;c<d;){var f=c++,x=_*this.bonesPerVertex+f;if(0!=this.vertexWeights[x])(P=this.boundJoints[this.vertexJoints[x]]).splitIndex!=A&&(P.splitIndex=A,o.push(P))}o.sort(XA(this,this.sortByBindIndex));for(var p=0;p<s.length;){var g=s[p];if(++p,g.material==h&&this.isSub(o,g.joints)){g.triangles.push(T),o=null;break}}if(null!=o){for(var m=0;m<s.length;){var v=s[m];if(++m,v.material==h&&this.isSub(v.joints,o)){v.joints=o,v.triangles.push(T),o=null;break}}if(null!=o){var y=new te;y.joints=o,y.triangles=[T],y.material=h,s.push(y)}}}for(;;){for(;this.merge(s););var b=1e5,w=1e5,M=null,B=null;for(r=0,a=s.length;r<a;){if((U=s[O=r++]).joints.length!=t)for(u=O+1,c=s.length;u<c;){if((g=s[P=u++]).joints.length!=t&&U.material==g.material){var C=this.jointsDiff(U,g),S=C+(U.joints.length+g.joints.length-C>>1);S>t||S>w||S==w&&C>b||(b=C,w=S,M=U,B=g)}}}if(null==M)break;var I=M;for(v=B,d=0,p=I.joints;d<p.length;){var k=p[d];++d,l.remove(v.joints,k),v.joints.push(k)}v.joints.sort(XA(this,this.sortByBindIndex));m=0;for(var E=I.triangles;m<E.length;){var F=E[m];++m,v.triangles.push(F)}l.remove(s,I)}for(r=0,a=s.length;r<a;)for(u=0,c=s[O=r++].triangles;u<c.length;){var T=c[u];++u,this.triangleGroups[T]=O}var D=[];for(r=0,a=this.boundJoints;r<a.length;){var P=a[r];++r;var z=[];for(u=0;u<s.length;){var R=s[u];++u,R.joints.indexOf(P)>=0&&z.push(R)}D.push({j:P,pl:z,priority:0})}for(;;){D.sort((function(t,e){return e.pl.length+100*e.priority-(t.pl.length+100*t.priority)}));for(r=0;r<s.length;){R=s[r];++r,R.indexedJoints=[]}var L=!1;for(a=0;a<D.length;){P=D[a];++a,P.j.splitIndex=-1;for(u=0,c=t;u<c;){var V=u++,Q=!0;for(d=0,p=P.pl;d<p.length;){var U=p[d];if(++d,null!=U.indexedJoints[V]){Q=!1;break}}if(Q){P.j.splitIndex=V;for(m=0,E=P.pl;m<E.length;){g=E[m];++m,g.indexedJoints[V]=P.j}break}}if(P.j.splitIndex<0){if(P.priority++,P.priority>10)throw kn.thrown("Failed to assign index while spliting skin");L=!0;break}}if(!L)break}this.splitJoints=[];for(r=0;r<s.length;){R=s[r];++r;for(o=[],a=0,u=R.indexedJoints.length;a<u;){var O=a++;null==(P=R.indexedJoints[O])&&(P=this.boundJoints[0]),o.push(P)}this.splitJoints.push({material:R.material,joints:o})}for(r=0,a=this.vertexJoints.length;r<a;){O=r++;this.vertexJoints[O]=this.boundJoints[this.vertexJoints[O]].splitIndex}return!0},__class__:ie};var ne=function(){};i["h3d.col.Collider"]=ne,ne.__name__="h3d.col.Collider",ne.__isInterface__=!0,ne.__interfaces__=[dt],ne.prototype={__class__:ne};var se=function(){this.xMin=1e20,this.xMax=-1e20,this.yMin=1e20,this.yMax=-1e20,this.zMin=1e20,this.zMax=-1e20};i["h3d.col.Bounds"]=se,se.__name__="h3d.col.Bounds",se.__interfaces__=[ne],se.fromPoints=function(t,e){var i=new se;return i.xMin=t.x,i.yMin=t.y,i.zMin=t.z,i.xMax=e.x,i.yMax=e.y,i.zMax=e.z,i},se.fromValues=function(t,e,i,n,s,r){var a=new se;return a.xMin=t,a.yMin=e,a.zMin=i,a.xMax=t+n,a.yMax=e+s,a.zMax=i+r,a},se.prototype={inFrustum:function(t,e){if(null!=e)throw kn.thrown("Not implemented");return t.hasBounds(this)},inSphere:function(t){var e=t.x,i=t.y;null==(A=t.z)&&(A=0),null==i&&(i=0),null==e&&(e=0);var n,s,r,a,A,h=e,o=i,l=A;e=(n=this.xMin)<(a=(s=t.x)>(r=this.xMax)?r:s)?a:n,i=(n=this.yMin)<(a=(s=t.y)>(r=this.yMax)?r:s)?a:n;null==(A=(n=this.zMin)<(a=(s=t.z)>(r=this.zMax)?r:s)?a:n)&&(A=0),null==i&&(i=0),null==e&&(e=0);var u=e-h,_=i-o,c=A-l;return u*u+_*_+c*c<t.r*t.r},testPlane:function(t){var e=t.nx,i=t.ny,n=t.nz,s=e*(this.xMax+this.xMin)+i*(this.yMax+this.yMin)+n*(this.zMax+this.zMin);return e<0&&(e=-e),i<0&&(i=-i),n<0&&(n=-n),s+(e*(this.xMax-this.xMin)+i*(this.yMax-this.yMin)+n*(this.zMax-this.zMin))-2*t.d},rayIntersection:function(t,e){var i,n=(this.xMin-t.px)/t.lx,s=(this.yMin-t.py)/t.ly,r=(this.zMin-t.pz)/t.lz,a=(this.xMax-t.px)/t.lx,A=(this.yMax-t.py)/t.ly,h=(this.zMax-t.pz)/t.lz,o=n>a?a:n,l=s>A?A:s,u=r>h?h:r,_=n<a?a:n,c=s<A?A:s,d=r<h?h:r,f=(i=_>c?c:_)>d?d:i,x=(i=o<l?l:o)<u?u:i;return f<x?-1:x},inFrustumDetails:function(t,e){null==e&&(e=!0);var i=1,n=t._14+t._11,s=t._24+t._21,r=t._34+t._31,a=t._44+t._41;if(n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+r*(r>0?this.zMax:this.zMin)+a<0)return-1;n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+r*(r>0?this.zMin:this.zMax)+a<0&&(i=0);n=t._14-t._11,s=t._24-t._21,r=t._34-t._31,a=t._44-t._41;if(n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+r*(r>0?this.zMax:this.zMin)+a<0)return-1;n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+r*(r>0?this.zMin:this.zMax)+a<0&&(i=0);n=t._14+t._12,s=t._24+t._22,r=t._34+t._32,a=t._44+t._42;if(n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+r*(r>0?this.zMax:this.zMin)+a<0)return-1;n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+r*(r>0?this.zMin:this.zMax)+a<0&&(i=0);n=t._14-t._12,s=t._24-t._22,r=t._34-t._32,a=t._44-t._42;if(n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+r*(r>0?this.zMax:this.zMin)+a<0)return-1;if(n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+r*(r>0?this.zMin:this.zMax)+a<0&&(i=0),e){n=t._13,s=t._23,r=t._33,a=t._43;if(n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+r*(r>0?this.zMax:this.zMin)+a<0)return-1;n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+r*(r>0?this.zMin:this.zMax)+a<0&&(i=0);n=t._14-t._13,s=t._24-t._23,r=t._34-t._33,a=t._44-t._43;if(n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+r*(r>0?this.zMax:this.zMin)+a<0)return-1;n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+r*(r>0?this.zMin:this.zMax)+a<0&&(i=0)}return i},transform3x3:function(t){var e=this.xMin,i=this.yMin,n=this.zMin,s=this.xMax,r=this.yMax,a=this.zMax;this.xMin=1e20,this.xMax=-1e20,this.yMin=1e20,this.yMax=-1e20,this.zMin=1e20,this.zMax=-1e20;var A=0,h=0,o=0;null==(f=n)&&(f=0),null==(d=i)&&(d=0),null==(c=e)&&(c=0),h=d,o=f;var l=(A=c)*t._11+h*t._21+o*t._31,u=A*t._12+h*t._22+o*t._32,_=A*t._13+h*t._23+o*t._33;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=a)&&(f=0),null==(d=i)&&(d=0),null==(c=e)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31,u=A*t._12+h*t._22+o*t._32,_=A*t._13+h*t._23+o*t._33;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=n)&&(f=0),null==(d=r)&&(d=0),null==(c=e)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31,u=A*t._12+h*t._22+o*t._32,_=A*t._13+h*t._23+o*t._33;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=a)&&(f=0),null==(d=r)&&(d=0),null==(c=e)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31,u=A*t._12+h*t._22+o*t._32,_=A*t._13+h*t._23+o*t._33;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=n)&&(f=0),null==(d=i)&&(d=0),null==(c=s)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31,u=A*t._12+h*t._22+o*t._32,_=A*t._13+h*t._23+o*t._33;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=a)&&(f=0),null==(d=i)&&(d=0),null==(c=s)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31,u=A*t._12+h*t._22+o*t._32,_=A*t._13+h*t._23+o*t._33;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=n)&&(f=0),null==(d=r)&&(d=0),null==(c=s)&&(c=0),h=d,o=f;var c,d,f;l=(A=c)*t._11+h*t._21+o*t._31,u=A*t._12+h*t._22+o*t._32,_=A*t._13+h*t._23+o*t._33;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=a)&&(f=0),null==(d=r)&&(d=0),null==(c=s)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31,u=A*t._12+h*t._22+o*t._32,_=A*t._13+h*t._23+o*t._33;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o)},transform:function(t){var e=this.xMin,i=this.yMin,n=this.zMin,s=this.xMax,r=this.yMax,a=this.zMax;if(this.xMin=1e20,this.xMax=-1e20,this.yMin=1e20,this.yMax=-1e20,this.zMin=1e20,this.zMax=-1e20,!(s<e&&r<i&&a<n)){var A=0,h=0,o=0;null==(f=n)&&(f=0),null==(d=i)&&(d=0),null==(c=e)&&(c=0),h=d,o=f;var l=(A=c)*t._11+h*t._21+o*t._31+t._41,u=A*t._12+h*t._22+o*t._32+t._42,_=A*t._13+h*t._23+o*t._33+t._43;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=a)&&(f=0),null==(d=i)&&(d=0),null==(c=e)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31+t._41,u=A*t._12+h*t._22+o*t._32+t._42,_=A*t._13+h*t._23+o*t._33+t._43;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=n)&&(f=0),null==(d=r)&&(d=0),null==(c=e)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31+t._41,u=A*t._12+h*t._22+o*t._32+t._42,_=A*t._13+h*t._23+o*t._33+t._43;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=a)&&(f=0),null==(d=r)&&(d=0),null==(c=e)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31+t._41,u=A*t._12+h*t._22+o*t._32+t._42,_=A*t._13+h*t._23+o*t._33+t._43;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=n)&&(f=0),null==(d=i)&&(d=0),null==(c=s)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31+t._41,u=A*t._12+h*t._22+o*t._32+t._42,_=A*t._13+h*t._23+o*t._33+t._43;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=a)&&(f=0),null==(d=i)&&(d=0),null==(c=s)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31+t._41,u=A*t._12+h*t._22+o*t._32+t._42,_=A*t._13+h*t._23+o*t._33+t._43;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=n)&&(f=0),null==(d=r)&&(d=0),null==(c=s)&&(c=0),h=d,o=f;var c,d,f;l=(A=c)*t._11+h*t._21+o*t._31+t._41,u=A*t._12+h*t._22+o*t._32+t._42,_=A*t._13+h*t._23+o*t._33+t._43;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o),null==(f=a)&&(f=0),null==(d=r)&&(d=0),null==(c=s)&&(c=0),h=d,o=f;l=(A=c)*t._11+h*t._21+o*t._31+t._41,u=A*t._12+h*t._22+o*t._32+t._42,_=A*t._13+h*t._23+o*t._33+t._43;h=u,o=_,(A=l)<this.xMin&&(this.xMin=A),A>this.xMax&&(this.xMax=A),h<this.yMin&&(this.yMin=h),h>this.yMax&&(this.yMax=h),o<this.zMin&&(this.zMin=o),o>this.zMax&&(this.zMax=o)}},collide:function(t){return!(this.xMin>t.xMax||this.yMin>t.yMax||this.zMin>t.zMax||this.xMax<t.xMin||this.yMax<t.yMin||this.zMax<t.zMin)},contains:function(t){return t.x>=this.xMin&&t.x<this.xMax&&t.y>=this.yMin&&t.y<this.yMax&&t.z>=this.zMin&&t.z<this.zMax},containsBounds:function(t){return this.xMin<=t.xMin&&this.yMin<=t.yMin&&this.zMin<=t.zMin&&this.xMax>=t.xMax&&this.yMax>=t.yMax&&this.zMax>=t.zMax},containsSphere:function(t){return this.xMin<=t.x-t.r&&this.yMin<=t.y-t.r&&this.zMin<=t.z-t.r&&this.xMax>=t.x+t.r&&this.yMax>=t.y+t.r&&this.zMax>=t.z+t.r},add:function(t){t.xMin<this.xMin&&(this.xMin=t.xMin),t.xMax>this.xMax&&(this.xMax=t.xMax),t.yMin<this.yMin&&(this.yMin=t.yMin),t.yMax>this.yMax&&(this.yMax=t.yMax),t.zMin<this.zMin&&(this.zMin=t.zMin),t.zMax>this.zMax&&(this.zMax=t.zMax)},addPoint:function(t){t.x<this.xMin&&(this.xMin=t.x),t.x>this.xMax&&(this.xMax=t.x),t.y<this.yMin&&(this.yMin=t.y),t.y>this.yMax&&(this.yMax=t.y),t.z<this.zMin&&(this.zMin=t.z),t.z>this.zMax&&(this.zMax=t.z)},addPos:function(t,e,i){t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),e<this.yMin&&(this.yMin=e),e>this.yMax&&(this.yMax=e),i<this.zMin&&(this.zMin=i),i>this.zMax&&(this.zMax=i)},addSphere:function(t){var e=t.x,i=t.y,n=t.z,s=t.r;e-s<this.xMin&&(this.xMin=e-s),e+s>this.xMax&&(this.xMax=e+s),i-s<this.yMin&&(this.yMin=i-s),i+s>this.yMax&&(this.yMax=i+s),n-s<this.zMin&&(this.zMin=n-s),n+s>this.zMax&&(this.zMax=n+s)},addSpherePos:function(t,e,i,n){t-n<this.xMin&&(this.xMin=t-n),t+n>this.xMax&&(this.xMax=t+n),e-n<this.yMin&&(this.yMin=e-n),e+n>this.yMax&&(this.yMax=e+n),i-n<this.zMin&&(this.zMin=i-n),i+n>this.zMax&&(this.zMax=i+n)},intersection:function(t,e){var i,n,s=(i=t.xMin)<(n=e.xMin)?n:i,r=(i=t.yMin)<(n=e.yMin)?n:i,a=(i=t.zMin)<(n=e.zMin)?n:i,A=(i=t.xMax)>(n=e.xMax)?n:i,h=(i=t.yMax)>(n=e.yMax)?n:i,o=(i=t.zMax)>(n=e.zMax)?n:i;this.xMin=s,this.xMax=A,this.yMin=r,this.yMax=h,this.zMin=a,this.zMax=o},offset:function(t,e,i){this.xMin+=t,this.xMax+=t,this.yMin+=e,this.yMax+=e,this.zMin+=i,this.zMax+=i},setMin:function(t){this.xMin=t.x,this.yMin=t.y,this.zMin=t.z},setMax:function(t){this.xMax=t.x,this.yMax=t.y,this.zMax=t.z},load:function(t){this.xMin=t.xMin,this.xMax=t.xMax,this.yMin=t.yMin,this.yMax=t.yMax,this.zMin=t.zMin,this.zMax=t.zMax},scalePivot:function(t){this.xMin*=t,this.yMin*=t,this.zMin*=t,this.xMax*=t,this.yMax*=t,this.zMax*=t},scaleCenter:function(t){var e=.5*(this.xMax-this.xMin)*t,i=.5*(this.yMax-this.yMin)*t,n=.5*(this.zMax-this.zMin)*t,s=.5*(this.xMax+this.xMin),r=.5*(this.yMax+this.yMin),a=.5*(this.zMax+this.zMin);this.xMin=s-e,this.yMin=r-i,this.zMin=a-n,this.xMax=s+e,this.yMax=r+i,this.zMax=a+n},getMin:function(){return new _e(this.xMin,this.yMin,this.zMin)},getCenter:function(){return new _e(.5*(this.xMin+this.xMax),.5*(this.yMin+this.yMax),.5*(this.zMin+this.zMax))},getSize:function(){return new _e(this.xMax-this.xMin,this.yMax-this.yMin,this.zMax-this.zMin)},getMax:function(){return new _e(this.xMax,this.yMax,this.zMax)},getVolume:function(){return(this.xMax-this.xMin)*(this.yMax-this.yMin)*(this.zMax-this.zMin)},get_xSize:function(){return this.xMax-this.xMin},get_ySize:function(){return this.yMax-this.yMin},get_zSize:function(){return this.zMax-this.zMin},set_xSize:function(t){return this.xMax=this.xMin+t,t},set_ySize:function(t){return this.yMax=this.yMin+t,t},set_zSize:function(t){return this.zMax=this.zMin+t,t},isEmpty:function(){return this.xMax<this.xMin||this.yMax<this.yMin||this.zMax<this.zMin},empty:function(){this.xMin=1e20,this.xMax=-1e20,this.yMin=1e20,this.yMax=-1e20,this.zMin=1e20,this.zMax=-1e20},all:function(){this.xMin=-1e20,this.xMax=1e20,this.yMin=-1e20,this.yMax=1e20,this.zMin=-1e20,this.zMax=1e20},clone:function(){var t=new se;return t.xMin=this.xMin,t.xMax=this.xMax,t.yMin=this.yMin,t.yMax=this.yMax,t.zMin=this.zMin,t.zMax=this.zMax,t},toString:function(){return"Bounds{"+x.string(new _e(this.xMin,this.yMin,this.zMin))+","+x.string(new _e(this.xMax-this.xMin,this.yMax-this.yMin,this.zMax-this.zMin))+"}"},toSphere:function(){var t=this.xMax-this.xMin,e=this.yMax-this.yMin,i=this.zMax-this.zMin;return new pe(.5*(this.xMin+this.xMax),.5*(this.yMin+this.yMax),.5*(this.zMin+this.zMax),.5*Math.sqrt(t*t+e*e+i*i))},__class__:se};var re=function(t,e){this.a=t,this.b=e};i["h3d.col.OptimizedCollider"]=re,re.__name__="h3d.col.OptimizedCollider",re.__interfaces__=[ne,dt],re.prototype={rayIntersection:function(t,e){return this.a.rayIntersection(t,e)<0?-1:this.b.rayIntersection(t,e)},contains:function(t){return!!this.a.contains(t)&&this.b.contains(t)},inFrustum:function(t,e){return!!this.a.inFrustum(t,e)&&this.b.inFrustum(t,e)},inSphere:function(t){return!!this.a.inSphere(t)&&this.b.inSphere(t)},__class__:re};var ae=function(t){this.colliders=t};i["h3d.col.GroupCollider"]=ae,ae.__name__="h3d.col.GroupCollider",ae.__interfaces__=[ne],ae.prototype={rayIntersection:function(t,e){for(var i=-1,n=0,s=this.colliders;n<s.length;){var r=s[n];++n;var a=r.rayIntersection(t,e);if(a>=0){if(!e)return a;(i<0||a<i)&&(i=a)}}return i},contains:function(t){for(var e=0,i=this.colliders;e<i.length;){var n=i[e];if(++e,n.contains(t))return!0}return!1},inFrustum:function(t,e){for(var i=0,n=this.colliders;i<n.length;){var s=n[i];if(++i,s.inFrustum(t,e))return!0}return!1},inSphere:function(t){for(var e=0,i=this.colliders;e<i.length;){var n=i[e];if(++e,n.inSphere(t))return!0}return!1},__class__:ae};var Ae=function(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i};i["h3d.col.FPoint"]=Ae,Ae.__name__="h3d.col.FPoint",Ae.prototype={sub:function(t){return new Ae(this.x-t.x,this.y-t.y,this.z-t.z)},add:function(t){return new Ae(this.x+t.x,this.y+t.y,this.z+t.z)},cross:function(t){return new Ae(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},toString:function(){return"FPoint{"+Es.fmt(this.x)+","+Es.fmt(this.y)+","+Es.fmt(this.z)+"}"},__class__:Ae};var he=function(t){this.checkNearFar=!0,this.pleft=new ue(1,0,0,0),this.pright=new ue(1,0,0,0),this.ptop=new ue(1,0,0,0),this.pbottom=new ue(1,0,0,0),this.pnear=new ue(1,0,0,0),this.pfar=new ue(1,0,0,0),null!=t&&this.loadMatrix(t)};i["h3d.col.Frustum"]=he,he.__name__="h3d.col.Frustum",he.prototype={clone:function(){var t=new he,e=t.pleft,i=this.pleft;e.nx=i.nx,e.ny=i.ny,e.nz=i.nz,e.d=i.d;e=t.pright,i=this.pright;e.nx=i.nx,e.ny=i.ny,e.nz=i.nz,e.d=i.d;e=t.ptop,i=this.ptop;e.nx=i.nx,e.ny=i.ny,e.nz=i.nz,e.d=i.d;e=t.pbottom,i=this.pbottom;e.nx=i.nx,e.ny=i.ny,e.nz=i.nz,e.d=i.d;e=t.pnear,i=this.pnear;e.nx=i.nx,e.ny=i.ny,e.nz=i.nz,e.d=i.d;e=t.pfar,i=this.pfar;return e.nx=i.nx,e.ny=i.ny,e.nz=i.nz,e.d=i.d,t.checkNearFar=this.checkNearFar,t},loadMatrix:function(t){var e=this.pleft,i=t._14+t._11,n=t._24+t._21,s=t._34+t._31,r=-(t._44+t._41);e.nx=i,e.ny=n,e.nz=s,e.d=r;e=this.pright,i=t._14-t._11,n=t._24-t._21,s=t._34-t._31,r=t._41-t._44;e.nx=i,e.ny=n,e.nz=s,e.d=r;e=this.ptop,i=t._14-t._12,n=t._24-t._22,s=t._34-t._32,r=t._42-t._44;e.nx=i,e.ny=n,e.nz=s,e.d=r;e=this.pbottom,i=t._14+t._12,n=t._24+t._22,s=t._34+t._32,r=-(t._44+t._42);e.nx=i,e.ny=n,e.nz=s,e.d=r;e=this.pnear,i=t._13,n=t._23,s=t._33,r=-t._43;e.nx=i,e.ny=n,e.nz=s,e.d=r;e=this.pfar,i=t._14-t._13,n=t._24-t._23,s=t._34-t._33,r=t._43-t._44;e.nx=i,e.ny=n,e.nz=s,e.d=r;e=this.pleft;var a=1/Math.sqrt(e.nx*e.nx+e.ny*e.ny+e.nz*e.nz);e.nx*=a,e.ny*=a,e.nz*=a,e.d*=a;e=this.pright,a=1/Math.sqrt(e.nx*e.nx+e.ny*e.ny+e.nz*e.nz);e.nx*=a,e.ny*=a,e.nz*=a,e.d*=a;e=this.ptop,a=1/Math.sqrt(e.nx*e.nx+e.ny*e.ny+e.nz*e.nz);e.nx*=a,e.ny*=a,e.nz*=a,e.d*=a;e=this.pbottom,a=1/Math.sqrt(e.nx*e.nx+e.ny*e.ny+e.nz*e.nz);e.nx*=a,e.ny*=a,e.nz*=a,e.d*=a;e=this.pnear,a=1/Math.sqrt(e.nx*e.nx+e.ny*e.ny+e.nz*e.nz);e.nx*=a,e.ny*=a,e.nz*=a,e.d*=a;e=this.pfar,a=1/Math.sqrt(e.nx*e.nx+e.ny*e.ny+e.nz*e.nz);e.nx*=a,e.ny*=a,e.nz*=a,e.d*=a},transform:function(t){var e=new Gt;e.initInverse(t),e.transpose();var i=(d=this.pleft).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);var r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;i=(d=this.pright).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;i=(d=this.ptop).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;i=(d=this.pbottom).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;i=(d=this.pfar).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;var _;i=(d=this.pnear).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);var c;r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;var d=this.pleft,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f;d=this.pright,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f;d=this.ptop,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f;d=this.pbottom,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f;d=this.pnear,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f;d=this.pfar,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f},transform3x3:function(t){var e=new Gt;e.initInverse3x3(t),e.transpose();var i=(d=this.pleft).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);var r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;i=(d=this.pright).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;i=(d=this.ptop).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;i=(d=this.pbottom).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;i=(d=this.pfar).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;var _;i=(d=this.pnear).nx,n=d.ny,s=d.nz;null==(_=-d.d)&&(_=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);var c;r=n,a=s,A=_,h=(c=i)*e._11+r*e._21+a*e._31+A*e._41,o=c*e._12+r*e._22+a*e._32+A*e._42,l=c*e._13+r*e._23+a*e._33+A*e._43,u=c*e._14+r*e._24+a*e._34+A*e._44;c=h,r=o,a=l,A=u,d.nx=c,d.ny=r,d.nz=a,d.d=-A;var d=this.pleft,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f;d=this.pright,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f;d=this.ptop,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f;d=this.pbottom,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f;d=this.pnear,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f;d=this.pfar,f=1/Math.sqrt(d.nx*d.nx+d.ny*d.ny+d.nz*d.nz);d.nx*=f,d.ny*=f,d.nz*=f,d.d*=f},hasPoint:function(t){if((e=this.pleft).nx*t.x+e.ny*t.y+e.nz*t.z-e.d<0)return!1;if((e=this.pright).nx*t.x+e.ny*t.y+e.nz*t.z-e.d<0)return!1;if((e=this.ptop).nx*t.x+e.ny*t.y+e.nz*t.z-e.d<0)return!1;if((e=this.pbottom).nx*t.x+e.ny*t.y+e.nz*t.z-e.d<0)return!1;if(this.checkNearFar){var e;if((e=this.pnear).nx*t.x+e.ny*t.y+e.nz*t.z-e.d<0)return!1;if((e=this.pfar).nx*t.x+e.ny*t.y+e.nz*t.z-e.d<0)return!1}return!0},hasSphere:function(t){var e=t.x,i=t.y,n=t.z;null==n&&(n=0),null==i&&(i=0),null==e&&(e=0);var s=e,r=i,a=n;if((A=this.pleft).nx*s+A.ny*r+A.nz*a-A.d<-t.r)return!1;if((A=this.pright).nx*s+A.ny*r+A.nz*a-A.d<-t.r)return!1;if((A=this.ptop).nx*s+A.ny*r+A.nz*a-A.d<-t.r)return!1;if((A=this.pbottom).nx*s+A.ny*r+A.nz*a-A.d<-t.r)return!1;if(this.checkNearFar){var A;if((A=this.pnear).nx*s+A.ny*r+A.nz*a-A.d<-t.r)return!1;if((A=this.pfar).nx*s+A.ny*r+A.nz*a-A.d<-t.r)return!1}return!0},hasBounds:function(t){var e=(r=this.pleft).nx,i=r.ny,n=r.nz,s=e*(t.xMax+t.xMin)+i*(t.yMax+t.yMin)+n*(t.zMax+t.zMin);if(e<0&&(e=-e),i<0&&(i=-i),n<0&&(n=-n),s+(e*(t.xMax-t.xMin)+i*(t.yMax-t.yMin)+n*(t.zMax-t.zMin))-2*r.d<0)return!1;e=(r=this.pright).nx,i=r.ny,n=r.nz,s=e*(t.xMax+t.xMin)+i*(t.yMax+t.yMin)+n*(t.zMax+t.zMin);if(e<0&&(e=-e),i<0&&(i=-i),n<0&&(n=-n),s+(e*(t.xMax-t.xMin)+i*(t.yMax-t.yMin)+n*(t.zMax-t.zMin))-2*r.d<0)return!1;e=(r=this.ptop).nx,i=r.ny,n=r.nz,s=e*(t.xMax+t.xMin)+i*(t.yMax+t.yMin)+n*(t.zMax+t.zMin);if(e<0&&(e=-e),i<0&&(i=-i),n<0&&(n=-n),s+(e*(t.xMax-t.xMin)+i*(t.yMax-t.yMin)+n*(t.zMax-t.zMin))-2*r.d<0)return!1;e=(r=this.ptop).nx,i=r.ny,n=r.nz,s=e*(t.xMax+t.xMin)+i*(t.yMax+t.yMin)+n*(t.zMax+t.zMin);if(e<0&&(e=-e),i<0&&(i=-i),n<0&&(n=-n),s+(e*(t.xMax-t.xMin)+i*(t.yMax-t.yMin)+n*(t.zMax-t.zMin))-2*r.d<0)return!1;e=(r=this.pnear).nx,i=r.ny,n=r.nz,s=e*(t.xMax+t.xMin)+i*(t.yMax+t.yMin)+n*(t.zMax+t.zMin);if(e<0&&(e=-e),i<0&&(i=-i),n<0&&(n=-n),s+(e*(t.xMax-t.xMin)+i*(t.yMax-t.yMin)+n*(t.zMax-t.zMin))-2*r.d<0)return!1;var r;e=(r=this.pfar).nx,i=r.ny,n=r.nz,s=e*(t.xMax+t.xMin)+i*(t.yMax+t.yMin)+n*(t.zMax+t.zMin);return e<0&&(e=-e),i<0&&(i=-i),n<0&&(n=-n),!(s+(e*(t.xMax-t.xMin)+i*(t.yMax-t.yMin)+n*(t.zMax-t.zMin))-2*r.d<0)},__class__:he};var oe=function(){};i["h3d.col.Ray"]=oe,oe.__name__="h3d.col.Ray",oe.fromPoints=function(t,e){var i=new oe;return i.px=t.x,i.py=t.y,i.pz=t.z,i.lx=e.x-t.x,i.ly=e.y-t.y,i.lz=e.z-t.z,i.normalize(),i},oe.fromValues=function(t,e,i,n,s,r){var a=new oe;return a.px=t,a.py=e,a.pz=i,a.lx=n,a.ly=s,a.lz=r,a.normalize(),a},oe.prototype={clone:function(){var t=new oe;return t.px=this.px,t.py=this.py,t.pz=this.pz,t.lx=this.lx,t.ly=this.ly,t.lz=this.lz,t},load:function(t){this.px=t.px,this.py=t.py,this.pz=t.pz,this.lx=t.lx,this.ly=t.ly,this.lz=t.lz},normalize:function(){var t=this.lx*this.lx+this.ly*this.ly+this.lz*this.lz;1!=t&&(t=t<1e-10?0:1/Math.sqrt(t),this.lx*=t,this.ly*=t,this.lz*=t)},transform:function(t){var e=this.px,i=this.py;null==(o=this.pz)&&(o=0),null==i&&(i=0),null==e&&(e=0);var n=e,s=i,r=o,a=n*t._11+s*t._21+r*t._31+1*t._41,A=n*t._12+s*t._22+r*t._32+1*t._42,h=n*t._13+s*t._23+r*t._33+1*t._43;n=a,s=A,r=h,this.px=n,this.py=s,this.pz=r;var o;e=this.lx,i=this.ly;null==(o=this.lz)&&(o=0),null==i&&(i=0),null==e&&(e=0);var l=e,u=i,_=o;a=l*t._11+u*t._21+_*t._31,A=l*t._12+u*t._22+_*t._32,h=l*t._13+u*t._23+_*t._33;l=a,u=A,_=h,this.lx=l,this.ly=u,this.lz=_,this.normalize()},getPos:function(){return new _e(this.px,this.py,this.pz)},getDir:function(){return new _e(this.lx,this.ly,this.lz)},getPoint:function(t){return new _e(this.px+t*this.lx,this.py+t*this.ly,this.pz+t*this.lz)},toString:function(){return"Ray{"+x.string(new _e(this.px,this.py,this.pz))+","+x.string(new _e(this.lx,this.ly,this.lz))+"}"},intersect:function(t){var e=this.lx*t.nx+this.ly*t.ny+this.lz*t.nz,i=t.d-(this.px*t.nx+this.py*t.ny+this.pz*t.nz);if((e<0?-e:e)<1e-10)return(i<0?-i:i)<1e-10?new _e(this.px,this.py,this.pz):null;var n=i/e;return new _e(this.px+this.lx*n,this.py+this.ly*n,this.pz+this.lz*n)},collideFrustum:function(t){var e=this.px,i=this.py;null==(l=this.pz)&&(l=0),null==i&&(i=0),null==e&&(e=0);var n=e,s=i,r=l,a=1,A=n*t._11+s*t._21+r*t._31+a*t._41,h=n*t._12+s*t._22+r*t._32+a*t._42,o=n*t._13+s*t._23+r*t._33+a*t._43;n=A*(f=1/(n*t._14+s*t._24+r*t._34+a*t._44)),s=h*f,r=o*f,a=1;var l;e=this.px+this.lx,i=this.py+this.ly;null==(l=this.pz+this.lz)&&(l=0),null==i&&(i=0),null==e&&(e=0);var u=e,_=i,c=l,d=1,f=(A=u*t._11+_*t._21+c*t._31+d*t._41,h=u*t._12+_*t._22+c*t._32+d*t._42,o=u*t._13+_*t._23+c*t._33+d*t._43,1/(u*t._14+_*t._24+c*t._34+d*t._44));d=1;var x,p,g,m=1/((u=A*f)-n),v=1/((_=h*f)-s),y=1/((c=o*f)-r),b=(-1-n)*m,w=(1-n)*m,M=(-1-s)*v,B=(1-s)*v,C=(0-r)*y,S=(1-r)*y,I=(p=(x=b>w?w:b)<(g=M>B?B:M)?g:x)<(g=C>S?S:C)?g:p,k=(p=(x=b<w?w:b)>(g=M<B?B:M)?g:x)>(g=C<S?S:C)?g:p;return!(k<0||I>k)},collide:function(t){var e,i,n=1/this.lx,s=1/this.ly,r=1/this.lz,a=(t.xMin-this.px)*n,A=(t.xMax-this.px)*n,h=(t.yMin-this.py)*s,o=(t.yMax-this.py)*s,l=(t.zMin-this.pz)*r,u=(t.zMax-this.pz)*r,_=(i=(e=a>A?A:a)<(t=h>o?o:h)?t:e)<(t=l>u?u:l)?t:i,c=(i=(e=a<A?A:a)>(t=h<o?o:h)?t:e)>(t=l<u?u:l)?t:i;return!(c<0)&&!(_>c)},__class__:oe};var le=function(t,e){this.obj=t,this.collider=e};i["h3d.col.ObjectCollider"]=le,le.__name__="h3d.col.ObjectCollider",le.__interfaces__=[dt,ne],le.prototype={rayIntersection:function(t,e){var i=le.TMP_RAY;le.TMP_RAY=null,i.px=t.px,i.py=t.py,i.pz=t.pz,i.lx=t.lx,i.ly=t.ly,i.lz=t.lz;var n=this.obj.getInvPos(),s=t.px,r=t.py;null==(x=t.pz)&&(x=0),null==r&&(r=0),null==s&&(s=0);var a=s,A=r,h=x,o=a*n._11+A*n._21+h*n._31+1*n._41,l=a*n._12+A*n._22+h*n._32+1*n._42,u=a*n._13+A*n._23+h*n._33+1*n._43;a=o,A=l,h=u,t.px=a,t.py=A,t.pz=h;s=t.lx,r=t.ly;null==(x=t.lz)&&(x=0),null==r&&(r=0),null==s&&(s=0);var _=s,c=r,d=x;o=_*n._11+c*n._21+d*n._31,l=_*n._12+c*n._22+d*n._32,u=_*n._13+c*n._23+d*n._33;_=o,c=l,d=u,t.lx=_,t.ly=c,t.lz=d,t.normalize();var f=this.collider.rayIntersection(t,e);if(f<0)return t.px=i.px,t.py=i.py,t.pz=i.pz,t.lx=i.lx,t.ly=i.ly,t.lz=i.lz,le.TMP_RAY=i,f;var x;s=t.px+f*t.lx,r=t.py+f*t.ly;null==(x=t.pz+f*t.lz)&&(x=0),null==r&&(r=0),null==s&&(s=0);var p=s,g=r,m=x;o=p*(n=this.obj.absPos)._11+g*n._21+m*n._31+n._41,l=p*n._12+g*n._22+m*n._32+n._42,u=p*n._13+g*n._23+m*n._33+n._43;p=o,g=l,m=u,t.px=i.px,t.py=i.py,t.pz=i.pz,t.lx=i.lx,t.ly=i.ly,t.lz=i.lz,le.TMP_RAY=i;var v=p-t.px,y=g-t.py,b=m-t.pz;null==b&&(b=0);var w=b;return null==w&&(w=0),Math.sqrt(v*v+y*y+w*w)},contains:function(t){var e=t.x,i=t.y,n=t.z;null==n&&(n=0),null==i&&(i=0),null==e&&(e=0);var s=e,r=i,a=n,A=this.obj.getInvPos(),h=t.x*A._11+t.y*A._21+t.z*A._31+A._41,o=t.x*A._12+t.y*A._22+t.z*A._32+A._42,l=t.x*A._13+t.y*A._23+t.z*A._33+A._43;t.x=h,t.y=o,t.z=l;var u=this.collider.contains(t);return t.x=s,t.y=r,t.z=a,u},inFrustum:function(t,e){if(null==e)return this.collider.inFrustum(t,this.obj.getAbsPos());var i=le.TMP_MAT,n=this.obj.getAbsPos(),s=e._11,r=e._12,a=e._13,A=e._21,h=e._22,o=e._23,l=e._31,u=e._32,_=e._33,c=e._41,d=e._42,f=e._43,x=n._11,p=n._12,g=n._13,m=n._21,v=n._22,y=n._23,b=n._31,w=n._32,M=n._33,B=n._41,C=n._42,S=n._43;return i._11=s*x+r*m+a*b,i._12=s*p+r*v+a*w,i._13=s*g+r*y+a*M,i._14=0,i._21=A*x+h*m+o*b,i._22=A*p+h*v+o*w,i._23=A*g+h*y+o*M,i._24=0,i._31=l*x+u*m+_*b,i._32=l*p+u*v+_*w,i._33=l*g+u*y+_*M,i._34=0,i._41=c*x+d*m+f*b+B,i._42=c*p+d*v+f*w+C,i._43=c*g+d*y+f*M+S,i._44=1,this.collider.inFrustum(t,i)},inSphere:function(t){var e=this.obj.getInvPos(),i=t.x,n=t.y,s=t.z,r=t.r,a=t.x,A=t.y,h=t.z;null==h&&(h=0),null==A&&(A=0),null==a&&(a=0);var o=a,l=A,u=h,_=o*e._11+l*e._21+u*e._31+e._41,c=o*e._12+l*e._22+u*e._32+e._42,d=o*e._13+l*e._23+u*e._33+e._43;o=_,l=c,u=d;var f=null;null==f&&(f=new Yt),f.x=Math.sqrt(e._11*e._11+e._12*e._12+e._13*e._13),f.y=Math.sqrt(e._21*e._21+e._22*e._22+e._23*e._23),f.z=Math.sqrt(e._31*e._31+e._32*e._32+e._33*e._33),e._11*(e._22*e._33-e._23*e._32)+e._12*(e._23*e._31-e._21*e._33)+e._13*(e._21*e._32-e._22*e._31)<0&&(f.x*=-1,f.y*=-1,f.z*=-1);var x=f;t.x=o,t.y=l,t.z=u,t.r*=Math.max(Math.max(x.x,x.y),x.z);var p=this.collider.inSphere(t);return t.x=i,t.y=n,t.z=s,t.r=r,p},__class__:le};var ue=function(t,e,i,n){this.nx=t,this.ny=e,this.nz=i,this.d=n};i["h3d.col.Plane"]=ue,ue.__name__="h3d.col.Plane",ue.fromPoints=function(t,e,i){var n=e.x-t.x,s=e.y-t.y;null==(h=e.z-t.z)&&(h=0),null==s&&(s=0),null==n&&(n=0);var r=n,a=s,A=h;n=i.x-t.x,s=i.y-t.y;null==(h=i.z-t.z)&&(h=0),null==s&&(s=0),null==n&&(n=0);var h,o=s,l=h;null==(h=r*o-a*n)&&(h=0),null==(s=A*n-r*l)&&(s=0),null==(n=a*l-A*o)&&(n=0);var u=s,_=h;return new ue(n,u,_,n*t.x+u*t.y+_*t.z)},ue.fromNormalPoint=function(t,e){return new ue(t.x,t.y,t.z,t.x*e.x+t.y*e.y+t.z*e.z)},ue.X=function(t){return null==t&&(t=0),new ue(1,0,0,t)},ue.Y=function(t){return null==t&&(t=0),new ue(0,1,0,t)},ue.Z=function(t){return null==t&&(t=0),new ue(0,0,1,t)},ue.frustumLeft=function(t){return new ue(t._14+t._11,t._24+t._21,t._34+t._31,-(t._44+t._41))},ue.frustumRight=function(t){return new ue(t._14-t._11,t._24-t._21,t._34-t._31,t._41-t._44)},ue.frustumBottom=function(t){return new ue(t._14+t._12,t._24+t._22,t._34+t._32,-(t._44+t._42))},ue.frustumTop=function(t){return new ue(t._14-t._12,t._24-t._22,t._34-t._32,t._42-t._44)},ue.frustumNear=function(t){return new ue(t._13,t._23,t._33,-t._43)},ue.frustumFar=function(t){return new ue(t._14-t._13,t._24-t._23,t._34-t._33,t._43-t._44)},ue.prototype={getNormal:function(){return new _e(this.nx,this.ny,this.nz)},getNormalDistance:function(){return this.d},load:function(t){this.nx=t.nx,this.ny=t.ny,this.nz=t.nz,this.d=t.d},transform:function(t){var e=new Gt;e.initInverse(t),e.transpose();var i=this.nx,n=this.ny,s=this.nz,r=-this.d;null==r&&(r=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);var a=i,A=n,h=s,o=r,l=a*e._11+A*e._21+h*e._31+o*e._41,u=a*e._12+A*e._22+h*e._32+o*e._42,_=a*e._13+A*e._23+h*e._33+o*e._43,c=a*e._14+A*e._24+h*e._34+o*e._44;a=l,A=u,h=_,o=c,this.nx=a,this.ny=A,this.nz=h,this.d=-o},transform3x3:function(t){var e=new Gt;e.initInverse3x3(t),e.transpose();var i=this.nx,n=this.ny,s=this.nz,r=-this.d;null==r&&(r=1),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);var a=i,A=n,h=s,o=r,l=a*e._11+A*e._21+h*e._31+o*e._41,u=a*e._12+A*e._22+h*e._32+o*e._42,_=a*e._13+A*e._23+h*e._33+o*e._43,c=a*e._14+A*e._24+h*e._34+o*e._44;a=l,A=u,h=_,o=c,this.nx=a,this.ny=A,this.nz=h,this.d=-o},transformInverseTranspose:function(t){var e=this.nx,i=this.ny,n=this.nz,s=-this.d;null==s&&(s=1),null==n&&(n=0),null==i&&(i=0),null==e&&(e=0);var r=e,a=i,A=n,h=s,o=r*t._11+a*t._21+A*t._31+h*t._41,l=r*t._12+a*t._22+A*t._32+h*t._42,u=r*t._13+a*t._23+A*t._33+h*t._43,_=r*t._14+a*t._24+A*t._34+h*t._44;r=o,a=l,A=u,h=_,this.nx=r,this.ny=a,this.nz=A,this.d=-h},normalize:function(){var t=1/Math.sqrt(this.nx*this.nx+this.ny*this.ny+this.nz*this.nz);this.nx*=t,this.ny*=t,this.nz*=t,this.d*=t},toString:function(){return"Plane{"+x.string(new _e(this.nx,this.ny,this.nz))+","+Es.fmt(this.d)+"}"},distance:function(t){return this.nx*t.x+this.ny*t.y+this.nz*t.z-this.d},side:function(t){return this.nx*t.x+this.ny*t.y+this.nz*t.z-this.d>=0},project:function(t){var e=this.nx*t.x+this.ny*t.y+this.nz*t.z-this.d;return new _e(t.x-e*this.nx,t.y-e*this.ny,t.z-e*this.nz)},projectTo:function(t,e){var i=this.nx*t.x+this.ny*t.y+this.nz*t.z-this.d;e.x=t.x-i*this.nx,e.y=t.y-i*this.ny,e.z=t.z-i*this.nz},__class__:ue};var _e=function(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i};i["h3d.col.Point"]=_e,_e.__name__="h3d.col.Point",_e.prototype={scale:function(t){this.x*=t,this.y*=t,this.z*=t},set:function(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i},sub:function(t){return new _e(this.x-t.x,this.y-t.y,this.z-t.z)},add:function(t){return new _e(this.x+t.x,this.y+t.y,this.z+t.z)},multiply:function(t){return new _e(this.x*t,this.y*t,this.z*t)},cross:function(t){return new _e(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},equals:function(t){return this.x==t.x&&this.y==t.y&&this.z==t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return e*e+i*i+n*n},distance:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return Math.sqrt(e*e+i*i+n*n)},normalize:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z;t=t<1e-10?0:1/Math.sqrt(t),this.x*=t,this.y*=t,this.z*=t},normalized:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z;return t=t<1e-10?0:1/Math.sqrt(t),new _e(this.x*t,this.y*t,this.z*t)},lerp:function(t,e,i){var n,s=(n=t.x)+i*(e.x-n),r=(n=t.y)+i*(e.y-n),a=(n=t.z)+i*(e.z-n);this.x=s,this.y=r,this.z=a},transform:function(t){var e=this.x*t._11+this.y*t._21+this.z*t._31+t._41,i=this.x*t._12+this.y*t._22+this.z*t._32+t._42,n=this.x*t._13+this.y*t._23+this.z*t._33+t._43;this.x=e,this.y=i,this.z=n},transformed:function(t){var e=this.x*t._11+this.y*t._21+this.z*t._31+t._41,i=this.x*t._12+this.y*t._22+this.z*t._32+t._42,n=this.x*t._13+this.y*t._23+this.z*t._33+t._43;return new _e(e,i,n)},transform3x3:function(t){var e=this.x*t._11+this.y*t._21+this.z*t._31,i=this.x*t._12+this.y*t._22+this.z*t._32,n=this.x*t._13+this.y*t._23+this.z*t._33;this.x=e,this.y=i,this.z=n},transformed3x3:function(t){var e=this.x*t._11+this.y*t._21+this.z*t._31,i=this.x*t._12+this.y*t._22+this.z*t._32,n=this.x*t._13+this.y*t._23+this.z*t._33;return new _e(e,i,n)},clone:function(){return new _e(this.x,this.y,this.z)},load:function(t){this.x=t.x,this.y=t.y,this.z=t.z},toString:function(){return"Point{"+Es.fmt(this.x)+","+Es.fmt(this.y)+","+Es.fmt(this.z)+"}"},inFrustum:function(t,e){return t.hasPoint(this)},toVector:function(){return new Yt(this.x,this.y,this.z)},__class__:_e};var ce=function(){this.next=null};i["h3d.col.TriPlane"]=ce,ce.__name__="h3d.col.TriPlane",ce.__interfaces__=[ne],ce.prototype={init:function(t,e,i){this.p0x=t.x,this.p0y=t.y,this.p0z=t.z;var n=e.x-t.x,s=e.y-t.y;null==(h=e.z-t.z)&&(h=0),null==s&&(s=0),null==n&&(n=0);var r=n,a=s,A=h;n=i.x-t.x,s=i.y-t.y;null==(h=i.z-t.z)&&(h=0),null==s&&(s=0),null==n&&(n=0);var h,o=n,l=s,u=h;null==(h=r*l-a*o)&&(h=0),null==(s=A*o-r*u)&&(s=0),null==(n=a*u-A*l)&&(n=0);var _=n,c=s,d=h;this.d=_*t.x+c*t.y+d*t.z,this.nx=_,this.ny=c,this.nz=d,this.d1x=r,this.d1y=a,this.d1z=A,this.d2x=o,this.d2y=l,this.d2z=u,this.dot00=r*r+a*a+A*A,this.dot01=r*o+a*l+A*u,this.dot11=o*o+l*l+u*u,this.invDenom=1/(this.dot00*this.dot11-this.dot01*this.dot01)},clone:function(){var t=new ce;return t.p0x=this.p0x,t.p0y=this.p0y,t.p0z=this.p0z,t.d1x=this.d1x,t.d1y=this.d1y,t.d1z=this.d1z,t.d2x=this.d2x,t.d2y=this.d2y,t.d2z=this.d2z,t.dot00=this.dot00,t.dot01=this.dot01,t.dot11=this.dot11,t.invDenom=this.invDenom,t.nx=this.nx,t.ny=this.ny,t.nz=this.nz,t.d=this.d,null!=this.next&&(t.next=this.next.clone()),t},load:function(t){this.p0x=t.p0x,this.p0y=t.p0y,this.p0z=t.p0z,this.d1x=t.d1x,this.d1y=t.d1y,this.d1z=t.d1z,this.d2x=t.d2x,this.d2y=t.d2y,this.d2z=t.d2z,this.dot00=t.dot00,this.dot01=t.dot01,this.dot11=t.dot11,this.invDenom=t.invDenom,this.nx=t.nx,this.ny=t.ny,this.nz=t.nz,this.d=t.d},transform:function(t){var e=this.p0x,i=this.p0y;null==(g=this.p0z)&&(g=0),null==i&&(i=0),null==e&&(e=0);var n=e,s=i,r=g;e=this.d1x+this.p0x,i=this.d1y+this.p0y;null==(g=this.d1z+this.p0z)&&(g=0),null==i&&(i=0),null==e&&(e=0);var a=e,A=i,h=g;e=this.d2x+this.p0x,i=this.d2y+this.p0y;null==(g=this.d2z+this.p0z)&&(g=0),null==i&&(i=0),null==e&&(e=0);var o=e,l=i,u=g,_=n*t._11+s*t._21+r*t._31+t._41,c=n*t._12+s*t._22+r*t._32+t._42,d=n*t._13+s*t._23+r*t._33+t._43;n=_,s=c,r=d;_=a*t._11+A*t._21+h*t._31+t._41,c=a*t._12+A*t._22+h*t._32+t._42,d=a*t._13+A*t._23+h*t._33+t._43;a=_,A=c,h=d;_=o*t._11+l*t._21+u*t._31+t._41,c=o*t._12+l*t._22+u*t._32+t._42,d=o*t._13+l*t._23+u*t._33+t._43;o=_,l=c,u=d,this.p0x=n,this.p0y=s,this.p0z=r,null==(g=h-r)&&(g=0),null==(i=A-s)&&(i=0),null==(e=a-n)&&(e=0);var f=e,x=i,p=g;null==(g=u-r)&&(g=0),null==(i=l-s)&&(i=0),null==(e=o-n)&&(e=0);var g,m=e,v=i,y=g;null==(g=f*v-x*m)&&(g=0),null==(i=p*m-f*y)&&(i=0),null==(e=x*y-p*v)&&(e=0);var b=e,w=i,M=g;this.d=b*n+w*s+M*r,this.nx=b,this.ny=w,this.nz=M,this.d1x=f,this.d1y=x,this.d1z=p,this.d2x=m,this.d2y=v,this.d2z=y,this.dot00=f*f+x*x+p*p,this.dot01=f*m+x*v+p*y,this.dot11=m*m+v*v+y*y,this.invDenom=1/(this.dot00*this.dot11-this.dot01*this.dot01)},contains:function(t){var e=t.x-this.p0x,i=t.y-this.p0y,n=t.z-this.p0z;null==n&&(n=0),null==i&&(i=0),null==e&&(e=0);var s=e,r=i,a=n,A=this.d1x*s+this.d1y*r+this.d1z*a,h=this.d2x*s+this.d2y*r+this.d2z*a,o=(this.dot11*A-this.dot01*h)*this.invDenom,l=(this.dot00*h-this.dot01*A)*this.invDenom;return o>=0&&l>=0&&o+l<1},side:function(t){return this.nx*t.x+this.ny*t.y+this.nz*t.z-this.d>=0},inFrustum:function(t,e){throw kn.thrown("Not implemented")},inSphere:function(t){throw kn.thrown("Not implemented")},rayIntersection:function(t,e){var i=t.lx*this.nx+t.ly*this.ny+t.lz*this.nz;if(i>=0)return-1;var n=(this.d-(t.px*this.nx+t.py*this.ny+t.pz*this.nz))/i;if(n<0)return-1;var s=t.px+t.lx*n,r=t.py+t.ly*n,a=t.pz+t.lz*n,A=s-this.p0x,h=r-this.p0y,o=a-this.p0z;null==o&&(o=0),null==h&&(h=0),null==A&&(A=0);var l=A,u=h,_=o,c=this.d1x*l+this.d1y*u+this.d1z*_,d=this.d2x*l+this.d2y*u+this.d2z*_,f=(this.dot11*c-this.dot01*d)*this.invDenom,x=(this.dot00*d-this.dot01*c)*this.invDenom;return f>=0&&x>=0&&f+x<1?n:-1},isPointInTriangle:function(t,e,i){var n=t-this.p0x,s=e-this.p0y,r=i-this.p0z;null==r&&(r=0),null==s&&(s=0),null==n&&(n=0);var a=n,A=s,h=r,o=this.d1x*a+this.d1y*A+this.d1z*h,l=this.d2x*a+this.d2y*A+this.d2z*h,u=(this.dot11*o-this.dot01*l)*this.invDenom,_=(this.dot00*l-this.dot01*o)*this.invDenom;return u>=0&&_>=0&&u+_<1},getPoints:function(){return[new _e(this.p0x,this.p0y,this.p0z),new _e(this.d1x+this.p0x,this.d1y+this.p0y,this.d1z+this.p0z),new _e(this.d2x+this.p0x,this.d2y+this.p0y,this.d2z+this.p0z)]},__class__:ce};var de=function(){};i["h3d.col.Polygon"]=de,de.__name__="h3d.col.Polygon",de.__interfaces__=[ne],de.fromPolygon2D=function(t,e){null==e&&(e=0);var i=new de;if(St.isConvex(t))for(var n=t[0],s=0,r=t.length-2;s<r;){var a=t[(B=s++)+1],A=t[B+2],h=new ce,o=n.x;null==(S=e)&&(S=0),null==(C=n.y)&&(C=0),null==o&&(o=0);var l=o,u=C,_=S,c=a.x;null==(k=e)&&(k=0),null==(I=a.y)&&(I=0),null==c&&(c=0);var d=c,f=I,x=k,p=A.x;null==(F=e)&&(F=0),null==(E=A.y)&&(E=0),null==p&&(p=0);var g=p,m=E,v=F;h.p0x=l,h.p0y=u,h.p0z=_,null==(P=x-_)&&(P=0),null==(D=f-u)&&(D=0),null==(T=d-l)&&(T=0),null==(U=v-_)&&(U=0),null==(Q=m-u)&&(Q=0),null==(V=g-l)&&(V=0),null==(j=(z=T)*(G=Q)-(R=D)*(O=V))&&(j=0),null==(X=(L=P)*O-z*(N=U))&&(X=0),null==(Y=R*N-L*G)&&(Y=0);var y=Y,b=X,w=j;h.d=y*l+b*u+w*_,h.nx=y,h.ny=b,h.nz=w,h.d1x=z,h.d1y=R,h.d1z=L,h.d2x=O,h.d2y=G,h.d2z=N,h.dot00=z*z+R*R+L*L,h.dot01=z*O+R*G+L*N,h.dot11=O*O+G*G+N*N,h.invDenom=1/(h.dot00*h.dot11-h.dot01*h.dot01),h.next=i.triPlanes,i.triPlanes=h}else{var M=St.fastTriangulate(t);for(s=0,r=M.length/3|0;s<r;){var B,C,S;n=t[M[3*(B=s++)]],a=t[M[3*B+1]],A=t[M[3*B+2]],h=new ce,o=n.x;null==(S=e)&&(S=0),null==(C=n.y)&&(C=0),null==o&&(o=0);var I,k;l=o,u=C,_=S,c=a.x;null==(k=e)&&(k=0),null==(I=a.y)&&(I=0),null==c&&(c=0);var E,F;d=c,f=I,x=k,p=A.x;null==(F=e)&&(F=0),null==(E=A.y)&&(E=0),null==p&&(p=0);var T,D,P,z,R,L,V,Q,U,O,G,N,Y,X,j;g=p,m=E,v=F;h.p0x=l,h.p0y=u,h.p0z=_,null==(P=x-_)&&(P=0),null==(D=f-u)&&(D=0),null==(T=d-l)&&(T=0),null==(U=v-_)&&(U=0),null==(Q=m-u)&&(Q=0),null==(V=g-l)&&(V=0),null==(j=(z=T)*(G=Q)-(R=D)*(O=V))&&(j=0),null==(X=(L=P)*O-z*(N=U))&&(X=0),null==(Y=R*N-L*G)&&(Y=0);y=Y,b=X,w=j;h.d=y*l+b*u+w*_,h.nx=y,h.ny=b,h.nz=w,h.d1x=z,h.d1y=R,h.d1z=L,h.d2x=O,h.d2y=G,h.d2z=N,h.dot00=z*z+R*R+L*L,h.dot01=z*O+R*G+L*N,h.dot11=O*O+G*G+N*N,h.invDenom=1/(h.dot00*h.dot11-h.dot01*h.dot01),h.next=i.triPlanes,i.triPlanes=h}}return i},de.prototype={addBuffers:function(t,e,i){null==i&&(i=3);for(var n=0,s=e.length/3|0;n<s;){var r=3*n++,a=new ce,A=e[r]*i,h=e[r+1]*i,o=e[r+2]*i,l=t[A],u=t[A+1],_=t[A+2];null==_&&(_=0),null==u&&(u=0),null==l&&(l=0);var c=l,d=u,f=_,x=t[h],p=t[h+1],g=t[h+2];null==g&&(g=0),null==p&&(p=0),null==x&&(x=0);var m=x,v=p,y=g,b=t[o],w=t[o+1],M=t[o+2];null==M&&(M=0),null==w&&(w=0),null==b&&(b=0);var B=b,C=w,S=M;a.p0x=c,a.p0y=d,a.p0z=f;var I=m-c,k=v-d,E=y-f;null==E&&(E=0),null==k&&(k=0),null==I&&(I=0);var F=I,T=k,D=E,P=B-c,z=C-d,R=S-f;null==R&&(R=0),null==z&&(z=0),null==P&&(P=0);var L=P,V=z,Q=R,U=T*Q-D*V,O=D*L-F*Q,G=F*V-T*L;null==G&&(G=0),null==O&&(O=0),null==U&&(U=0);var N=U,Y=O,X=G;a.d=N*c+Y*d+X*f,a.nx=N,a.ny=Y,a.nz=X,a.d1x=F,a.d1y=T,a.d1z=D,a.d2x=L,a.d2y=V,a.d2z=Q,a.dot00=F*F+T*T+D*D,a.dot01=F*L+T*V+D*Q,a.dot11=L*L+V*V+Q*Q,a.invDenom=1/(a.dot00*a.dot11-a.dot01*a.dot01),a.next=this.triPlanes,this.triPlanes=a}},isConvex:function(){return!0},clone:function(){var t=new de;t.triPlanes=new ce;var e=this.triPlanes,i=new ce;if(i.p0x=e.p0x,i.p0y=e.p0y,i.p0z=e.p0z,i.d1x=e.d1x,i.d1y=e.d1y,i.d1z=e.d1z,i.d2x=e.d2x,i.d2y=e.d2y,i.d2z=e.d2z,i.dot00=e.dot00,i.dot01=e.dot01,i.dot11=e.dot11,i.invDenom=e.invDenom,i.nx=e.nx,i.ny=e.ny,i.nz=e.nz,i.d=e.d,null!=e.next){var n=e.next,s=new ce;s.p0x=n.p0x,s.p0y=n.p0y,s.p0z=n.p0z,s.d1x=n.d1x,s.d1y=n.d1y,s.d1z=n.d1z,s.d2x=n.d2x,s.d2y=n.d2y,s.d2z=n.d2z,s.dot00=n.dot00,s.dot01=n.dot01,s.dot11=n.dot11,s.invDenom=n.invDenom,s.nx=n.nx,s.ny=n.ny,s.nz=n.nz,s.d=n.d,null!=n.next&&(s.next=n.next.clone()),i.next=s}return t.triPlanes=i,t},transform:function(t){for(var e=this.triPlanes;null!=e;)e.transform(t),e=e.next},getPoints:function(){for(var t=[],e=this.triPlanes;null!=e;)t=t.concat(e.getPoints()),e=e.next;return t},getBounds:function(t){null==t&&(t=new se),t.xMin=1e20,t.xMax=-1e20,t.yMin=1e20,t.yMax=-1e20,t.zMin=1e20,t.zMax=-1e20;for(var e=this.triPlanes;null!=e;){var i=e.p0x,n=e.p0y,s=e.p0z;i<t.xMin&&(t.xMin=i),i>t.xMax&&(t.xMax=i),n<t.yMin&&(t.yMin=n),n>t.yMax&&(t.yMax=n),s<t.zMin&&(t.zMin=s),s>t.zMax&&(t.zMax=s);var r=e.d1x+e.p0x,a=e.d1y+e.p0y,A=e.d1z+e.p0z;r<t.xMin&&(t.xMin=r),r>t.xMax&&(t.xMax=r),a<t.yMin&&(t.yMin=a),a>t.yMax&&(t.yMax=a),A<t.zMin&&(t.zMin=A),A>t.zMax&&(t.zMax=A);var h=e.d2x+e.p0x,o=e.d2y+e.p0y,l=e.d2z+e.p0z;h<t.xMin&&(t.xMin=h),h>t.xMax&&(t.xMax=h),o<t.yMin&&(t.yMin=o),o>t.yMax&&(t.yMax=o),l<t.zMin&&(t.zMin=l),l>t.zMax&&(t.zMax=l),e=e.next}return t},contains:function(t){if(!this.isConvex())throw kn.thrown("Not implemented for concave polygon");for(var e=this.triPlanes;null!=e;){if(e.nx*t.x+e.ny*t.y+e.nz*t.z-e.d>=0)return!1;e=e.next}return!0},rayIntersection:function(t,e){for(var i=this.triPlanes,n=-1;null!=i;){var s,r=t.lx*i.nx+t.ly*i.ny+t.lz*i.nz;if(r>=0)s=-1;else{var a=(i.d-(t.px*i.nx+t.py*i.ny+t.pz*i.nz))/r;if(a<0)s=-1;else{var A=t.px+t.lx*a,h=t.py+t.ly*a,o=t.pz+t.lz*a,l=A-i.p0x,u=h-i.p0y,_=o-i.p0z;null==_&&(_=0),null==u&&(u=0),null==l&&(l=0);var c=l,d=u,f=_,x=i.d1x*c+i.d1y*d+i.d1z*f,p=i.d2x*c+i.d2y*d+i.d2z*f,g=(i.dot11*x-i.dot01*p)*i.invDenom,m=(i.dot00*p-i.dot01*x)*i.invDenom;s=g>=0&&m>=0&&g+m<1?a:-1}}if(s>=0){if(!e)return s;(n<0||s<n)&&(n=s)}i=i.next}return n},inFrustum:function(t,e){throw kn.thrown("Not implemented")},inSphere:function(t){throw kn.thrown("Not implemented")},__class__:de};var fe=function(){};i["h3d.col.PolygonBuffer"]=fe,fe.__name__="h3d.col.PolygonBuffer",fe.__interfaces__=[ne],fe.prototype={setData:function(t,e,i,n){null==n&&(n=-1),null==i&&(i=0),this.buffer=t,this.indexes=e,this.startIndex=i,this.triCount=n>=0?n:(e.length-i)/3|0},contains:function(t){var e=this.startIndex,i=t.x,n=t.y;null==(o=t.z)&&(o=0),null==n&&(n=0),null==i&&(i=0);for(var s=i,r=n,a=o,A=0,h=this.triCount;A<h;){A++;var o,l=3*this.indexes[e++];i=this.buffer[l++],n=this.buffer[l++];null==(o=this.buffer[l])&&(o=0),null==n&&(n=0),null==i&&(i=0);var u=i,_=n,c=o,d=3*this.indexes[e++],f=this.buffer[d++],x=this.buffer[d++],p=this.buffer[d];null==p&&(p=0),null==x&&(x=0),null==f&&(f=0);var g=f,m=x,v=p,y=3*this.indexes[e++],b=this.buffer[y++],w=this.buffer[y++],M=this.buffer[y];null==M&&(M=0),null==w&&(w=0),null==b&&(b=0);var B=g-u,C=m-_,S=v-c;null==S&&(S=0),null==C&&(C=0),null==B&&(B=0);var I=b-u,k=w-_,E=M-c;null==E&&(E=0),null==k&&(k=0),null==I&&(I=0);var F=C*E-S*k,T=S*I-B*E,D=B*k-C*I;null==D&&(D=0),null==T&&(T=0),null==F&&(F=0);if(F*s+T*r+D*a>=F*u+T*_+D*c)return!1}return!0},inFrustum:function(t,e){throw kn.thrown("Not implemented")},inSphere:function(t){throw kn.thrown("Not implemented")},rayIntersection:function(t,e){var i=this.startIndex,n=t.lx,s=t.ly;null==(d=t.lz)&&(d=0),null==s&&(s=0),null==n&&(n=0);var r=n,a=s,A=d;n=t.px,s=t.py;null==(d=t.pz)&&(d=0),null==s&&(s=0),null==n&&(n=0);for(var h=n,o=s,l=d,u=-1,_=0,c=this.triCount;_<c;){_++;var d,f=3*this.indexes[i++];n=this.buffer[f++],s=this.buffer[f++];null==(d=this.buffer[f])&&(d=0),null==s&&(s=0),null==n&&(n=0);var x=n,p=s,g=d,m=3*this.indexes[i++],v=this.buffer[m++],y=this.buffer[m++],b=this.buffer[m];null==b&&(b=0),null==y&&(y=0),null==v&&(v=0);var w=v,M=y,B=b,C=3*this.indexes[i++],S=this.buffer[C++],I=this.buffer[C++],k=this.buffer[C];null==k&&(k=0),null==I&&(I=0),null==S&&(S=0);var E=w-x,F=M-p,T=B-g;null==T&&(T=0),null==F&&(F=0),null==E&&(E=0);var D=S-x,P=I-p,z=k-g;null==z&&(z=0),null==P&&(P=0),null==D&&(D=0);var R=a*z-A*P,L=A*D-r*z,V=r*P-a*D;null==V&&(V=0),null==L&&(L=0),null==R&&(R=0);var Q=E*R+F*L+T*V;if(!(Q<1e-10)){var U=1/Q,O=h-x,G=o-p,N=l-g;null==N&&(N=0),null==G&&(G=0),null==O&&(O=0);var Y=(O*R+G*L+N*V)*U;if(!(Y<0||Y>1)){var X=G*T-N*F,j=N*E-O*T,H=O*F-G*E;null==H&&(H=0),null==j&&(j=0),null==X&&(X=0);var W=(r*X+a*j+A*H)*U;if(!(W<0||Y+W>1)){var Z=(D*X+P*j+z*H)*U;if(!(Z<1e-10)){if(!e)return Z;(u<0||Z<u)&&(u=Z)}}}}}return u},__class__:fe};var xe=function(t,e){this.lastBoundsFrame=-1,this.lastFrame=-1,this.obj=t,this.col=e,this.transform=new fe;var i=this.transform,n=e.buffer,s=new Array(n.length);$n.blit(n,0,s,0,n.length),i.setData(s,e.indexes,e.startIndex,e.triCount),this.currentBounds=new se};i["h3d.col.SkinCollider"]=xe,xe.__name__="h3d.col.SkinCollider",xe.__interfaces__=[ne,dt],xe.prototype={contains:function(t){this.checkBounds();var e=this.currentBounds;return t.x>=e.xMin&&t.x<e.xMax&&t.y>=e.yMin&&t.y<e.yMax&&t.z>=e.zMin&&t.z<e.zMax&&(this.applyTransform(),this.transform.contains(t))},inFrustum:function(t,e){this.checkBounds();var i=this.currentBounds;if(null!=e)throw kn.thrown("Not implemented");if(!t.hasBounds(i))return!1;if(null!=e)throw kn.thrown("Not implemented");return this.applyTransform(),this.transform.inFrustum(t)},inSphere:function(t){this.checkBounds();var e=this.currentBounds,i=t.x,n=t.y;null==(h=t.z)&&(h=0),null==n&&(n=0),null==i&&(i=0);var s,r,a,A,h,o=i,l=n,u=h;i=(s=e.xMin)<(A=(r=t.x)>(a=e.xMax)?a:r)?A:s,n=(s=e.yMin)<(A=(r=t.y)>(a=e.yMax)?a:r)?A:s;null==(h=(s=e.zMin)<(A=(r=t.z)>(a=e.zMax)?a:r)?A:s)&&(h=0),null==n&&(n=0),null==i&&(i=0);var _=i-o,c=n-l,d=h-u;if(!(_*_+c*c+d*d<t.r*t.r))return!1;throw this.applyTransform(),kn.thrown("Not implemented")},rayIntersection:function(t,e){return this.checkBounds(),this.currentBounds.rayIntersection(t,!1)<0?-1:(this.applyTransform(),this.transform.rayIntersection(t,e))},checkBounds:function(){if(this.obj.jointsUpdated||this.lastBoundsFrame!=this.obj.lastFrame){this.lastBoundsFrame=this.obj.lastFrame,this.obj.syncJoints();var t=this.currentBounds;t.xMin=1e20,t.xMax=-1e20,t.yMin=1e20,t.yMax=-1e20,t.zMin=1e20,t.zMax=-1e20,this.obj.getBoundsRec(this.currentBounds)}},applyTransform:function(){if(this.obj.jointsUpdated||this.lastFrame!=this.obj.lastFrame){this.lastFrame=this.obj.lastFrame,this.obj.syncJoints();for(var t=0,e=0,i=this.obj.skinData.bonesPerVertex,n=0,s=this.obj.skinData.vertexCount;n<s;){n++;var r=0,a=0,A=0,h=this.col.buffer[e],o=this.col.buffer[e+1],l=this.col.buffer[e+2];null==l&&(l=0),null==o&&(o=0),null==h&&(h=0);for(var u=h,_=o,c=l,d=0,f=i;d<f;){d++;var x=this.obj.skinData.vertexWeights[t];if(0!=x){var p=this.obj.skinData.vertexJoints[t++],g=u,m=_,v=c;null==v&&(v=0),null==m&&(m=0),null==g&&(g=0);var y=g,b=m,w=v,M=this.obj.currentPalette[p],B=y*M._11+b*M._21+w*M._31+M._41,C=y*M._12+b*M._22+w*M._32+M._42,S=y*M._13+b*M._23+w*M._33+M._43;r+=(y=B)*x,a+=(b=C)*x,A+=(w=S)*x}else++t}this.transform.buffer[e++]=r,this.transform.buffer[e++]=a,this.transform.buffer[e++]=A}}},__class__:xe};var pe=function(t,e,i,n){null==n&&(n=0),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0);var s=t,r=e,a=i,A=n;null==A&&(A=0),null==a&&(a=0),null==r&&(r=0),null==s&&(s=0),this.x=s,this.y=r,this.z=a,this.r=A};i["h3d.col.Sphere"]=pe,pe.__name__="h3d.col.Sphere",pe.__interfaces__=[ne],pe.prototype={load:function(t,e,i,n){null==n&&(n=0),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.r=n},getCenter:function(){return new _e(this.x,this.y,this.z)},distance:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z,s=e*e+i*i+n*n-this.r*this.r;return s<0?-Math.sqrt(-s):Math.sqrt(s)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return e*e+i*i+n*n-this.r*this.r},contains:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return e*e+i*i+n*n-this.r*this.r<0},rayIntersection:function(t,e){var i=this.r*this.r,n=t.px+t.lx,s=t.py+t.ly,r=t.pz+t.lz,a=t.lx*t.lx+t.ly*t.ly+t.lz*t.lz,A=2*t.lx*(this.x-n)+2*t.ly*(this.y-s)+2*t.lz*(this.z-r),h=A*A-4*a*(this.x*this.x+this.y*this.y+this.z*this.z+(n*n+s*s+r*r)-2*(this.x*n+this.y*s+this.z*r)-i);return h<0?-1:1-(-A+(h=Math.sqrt(h)))/(2*a)},inFrustum:function(t,e){return null!=e?this.inFrustumMatrix(t,e):t.hasSphere(this)},inFrustumMatrix:function(t,e){var i=this.x,n=this.y,s=this.z,r=this.r,a=this.x,A=this.y,h=this.z;null==h&&(h=0),null==A&&(A=0),null==a&&(a=0);var o=a,l=A,u=h,_=o*e._11+l*e._21+u*e._31+e._41,c=o*e._12+l*e._22+u*e._32+e._42,d=o*e._13+l*e._23+u*e._33+e._43;o=_,l=c,u=d,this.x=o,this.y=l,this.z=u;var f=null;null==f&&(f=new Yt),f.x=Math.sqrt(e._11*e._11+e._12*e._12+e._13*e._13),f.y=Math.sqrt(e._21*e._21+e._22*e._22+e._23*e._23),f.z=Math.sqrt(e._31*e._31+e._32*e._32+e._33*e._33),e._11*(e._22*e._33-e._23*e._32)+e._12*(e._23*e._31-e._21*e._33)+e._13*(e._21*e._32-e._22*e._31)<0&&(f.x*=-1,f.y*=-1,f.z*=-1);var x=f;this.r*=Math.max(Math.max(x.x,x.y),x.z);var p=t.hasSphere(this);return this.x=i,this.y=n,this.z=s,this.r=r,p},inSphere:function(t){var e=this.x,i=this.y;null==(n=this.z)&&(n=0),null==i&&(i=0),null==e&&(e=0);var n,s=e,r=i,a=n;e=t.x,i=t.y;null==(n=t.z)&&(n=0),null==i&&(i=0),null==e&&(e=0);var A=e-s,h=i-r,o=n-a;return A*A+h*h+o*o<(t.r+this.r)*(t.r+this.r)},toString:function(){return"Sphere{"+x.string(new _e(this.x,this.y,this.z))+","+Es.fmt(this.r)+"}"},__class__:pe};var ge=s["h3d.impl.Feature"]={__ename__:!0,__constructs__:null,StandardDerivatives:{_hx_name:"StandardDerivatives",_hx_index:0,__enum__:"h3d.impl.Feature",toString:n},FloatTextures:{_hx_name:"FloatTextures",_hx_index:1,__enum__:"h3d.impl.Feature",toString:n},AllocDepthBuffer:{_hx_name:"AllocDepthBuffer",_hx_index:2,__enum__:"h3d.impl.Feature",toString:n},HardwareAccelerated:{_hx_name:"HardwareAccelerated",_hx_index:3,__enum__:"h3d.impl.Feature",toString:n},MultipleRenderTargets:{_hx_name:"MultipleRenderTargets",_hx_index:4,__enum__:"h3d.impl.Feature",toString:n},Queries:{_hx_name:"Queries",_hx_index:5,__enum__:"h3d.impl.Feature",toString:n},SRGBTextures:{_hx_name:"SRGBTextures",_hx_index:6,__enum__:"h3d.impl.Feature",toString:n},ShaderModel3:{_hx_name:"ShaderModel3",_hx_index:7,__enum__:"h3d.impl.Feature",toString:n},BottomLeftCoords:{_hx_name:"BottomLeftCoords",_hx_index:8,__enum__:"h3d.impl.Feature",toString:n},Wireframe:{_hx_name:"Wireframe",_hx_index:9,__enum__:"h3d.impl.Feature",toString:n},InstancedRendering:{_hx_name:"InstancedRendering",_hx_index:10,__enum__:"h3d.impl.Feature",toString:n}};ge.__constructs__=[ge.StandardDerivatives,ge.FloatTextures,ge.AllocDepthBuffer,ge.HardwareAccelerated,ge.MultipleRenderTargets,ge.Queries,ge.SRGBTextures,ge.ShaderModel3,ge.BottomLeftCoords,ge.Wireframe,ge.InstancedRendering],ge.__empty_constructs__=[ge.StandardDerivatives,ge.FloatTextures,ge.AllocDepthBuffer,ge.HardwareAccelerated,ge.MultipleRenderTargets,ge.Queries,ge.SRGBTextures,ge.ShaderModel3,ge.BottomLeftCoords,ge.Wireframe,ge.InstancedRendering];var me=s["h3d.impl.QueryKind"]={__ename__:!0,__constructs__:null,TimeStamp:{_hx_name:"TimeStamp",_hx_index:0,__enum__:"h3d.impl.QueryKind",toString:n},Samples:{_hx_name:"Samples",_hx_index:1,__enum__:"h3d.impl.QueryKind",toString:n}};me.__constructs__=[me.TimeStamp,me.Samples],me.__empty_constructs__=[me.TimeStamp,me.Samples];var ve=s["h3d.impl.RenderFlag"]={__ename__:!0,__constructs__:null,CameraHandness:{_hx_name:"CameraHandness",_hx_index:0,__enum__:"h3d.impl.RenderFlag",toString:n}};ve.__constructs__=[ve.CameraHandness],ve.__empty_constructs__=[ve.CameraHandness];var ye=function(t){this.id=ye.UID++,this.names=t};i["h3d.impl.InputNames"]=ye,ye.__name__="h3d.impl.InputNames",ye.get=function(t){var e=t.join("|"),i=ye.CACHE.h[e];return null==i&&(i=new ye(t.slice()),ye.CACHE.h[e]=i),i},ye.prototype={__class__:ye};var be=function(){};i["h3d.impl.Driver"]=be,be.__name__="h3d.impl.Driver",be.prototype={hasFeature:function(t){return!1},setRenderFlag:function(t,e){},isSupportedFormat:function(t){return!1},isDisposed:function(){return!0},dispose:function(){},begin:function(t){},log:function(t){this.logEnable&&this.logImpl(t)},generateMipMaps:function(t){throw kn.thrown("Mipmaps auto generation is not supported on this platform")},getNativeShaderCode:function(t){return null},logImpl:function(t){},clear:function(t,e,i){},captureRenderBuffer:function(t){},capturePixels:function(t,e,i,n){throw kn.thrown("Can't capture pixels on this platform")},getDriverName:function(t){return"Not available"},init:function(t,e){null==e&&(e=!1)},resize:function(t,e){},selectShader:function(t){return!1},selectMaterial:function(t){},uploadShaderBuffers:function(t,e){},getShaderInputNames:function(){return null},selectBuffer:function(t){},selectMultiBuffers:function(t){},draw:function(t,e,i){},drawInstanced:function(t,e){},setRenderZone:function(t,e,i,n){},setRenderTarget:function(t,e,i){null==i&&(i=0),null==e&&(e=0)},setRenderTargets:function(t){},allocDepthBuffer:function(t){return null},disposeDepthBuffer:function(t){},getDefaultDepthBuffer:function(){return null},present:function(){},end:function(){},setDebug:function(t){},allocTexture:function(t){return null},allocIndexes:function(t,e){return null},allocVertexes:function(t){return null},allocInstanceBuffer:function(t,e){},disposeTexture:function(t){},disposeIndexes:function(t){},disposeVertexes:function(t){},disposeInstanceBuffer:function(t){},uploadIndexBuffer:function(t,e,i,n,s){},uploadIndexBytes:function(t,e,i,n,s){},uploadVertexBuffer:function(t,e,i,n,s){},uploadVertexBytes:function(t,e,i,n,s){},uploadTextureBitmap:function(t,e,i,n){},uploadTexturePixels:function(t,e,i,n){},readVertexBytes:function(t,e,i,n,s){throw kn.thrown("Driver does not allow to read vertex bytes")},readIndexBytes:function(t,e,i,n,s){throw kn.thrown("Driver does not allow to read index bytes")},copyTexture:function(t,e){return!1},allocQuery:function(t){return null},deleteQuery:function(t){},beginQuery:function(t){},endQuery:function(t){},queryResultAvailable:function(t){return!0},queryResult:function(t){return 0},__class__:be};var we=function(t,e,i){this.s=t,this.vertex=e,this.shader=i};i["h3d.impl._GlDriver.CompiledShader"]=we,we.__name__="h3d.impl._GlDriver.CompiledShader",we.prototype={__class__:we};var Me=function(){};i["h3d.impl._GlDriver.CompiledAttribute"]=Me,Me.__name__="h3d.impl._GlDriver.CompiledAttribute",Me.prototype={__class__:Me};var Be=function(){};i["h3d.impl._GlDriver.CompiledProgram"]=Be,Be.__name__="h3d.impl._GlDriver.CompiledProgram",Be.prototype={__class__:Be};var Ce=function(t){null==t&&(t=0),this.features=new Hn,this.maxCompressedTexturesSupport=0,this.hasMultiIndirect=!1,this.rightHanded=!1,this.firstShader=!0,this.boundTextures=[],this.curTargets=[];var e=[];e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),e.push(0),this.currentDivisor=e,this.curColorMask=-1,this.lastActiveIndex=0,this.curStEnabled=!1,this.curStMaskBits=-1,this.curStOpBits=-1,this.curMatBits=-1,this.maxIdxCurAttribs=0,this.curAttribs=[],this.canvas=Us.getInstance().canvas;var i={alpha:!1,stencil:!0,antialias:t>0};if(Ce.ALLOW_WEBGL2&&(this.gl=this.canvas.getContext("webgl2",i)),null==this.gl&&(this.gl=NA.getContextWebGL(this.canvas,i)),null==this.gl)throw kn.thrown("Could not acquire GL context");"undefined"!=typeof WebGLDebugUtils&&(this.gl=WebGLDebugUtils.makeDebugContext(this.gl),this.glDebug=!0),this.commonFB=this.gl.createFramebuffer(),this.programs=new Wn,this.defStencil=new Ke;var n=this.gl.getParameter(7938);(s=new a("ES ([0-9]+\\.[0-9]+)","")).match(n)&&(this.glES=parseFloat(s.matched(1)));var s=new a("[0-9]+\\.[0-9]+","");n=this.gl.getParameter(35724);if(s.match(n)&&(this.glES=parseFloat(s.matched(0)),this.shaderVersion=Math.round(100*parseFloat(s.matched(0)))),this.drawMode=4,this.makeFeatures(),this.hasFeature(ge.InstancedRendering)&&this.glES<3){var r=this.gl.getExtension("ANGLE_instanced_arrays");this.gl.vertexAttribDivisor=XA(r,r.vertexAttribDivisorANGLE),this.gl.drawElementsInstanced=XA(r,r.drawElementsInstancedANGLE)}QA.UNROLL_LOOPS=!this.hasFeature(ge.ShaderModel3),this.gl.pixelStorei(3333,1),this.gl.pixelStorei(3317,1)};i["h3d.impl.GlDriver"]=Ce,Ce.__name__="h3d.impl.GlDriver",Ce.__super__=be,Ce.prototype=r(be.prototype,{setRenderFlag:function(t,e){this.rightHanded=e>0},logImpl:function(t){console.log(t)},setDebug:function(t){this.debug=t},begin:function(t){this.frame=t,this.resetStream(),this.gl.useProgram(null),this.curShader=null,this.curBuffer=null},getShaderInputNames:function(){return this.curShader.inputs},makeCompiler:function(){var t=new bA;return t.glES=this.glES,t.version=this.shaderVersion,t.intelDriverFix=this.isIntelGpu,t},getNativeShaderCode:function(t){var e=t.vertex.data,i="// vertex:\n"+this.makeCompiler().run(e)+"// fragment:\n";e=t.fragment.data;return i+this.makeCompiler().run(e)},getDriverName:function(t){var e=this.gl.getParameter(7937);return t?e+=" GLv"+x.string(this.gl.getParameter(7938)):e=e.split("/").shift(),"OpenGL "+(e=e.split("WebGL ").join(""))},compileShader:function(t,e){var i=e.vertex?35633:35632,n=this.gl.createShader(i);null==e.code&&(e.code=t.run(e.data),e.data.funs=null),this.gl.shaderSource(n,e.code),this.gl.compileShader(n);var s=this.gl.getShaderInfoLog(n);if(1!=this.gl.getShaderParameter(n,35713)){s=this.gl.getShaderInfoLog(n);var r=x.parseInt(l.substr(s,9,null)),a=null==r?null:e.code.split("\n")[r-1];a=null==a?"":"("+g.trim(a)+")";for(var A=e.code.split("\n"),h=0,o=A.length;h<o;){var u=h++;A[u]=u+1+"\t"+A[u]}throw kn.thrown("An error occurred compiling the shaders: "+s+a+"\n\n"+A.join("\n"))}return new we(n,e.vertex,e)},initShader:function(t,e,i,n){var s=e.vertex?"vertex":"fragment";e.globals=this.gl.getUniformLocation(t.p,s+"Globals"),e.params=this.gl.getUniformLocation(t.p,s+"Params"),e.textures=[];for(var r=0,a=null,A=0,h="",o=i.textures;null!=o;){var l=o.type,u=1;switch(l._hx_index){case 15:if(0==(m=l.size)._hx_index){var _=m.v;l=l.t,u=_}break;case 17:var c=l.size;l=Xa.TSampler2D}if(l!=a){switch(a=l,l._hx_index){case 10:A=3553,h="Textures";break;case 11:A=35866,h="TexturesArray";break;case 12:A=34067,h="TexturesCube";break;default:throw kn.thrown("Unsupported texture type "+x.string(l))}r=0}for(var d=0,f=u;d<f;){var p=d++,g=this.gl.getUniformLocation(t.p,s+h+"["+r+"]");if(null==g)throw kn.thrown("Texture "+n.spec.instances[o.instance].shader.data.name+"."+o.name+" is missing from shader output");e.textures.push({u:g,t:a,mode:A}),++r}o=o.next}if(i.bufferCount>0){var m=[];for(c=0,d=i.bufferCount;c<d;){p=c++;m.push(this.gl.getUniformBlockIndex(t.p,(i.vertex?"vertex_":"")+"uniform_buffer"+p))}e.buffers=m;var v=0;e.vertex||(v=n.vertex.bufferCount);for(m=0,c=i.bufferCount;m<c;){p=m++;this.gl.uniformBlockBinding(t.p,e.buffers[p],p+v)}}},selectShader:function(t){var e=this.programs.h[t.id];if(null==e){e=new Be;var i=this.makeCompiler();e.vertex=this.compileShader(i,t.vertex),e.fragment=this.compileShader(i,t.fragment),e.p=this.gl.createProgram(),this.gl.attachShader(e.p,e.vertex.s),this.gl.attachShader(e.p,e.fragment.s);var n=null;try{this.gl.linkProgram(e.p),1!=this.gl.getProgramParameter(e.p,35714)&&(n=this.gl.getProgramInfoLog(e.p))}catch(a){var s=kn.caught(a).unwrap();throw kn.thrown("Shader linkage error: "+x.string(s)+" ("+this.getDriverName(!1)+")")}if(this.gl.deleteShader(e.vertex.s),this.gl.deleteShader(e.fragment.s),null!=n)throw this.gl.deleteProgram(e.p),kn.thrown("Program linkage failure: "+n+"\nVertex=\n"+t.vertex.code+"\n\nFragment=\n"+t.fragment.code);this.firstShader=!1,this.initShader(e,e.vertex,t.vertex,t),this.initShader(e,e.fragment,t.fragment,t);var r=[];e.attribs=[],e.hasAttribIndex=[],e.stride=0;for(var a=0,A=t.vertex.data.vars;a<A.length;){var h=A[a];if(++a,1==h.kind._hx_index){var o,l=5126,u=h.type;switch(u._hx_index){case 3:o=1;break;case 5:u.t;o=u.size;break;case 9:l=5120,o=u.size;break;default:throw kn.thrown("assert "+x.string(h.type))}var _=this.gl.getAttribLocation(e.p,i.varNames.h.hasOwnProperty(h.id)?i.varNames.h[h.id]:h.name);if(_<0){e.stride+=o;continue}var c=new Me;if(c.type=l,c.size=o,c.index=_,c.offset=e.stride,c.divisor=0,null!=h.qualifiers)for(var d=0,f=h.qualifiers;d<f.length;){var p=f[d];if(++d,9==p._hx_index){var g=p.v;c.divisor=g}}e.attribs.push(c),e.hasAttribIndex[c.index]=!0,r.push(h.name),e.stride+=o}}e.inputs=ye.get(r),this.programs.h[t.id]=e}return this.curShader!=e&&(this.setProgram(e),!0)},setProgram:function(t){this.gl.useProgram(t.p);for(var e=0,i=t.attribs;e<i.length;){var n=i[e];++e,this.curAttribs[n.index]||(this.gl.enableVertexAttribArray(n.index),this.curAttribs[n.index]=!0,this.maxIdxCurAttribs<n.index&&(this.maxIdxCurAttribs=n.index))}var s=0;for(e=0,i=this.maxIdxCurAttribs+1;e<i;){var r=e++;this.curAttribs[r]&&!t.hasAttribIndex[r]?(this.gl.disableVertexAttribArray(r),this.curAttribs[r]=!1):this.curAttribs[r]&&(s=r)}this.maxIdxCurAttribs=s,this.curShader=t,this.curBuffer=null;for(e=0,i=this.boundTextures.length;e<i;){r=e++;this.boundTextures[r]=null}},uploadShaderBuffers:function(t,e){this.uploadBuffer(t,this.curShader.vertex,t.vertex,e),this.uploadBuffer(t,this.curShader.fragment,t.fragment,e)},uploadBuffer:function(t,e,i,n){switch(n){case 0:if(null!=e.globals){var s=i.globals.subarray(0,4*e.shader.globalsSize);this.gl.uniform4fv(e.globals,s)}break;case 1:if(null!=e.params){s=i.params.subarray(0,4*e.shader.paramsSize);this.gl.uniform4fv(e.params,s)}break;case 2:e.textures.length;for(var r=0,a=e.textures.length;r<a;){var A=r++,h=i.tex[A],o=e.textures[A];if(null==h||null==h.t&&null==h.realloc)switch(o.t._hx_index){case 10:var l=Xe.loadingTextureColor;h=ti.fromColor(l,(l>>>24)/255);break;case 12:h=ti.defaultCubeTexture();break;default:throw kn.thrown("Missing texture")}if(null!=h&&null==h.t&&null!=h.realloc){var u=this.curShader;if(h.alloc(),h.realloc(),this.curShader!=u)return this.setProgram(u),this.uploadShaderBuffers(t,0),this.uploadShaderBuffers(t,1),void this.uploadShaderBuffers(t,2)}if(h.set_lastFrame(this.frame),null!=o.u){var _=e.vertex?A:this.curShader.vertex.textures.length+A;if(this.boundTextures[_]!=h.t){this.boundTextures[_]=h.t;var c=this.getBindType(h);if(c!=o.mode)throw kn.thrown("Texture format mismatch: "+x.string(h)+" should be "+x.string(o.t));this.gl.activeTexture(33984+_),this.gl.uniform1i(o.u,_),this.gl.bindTexture(c,h.t.t),this.lastActiveIndex=_}var d=h.mipMap._hx_index,f=h.filter._hx_index,p=h.wrap._hx_index,g=d|f<<3|p<<6;if(g!=h.t.bits){h.t.bits=g;var m=Ce.TFILTERS[d][f],v=o.mode;this.gl.texParameteri(v,10240,m[0]),this.gl.texParameteri(v,10241,m[1]);var y=Ce.TWRAP[p];this.gl.texParameteri(v,10242,y),this.gl.texParameteri(v,10243,y)}h.lodBias!=h.t.bias&&(h.t.bias=h.lodBias,this.gl.texParameterf(o.mode,34045,h.lodBias))}}break;case 3:if(null!=e.buffers){var b=0;e.vertex||null==this.curShader.vertex.buffers||(b=this.curShader.vertex.buffers.length);for(r=0,a=e.buffers.length;r<a;){A=r++;this.gl.bindBufferBase(35345,A+b,i.buffers[A].buffer.vbuf.b)}}}},selectMaterial:function(t){var e=t.bits;if(null==this.curTarget==this.rightHanded)switch(t.culling._hx_index){case 1:e=-4&e|2;break;case 2:e=-4&e|1}if(this.selectMaterialBits(e),this.curColorMask!=t.colorMask){var i=t.colorMask;this.gl.colorMask(0!=(1&i),0!=(2&i),0!=(4&i),0!=(8&i)),this.curColorMask=i}var n=this.defStencil;null==t.stencil?this.curStEnabled&&(this.gl.disable(2960),this.curStEnabled=!1):(n=t.stencil,this.curStEnabled||(this.gl.enable(2960),this.curStEnabled=!0)),this.selectStencilBits(n.opBits,n.maskBits)},selectMaterialBits:function(t){var e=t^this.curMatBits;if(this.curMatBits<0&&(e=-1),0!=e){var i=0!=(268435456&t);if(this.drawMode=i?3:4,0!=(3&e)){var n=3&t;0==n?this.gl.disable(2884):((this.curMatBits<0||0==(3&this.curMatBits))&&this.gl.enable(2884),this.gl.cullFace(Ce.FACES[n]))}if(0!=(4194240&e)){var s=t>>6&15,r=t>>10&15,a=t>>14&15,A=t>>18&15;s==a&&r==A?0==s&&1==r?this.gl.disable(3042):((this.curMatBits<0||0==(this.curMatBits>>6&15)&&1==(this.curMatBits>>10&15))&&this.gl.enable(3042),this.gl.blendFunc(Ce.BLEND[s],Ce.BLEND[r])):((this.curMatBits<0||0==(this.curMatBits>>6&15)&&1==(this.curMatBits>>10&15))&&this.gl.enable(3042),this.gl.blendFuncSeparate(Ce.BLEND[s],Ce.BLEND[r],Ce.BLEND[a],Ce.BLEND[A]))}if(0!=(264241152&e)){var h=t>>22&7,o=t>>25&7;h==o?this.gl.blendEquation(Ce.OP[h]):this.gl.blendEquationSeparate(Ce.OP[h],Ce.OP[o])}if(0!=(4&e)&&this.gl.depthMask(0!=(t>>2&1)),0!=(56&e)){var l=t>>3&7;0==l?this.gl.disable(2929):((this.curMatBits<0||0==(this.curMatBits>>3&7))&&this.gl.enable(2929),this.gl.depthFunc(Ce.COMPARE[l]))}this.curMatBits=t}},selectStencilBits:function(t,e){var i=t^this.curStOpBits,n=e^this.curStMaskBits;if(0!=(i|n)){if(0!=(4088&i)&&this.gl.stencilOpSeparate(Ce.FACES[2],Ce.STENCIL_OP[t>>6&7],Ce.STENCIL_OP[t>>9&7],Ce.STENCIL_OP[t>>3&7]),0!=(16744448&i)&&this.gl.stencilOpSeparate(Ce.FACES[1],Ce.STENCIL_OP[t>>18&7],Ce.STENCIL_OP[t>>21&7],Ce.STENCIL_OP[t>>15&7]),0!=(7&i|16711935&n)&&this.gl.stencilFuncSeparate(Ce.FACES[2],Ce.COMPARE[7&t],e>>16&255,255&e),0!=(28672&i|16711935&n)&&this.gl.stencilFuncSeparate(Ce.FACES[1],Ce.COMPARE[t>>12&7],e>>16&255,255&e),0!=(65280&n)){var s=e>>8&255;this.gl.stencilMaskSeparate(Ce.FACES[2],s),this.gl.stencilMaskSeparate(Ce.FACES[1],s)}this.curStOpBits=t,this.curStMaskBits=e}},clear:function(t,e,i){var n=0;null!=t&&(this.gl.colorMask(!0,!0,!0,!0),this.curColorMask=15,this.gl.clearColor(t.x,t.y,t.z,t.w),n|=16384),null!=e&&(this.gl.depthMask(!0),this.curMatBits>=0&&(this.curMatBits|=4),this.gl.clearDepth(e),n|=256),null!=i&&(this.selectStencilBits(this.defStencil.opBits,this.defStencil.maskBits),this.gl.clearStencil(i),n|=1024),0!=n&&this.gl.clear(n),null!=this.curTarget&&(this.curTarget.flags|=1<<Ye.WasCleared._hx_index)},resize:function(t,e){if(""==this.canvas.style.width){var i=t/window.devicePixelRatio|0;this.canvas.style.width=i+"px";i=e/window.devicePixelRatio|0;this.canvas.style.height=i+"px"}this.canvas.width=t,this.canvas.height=e,this.bufferWidth=t,this.bufferHeight=e,this.gl.viewport(0,0,t,e),null!=this.defaultDepth&&(this.disposeDepthBuffer(this.defaultDepth),this.defaultDepth.width=this.bufferWidth,this.defaultDepth.height=this.bufferHeight,this.defaultDepth.b=this.allocDepthBuffer(this.defaultDepth))},getChannels:function(t){switch(t.internalFmt){case 6407:case 34837:case 34843:case 35898:case 35904:case 35905:return 6407;case 6408:case 32857:case 33777:case 33778:case 33779:case 34836:case 34842:case 35906:case 35907:return 6408;case 32856:return 32993;case 6403:case 33321:case 33325:case 33326:return 6403;case 33319:case 33323:case 33327:case 33328:return 33319;default:throw kn.thrown("Invalid format "+t.internalFmt)}},isSupportedFormat:function(t){switch(t._hx_index){case 2:return!0;case 3:case 4:return this.hasFeature(ge.FloatTextures);case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 16:case 17:return this.glES>=3;case 14:case 15:return this.hasFeature(ge.SRGBTextures);case 21:return t.v<=this.maxCompressedTexturesSupport;default:return!1}},getBindType:function(t){var e=0!=(t.flags&1<<Ye.Cube._hx_index),i=0!=(t.flags&1<<Ye.IsArray._hx_index);return e?34067:i?35866:3553},allocTexture:function(t){var e=this;Ce.outOfMemoryCheck&&this.gl.getError();var i=this.gl.createTexture(),n=this.getBindType(t),s={t:i,width:t.width,height:t.height,internalFmt:6408,pixelFmt:5121,bits:-1,bind:n,bias:0};switch((A=t.format)._hx_index){case 1:s.internalFmt=32856;break;case 2:break;case 3:if(!this.hasFeature(ge.FloatTextures))throw kn.thrown("Unsupported texture format "+x.string(t.format));s.pixelFmt=5131,s.internalFmt=34842;break;case 4:if(!this.hasFeature(ge.FloatTextures))throw kn.thrown("Unsupported texture format "+x.string(t.format));s.internalFmt=34836,s.pixelFmt=5126;break;case 5:s.internalFmt=33321;break;case 6:s.internalFmt=33325,s.pixelFmt=5131;break;case 7:s.internalFmt=33326,s.pixelFmt=5126;break;case 8:s.internalFmt=33323;break;case 9:s.internalFmt=33327,s.pixelFmt=5131;break;case 10:s.internalFmt=33328,s.pixelFmt=5126;break;case 11:s.internalFmt=6407;break;case 12:s.internalFmt=34843,s.pixelFmt=5131;break;case 13:s.internalFmt=34837,s.pixelFmt=5126;break;case 14:s.internalFmt=35905;break;case 15:s.internalFmt=35907;break;case 16:s.internalFmt=32857,s.pixelFmt=33640;break;case 17:s.internalFmt=35898,s.pixelFmt=35899;break;case 21:var r=A.v;if(!(r<=this.maxCompressedTexturesSupport))throw kn.thrown("Unsupported texture format "+x.string(t.format));if(0!=(3&t.width)||0!=(3&t.height))throw kn.thrown("Compressed texture "+x.string(t)+" has size "+t.width+"x"+t.height+" - must be a multiple of 4");switch(r){case 1:s.internalFmt=33777;break;case 2:s.internalFmt=33778;break;case 3:s.internalFmt=33779;break;default:throw kn.thrown("Unsupported texture format "+x.string(t.format))}break;default:throw kn.thrown("Unsupported texture format "+x.string(t.format))}t.set_lastFrame(this.frame),t.flags&=-1-(1<<Ye.WasCleared._hx_index),this.gl.bindTexture(n,s.t);for(var a=!1,A=0,h=t.get_mipLevels();A<h;){var o=A++,l=s.width>>o,u=1<l?l:1,_=s.height>>o,c=1<_?_:1;if(0!=(t.flags&1<<Ye.Cube._hx_index))for(var d=0;d<6;){var f,p=d++;if(this.gl.texImage2D(Ce.CUBE_FACES[p],o,s.internalFmt,u,c,0,this.getChannels(s),s.pixelFmt,null),Ce.outOfMemoryCheck){var g=e.gl.getError();if(1285==g)a=!0,f=!0;else{if(0!=g)throw kn.thrown("Failed to alloc texture "+x.string(t.format)+"(error "+g+")");f=!1}}else f=!1;if(f)break}else if(0!=(t.flags&1<<Ye.IsArray._hx_index)){if(this.gl.texImage3D(n,o,s.internalFmt,u,c,t.get_layerCount(),0,this.getChannels(s),s.pixelFmt,null),Ce.outOfMemoryCheck){var m=e.gl.getError();if(1285==m)a=!0;else if(0!=m)throw kn.thrown("Failed to alloc texture "+x.string(t.format)+"(error "+m+")")}}else{var v,y=t.format;if(21==y._hx_index){y.v;v=!0}else v=!1;if(v||this.gl.texImage2D(n,o,s.internalFmt,u,c,0,this.getChannels(s),s.pixelFmt,null),Ce.outOfMemoryCheck){var b=e.gl.getError();if(1285==b)a=!0;else if(0!=b)throw kn.thrown("Failed to alloc texture "+x.string(t.format)+"(error "+b+")")}}}return this.restoreBind(),a?(this.gl.deleteTexture(s.t),null):s},restoreBind:function(){var t=this.boundTextures[this.lastActiveIndex];null==t?this.gl.bindTexture(3553,null):this.gl.bindTexture(t.bind,t.t)},allocDepthBuffer:function(t){var e,i=this.gl.createRenderbuffer();switch(null==t.format&&(t.format=this.glES>=3?je.Depth24Stencil8:je.Depth16),t.format._hx_index){case 0:e=33189;break;case 1:if(!(this.glES>=3))throw kn.thrown("Unsupported depth format "+x.string(t.format));e=33190;break;case 2:e=34041;break;default:throw kn.thrown("Unsupported depth format "+x.string(t.format))}return this.gl.bindRenderbuffer(36161,i),this.gl.renderbufferStorage(36161,e,t.width,t.height),this.gl.bindRenderbuffer(36161,null),{r:i}},disposeDepthBuffer:function(t){null!=t.b&&null!=t.b.r&&(this.gl.deleteRenderbuffer(t.b.r),t.b=null)},getDefaultDepthBuffer:function(){return null!=this.defaultDepth||(this.defaultDepth=new He(0,0),this.defaultDepth.width=this.bufferWidth,this.defaultDepth.height=this.bufferHeight,this.defaultDepth.b=this.allocDepthBuffer(this.defaultDepth)),this.defaultDepth},discardError:function(){Ce.outOfMemoryCheck&&this.gl.getError()},allocVertexes:function(t){Ce.outOfMemoryCheck&&this.gl.getError();var e=this.gl.createBuffer();if(this.gl.bindBuffer(34962,e),t.size*t.stride==0)throw kn.thrown("assert");this.gl.bufferData(34962,t.size*t.stride*4,0!=(t.flags&1<<zt.Dynamic._hx_index)?35048:35044);var i=Ce.outOfMemoryCheck&&1285==this.gl.getError();return this.gl.bindBuffer(34962,null),i?(this.gl.deleteBuffer(e),null):{b:e,stride:t.stride}},allocIndexes:function(t,e){Ce.outOfMemoryCheck&&this.gl.getError();var i=this.gl.createBuffer(),n=e?4:2;this.gl.bindBuffer(34963,i),this.gl.bufferData(34963,t*n,35044);var s=Ce.outOfMemoryCheck&&1285==this.gl.getError();return this.gl.bindBuffer(34963,null),this.curIndexBuffer=null,s?(this.gl.deleteBuffer(i),null):{b:i,is32:e}},disposeTexture:function(t){var e=t.t;if(null!=e){t.t=null;for(var i=0,n=this.boundTextures.length;i<n;){var s=i++;this.boundTextures[s]==e&&(this.boundTextures[s]=null)}this.gl.deleteTexture(e.t)}},disposeIndexes:function(t){this.gl.deleteBuffer(t.b)},disposeVertexes:function(t){this.gl.deleteBuffer(t.b)},generateMipMaps:function(t){var e=this.getBindType(t);this.gl.bindTexture(e,t.t.t),this.gl.generateMipmap(e),this.restoreBind()},uploadTextureBitmap:function(t,e,i,n){if(t.format!=$e.RGBA||1!=t.get_layerCount()){var s=e.getPixels();this.uploadTexturePixels(t,s,i,n),s.dispose()}else{var r=e.ctx;this.gl.bindTexture(3553,t.t.t),this.gl.texImage2D(3553,i,t.t.internalFmt,this.getChannels(t.t),t.t.pixelFmt,r.getImageData(0,0,e.ctx.canvas.width,e.ctx.canvas.height)),this.restoreBind()}},resetStream:function(){},streamData:function(t,e,i){return t},uploadTexturePixels:function(t,e,i,n){var s=0!=(t.flags&1<<Ye.Cube._hx_index)?Ce.CUBE_FACES[n]:0!=(t.flags&1<<Ye.IsArray._hx_index)?35866:3553,r=this.getBindType(t);this.gl.bindTexture(r,t.t.t),e.convert(t.format),e.setFlip(!1);var a,A=e.dataSize;switch(t.format._hx_index){case 3:case 6:case 9:case 12:a=new Uint16Array(e.bytes.b.buffer,e.offset,A>>1);break;case 4:case 7:case 10:case 13:a=new Float32Array(e.bytes.b.buffer,e.offset,A>>2);break;case 16:case 17:a=new Uint32Array(e.bytes.b.buffer,e.offset,A>>2);break;default:a=new Uint8Array(e.bytes.b.buffer,e.offset,A)}var h,o=t.format;if(21==o._hx_index){o.v;h=!0}else h=!1;h?0!=(t.flags&1<<Ye.IsArray._hx_index)?this.gl.compressedTexSubImage3D(s,i,0,0,n,e.width,e.height,1,t.t.internalFmt,a):this.gl.compressedTexImage2D(s,i,t.t.internalFmt,e.width,e.height,0,a):0!=(t.flags&1<<Ye.IsArray._hx_index)?this.gl.texSubImage3D(s,i,0,0,n,e.width,e.height,1,this.getChannels(t.t),t.t.pixelFmt,a):this.gl.texImage2D(s,i,t.t.internalFmt,e.width,e.height,0,this.getChannels(t.t),t.t.pixelFmt,a),t.flags|=1<<Ye.WasCleared._hx_index,this.restoreBind()},uploadVertexBuffer:function(t,e,i,n,s){var r=t.stride;this.gl.bindBuffer(34962,t.b);var a=n.array,A=new Float32Array(a.buffer,4*s,i*r);this.gl.bufferSubData(34962,e*r*4,A),this.gl.bindBuffer(34962,null)},uploadVertexBytes:function(t,e,i,n,s){var r=t.stride;this.gl.bindBuffer(34962,t.b);var a=new Uint8Array(n.b.bufferValue,4*s,i*r*4);this.gl.bufferSubData(34962,e*r*4,a),this.gl.bindBuffer(34962,null)},uploadIndexBuffer:function(t,e,i,n,s){var r=t.is32?2:1;this.gl.bindBuffer(34963,t.b);var a=new Uint16Array(n),A=new Uint16Array(a.buffer,s<<r,i);this.gl.bufferSubData(34963,e<<r,A),this.gl.bindBuffer(34963,null),this.curIndexBuffer=null},uploadIndexBytes:function(t,e,i,n,s){var r=t.is32?2:1;this.gl.bindBuffer(34963,t.b);var a=new Uint8Array(n.b.bufferValue,s<<r,i<<r);this.gl.bufferSubData(34963,e<<r,a),this.gl.bindBuffer(34963,null),this.curIndexBuffer=null},updateDivisor:function(t){this.currentDivisor[t.index]!=t.divisor&&(this.currentDivisor[t.index]=t.divisor,this.gl.vertexAttribDivisor(t.index,t.divisor))},selectBuffer:function(t){if(t!=this.curBuffer)if(null==this.curBuffer||t.buffer!=this.curBuffer.buffer||0!=(t.buffer.flags&1<<zt.RawFormat._hx_index)!=(0!=(this.curBuffer.flags&1<<zt.RawFormat._hx_index))){if(null==this.curShader)throw kn.thrown("No shader selected");this.curBuffer=t;var e=t.buffer.vbuf;if(e.stride<this.curShader.stride)throw kn.thrown("Buffer stride ("+e.stride+") and shader stride ("+this.curShader.stride+") mismatch");if(this.gl.bindBuffer(34962,e.b),0!=(t.flags&1<<zt.RawFormat._hx_index))for(var i=0,n=this.curShader.attribs;i<n.length;){var s=n[i];++i;var r=s.offset;this.gl.vertexAttribPointer(s.index,s.size,s.type,!1,4*e.stride,4*r),this.currentDivisor[s.index]!=s.divisor&&(this.currentDivisor[s.index]=s.divisor,this.gl.vertexAttribDivisor(s.index,s.divisor))}else{var a=8;for(i=0,n=this.curShader.attribs.length;i<n;){var A=i++,h=(s=this.curShader.attribs[A],this.curShader.inputs.names[A]);switch(h){case"normal":if(e.stride<6)throw kn.thrown("Buffer is missing NORMAL data, set it to RAW format ?");r=3;break;case"position":r=0;break;case"uv":if(e.stride<8)throw kn.thrown("Buffer is missing UV data, set it to RAW format ?");r=6;break;default:var o=h;if(r=a,(a+=s.size)>e.stride)throw kn.thrown("Buffer is missing '"+o+"' data, set it to RAW format ?")}this.gl.vertexAttribPointer(s.index,s.size,s.type,!1,4*e.stride,4*r),this.currentDivisor[s.index]!=s.divisor&&(this.currentDivisor[s.index]=s.divisor,this.gl.vertexAttribDivisor(s.index,s.divisor))}}}else this.curBuffer=t},selectMultiBuffers:function(t){for(var e=0,i=this.curShader.attribs;e<i.length;){var n=i[e];++e,this.gl.bindBuffer(34962,t.buffer.buffer.vbuf.b),this.gl.vertexAttribPointer(n.index,n.size,n.type,!1,4*t.buffer.buffer.stride,4*t.offset),this.currentDivisor[n.index]!=n.divisor&&(this.currentDivisor[n.index]=n.divisor,this.gl.vertexAttribDivisor(n.index,n.divisor)),t=t.next}this.curBuffer=null},draw:function(t,e,i){t!=this.curIndexBuffer&&(this.curIndexBuffer=t,this.gl.bindBuffer(34963,t.b)),t.is32?this.gl.drawElements(this.drawMode,3*i,5125,4*e):this.gl.drawElements(this.drawMode,3*i,5123,2*e)},allocInstanceBuffer:function(t,e){for(var i=[],n=0,s=t.commandCount;n<s;){var r=5*n++*4,a=e.getInt32(r),A=e.getInt32(r+4),h=e.getInt32(r+8),o=e.getInt32(r+12),l=e.getInt32(r+16);if(0!=o||0!=l)throw kn.thrown("baseVertex and baseInstance must be zero on this platform");i.push(a),i.push(h),i.push(A)}t.data=i},disposeInstanceBuffer:function(t){t.data=null},drawInstanced:function(t,e){t!=this.curIndexBuffer&&(this.curIndexBuffer=t,this.gl.bindBuffer(34963,t.b));var i=e.data;if(null!=i)for(var n=0,s=0,r=i.length/3|0;s<r;){s++;var a=n++,A=n++;this.gl.drawElementsInstanced(this.drawMode,i[a],t.is32?5125:5123,i[A],i[n++])}else this.gl.drawElementsInstanced(this.drawMode,e.indexCount,t.is32?5125:5123,0,e.commandCount)},end:function(){},present:function(){},isDisposed:function(){return this.gl.isContextLost()},setRenderZone:function(t,e,i,n){0==t&&0==e&&i<0&&n<0?this.gl.disable(3089):(this.gl.enable(3089),null==this.curTarget&&(e=this.bufferHeight-(e+n)),this.gl.scissor(t,e,i,n))},setDrawBuffers:function(t){this.glES>=3?this.gl.drawBuffers(Ce.CBUFFERS[t]):null!=this.mrtExt&&this.mrtExt.drawBuffersWEBGL(Ce.CBUFFERS[t])},unbindTargets:function(){if(null!=this.curTarget&&this.numTargets>1){for(;this.numTargets>1;)this.gl.framebufferTexture2D(36160,36064+--this.numTargets,3553,null,0),this.curTargets[this.numTargets]=null;this.setDrawBuffers(1)}},capturePixels:function(t,e,i,n){var s,r,a,A;null!=n?(n.xMax>t.width&&(n.xMax=t.width),n.yMax>t.height&&(n.yMax=t.height),n.xMin<0&&(n.xMin=0),n.yMin<0&&(n.yMin=0),a=n.xMax-n.xMin,A=n.yMax-n.yMin,s=n.xMin,r=n.yMin):(a=t.width,A=t.height,s=0,r=0),0==(a>>=i)&&(a=1),0==(A>>=i)&&(A=1);var h=Ps.alloc(a,A,t.format),o=this.curTarget,l=this.numTargets,u=this.curTargetLayer,_=this.curTargetMip;if(l>1){this.numTargets=1;for(var c=1,d=l;c<d;){var f=c++;this.curTargets[f]==t&&this.gl.framebufferTexture2D(36160,36064+f,3553,null,0)}}if(this.setRenderTarget(t,e,i),this.captureSubRenderBuffer(h,s,r),this.setRenderTarget(o,u,_),l>1){for(c=1,d=l;c<d;){f=c++;this.curTargets[f]==t&&this.gl.framebufferTexture2D(36160,36064+f,3553,t.t.t,0)}this.setDrawBuffers(l),this.numTargets=l}return h},setRenderTarget:function(t,e,i){if(null==i&&(i=0),null==e&&(e=0),this.unbindTargets(),this.curTarget=t,null==t)return this.gl.bindFramebuffer(36160,null),void this.gl.viewport(0,0,this.bufferWidth,this.bufferHeight);if(null!=t.depthBuffer&&(t.depthBuffer.width!=t.width||t.depthBuffer.height!=t.height))throw kn.thrown("Invalid depth buffer size : does not match render target size");if(i>0&&1==this.glES)throw kn.thrown("Cannot render to mipLevel in WebGL1, use upload() instead");if(null==t.t&&t.alloc(),0!=(t.flags&1<<Ye.MipMapped._hx_index)&&0==(t.flags&1<<Ye.WasCleared._hx_index)){var n=this.getBindType(t);this.gl.bindTexture(n,t.t.t),this.gl.generateMipmap(n),this.restoreBind()}t.set_lastFrame(this.frame),this.curTargetLayer=e,this.curTargetMip=i,this.gl.bindFramebuffer(36160,this.commonFB),0!=(t.flags&1<<Ye.IsArray._hx_index)?this.gl.framebufferTextureLayer(36160,36064,t.t.t,i,e):this.gl.framebufferTexture2D(36160,36064,0!=(t.flags&1<<Ye.Cube._hx_index)?Ce.CUBE_FACES[e]:3553,t.t.t,i),null!=t.depthBuffer?t.depthBuffer.hasStencil()&&t.depthBuffer.format==je.Depth24Stencil8?this.gl.framebufferRenderbuffer(36160,33306,36161,t.depthBuffer.b.r):(this.gl.framebufferRenderbuffer(36160,33306,36161,null),this.gl.framebufferRenderbuffer(36160,36096,36161,t.depthBuffer.b.r),this.gl.framebufferRenderbuffer(36160,36128,36161,t.depthBuffer.hasStencil()?t.depthBuffer.b.r:null)):(this.gl.framebufferRenderbuffer(36160,33306,36161,null),this.gl.framebufferRenderbuffer(36160,36096,36161,null),this.gl.framebufferRenderbuffer(36160,36128,36161,null));var s=t.width>>i;0==s&&(s=1);var r=t.height>>i;0==r&&(r=1),this.gl.viewport(0,0,s,r);for(var a=0,A=this.boundTextures.length;a<A;){var h=a++;this.boundTextures[h]=null}if(0==(t.flags&1<<Ye.WasCleared._hx_index)&&(t.flags|=1<<Ye.WasCleared._hx_index,this.clear(Ce.BLACK)),this.glDebug){var o=this.gl.checkFramebufferStatus(36160);if(36053!=o)throw kn.thrown("Invalid frame buffer: "+o)}},setRenderTargets:function(t){if(this.unbindTargets(),this.setRenderTarget(t[0]),!(t.length<2)){this.numTargets=t.length;for(var e=!1,i=1,n=t.length;i<n;){var s=i++,r=t[s];null==r.t&&r.alloc(),this.gl.framebufferTexture2D(36160,36064+s,3553,r.t.t,0),this.curTargets[s]=r,r.set_lastFrame(this.frame),0==(r.flags&1<<Ye.WasCleared._hx_index)&&(r.flags|=1<<Ye.WasCleared._hx_index,e=!0)}this.setDrawBuffers(t.length),e&&this.clear(Ce.BLACK)}},init:function(t,e){null==e&&(e=!1);var i=!1;if("complete"==window.document.readyState){var n=t;Pn.delay((function(){n(false)}),1)}else window.addEventListener("load",(function(e){i||(i=!0,t(!1))}))},hasFeature:function(t){return this.features.get(t)},makeFeatures:function(){for(var t=0,e=ge.__empty_constructs__.slice();t<e.length;){var i=e[t];++t,this.features.set(i,this.checkFeature(i))}null!=this.gl.getExtension("WEBGL_compressed_texture_s3tc")&&(this.maxCompressedTexturesSupport=3)},checkFeature:function(t){switch(t._hx_index){case 0:return this.glES>=3||null!=this.gl.getExtension("OES_standard_derivatives");case 1:return this.glES>=3?null!=this.gl.getExtension("EXT_color_buffer_float")&&null!=this.gl.getExtension("OES_texture_float_linear"):null!=this.gl.getExtension("OES_texture_float")&&null!=this.gl.getExtension("OES_texture_float_linear")&&null!=this.gl.getExtension("OES_texture_half_float")&&null!=this.gl.getExtension("OES_texture_half_float_linear");case 2:case 3:case 8:case 9:return!0;case 4:return this.glES>=3||(null!=this.mrtExt||null!=(this.mrtExt=this.gl.getExtension("WEBGL_draw_buffers")));case 6:return this.glES>=3||null!=this.gl.getExtension("EXT_sRGB");case 7:return this.glES>=3;case 10:return this.glES>=3||null!=this.gl.getExtension("ANGLE_instanced_arrays");default:return!1}},uploadTextureVideoElement:function(t,e,i,n){var s=0!=(t.flags&1<<Ye.Cube._hx_index),r=this.getBindType(t);if(0!=(t.flags&1<<Ye.IsArray._hx_index))throw kn.thrown("TODO:texImage3D");var a=s?Ce.CUBE_FACES[n]:3553;this.gl.bindTexture(r,t.t.t),this.glES>=3?this.gl.texImage2D(a,i,t.t.internalFmt,e.videoWidth,e.videoHeight,0,this.getChannels(t.t),t.t.pixelFmt,e):this.gl.texImage2D(a,i,t.t.internalFmt,t.t.internalFmt,t.t.pixelFmt,e),this.restoreBind()},captureRenderBuffer:function(t){this.captureSubRenderBuffer(t,0,0)},captureSubRenderBuffer:function(t,e,i){if(null==this.curTarget)throw kn.thrown("Can't capture main render buffer in GL");Ce.outOfMemoryCheck&&this.gl.getError();var n=t.bytes.b;switch(this.curTarget.format._hx_index){case 3:case 6:case 9:case 12:n=new Uint16Array(n.buffer);break;case 4:case 7:case 10:case 13:n=new Float32Array(n.buffer);break;case 16:case 17:n=new Uint32Array(n.buffer)}this.gl.readPixels(e,i,t.width,t.height,this.getChannels(this.curTarget.t),this.curTarget.t.pixelFmt,n);var s=this.gl.getError();if(0!=s)throw kn.thrown("Failed to capture pixels (error "+s+")");t.set_innerFormat(this.curTarget.format)},__class__:Ce});var Se=function(){this.triCount=0,this.indexCount=0};i["h3d.impl.InstanceBuffer"]=Se,Se.__name__="h3d.impl.InstanceBuffer",Se.prototype={setCommand:function(t,e){this.commandCount=t,this.indexCount=e,this.triCount=t*e/3|0},setBuffer:function(t,e){this.dispose();for(var i=0,n=t;i<n;){var s=i++,r=e.getInt32(20*s)*e.getInt32(20*s+4)/3|0;this.triCount+=r}this.commandCount=t,this.indexCount=0,this.driver=Ut.CURRENT.driver,this.driver.allocInstanceBuffer(this,e)},dispose:function(){null!=this.data&&this.driver.disposeInstanceBuffer(this)},__class__:Se};var Ie=function(t,e,i){this.pos=t,this.count=e,this.next=i};i["h3d.impl._ManagedBuffer.FreeCell"]=Ie,Ie.__name__="h3d.impl._ManagedBuffer.FreeCell",Ie.prototype={__class__:Ie};var ke=function(t,e,i){if(this.flags=0,null!=i)for(var n=0;n<i.length;){var s=i[n];++n,this.flags|=1<<s._hx_index}this.size=e,this.stride=t,this.freeList=new Ie(0,e,null),this.mem=Ut.CURRENT.mem,this.mem.allocManaged(this)};i["h3d.impl.ManagedBuffer"]=ke,ke.__name__="h3d.impl.ManagedBuffer",ke.prototype={uploadVertexBuffer:function(t,e,i,n){null==n&&(n=0),this.mem.driver.uploadVertexBuffer(this.vbuf,t,e,i,n)},uploadVertexBytes:function(t,e,i,n){null==n&&(n=0),this.mem.driver.uploadVertexBytes(this.vbuf,t,e,i,n)},readVertexBytes:function(t,e,i,n){null==n&&(n=0),this.mem.driver.readVertexBytes(this.vbuf,t,e,i,n)},alloc:function(t,e){var i=this.allocPosition(t,e);if(i<0)return null;var n=new Rt(t,this.stride,[zt.NoAlloc]);return n.position=i,n.buffer=this,n},getFreeVertices:function(){for(var t=0,e=this.freeList;null!=e;)t+=e.count,e=e.next;return t},allocPosition:function(t,e){for(var i=this.freeList;null!=i;){if(i.count>=t){var n=(e-i.pos%e)%e;if(0==n)break;if(i.count>=t+n){i.next=new Ie(i.pos+n,i.count-n,i.next),i.count=n,i=i.next;break}}i=i.next}if(null==i)return-1;var s=i.pos;return i.pos+=t,i.count-=t,s},allocBuffer:function(t){var e=0!=(t.flags&1<<zt.Quads._hx_index)?4:0!=(t.flags&1<<zt.Triangles._hx_index)?3:1,i=this.allocPosition(t.vertices,e);return!(i<0)&&(t.position=i,t.buffer=this,!0)},freeBuffer:function(t){for(var e=null,i=this.freeList,n=t.vertices,s=t.position+n;null!=i;){if(i.pos==s){i.pos-=n,i.count+=n,null!=e&&e.pos+e.count==i.pos&&(e.count+=i.count,e.next=i.next),n=0;break}if(i.pos>s){if(null!=e&&e.pos+e.count==t.position)e.count+=n;else{var r=new Ie(t.position,n,i);null==e?this.freeList=r:e.next=r}n=0;break}e=i,i=i.next}if(0!=n)throw kn.thrown("assert");this.freeList.count==this.size&&0==(this.flags&1<<zt.Managed._hx_index)&&this.dispose()},dispose:function(){this.mem.freeManaged(this)},isDisposed:function(){return null==this.vbuf},__class__:ke};var Ee=function(t){this.bufferCount=0,this.texMemory=0,this.usedMemory=0,this.driver=t};i["h3d.impl.MemoryManager"]=Ee,Ee.__name__="h3d.impl.MemoryManager",Ee.prototype={init:function(){this.indexes=[],this.textures=[],this.buffers=[],this.depths=[],this.initIndexes()},initIndexes:function(){for(var t=new Array(0),e=0;e<65533;){var i=e++;t.push(i)}this.triIndexes=Ot.alloc(t);for(t=new Array(0),e=0;e<16383;){var n=(i=e++)<<2;t.push(n),t.push(n+1),t.push(n+2),t.push(n+2),t.push(n+1),t.push(n+3)}t.push(65533),this.quadIndexes=Ot.alloc(t)},garbage:function(){},cleanManagedBuffers:function(){for(var t=1,e=this.buffers.length;t<e;)for(var i=t++,n=this.buffers[i],s=null;null!=n;)n.freeList.count==n.size?(n.dispose(),null==s?this.buffers[i]=n.next:s.next=n.next):s=n,n=n.next},allocManaged:function(t){if(null==t.vbuf){var e=t.size*t.stride*4;if(0!=e){for(;this.usedMemory+e>4294967296||this.bufferCount>=65536||null==(t.vbuf=this.driver.allocVertexes(t));){if(this.driver.isDisposed())return;var i=this.usedMemory-this.freeMemorySize();if(this.garbage(),this.cleanManagedBuffers(),this.usedMemory-this.freeMemorySize()==i){if(this.bufferCount>=65536)throw kn.thrown("Too many buffers");throw kn.thrown("Memory full ("+Math.ceil(i/1024)+" KB,"+this.bufferCount+" buffers)")}}this.usedMemory+=e,this.bufferCount++}}},freeManaged:function(t){if(null!=t.vbuf&&(this.driver.disposeVertexes(t.vbuf),t.vbuf=null,this.usedMemory-=t.size*t.stride*4,this.bufferCount--,0==(t.flags&1<<zt.Managed._hx_index)))for(var e=this.buffers[0],i=null;null!=e;){if(e==t){null==i?this.buffers[0]=t.next:i.next=t.next;break}i=e,e=e.next}},allocBuffer:function(t,e){var i=0!=(t.flags&1<<zt.Quads._hx_index)?65532:0!=(t.flags&1<<zt.Triangles._hx_index)?65533:65534;if(t.vertices>i&&0==(t.flags&1<<zt.UniformBuffer._hx_index)&&0==(t.flags&1<<zt.LargeBuffer._hx_index)){if(65534==i)throw kn.thrown("Cannot split buffer with "+t.vertices+" vertices if it's not Quads/Triangles");var n=t.vertices-i;t.vertices=i,this.allocBuffer(t,e);for(var s=t;null!=s.next;)s=s.next;for(var r=[],a=0,A=Ee.ALL_FLAGS;a<A.length;){var h=A[a];++a,0!=(t.flags&1<<h._hx_index)&&r.push(h)}s.next=new Rt(n,e,r)}else if(0!=(t.flags&1<<zt.Managed._hx_index)){c=this.buffers[e];for(var o=null;null!=c;){if(c.allocBuffer(t))return;o=c,c=c.next}var l=0!=(t.flags&1<<zt.Triangles._hx_index)?3:0!=(t.flags&1<<zt.Quads._hx_index)?4:0;if(null==c&&l>0){for(var u=t.vertices,_=u;_>2048;)for(c=this.buffers[e],_>>=1,_-=_%l,t.vertices=_;null!=c;){if(c.allocBuffer(t)){for(r=[],a=0,A=Ee.ALL_FLAGS;a<A.length;){h=A[a];++a,0!=(t.flags&1<<h._hx_index)&&r.push(h)}return void(t.next=new Rt(u-_,e,r))}c=c.next}t.vertices=u}if(c=new ke(e,65533,[zt.Managed]),null==o?this.buffers[e]=c:o.next=c,!c.allocBuffer(t))throw kn.thrown("assert")}else{var c,r=null;if(0!=(t.flags&1<<zt.Dynamic._hx_index)&&(null==r&&(r=[]),r.push(zt.Dynamic)),0!=(t.flags&1<<zt.UniformBuffer._hx_index)&&(null==r&&(r=[]),r.push(zt.UniformBuffer)),(c=new ke(e,t.vertices,r)).next=this.buffers[0],this.buffers[0]=c,!c.allocBuffer(t))throw kn.thrown("assert")}},deleteIndexes:function(t){l.remove(this.indexes,t),this.driver.disposeIndexes(t.ibuf),t.ibuf=null,this.usedMemory-=t.count*(t.is32?4:2)},allocIndexes:function(t){t.ibuf=this.driver.allocIndexes(t.count,t.is32),this.indexes.push(t),this.usedMemory+=t.count*(t.is32?4:2)},bpp:function(t){return 4},cleanTextures:function(t){null==t&&(t=!0),this.textures.sort(XA(this,this.sortByLRU));for(var e=0,i=this.textures;e<i.length;){var n=i[e];if(++e,null!=n.realloc&&(null!=n.t||null!=n.realloc)&&(t||n.get_lastFrame()<Qs.frameCount-3600))return n.dispose(),!0}return!1},sortByLRU:function(t,e){return t.get_lastFrame()-e.get_lastFrame()},deleteTexture:function(t){l.remove(this.textures,t)&&(this.driver.disposeTexture(t),this.texMemory-=t.width*t.height*this.bpp(t))},allocTexture:function(t){this.cleanTextures(!1);if(t.t=this.driver.allocTexture(t),null!=t.t)this.textures.push(t),this.texMemory+=t.width*t.height*this.bpp(t);else{if(this.driver.isDisposed())return;if(!this.cleanTextures(!0))throw kn.thrown("Maximum texture memory reached");this.allocTexture(t)}},allocDepth:function(t){this.cleanTextures(!1);if(t.b=this.driver.allocDepthBuffer(t),null!=t.b)this.depths.push(t),this.texMemory+=t.width*t.height*4;else{if(this.driver.isDisposed())return;if(!this.cleanTextures(!0))throw kn.thrown("Maximum texture memory reached");this.allocDepth(t)}},deleteDepth:function(t){l.remove(this.depths,t)&&(this.driver.disposeDepthBuffer(t),this.texMemory-=t.width*t.height*4)},onContextLost:function(){this.dispose(),this.initIndexes()},dispose:function(){null!=this.triIndexes&&this.triIndexes.dispose(),null!=this.quadIndexes&&this.quadIndexes.dispose(),this.triIndexes=null,this.quadIndexes=null;for(var t=0,e=this.textures.slice();t<e.length;){var i=e[t];++t,i.dispose()}for(t=0,e=this.depths.slice();t<e.length;){var n=e[t];++t,n.dispose()}for(t=0,e=this.buffers.slice();t<e.length;){n=e[t];++t;for(var s=n;null!=s;)s.dispose(),s=s.next}for(t=0,e=this.indexes.slice();t<e.length;){var r=e[t];++t,r.dispose()}this.buffers=[],this.indexes=[],this.textures=[],this.bufferCount=0,this.usedMemory=0,this.texMemory=0},freeMemorySize:function(){for(var t=0,e=0,i=this.buffers;e<i.length;){var n=i[e];++e;for(var s=n;null!=s;){for(var r=s.freeList;null!=r;)t+=r.count*s.stride*4,r=r.next;s=s.next}}return t},stats:function(){for(var t=0,e=0,i=0,n=this.buffers;i<n.length;){var s=n[i];++i;for(var r=s;null!=r;){t+=r.stride*r.size*4;for(var a=r.freeList;null!=a;)e+=a.count*r.stride*4,a=a.next;r=r.next}}return{bufferCount:this.bufferCount,freeManagedMemory:e,managedMemory:t,totalMemory:this.usedMemory+this.texMemory,textureCount:this.textures.length,textureMemory:this.texMemory}},allocStats:function(){return[]},__class__:Ee};var Fe=s["h3d.impl.Step"]={__ename__:!0,__constructs__:null,MainDraw:{_hx_name:"MainDraw",_hx_index:0,__enum__:"h3d.impl.Step",toString:n},Decals:{_hx_name:"Decals",_hx_index:1,__enum__:"h3d.impl.Step",toString:n},Shadows:{_hx_name:"Shadows",_hx_index:2,__enum__:"h3d.impl.Step",toString:n},Lighting:{_hx_name:"Lighting",_hx_index:3,__enum__:"h3d.impl.Step",toString:n},Forward:{_hx_name:"Forward",_hx_index:4,__enum__:"h3d.impl.Step",toString:n},BeforeTonemapping:{_hx_name:"BeforeTonemapping",_hx_index:5,__enum__:"h3d.impl.Step",toString:n},AfterTonemapping:{_hx_name:"AfterTonemapping",_hx_index:6,__enum__:"h3d.impl.Step",toString:n},Overlay:{_hx_name:"Overlay",_hx_index:7,__enum__:"h3d.impl.Step",toString:n}};Fe.__constructs__=[Fe.MainDraw,Fe.Decals,Fe.Shadows,Fe.Lighting,Fe.Forward,Fe.BeforeTonemapping,Fe.AfterTonemapping,Fe.Overlay],Fe.__empty_constructs__=[Fe.MainDraw,Fe.Decals,Fe.Shadows,Fe.Lighting,Fe.Forward,Fe.BeforeTonemapping,Fe.AfterTonemapping,Fe.Overlay];var Te=function(){};i["h3d.impl.RendererFX"]=Te,Te.__name__="h3d.impl.RendererFX",Te.__isInterface__=!0,Te.prototype={__class__:Te};var De=function(t){this.position=0,this.ctx=t,this.cache=[];Ut.CURRENT;this.defaultFormat=ti.nativeFormat,this.defaultDepthBuffer=He.getDefault()};i["h3d.impl.TextureCache"]=De,De.__name__="h3d.impl.TextureCache",De.prototype={get:function(t){return null==t&&(t=0),this.cache[t]},getNamed:function(t){for(var e=0,i=this.position;e<i;){var n=e++;if(this.cache[n].name==t)return this.cache[n]}return null},set:function(t,e){this.cache[e]=t},begin:function(){for(;this.cache.length>this.position;){var t=this.cache.pop();null!=t&&t.dispose()}this.position=0},lookupTarget:function(t,e,i,n,s){for(var r=this.cache[this.position],a=this.position+1,A=this.cache.length;a<A;){var h=a++,o=this.cache[h];if(null!=o&&(null!=o.t||null!=o.realloc)&&o.width==e&&o.height==i&&o.format==n&&s==(0!=(o.flags&1<<Ye.Cube._hx_index)))return this.cache[this.position]=o,this.cache[h]=r,o}null!=r&&r.name==t&&(r.dispose(),r=null);var l=[Ye.Target];s&&l.push(Ye.Cube);var u=new ti(e,i,l,n);return null!=r?this.cache.splice(this.position,0,u):this.cache[this.position]=u,u},allocTarget:function(t,e,i,n,s,r){null==r&&(r=!1),null==n&&(n=!0);var a=this.cache[this.position];return null==s&&(s=this.defaultFormat),(null==a||null==a.t&&null==a.realloc||a.width!=e||a.height!=i||a.format!=s||r!=(0!=(a.flags&1<<Ye.Cube._hx_index)))&&(a=this.lookupTarget(t,e,i,s,r)),a.depthBuffer=n?this.defaultDepthBuffer:null,a.setName(t),this.position++,a},allocTargetScale:function(t,e,i,n){null==i&&(i=!0);var s=Ut.CURRENT;return this.allocTarget(t,Math.ceil(s.width*e),Math.ceil(s.height*e),i,n)},allocTileTarget:function(t,e,i,n){return null==i&&(i=!1),this.allocTarget(t,Math.ceil(e.width+e.x)-Math.floor(e.x),Math.ceil(e.height+e.y)-Math.floor(e.y),i,n)},dispose:function(){for(var t=0,e=this.cache;t<e.length;){var i=e[t];++t,i.dispose()}this.cache=[]},__class__:De};var Pe=function(){};i["hxd.impl.AnyProps"]=Pe,Pe.__name__="hxd.impl.AnyProps",Pe.prototype={set_props:function(t){return this.props=t,this.refreshProps(),t},setDefaultProps:function(t){this.set_props(this.getDefaultProps(t))},getDefaultProps:function(t){return{}},refreshProps:function(){},__class__:Pe};var ze=function(t){null!=t&&this.addPass(new qe("default",null)).addShader(t)};i["h3d.mat.BaseMaterial"]=ze,ze.__name__="h3d.mat.BaseMaterial",ze.__interfaces__=[dt],ze.__super__=Pe,ze.prototype=r(Pe.prototype,{addPass:function(t){for(var e=null,i=this.passes;null!=i;)e=i,i=i.nextPass;return null==e?this.passes=t:e.nextPass=t,t.nextPass=null,t},removePass:function(t){for(var e=null,i=this.passes;null!=i;){if(i==t)return null==e?this.passes=t.nextPass:e.nextPass=t.nextPass,t.nextPass=null,!0;e=i,i=i.nextPass}return!1},get_mainPass:function(){return this.passes},getPasses:function(){for(var t=this.passes,e=[];null!=t;)e.push(t),t=t.nextPass;return e},getPass:function(t){for(var e=this.passes;null!=e;){if(e.name==t)return e;e=e.nextPass}return null},allocPass:function(t,e){if(null==e&&(e=!0),null!=(i=this.getPass(t)))return i;var i=new qe(t,null,e?this.passes:null);return e&&null!=this.passes&&i.set_batchMode(this.passes.batchMode),this.addPass(i),i},clone:function(t){return null==t&&(t=new ze),t.passes.load(this.passes),t.name=this.name,t.set_props(this.props),t},__class__:ze});var Re=s["h3d.mat.Face"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"h3d.mat.Face",toString:n},Back:{_hx_name:"Back",_hx_index:1,__enum__:"h3d.mat.Face",toString:n},Front:{_hx_name:"Front",_hx_index:2,__enum__:"h3d.mat.Face",toString:n},Both:{_hx_name:"Both",_hx_index:3,__enum__:"h3d.mat.Face",toString:n}};Re.__constructs__=[Re.None,Re.Back,Re.Front,Re.Both],Re.__empty_constructs__=[Re.None,Re.Back,Re.Front,Re.Both];var Le=s["h3d.mat.Blend"]={__ename__:!0,__constructs__:null,One:{_hx_name:"One",_hx_index:0,__enum__:"h3d.mat.Blend",toString:n},Zero:{_hx_name:"Zero",_hx_index:1,__enum__:"h3d.mat.Blend",toString:n},SrcAlpha:{_hx_name:"SrcAlpha",_hx_index:2,__enum__:"h3d.mat.Blend",toString:n},SrcColor:{_hx_name:"SrcColor",_hx_index:3,__enum__:"h3d.mat.Blend",toString:n},DstAlpha:{_hx_name:"DstAlpha",_hx_index:4,__enum__:"h3d.mat.Blend",toString:n},DstColor:{_hx_name:"DstColor",_hx_index:5,__enum__:"h3d.mat.Blend",toString:n},OneMinusSrcAlpha:{_hx_name:"OneMinusSrcAlpha",_hx_index:6,__enum__:"h3d.mat.Blend",toString:n},OneMinusSrcColor:{_hx_name:"OneMinusSrcColor",_hx_index:7,__enum__:"h3d.mat.Blend",toString:n},OneMinusDstAlpha:{_hx_name:"OneMinusDstAlpha",_hx_index:8,__enum__:"h3d.mat.Blend",toString:n},OneMinusDstColor:{_hx_name:"OneMinusDstColor",_hx_index:9,__enum__:"h3d.mat.Blend",toString:n},ConstantColor:{_hx_name:"ConstantColor",_hx_index:10,__enum__:"h3d.mat.Blend",toString:n},ConstantAlpha:{_hx_name:"ConstantAlpha",_hx_index:11,__enum__:"h3d.mat.Blend",toString:n},OneMinusConstantColor:{_hx_name:"OneMinusConstantColor",_hx_index:12,__enum__:"h3d.mat.Blend",toString:n},OneMinusConstantAlpha:{_hx_name:"OneMinusConstantAlpha",_hx_index:13,__enum__:"h3d.mat.Blend",toString:n},SrcAlphaSaturate:{_hx_name:"SrcAlphaSaturate",_hx_index:14,__enum__:"h3d.mat.Blend",toString:n}};Le.__constructs__=[Le.One,Le.Zero,Le.SrcAlpha,Le.SrcColor,Le.DstAlpha,Le.DstColor,Le.OneMinusSrcAlpha,Le.OneMinusSrcColor,Le.OneMinusDstAlpha,Le.OneMinusDstColor,Le.ConstantColor,Le.ConstantAlpha,Le.OneMinusConstantColor,Le.OneMinusConstantAlpha,Le.SrcAlphaSaturate],Le.__empty_constructs__=[Le.One,Le.Zero,Le.SrcAlpha,Le.SrcColor,Le.DstAlpha,Le.DstColor,Le.OneMinusSrcAlpha,Le.OneMinusSrcColor,Le.OneMinusDstAlpha,Le.OneMinusDstColor,Le.ConstantColor,Le.ConstantAlpha,Le.OneMinusConstantColor,Le.OneMinusConstantAlpha,Le.SrcAlphaSaturate];var Ve=s["h3d.mat.Compare"]={__ename__:!0,__constructs__:null,Always:{_hx_name:"Always",_hx_index:0,__enum__:"h3d.mat.Compare",toString:n},Never:{_hx_name:"Never",_hx_index:1,__enum__:"h3d.mat.Compare",toString:n},Equal:{_hx_name:"Equal",_hx_index:2,__enum__:"h3d.mat.Compare",toString:n},NotEqual:{_hx_name:"NotEqual",_hx_index:3,__enum__:"h3d.mat.Compare",toString:n},Greater:{_hx_name:"Greater",_hx_index:4,__enum__:"h3d.mat.Compare",toString:n},GreaterEqual:{_hx_name:"GreaterEqual",_hx_index:5,__enum__:"h3d.mat.Compare",toString:n},Less:{_hx_name:"Less",_hx_index:6,__enum__:"h3d.mat.Compare",toString:n},LessEqual:{_hx_name:"LessEqual",_hx_index:7,__enum__:"h3d.mat.Compare",toString:n}};Ve.__constructs__=[Ve.Always,Ve.Never,Ve.Equal,Ve.NotEqual,Ve.Greater,Ve.GreaterEqual,Ve.Less,Ve.LessEqual],Ve.__empty_constructs__=[Ve.Always,Ve.Never,Ve.Equal,Ve.NotEqual,Ve.Greater,Ve.GreaterEqual,Ve.Less,Ve.LessEqual];var Qe=s["h3d.mat.StencilOp"]={__ename__:!0,__constructs__:null,Keep:{_hx_name:"Keep",_hx_index:0,__enum__:"h3d.mat.StencilOp",toString:n},Zero:{_hx_name:"Zero",_hx_index:1,__enum__:"h3d.mat.StencilOp",toString:n},Replace:{_hx_name:"Replace",_hx_index:2,__enum__:"h3d.mat.StencilOp",toString:n},Increment:{_hx_name:"Increment",_hx_index:3,__enum__:"h3d.mat.StencilOp",toString:n},IncrementWrap:{_hx_name:"IncrementWrap",_hx_index:4,__enum__:"h3d.mat.StencilOp",toString:n},Decrement:{_hx_name:"Decrement",_hx_index:5,__enum__:"h3d.mat.StencilOp",toString:n},DecrementWrap:{_hx_name:"DecrementWrap",_hx_index:6,__enum__:"h3d.mat.StencilOp",toString:n},Invert:{_hx_name:"Invert",_hx_index:7,__enum__:"h3d.mat.StencilOp",toString:n}};Qe.__constructs__=[Qe.Keep,Qe.Zero,Qe.Replace,Qe.Increment,Qe.IncrementWrap,Qe.Decrement,Qe.DecrementWrap,Qe.Invert],Qe.__empty_constructs__=[Qe.Keep,Qe.Zero,Qe.Replace,Qe.Increment,Qe.IncrementWrap,Qe.Decrement,Qe.DecrementWrap,Qe.Invert];var Ue=s["h3d.mat.MipMap"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"h3d.mat.MipMap",toString:n},Nearest:{_hx_name:"Nearest",_hx_index:1,__enum__:"h3d.mat.MipMap",toString:n},Linear:{_hx_name:"Linear",_hx_index:2,__enum__:"h3d.mat.MipMap",toString:n}};Ue.__constructs__=[Ue.None,Ue.Nearest,Ue.Linear],Ue.__empty_constructs__=[Ue.None,Ue.Nearest,Ue.Linear];var Oe=s["h3d.mat.Filter"]={__ename__:!0,__constructs__:null,Nearest:{_hx_name:"Nearest",_hx_index:0,__enum__:"h3d.mat.Filter",toString:n},Linear:{_hx_name:"Linear",_hx_index:1,__enum__:"h3d.mat.Filter",toString:n}};Oe.__constructs__=[Oe.Nearest,Oe.Linear],Oe.__empty_constructs__=[Oe.Nearest,Oe.Linear];var Ge=s["h3d.mat.Wrap"]={__ename__:!0,__constructs__:null,Clamp:{_hx_name:"Clamp",_hx_index:0,__enum__:"h3d.mat.Wrap",toString:n},Repeat:{_hx_name:"Repeat",_hx_index:1,__enum__:"h3d.mat.Wrap",toString:n}};Ge.__constructs__=[Ge.Clamp,Ge.Repeat],Ge.__empty_constructs__=[Ge.Clamp,Ge.Repeat];var Ne=s["h3d.mat.Operation"]={__ename__:!0,__constructs__:null,Add:{_hx_name:"Add",_hx_index:0,__enum__:"h3d.mat.Operation",toString:n},Sub:{_hx_name:"Sub",_hx_index:1,__enum__:"h3d.mat.Operation",toString:n},ReverseSub:{_hx_name:"ReverseSub",_hx_index:2,__enum__:"h3d.mat.Operation",toString:n},Min:{_hx_name:"Min",_hx_index:3,__enum__:"h3d.mat.Operation",toString:n},Max:{_hx_name:"Max",_hx_index:4,__enum__:"h3d.mat.Operation",toString:n}};Ne.__constructs__=[Ne.Add,Ne.Sub,Ne.ReverseSub,Ne.Min,Ne.Max],Ne.__empty_constructs__=[Ne.Add,Ne.Sub,Ne.ReverseSub,Ne.Min,Ne.Max];var Ye=s["h3d.mat.TextureFlags"]={__ename__:!0,__constructs__:null,Target:{_hx_name:"Target",_hx_index:0,__enum__:"h3d.mat.TextureFlags",toString:n},Cube:{_hx_name:"Cube",_hx_index:1,__enum__:"h3d.mat.TextureFlags",toString:n},MipMapped:{_hx_name:"MipMapped",_hx_index:2,__enum__:"h3d.mat.TextureFlags",toString:n},ManualMipMapGen:{_hx_name:"ManualMipMapGen",_hx_index:3,__enum__:"h3d.mat.TextureFlags",toString:n},IsNPOT:{_hx_name:"IsNPOT",_hx_index:4,__enum__:"h3d.mat.TextureFlags",toString:n},NoAlloc:{_hx_name:"NoAlloc",_hx_index:5,__enum__:"h3d.mat.TextureFlags",toString:n},Dynamic:{_hx_name:"Dynamic",_hx_index:6,__enum__:"h3d.mat.TextureFlags",toString:n},AlphaPremultiplied:{_hx_name:"AlphaPremultiplied",_hx_index:7,__enum__:"h3d.mat.TextureFlags",toString:n},WasCleared:{_hx_name:"WasCleared",_hx_index:8,__enum__:"h3d.mat.TextureFlags",toString:n},Loading:{_hx_name:"Loading",_hx_index:9,__enum__:"h3d.mat.TextureFlags",toString:n},Serialize:{_hx_name:"Serialize",_hx_index:10,__enum__:"h3d.mat.TextureFlags",toString:n},IsArray:{_hx_name:"IsArray",_hx_index:11,__enum__:"h3d.mat.TextureFlags",toString:n}};Ye.__constructs__=[Ye.Target,Ye.Cube,Ye.MipMapped,Ye.ManualMipMapGen,Ye.IsNPOT,Ye.NoAlloc,Ye.Dynamic,Ye.AlphaPremultiplied,Ye.WasCleared,Ye.Loading,Ye.Serialize,Ye.IsArray],Ye.__empty_constructs__=[Ye.Target,Ye.Cube,Ye.MipMapped,Ye.ManualMipMapGen,Ye.IsNPOT,Ye.NoAlloc,Ye.Dynamic,Ye.AlphaPremultiplied,Ye.WasCleared,Ye.Loading,Ye.Serialize,Ye.IsArray];var Xe=function(){};i["h3d.mat.Defaults"]=Xe,Xe.__name__="h3d.mat.Defaults",Xe.get_shadowShader=function(){var t=Xe.shadowShader;return null==t&&(t=new gn,Xe.set_shadowShader(t),Xe.shadowShader.setPriority(-1)),t},Xe.set_shadowShader=function(t){return Xe.shadowShader=t},Xe.makeVolumeDecal=function(t){return new Cn(t.xMax-t.xMin,t.yMax-t.yMin)};var je=s["h3d.mat.DepthFormat"]={__ename__:!0,__constructs__:null,Depth16:{_hx_name:"Depth16",_hx_index:0,__enum__:"h3d.mat.DepthFormat",toString:n},Depth24:{_hx_name:"Depth24",_hx_index:1,__enum__:"h3d.mat.DepthFormat",toString:n},Depth24Stencil8:{_hx_name:"Depth24Stencil8",_hx_index:2,__enum__:"h3d.mat.DepthFormat",toString:n}};je.__constructs__=[je.Depth16,je.Depth24,je.Depth24Stencil8],je.__empty_constructs__=[je.Depth16,je.Depth24,je.Depth24Stencil8];var He=function(t,e,i){this.width=t,this.height=e,this.format=i,t>0&&this.alloc()};i["h3d.mat.DepthBuffer"]=He,He.__name__="h3d.mat.DepthBuffer",He.getDefault=function(){return Ut.CURRENT.driver.getDefaultDepthBuffer()},He.prototype={hasStencil:function(){switch(this.format._hx_index){case 0:case 1:return!1;case 2:return!0}},alloc:function(){Ut.CURRENT.mem.allocDepth(this)},dispose:function(){null!=this.b&&(Ut.CURRENT.mem.deleteDepth(this),this.b=null)},isDisposed:function(){return null==this.b},__class__:He};var We=function(t){this.mshader=new rn,this.set_blendMode(et.None),ze.call(this,this.mshader),this.set_texture(t)};i["h3d.mat.Material"]=We,We.__name__="h3d.mat.Material",We.create=function(t){var e=Je.current.createMaterial();return e.set_texture(t),e.set_props(e.getDefaultProps()),e},We.__super__=ze,We.prototype=r(ze.prototype,{get_specularPower:function(){return this.mshader.specularPower__},set_specularPower:function(t){return this.mshader.specularPower__=t},get_specularAmount:function(){return this.mshader.specularAmount__},set_specularAmount:function(t){return this.mshader.specularAmount__=t},get_color:function(){return this.mshader.color__},set_color:function(t){return this.mshader.color__=t},get_shadows:function(){return!!this.castShadows&&this.receiveShadows},set_shadows:function(t){return this.set_castShadows(t),this.set_receiveShadows(t),t},set_castShadows:function(t){return this.castShadows==t?t:(null!=this.passes&&(t?this.addPass(new qe("shadow",null,this.passes)).set_isStatic(this.staticShadows):this.removePass(this.getPass("shadow"))),this.castShadows=t)},set_receiveShadows:function(t){if(t==this.receiveShadows)return t;if(null!=this.passes){var e=Xe.get_shadowShader();t?this.passes.addShader(e):this.passes.removeShader(e)}return this.receiveShadows=t},set_staticShadows:function(t){var e=this.getPass("shadow");return null!=e&&e.set_isStatic(t),this.staticShadows=t},clone:function(t){var e,i=null==t?new We:t;(ze.prototype.clone.call(this,i),i.set_castShadows(this.castShadows),i.set_receiveShadows(this.receiveShadows),i.set_texture(this.get_texture()),i.set_specularTexture(this.get_specularTexture()),i.set_normalMap(this.get_normalMap()),null!=this.textureShader)&&((e=i.textureShader).constModified=!0,e.additive__=this.textureShader.additive__,(e=i.textureShader).constModified=!0,e.killAlpha__=this.textureShader.killAlpha__,i.textureShader.killAlphaThreshold__=this.textureShader.killAlphaThreshold__);return i.mshader.color__=this.mshader.color__,i.set_blendMode(this.blendMode),i},set_blendMode:function(t){if(null!=this.passes)switch(this.passes.setBlendMode(t),t._hx_index){case 0:this.passes.set_depthWrite(!0),this.passes.setPassName("default");break;case 1:this.passes.set_depthWrite(!0),this.passes.setPassName("alpha");break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:this.passes.set_depthWrite(!1),this.passes.setPassName("additive")}return this.blendMode=t},get_specularTexture:function(){return null==this.specularShader?null:this.specularShader.texture__},get_texture:function(){return null==this.textureShader?null:this.textureShader.texture__},set_texture:function(t){return null==t?null!=this.textureShader&&(this.passes.removeShader(this.textureShader),this.textureShader=null):(null==this.textureShader&&(this.textureShader=new wn,this.passes.addShader(this.textureShader)),this.textureShader.texture__=t),t},get_normalMap:function(){return null==this.normalShader?null:this.normalShader.texture__},set_normalMap:function(t){return null==t?null!=this.normalShader&&(this.passes.removeShader(this.normalShader),this.normalShader=null):(null==this.normalShader&&(this.normalShader=new pn,null!=this.textureShader?this.passes.addShaderAtIndex(this.normalShader,this.passes.getShaderIndex(this.textureShader)+1):this.passes.addShader(this.normalShader)),this.normalShader.texture__=t),t},set_specularTexture:function(t){return null==t?null!=this.specularShader&&(this.passes.removeShader(this.specularShader),this.specularShader=null):(null==this.specularShader&&(this.specularShader=new bn,this.passes.addShader(this.specularShader)),this.specularShader.texture__=t),t},getDefaultModelProps:function(){var t=this.getDefaultProps();switch(this.blendMode._hx_index){case 0:break;case 1:t.kind="Alpha";break;case 2:t.kind="Add",t.culling=!1,t.shadows=!1,t.light=!1;break;default:throw kn.thrown("Unsupported HMD material "+x.string(this.blendMode))}return t},getDefaultProps:function(t){var e;if(null==t)e={kind:"Opaque",shadows:!0,culling:!0,light:!0};else switch(t){case"particles3D":case"trail3D":e={kind:"Alpha",shadows:!1,culling:!1,light:!0};break;case"ui":e={kind:"Alpha",shadows:!1,culling:!1,light:!1};break;default:e={kind:"Opaque",shadows:!0,culling:!0,light:!0}}return e},refreshProps:function(){if(null!=this.props&&null!=this.passes){var t=this.props;switch(t.kind){case"Add":this.set_blendMode(et.Add);break;case"Alpha":this.set_blendMode(et.Alpha);break;case"AlphaKill":case"Hidden":case"Opaque":this.set_blendMode(et.None);break;case"SoftAdd":this.set_blendMode(et.SoftAdd)}var e=this.textureShader;null!=e&&(e.constModified=!0,e.killAlpha__="AlphaKill"==t.kind,e.killAlphaThreshold__=.5),this.passes.set_culling("Hidden"==t.kind?Re.Both:t.culling?Re.Back:Re.None),this.passes.set_enableLights(t.light);var i=t.shadows;this.set_castShadows(i),this.set_receiveShadows(i),this.castShadows&&this.receiveShadows&&this.getPass("shadow").set_culling(this.passes.culling)}},__class__:We});var Ze=function(){this.db=new Kn};i["h3d.mat.MaterialDatabase"]=Ze,Ze.__name__="h3d.mat.MaterialDatabase",Ze.prototype={getFilePath:function(t){return t.entry.get_directory()+"/materials.props"},getModelData:function(t){if(null==t)return null;var e=this.db,i=t.entry.get_directory(),n=e.h[i];if(null!=n)return n.v;var s,r=this.getFilePath(t);try{s=JSON.parse(la.currentInstance.load(r).toText())}catch(t){if(!(kn.caught(t).unwrap()instanceof Gr))throw t;s={}}e=this.db,i=t.entry.get_directory();return e.h[i]={v:s},s},saveData:function(t,e){var i=this.getFilePath(t);throw kn.thrown("Can't save material props database "+i)},loadMatProps:function(t,e){var i=this.getModelData(t.model);return null==i||null==(i=i.materials)||null==(i=f.field(i,e.name))?i:f.field(i,t.name)},saveMatProps:function(t,e){var i=["materials",e.name,t.name],n=this.getModelData(t.model);if(null!=n){for(var s=n,r=[],a=0,A=i.length-1;a<A;){var h=a++,o=f.field(n,i[h]);null==o&&(o={},n[i[h]]=o),r.push(n),n=o}var l=i.pop();f.deleteField(n,l);var u=t.props,_=t.getDefaultProps();if(null==u||x.string(_)==x.string(u))for(;i.length>0;){var c=i.pop(),d=r.pop();if(0!=f.fields(f.field(d,c)).length)break;f.deleteField(d,c)}else n[l]=u;this.getFilePath(t.model);0==f.fields(s).length&&(s=null),this.saveData(t.model,s)}},__class__:Ze};var Je=function(t){null==this.database&&(this.database=new Ze),this.name=t};i["h3d.mat.MaterialSetup"]=Je,Je.__name__="h3d.mat.MaterialSetup",Je.prototype={createRenderer:function(){return new en},createLightSystem:function(){return new Ki},createMaterial:function(){return new We},getDefaults:function(t){return null==this.emptyMat&&(this.emptyMat=this.createMaterial()),this.emptyMat.getDefaultProps(t)},loadMaterialProps:function(t){return this.database.loadMatProps(t,this)},saveMaterialProps:function(t){this.database.saveMatProps(t,this)},customMeshInit:function(t){},__class__:Je};var qe=function(t,e,i){this.layer=0,this.bits=0,this.parentPass=i,this.shaders=e,this.setPassName(t),this.set_culling(Re.Back);var n=Le.One,s=Le.Zero;this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(s),this.set_blendAlphaDst(s),this.depth(!0,Ve.Less),this.set_blendOp(this.set_blendAlphaOp(Ne.Add)),this.colorMask=15};i["h3d.mat.Pass"]=qe,qe.__name__="h3d.mat.Pass",qe.__interfaces__=[dt],qe.getEnableLights=function(t){return 1&t},qe.getDynamicParameters=function(t){return t>>1&1},qe.getIsStatic=function(t){return t>>2&1},qe.getBatchMode=function(t){return t>>3&1},qe.getCulling=function(t){return 3&t},qe.getDepthWrite=function(t){return t>>2&1},qe.getDepthTest=function(t){return t>>3&7},qe.getBlendSrc=function(t){return t>>6&15},qe.getBlendDst=function(t){return t>>10&15},qe.getBlendAlphaSrc=function(t){return t>>14&15},qe.getBlendAlphaDst=function(t){return t>>18&15},qe.getBlendOp=function(t){return t>>22&7},qe.getBlendAlphaOp=function(t){return t>>25&7},qe.getWireframe=function(t){return t>>28&1},qe.getReserved=function(t){return t>>29&1},qe.prototype={load:function(t){this.name=t.name,this.passId=t.passId,this.bits=t.bits,this.set_enableLights(t.enableLights),this.set_dynamicParameters(t.dynamicParameters),this.set_culling(t.culling),this.set_depthWrite(t.depthWrite),this.set_depthTest(t.depthTest),this.set_blendSrc(t.blendSrc),this.set_blendDst(t.blendDst),this.set_blendOp(t.blendOp),this.set_blendAlphaSrc(t.blendAlphaSrc),this.set_blendAlphaDst(t.blendAlphaDst),this.set_blendAlphaOp(t.blendAlphaOp),this.colorMask=t.colorMask,null!=t.stencil&&(null==this.stencil&&(this.stencil=new Ke),this.stencil.load(t.stencil))},setPassName:function(t){this.name=t,this.passId=vA.allocID(t)},blend:function(t,e){this.set_blendSrc(t),this.set_blendAlphaSrc(t),this.set_blendDst(e),this.set_blendAlphaDst(e)},setBlendMode:function(t){switch(t._hx_index){case 0:var e=Le.One,i=Le.Zero;this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(i),this.set_blendAlphaDst(i),this.set_blendOp(Ne.Add),this.set_blendAlphaOp(Ne.Add);break;case 1:e=Le.SrcAlpha,i=Le.OneMinusSrcAlpha;this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(i),this.set_blendAlphaDst(i),this.set_blendOp(Ne.Add),this.set_blendAlphaOp(Ne.Add);break;case 2:e=Le.SrcAlpha,i=Le.One;this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(i),this.set_blendAlphaDst(i),this.set_blendOp(Ne.Add),this.set_blendAlphaOp(Ne.Add);break;case 3:e=Le.One,i=Le.OneMinusSrcAlpha;this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(i),this.set_blendAlphaDst(i),this.set_blendOp(Ne.Add),this.set_blendAlphaOp(Ne.Add);break;case 4:e=Le.OneMinusDstColor,i=Le.One;this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(i),this.set_blendAlphaDst(i),this.set_blendOp(Ne.Add),this.set_blendAlphaOp(Ne.Add);break;case 5:e=Le.DstColor,i=Le.Zero;this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(i),this.set_blendAlphaDst(i),this.set_blendOp(Ne.Add),this.set_blendAlphaOp(Ne.Add);break;case 6:e=Le.DstColor,i=Le.OneMinusSrcAlpha;this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(i),this.set_blendAlphaDst(i),this.set_blendOp(Ne.Add),this.set_blendAlphaOp(Ne.Add);break;case 7:e=Le.Zero,i=Le.OneMinusSrcColor;this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(i),this.set_blendAlphaDst(i),this.set_blendOp(Ne.Add),this.set_blendAlphaOp(Ne.Add);break;case 8:e=Le.One,i=Le.OneMinusSrcColor;this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(i),this.set_blendAlphaDst(i),this.set_blendOp(Ne.Add),this.set_blendAlphaOp(Ne.Add);break;case 9:e=Le.SrcAlpha,i=Le.One;this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(i),this.set_blendAlphaDst(i),this.set_blendOp(Ne.ReverseSub),this.set_blendAlphaOp(Ne.ReverseSub);break;case 10:this.set_blendSrc(Le.Zero),this.set_blendAlphaSrc(Le.Zero),this.set_blendDst(Le.Zero),this.set_blendAlphaDst(Le.Zero),this.set_blendAlphaSrc(Le.Zero),this.set_blendAlphaDst(Le.Zero),this.set_blendAlphaOp(Ne.Max),this.set_blendOp(Ne.Max);break;case 11:this.set_blendSrc(Le.Zero),this.set_blendAlphaSrc(Le.Zero),this.set_blendDst(Le.Zero),this.set_blendAlphaDst(Le.Zero),this.set_blendAlphaSrc(Le.Zero),this.set_blendAlphaDst(Le.Zero),this.set_blendAlphaOp(Ne.Min),this.set_blendOp(Ne.Min)}},depth:function(t,e){this.set_depthWrite(t),this.set_depthTest(e)},setColorMask:function(t,e,i,n){this.colorMask=(t?1:0)|(e?2:0)|(i?4:0)|(n?8:0)},setColorChannel:function(t){switch(t._hx_index){case 1:this.setColorMask(!0,!1,!1,!1);break;case 2:this.setColorMask(!1,!0,!1,!1);break;case 3:this.setColorMask(!1,!1,!0,!1);break;case 4:this.setColorMask(!1,!1,!1,!0);break;default:throw kn.thrown("Unsupported channel "+x.string(t))}},addShader:function(t){return null==t?null:(this.shaders=PA.addSort(t,this.shaders),t)},addShaderAtIndex:function(t,e){for(var i=null,n=this.shaders;e>0&&n!=this.parentShaders;)i=n,n=n.next,--e;return null==i?this.shaders=new PA(t,n):i.next=new PA(t,n),t},getShaderIndex:function(t){for(var e=0,i=this.shaders;i!=this.parentShaders;){if(i.s==t)return e;i=i.next,++e}return-1},removeShader:function(t){for(var e=this.shaders,i=null;null!=e;){if(e.s==t)return null==i?this.shaders=e.next:i.next=e.next,!0;i=e,e=e.next}return!1},getShader:function(t){for(var e=this.shaders;e!=this.parentShaders;){var i=e.s,n=yA.__downcastCheck(i,t)?i:null;if(null!=n)return n;e=e.next}return null},getShaderByName:function(t){for(var e=this.shaders;e!=this.parentShaders;){if(e.s.shader.data.name==t)return e.s;e=e.next}return null},getShaders:function(){return new zA(this.shaders,this.parentShaders)},getShadersRec:function(){if(null==this.parentPass||this.parentShaders==this.parentPass.shaders)return this.shaders;for(var t=this.shaders,e=null;null!=t&&t!=this.parentShaders;)e=t,t=t.next;return this.parentShaders=this.parentPass.shaders,null==e?this.shaders=this.parentShaders:e.next=this.parentShaders,this.shaders},clone:function(){var t=new qe(this.name,this.shaders.clone());return t.bits=this.bits,t.set_enableLights(this.enableLights),null!=this.stencil&&(t.stencil=this.stencil.clone()),t},getDebugShaderCode:function(t,e){null==e&&(e=!0);var i=t.renderer.debugCompileShader(this);if(e){var n=function(t){return SA.shaderToString(t,true)};return"// vertex:\n"+n(i.vertex.data)+"\n\nfragment:\n"+n(i.fragment.data)}return Ut.CURRENT.driver.getNativeShaderCode(i)},set_enableLights:function(t){return this.flags=-2&this.flags|(t?1:0),this.enableLights=t},set_dynamicParameters:function(t){return this.flags=-3&this.flags|(t?1:0)<<1,this.dynamicParameters=t},set_isStatic:function(t){return this.flags=-5&this.flags|(t?1:0)<<2,this.isStatic=t},set_batchMode:function(t){return this.flags=-9&this.flags|(t?1:0)<<3,this.batchMode=t},set_culling:function(t){return this.bits=-4&this.bits|t._hx_index,this.culling=t},set_depthWrite:function(t){return this.bits=-5&this.bits|(t?1:0)<<2,this.depthWrite=t},set_depthTest:function(t){return this.bits=-57&this.bits|t._hx_index<<3,this.depthTest=t},set_blendSrc:function(t){return this.bits=-961&this.bits|t._hx_index<<6,this.blendSrc=t},set_blendDst:function(t){return this.bits=-15361&this.bits|t._hx_index<<10,this.blendDst=t},set_blendAlphaSrc:function(t){return this.bits=-245761&this.bits|t._hx_index<<14,this.blendAlphaSrc=t},set_blendAlphaDst:function(t){return this.bits=-3932161&this.bits|t._hx_index<<18,this.blendAlphaDst=t},set_blendOp:function(t){return this.bits=-29360129&this.bits|t._hx_index<<22,this.blendOp=t},set_blendAlphaOp:function(t){return this.bits=-234881025&this.bits|t._hx_index<<25,this.blendAlphaOp=t},set_wireframe:function(t){return this.bits=-268435457&this.bits|(t?1:0)<<28,this.wireframe=t},set_reserved:function(t){return this.bits=-536870913&this.bits|(t?1:0)<<29,this.reserved=t},loadFlags:function(t){this.flags=t,this.set_enableLights(0!=(1&this.flags)),this.set_dynamicParameters(0!=(this.flags>>1&1)),this.set_isStatic(0!=(this.flags>>2&1)),this.set_batchMode(0!=(this.flags>>3&1))},loadBits:function(t){this.bits=t,this.set_culling(m.createEnumIndex(Re,3&this.bits)),this.set_depthWrite(0!=(this.bits>>2&1)),this.set_depthTest(m.createEnumIndex(Ve,this.bits>>3&7)),this.set_blendSrc(m.createEnumIndex(Le,this.bits>>6&15)),this.set_blendDst(m.createEnumIndex(Le,this.bits>>10&15)),this.set_blendAlphaSrc(m.createEnumIndex(Le,this.bits>>14&15)),this.set_blendAlphaDst(m.createEnumIndex(Le,this.bits>>18&15)),this.set_blendOp(m.createEnumIndex(Ne,this.bits>>22&7)),this.set_blendAlphaOp(m.createEnumIndex(Ne,this.bits>>25&7)),this.set_wireframe(0!=(this.bits>>28&1)),this.set_reserved(0!=(this.bits>>29&1))},__class__:qe};var Ke=function(){this.opBits=0,this.maskBits=0,this.setOp(Qe.Keep,Qe.Keep,Qe.Keep),this.setFunc(Ve.Always)};i["h3d.mat.Stencil"]=Ke,Ke.__name__="h3d.mat.Stencil",Ke.__interfaces__=[dt],Ke.getReadMask=function(t){return 255&t},Ke.getWriteMask=function(t){return t>>8&255},Ke.getReference=function(t){return t>>16&255},Ke.getFrontTest=function(t){return 7&t},Ke.getFrontPass=function(t){return t>>3&7},Ke.getFrontSTfail=function(t){return t>>6&7},Ke.getFrontDPfail=function(t){return t>>9&7},Ke.getBackTest=function(t){return t>>12&7},Ke.getBackPass=function(t){return t>>15&7},Ke.getBackSTfail=function(t){return t>>18&7},Ke.getBackDPfail=function(t){return t>>21&7},Ke.prototype={setFront:function(t,e,i){this.set_frontSTfail(t),this.set_frontDPfail(e),this.set_frontPass(i)},setBack:function(t,e,i){this.set_backSTfail(t),this.set_backDPfail(e),this.set_backPass(i)},setOp:function(t,e,i){this.setFront(t,e,i),this.setBack(t,e,i)},setFunc:function(t,e,i,n){null==n&&(n=255),null==i&&(i=255),null==e&&(e=0),this.set_frontTest(this.set_backTest(t)),this.set_reference(e),this.set_readMask(i),this.set_writeMask(n)},clone:function(){var t=new Ke;return t.opBits=this.opBits,t.maskBits=this.maskBits,t},load:function(t){this.opBits=t.opBits,this.maskBits=t.maskBits},set_readMask:function(t){return this.maskBits=-256&this.maskBits|255&t,this.readMask=t},set_writeMask:function(t){return this.maskBits=-65281&this.maskBits|(255&t)<<8,this.writeMask=t},set_reference:function(t){return this.maskBits=-16711681&this.maskBits|(255&t)<<16,this.reference=t},set_frontTest:function(t){return this.opBits=-8&this.opBits|t._hx_index,this.frontTest=t},set_frontPass:function(t){return this.opBits=-57&this.opBits|t._hx_index<<3,this.frontPass=t},set_frontSTfail:function(t){return this.opBits=-449&this.opBits|t._hx_index<<6,this.frontSTfail=t},set_frontDPfail:function(t){return this.opBits=-3585&this.opBits|t._hx_index<<9,this.frontDPfail=t},set_backTest:function(t){return this.opBits=-28673&this.opBits|t._hx_index<<12,this.backTest=t},set_backPass:function(t){return this.opBits=-229377&this.opBits|t._hx_index<<15,this.backPass=t},set_backSTfail:function(t){return this.opBits=-1835009&this.opBits|t._hx_index<<18,this.backSTfail=t},set_backDPfail:function(t){return this.opBits=-14680065&this.opBits|t._hx_index<<21,this.backDPfail=t},loadOpBits:function(t){this.opBits=t,this.set_frontTest(m.createEnumIndex(Ve,7&this.opBits)),this.set_frontPass(m.createEnumIndex(Qe,this.opBits>>3&7)),this.set_frontSTfail(m.createEnumIndex(Qe,this.opBits>>6&7)),this.set_frontDPfail(m.createEnumIndex(Qe,this.opBits>>9&7)),this.set_backTest(m.createEnumIndex(Ve,this.opBits>>12&7)),this.set_backPass(m.createEnumIndex(Qe,this.opBits>>15&7)),this.set_backSTfail(m.createEnumIndex(Qe,this.opBits>>18&7)),this.set_backDPfail(m.createEnumIndex(Qe,this.opBits>>21&7))},loadMaskBits:function(t){this.maskBits=t,this.set_readMask(255&this.maskBits),this.set_writeMask(this.maskBits>>8&255),this.set_reference(this.maskBits>>16&255)},__class__:Ke};var $e=s["hxd.PixelFormat"]={__ename__:!0,__constructs__:null,ARGB:{_hx_name:"ARGB",_hx_index:0,__enum__:"hxd.PixelFormat",toString:n},BGRA:{_hx_name:"BGRA",_hx_index:1,__enum__:"hxd.PixelFormat",toString:n},RGBA:{_hx_name:"RGBA",_hx_index:2,__enum__:"hxd.PixelFormat",toString:n},RGBA16F:{_hx_name:"RGBA16F",_hx_index:3,__enum__:"hxd.PixelFormat",toString:n},RGBA32F:{_hx_name:"RGBA32F",_hx_index:4,__enum__:"hxd.PixelFormat",toString:n},R8:{_hx_name:"R8",_hx_index:5,__enum__:"hxd.PixelFormat",toString:n},R16F:{_hx_name:"R16F",_hx_index:6,__enum__:"hxd.PixelFormat",toString:n},R32F:{_hx_name:"R32F",_hx_index:7,__enum__:"hxd.PixelFormat",toString:n},RG8:{_hx_name:"RG8",_hx_index:8,__enum__:"hxd.PixelFormat",toString:n},RG16F:{_hx_name:"RG16F",_hx_index:9,__enum__:"hxd.PixelFormat",toString:n},RG32F:{_hx_name:"RG32F",_hx_index:10,__enum__:"hxd.PixelFormat",toString:n},RGB8:{_hx_name:"RGB8",_hx_index:11,__enum__:"hxd.PixelFormat",toString:n},RGB16F:{_hx_name:"RGB16F",_hx_index:12,__enum__:"hxd.PixelFormat",toString:n},RGB32F:{_hx_name:"RGB32F",_hx_index:13,__enum__:"hxd.PixelFormat",toString:n},SRGB:{_hx_name:"SRGB",_hx_index:14,__enum__:"hxd.PixelFormat",toString:n},SRGB_ALPHA:{_hx_name:"SRGB_ALPHA",_hx_index:15,__enum__:"hxd.PixelFormat",toString:n},RGB10A2:{_hx_name:"RGB10A2",_hx_index:16,__enum__:"hxd.PixelFormat",toString:n},RG11B10UF:{_hx_name:"RG11B10UF",_hx_index:17,__enum__:"hxd.PixelFormat",toString:n},R16U:{_hx_name:"R16U",_hx_index:18,__enum__:"hxd.PixelFormat",toString:n},RGB16U:{_hx_name:"RGB16U",_hx_index:19,__enum__:"hxd.PixelFormat",toString:n},RGBA16U:{_hx_name:"RGBA16U",_hx_index:20,__enum__:"hxd.PixelFormat",toString:n},S3TC:(e=function(t){return{_hx_index:21,v:t,__enum__:"hxd.PixelFormat",toString:n}},e._hx_name="S3TC",e.__params__=["v"],e)};$e.__constructs__=[$e.ARGB,$e.BGRA,$e.RGBA,$e.RGBA16F,$e.RGBA32F,$e.R8,$e.R16F,$e.R32F,$e.RG8,$e.RG16F,$e.RG32F,$e.RGB8,$e.RGB16F,$e.RGB32F,$e.SRGB,$e.SRGB_ALPHA,$e.RGB10A2,$e.RG11B10UF,$e.R16U,$e.RGB16U,$e.RGBA16U,$e.S3TC],$e.__empty_constructs__=[$e.ARGB,$e.BGRA,$e.RGBA,$e.RGBA16F,$e.RGBA32F,$e.R8,$e.R16F,$e.R32F,$e.RG8,$e.RG16F,$e.RG32F,$e.RGB8,$e.RGB16F,$e.RGB32F,$e.SRGB,$e.SRGB_ALPHA,$e.RGB10A2,$e.RG11B10UF,$e.R16U,$e.RGB16U,$e.RGBA16U];var ti=function(t,e,i,n){this.lodBias=0;var s=Ut.CURRENT;this.mem=s.mem,null==n&&(n=ti.nativeFormat),this.id=++ti.UID,this.format=n;if(this.flags=0,null!=i)for(var r=0;r<i.length;){var a=i[r];++r,this.flags|=1<<a._hx_index}for(var A=1,h=1;A<t;)A<<=1;for(;h<e;)h<<=1;A==t&&h==e||(this.flags|=1<<Ye.IsNPOT._hx_index),0!=(this.flags&1<<Ye.Target._hx_index)&&(this.realloc=function(){}),this.width=t,this.height=e,this.set_mipMap(0!=(this.flags&1<<Ye.MipMapped._hx_index)?Ue.Nearest:Ue.None),this.set_filter(Oe.Linear),this.set_wrap(Ge.Clamp),this.bits&=32767,0==(this.flags&1<<Ye.NoAlloc._hx_index)&&this.alloc()};i["h3d.mat.Texture"]=ti,ti.__name__="h3d.mat.Texture",ti.fromBitmap=function(t){var e=new ti(t.ctx.canvas.width,t.ctx.canvas.height);return e.uploadBitmap(t),e},ti.fromPixels=function(t){var e=new ti(t.width,t.height);return e.uploadPixels(t),e},ti.fromColor=function(t,e){null==e&&(e=1);var i=Ut.CURRENT,n=255*e|0;n<0?n=0:n>255&&(n=255);var s,r=16777215&t|n<<24;return null!=(s=i.textureColorCache.h[r])||((s=new ti(1,1,null)).clear(t,e),s.realloc=function(){s.clear(t,e)},i.textureColorCache.h[r]=s),s},ti.genDisc=function(t,e,i){return null==i&&(i=1),ti.genTexture(0,t,e,i)},ti.genTexture=function(t,e,i,n){var s=Ut.CURRENT,r=255*n|0;r<0?r=0:r>255&&(r=255);var a=(e<<16|t)+","+(i=16777215&i|r<<24),A=ti.genTextureKeys.h[a],h=null==A?null:s.resCache.h[A.__id__];return null!=h||(null==A&&(A={},ti.genTextureKeys.h[a]=A),(h=new ti(e,e,[Ye.Target])).realloc=function(){ti.drawGenTexture(h,i,t)},ti.drawGenTexture(h,i,t),s.resCache.set(A,h)),h},ti.drawGenTexture=function(t,e,i){var n,s=new ni(new cn),r=Ut.CURRENT;(n=s.shader).constModified=!0,n.mode__=i,(n=s.shader.color__).x=(e>>16&255)/255,n.y=(e>>8&255)/255,n.z=(255&e)/255,n.w=(e>>>24)/255,r.pushTarget(t),s.render(),r.popTarget()},ti.defaultCubeTexture=function(){var t=Ut.CURRENT,e=t.resCache.h[ti.__id__];return null!=e||((e=new ti(1,1,[Ye.Cube])).clear(2105376),e.realloc=function(){e.clear(2105376)},t.resCache.set(ti,e)),e},ti.genChecker=function(t){var e=Ut.CURRENT,i=ti.checkerTextureKeys.h[t];if(null!=(n=null==i?null:e.resCache.h[i.__id__])&&(null!=n.t||null!=n.realloc))return n;null==i&&(i={},ti.checkerTextureKeys.h[t]=i);var n,s=n=new ti(t,t,[Ye.NoAlloc]),r=t;return n.realloc=function(){ti.allocChecker(s,r)},e.resCache.set(i,n),n},ti.genNoise=function(t){var e=Ut.CURRENT,i=ti.noiseTextureKeys.h[t];if(null!=(n=null==i?null:e.resCache.h[i.__id__])&&(null!=n.t||null!=n.realloc))return n;null==i&&(i={},ti.noiseTextureKeys.h[t]=i);var n,s=n=new ti(t,t,[Ye.NoAlloc]),r=t;return n.realloc=function(){ti.allocNoise(s,r)},e.resCache.set(i,n),n},ti.allocNoise=function(t,e){for(var i=new ys(e,e),n=0,s=e;n<s;)for(var r=n++,a=0,A=e;a<A;){var h=a++,o=x.random(256);i.setPixel(r,h,-16777216|o|o<<8|o<<16)}t.uploadBitmap(i),i.ctx=null,i.pixel=null},ti.allocChecker=function(t,e){var i=new ys(e,e);i.clear(-1);for(var n=0,s=e>>1;n<s;)for(var r=n++,a=0,A=e>>1;a<A;){var h=a++;i.setPixel(r,h,-16777216),i.setPixel(r+(e>>1),h+(e>>1),-16777216)}t.uploadBitmap(i),i.ctx=null,i.pixel=null},ti.prototype={set_lastFrame:function(t){return this._lastFrame!=ti.PREVENT_AUTO_DISPOSE&&(this._lastFrame=t),this._lastFrame},get_lastFrame:function(){return this._lastFrame},get_mipLevels:function(){if(0==(this.flags&1<<Ye.MipMapped._hx_index))return 1;for(var t=1,e=this.width,i=this.height;e>>t>=1||i>>t>=1;)++t;return t},get_layerCount:function(){return 0!=(this.flags&1<<Ye.Cube._hx_index)?6:1},alloc:function(){null==this.t&&this.mem.allocTexture(this)},isSRGB:function(){switch(this.format._hx_index){case 14:case 15:return!0;default:return!1}},checkAlloc:function(){null==this.t&&null!=this.realloc&&(this.alloc(),this.realloc())},clone:function(){if(this.checkAlloc(),null==this.t)throw kn.thrown("Can't clone disposed texture");var t=this.get_lastFrame();this.preventAutoDispose();var e=[],i=Ye.Target;0!=(this.flags&1<<i._hx_index)&&e.push(i);i=Ye.Cube;0!=(this.flags&1<<i._hx_index)&&e.push(i);i=Ye.MipMapped;0!=(this.flags&1<<i._hx_index)&&e.push(i);i=Ye.IsArray;0!=(this.flags&1<<i._hx_index)&&e.push(i);var n=new ti(this.width,this.height,e,this.format);return n.name=this.name,0!=(this.flags&1<<Ye.Cube._hx_index)?di.run(this,n):_i.run(this,n),this.set_lastFrame(t),n},preventAutoDispose:function(){this.set_lastFrame(ti.PREVENT_AUTO_DISPOSE)},waitLoad:function(t){0!=(this.flags&1<<Ye.Loading._hx_index)?(null==this.waitLoads&&(this.waitLoads=[]),this.waitLoads.push(t)):t()},toString:function(){var t=this.name;return null==this.name&&(t="Texture_"+this.id),t+"("+this.width+"x"+this.height+")"},setName:function(t){this.name=t},set_mipMap:function(t){return this.bits=-4&this.bits|t._hx_index,this.mipMap=t},set_filter:function(t){return this.bits=-25&this.bits|t._hx_index<<3,this.filter=t},set_wrap:function(t){return this.bits=-193&this.bits|t._hx_index<<6,this.wrap=t},isDisposed:function(){return null==this.t&&null==this.realloc},resize:function(t,e){this.dispose();for(var i=1,n=1;i<t;)i<<=1;for(;n<e;)n<<=1;i!=t||n!=e?this.flags|=1<<Ye.IsNPOT._hx_index:this.flags&=-1-(1<<Ye.IsNPOT._hx_index),this.width=t,this.height=e,0==(this.flags&1<<Ye.NoAlloc._hx_index)&&this.alloc()},clearF:function(t,e,i,n,s){if(null==s&&(s=-1),null==n&&(n=0),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.alloc(),0==(this.flags&1<<Ye.Target._hx_index))throw kn.thrown("Texture should be target");var r=Ut.CURRENT,a=new Yt(t,e,i,n);if(s<0)for(var A=0,h=this.get_layerCount();A<h;){var o=A++;r.pushTarget(this,o),r.clearF(a),r.popTarget()}else r.pushTarget(this,s),r.clearF(a),r.popTarget()},clear:function(t,e,i){if(null==i&&(i=-1),null==e&&(e=1),this.alloc(),0!=this.width&&0!=this.height)if(1!=this.width||1!=this.height){var n=Ut.CURRENT;if(t|=(255*(e<0?0:e>1?1:e)|0)<<24,i<0)for(var s=0,r=this.get_layerCount();s<r;){var a=s++;n.pushTarget(this,a),n.clear(t),n.popTarget()}else n.pushTarget(this,i),n.clear(t),n.popTarget()}else{var A=Ps.alloc(this.width,this.height,ti.nativeFormat),h=0,o=255&t,l=t>>8&255,u=t>>16&255,_=255*e|0;switch(_<0?_=0:_>255&&(_=255),ti.nativeFormat._hx_index){case 1:var c=u;u=o,o=c;break;case 2:break;default:throw kn.thrown("TODO")}for(s=0,r=this.width*this.height;s<r;){a=s++;A.bytes.b[h++]=u,A.bytes.b[h++]=l,A.bytes.b[h++]=o,A.bytes.b[h++]=_}if(i<0)for(s=0,r=this.get_layerCount();s<r;){a=s++;this.uploadPixels(A,0,a)}else this.uploadPixels(A,0,i);A.dispose()}},checkSize:function(t,e,i){var n=this.width>>i;0==n&&(n=1);var s=this.height>>i;if(0==s&&(s=1),t!=n||e!=s)throw kn.thrown("Invalid upload size : "+t+"x"+e+" should be "+n+"x"+s)},checkMipMapGen:function(t,e){0==t&&0!=(this.flags&1<<Ye.MipMapped._hx_index)&&0==(this.flags&1<<Ye.ManualMipMapGen._hx_index)&&e==this.get_layerCount()-1&&this.mem.driver.generateMipMaps(this)},uploadBitmap:function(t,e,i){null==i&&(i=0),null==e&&(e=0),this.alloc(),this.checkSize(t.ctx.canvas.width,t.ctx.canvas.height,e),this.mem.driver.uploadTextureBitmap(this,t,e,i),this.flags|=1<<Ye.WasCleared._hx_index,this.checkMipMapGen(e,i)},uploadPixels:function(t,e,i){null==i&&(i=0),null==e&&(e=0),this.alloc(),this.checkSize(t.width,t.height,e),this.mem.driver.uploadTexturePixels(this,t,e,i),this.flags|=1<<Ye.WasCleared._hx_index,this.checkMipMapGen(e,i)},dispose:function(){null!=this.t&&this.mem.deleteTexture(this)},swapTexture:function(t){if(this.checkAlloc(),t.checkAlloc(),null==this.t&&null==this.realloc||null==t.t&&null==t.realloc)throw kn.thrown("One of the two texture is disposed");var e=this.t;this.t=t.t,t.t=e},capturePixels:function(t,e,i){null==e&&(e=0),null==t&&(t=0);var n=this.get_lastFrame();this.preventAutoDispose();var s=this.mem.driver.capturePixels(this,t,e,i);return this.set_lastFrame(n),s},__class__:ti};var ei=function(t,e,i,n,s){this.layers=i,null==n&&(n=[]),n.push(Ye.IsArray),ti.call(this,t,e,n,s)};i["h3d.mat.TextureArray"]=ei,ei.__name__="h3d.mat.TextureArray",ei.__super__=ti,ei.prototype=r(ti.prototype,{get_layerCount:function(){return this.layers},clone:function(){var t=this.get_lastFrame();this.preventAutoDispose();var e=new ei(this.width,this.height,this.layers,null,this.format);return _i.run(this,e),this.set_lastFrame(t),e},toString:function(){return ti.prototype.toString.call(this)+"["+this.layers+"]"},__class__:ei});var ii=function(t){this.name=t};i["h3d.pass.Base"]=ii,ii.__name__="h3d.pass.Base",ii.prototype={compileShader:function(t){throw kn.thrown("Not implemented for this pass")},setContext:function(t){this.ctx=t},dispose:function(){},draw:function(t,e){},__class__:ii};var ni=function(t,e){this.shader=t,this.shaders=new PA(t),this.manager=new Mi(e),this.pass=new qe("screenfx",new PA(t)),this.pass.set_culling(Re.None),this.pass.depth(!1,Ve.Always)};i["h3d.pass.ScreenFx"]=ni,ni.__name__="h3d.pass.ScreenFx",ni.run=function(t,e,i){var n=Ut.CURRENT;n.pushTarget(e,i),new ni(t).render(),n.popTarget()},ni.prototype={get_engine:function(){return null==this._engine&&(this._engine=Ut.CURRENT),this._engine},copy:function(t,e){_i.run(t,e)},setGlobals:function(t){for(var e=0,i=t.sharedGlobals;e<i.length;){var n=i[e];++e,this.manager.globals.map.h[n.gid]=n.value}},addShader:function(t){return this.shaders=PA.addSort(t,this.shaders),this.pass.addShader(t)},removeShader:function(t){for(var e=null,i=this.shaders;null!=i;){if(i.s==t)return null==e?this.shaders=i.next:e.next=i.next,!0;e=i,i=i.next}return!1},getShader:function(t){for(var e=this.shaders;null!=e;){var i=e.s;e=e.next;var n=i,s=yA.__downcastCheck(n,t)?n:null;if(null!=s)return s}return null},render:function(){null==this.primitive&&(this.primitive=Fi.get()),this.shader.flipY__=this.get_engine().driver.hasFeature(ge.BottomLeftCoords)&&null!=this.get_engine().getCurrentTarget()?-1:1;var t=this.manager.compileShaders(this.shaders);if(this.get_engine().selectMaterial(this.pass),this.get_engine().selectShader(t),null==this.buffers)this.buffers=new hn(t);else{var e=this.buffers;e.vertex.grow(t.vertex),e.fragment.grow(t.fragment)}this.manager.fillGlobals(this.buffers,t),this.manager.fillParams(this.buffers,t,this.shaders),this.get_engine().uploadShaderBuffers(this.buffers,0),this.get_engine().uploadShaderBuffers(this.buffers,1),this.get_engine().uploadShaderBuffers(this.buffers,2),this.primitive.render(this.get_engine())},dispose:function(){},__class__:ni};var si=function(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=1),null==t&&(t=1),this.cubeDir=[Gt.L([0,0,-1,0,0,-1,0,0,1,0,0,0]),Gt.L([0,0,1,0,0,-1,0,0,-1,0,0,0]),Gt.L([1,0,0,0,0,0,1,0,0,1,0,0]),Gt.L([1,0,0,0,0,0,-1,0,0,-1,0,0]),Gt.L([1,0,0,0,0,-1,0,0,0,1,0,0]),Gt.L([-1,0,0,0,0,-1,0,0,0,0,-1,0])],ni.call(this,new an),this.set_radius(t),this.set_quality(n),this.set_gain(e),this.set_linear(i)};i["h3d.pass.Blur"]=si,si.__name__="h3d.pass.Blur",si.__super__=ni,si.prototype=r(ni.prototype,{set_radius:function(t){return this.radius==t?t:(this.values=null,this.radius=t)},set_quality:function(t){return this.quality==t?t:(this.values=null,this.quality=t)},set_gain:function(t){return this.gain==t?t:(this.values=null,this.gain=t)},set_linear:function(t){return this.linear==t?t:(this.values=null,this.linear=t)},gauss:function(t,e){if(e<=0)return 0==t?1:0;var i=e*e;return Math.pow(2.718281828459,-t*t/(2*i))/Math.sqrt(2*Math.PI*i)},calcValues:function(){this.values=[],this.offsets=[];var t,e=0,i=this.quality,n=.7*(i<0?0:i>1?1:i)+.3;if(this.radius>0){var s=this.radius-1;t=Math.ceil((s<1?1:s)*n/2)}else t=0;for(var r=Math.sqrt(this.radius),a=0,A=t+1;a<A;){var h=2*(f=a++),o=0==f?0:2*f-1,l=this.gauss(h,r),u=this.gauss(o,r),_=l+u;this.values[f]=_,this.offsets[f]=0==f?0:(l*h+u*o)/(_*f*Math.sqrt(n)),e+=_,f>0&&(e+=_)}for(var c=this.values[0]*(.01/n);this.values.length>2;){var d=this.values[this.values.length-1];if(d>c)break;e-=2*d,this.values.pop()}e/=this.gain;for(a=0,A=this.values.length;a<A;){var f=a++;this.values[f]/=e}if(this.linear>0){var x=this.gain/(2*this.values.length-1);for(a=0,A=this.values.length;a<A;){f=a++,s=this.values[f];this.values[f]=s+this.linear*(x-s);var p=this.offsets[f];this.offsets[f]=p+this.linear*((0==f?0:(2*f-.5)/(f*n))-p)}}},getKernelSize:function(){return null==this.values&&this.calcValues(),this.radius<=0?0:2*this.values.length-1},apply:function(t,e,i){if(this.radius<=0&&null==this.shader.fixedColor__)null!=i&&_i.run(e,i);else{null==i&&(i=e),null==this.values&&this.calcValues();var n=0!=(e.flags&1<<Ye.Cube._hx_index),s=n?6:1,r=t.textures.allocTarget(e.name+"BlurTmp",e.width,e.height,!1,e.format,n);if((a=this.shader).constModified=!0,a.Quality__=this.values.length,this.shader.values__=this.values,this.shader.offsets__=this.offsets,n)this.shader.cubeTexture__=e,(a=this.shader).constModified=!0,a.isCube__=!0;else this.shader.texture__=e,(a=this.shader).constModified=!0,a.isCube__=!1;var a=this.shader.pixel__;null==(l=0)&&(l=0),null==(u=1/e.width)&&(u=0),a.x=u,a.y=l,a.z=0,a.w=1;for(var A=0,h=s;A<h;){var o=A++;this.get_engine().pushTarget(r,o),n&&(this.shader.cubeDir__=this.cubeDir[o]),this.render(),this.get_engine().popTarget()}n?this.shader.cubeTexture__=r:this.shader.texture__=r;a=this.shader.pixel__;var l,u=0;null==(l=1/e.height)&&(l=0),null==u&&(u=0),a.x=u,a.y=l,a.z=0,a.w=1;var _=i.depthBuffer;i.depthBuffer=null;for(A=0,h=s;A<h;){o=A++;this.get_engine().pushTarget(i,o),n&&(this.shader.cubeDir__=this.cubeDir[o]),this.render(),this.get_engine().popTarget()}i.depthBuffer=_}},__class__:si});var ri=function(){this.priority=0,this.initialize()};i["hxsl.Shader"]=ri,ri.__name__="hxsl.Shader",ri.prototype={initialize:function(){if(this.constModified=!0,null==this.shader){var t=yA.getClass(this);if(this.shader=t._SHADER,null==this.shader){for(var e=t;null!=e&&null==e.SRC;)e=e.__super__;if(null==e)throw kn.thrown(t.__name__+" has no shader source");this.shader=e._SHADER,null==this.shader&&(this.shader=new QA(e.SRC),e._SHADER=this.shader)}}},setPriority:function(t){this.priority=t},getParamValue:function(t){throw kn.thrown("assert")},getParamFloatValue:function(t){throw kn.thrown("assert")},updateConstants:function(t){throw kn.thrown("assert")},updateConstantsFinal:function(t){for(var e=this.shader.consts;null!=e;)if(0!=e.globalId){var i=t.map.h[e.globalId],n=e.v.type;switch(n._hx_index){case 1:var s=i;if(s>>>e.bits!=0)throw kn.thrown("Constant "+e.v.name+" is outside range ("+s+" > "+((1<<e.bits)-1)+")");this.constBits|=s<<e.pos;break;case 2:i&&(this.constBits|=1<<e.pos);break;case 17:var r=n.size;if(null==i){e=e.next;continue}var a=i,A=a.channel;if(null==a.texture)A=uA.Unknown;else if(null==A||A==uA.Unknown)switch(r){case 1:if(a.texture.format!=ti.nativeFormat)throw kn.thrown("Constant "+e.v.name+" does not define channel select value");A=uA.PackedFloat;break;case 3:if(a.texture.format!=ti.nativeFormat)throw kn.thrown("Constant "+e.v.name+" does not define channel select value");A=uA.PackedNormal;break;default:throw kn.thrown("Constant "+e.v.name+" does not define channel select value")}this.constBits|=(t.allocChannelID(a.texture)<<3|A._hx_index)<<e.pos;break;default:throw kn.thrown("assert")}e=e.next}else e=e.next;var h=this.shader,o=this.constBits,l=h.instanceCache.h[o];this.instance=null==l?h.makeInstance(o):l},clone:function(){return this},toString:function(){return yA.getClass(this).__name__},__class__:ri};var ai=function(){this.flipY__=0,ri.call(this)};i["h3d.shader.ScreenShader"]=ai,ai.__name__="h3d.shader.ScreenShader",ai.__super__=ri,ai.prototype=r(ri.prototype,{get_flipY:function(){return this.flipY__},set_flipY:function(t){return this.flipY__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.flipY__:null},getParamFloatValue:function(t){return 0==t?this.flipY__:0},clone:function(){var t=Object.create(ai.prototype);return t.shader=this.shader,t.flipY__=this.flipY__,t},__class__:ai});var Ai=function(){this.color__=new Yt,ai.call(this)};i["h3d.pass._Border.BorderShader"]=Ai,Ai.__name__="h3d.pass._Border.BorderShader",Ai.__super__=ai,Ai.prototype=r(ai.prototype,{get_color:function(){return this.color__},set_color:function(t){return this.color__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.flipY__;case 1:return this.color__}return null},getParamFloatValue:function(t){return 0==t?this.flipY__:0},clone:function(){var t=Object.create(Ai.prototype);return t.shader=this.shader,t.flipY__=this.flipY__,t.color__=this.color__,t},__class__:Ai});var hi=function(t,e,i){null==i&&(i=1),ni.call(this,new Ai);var n,s,r=Cs._new(0);r.pos==r.array.length&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=0/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-0/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=t/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-0/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=0/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-i/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=t/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-i/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=0/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-0/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=i/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-0/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=0/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-e/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=i/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-e/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=0/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-(e-i)/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=t/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-(e-i)/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=0/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-e/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=t/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-e/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=(t-i)/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-0/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=t/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-0/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=(t-i)/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=1-e/e*2,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);(r.array[r.pos++]=t/t*2-1,r.pos==r.array.length)&&((n=r.array.length<<1)<128&&(n=128),(s=new Float32Array(n)).set(r.array),r.array=s);r.array[r.pos++]=1-e/e*2,this.primitive=new Di({vbuf:r,stride:2,quads:!0},!0);var a=this.shader.color__,A=1,h=1,o=1,l=1;null==l&&(l=1),null==o&&(o=0),null==h&&(h=0),null==A&&(A=0),a.x=A,a.y=h,a.z=o,a.w=l};i["h3d.pass.Border"]=hi,hi.__name__="h3d.pass.Border",hi.__super__=ni,hi.prototype=r(ni.prototype,{dispose:function(){ni.prototype.dispose.call(this),this.primitive.dispose()},__class__:hi});var oi=function(){this.layer__=0,ai.call(this)};i["h3d.pass._Copy.ArrayCopyShader"]=oi,oi.__name__="h3d.pass._Copy.ArrayCopyShader",oi.__super__=ai,oi.prototype=r(ai.prototype,{get_texture:function(){return this.texture__},set_texture:function(t){return this.texture__=t},get_layer:function(){return this.layer__},set_layer:function(t){return this.layer__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.flipY__;case 1:return this.texture__;case 2:return this.layer__}return null},getParamFloatValue:function(t){return 0==t?this.flipY__:0},clone:function(){var t=Object.create(oi.prototype);return t.shader=this.shader,t.flipY__=this.flipY__,t.texture__=this.texture__,t.layer__=this.layer__,t},__class__:oi});var li=function(){ni.call(this,new oi)};i["h3d.pass.ArrayCopy"]=li,li.__name__="h3d.pass.ArrayCopy",li.run=function(t,e,i,n,s,r){var a=Ut.CURRENT;if(null==i||null==t||null!=n&&n!=et.None||null!=s||!a.driver.copyTexture(t,i)){var A=a.resCache.h[li.__id__];null==A&&(A=new li,a.resCache.set(li,A)),A.apply(t,e,i,n,s,r)}},li.__super__=ni,li.prototype=r(ni.prototype,{apply:function(t,e,i,n,s,r){if(null!=i&&this.get_engine().pushTarget(i,null!=r?r:0),this.shader.texture__=t,this.shader.layer__=e,null!=s){var a=this.pass;this.pass=s,null!=n&&this.pass.setBlendMode(n);for(var A=this.shaders;null!=A.next;)A=A.next;A.next=this.pass.shaders,this.render(),this.pass=a,A.next=null}else this.pass.setBlendMode(null==n?et.None:n),this.render();this.shader.texture__=null,this.shader.layer__=0,null!=i&&this.get_engine().popTarget()},__class__:li});var ui=function(){ai.call(this)};i["h3d.pass._Copy.CopyShader"]=ui,ui.__name__="h3d.pass._Copy.CopyShader",ui.__super__=ai,ui.prototype=r(ai.prototype,{get_texture:function(){return this.texture__},set_texture:function(t){return this.texture__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.flipY__;case 1:return this.texture__}return null},getParamFloatValue:function(t){return 0==t?this.flipY__:0},clone:function(){var t=Object.create(ui.prototype);return t.shader=this.shader,t.flipY__=this.flipY__,t.texture__=this.texture__,t},__class__:ui});var _i=function(){ni.call(this,new ui)};i["h3d.pass.Copy"]=_i,_i.__name__="h3d.pass.Copy",_i.run=function(t,e,i,n,s){var r=Ut.CURRENT;if(null==e||null==t||null!=i&&i!=et.None||null!=n||null!=s||!r.driver.copyTexture(t,e)){var a=r.resCache.h[_i.__id__];null==a&&(a=new _i,r.resCache.set(_i,a)),a.apply(t,e,i,n,s)}},_i.__super__=ni,_i.prototype=r(ni.prototype,{apply:function(t,e,i,n,s){if(null!=e&&this.get_engine().pushTarget(e,null!=s?s:0),this.shader.texture__=t,null!=n){var r=this.pass;this.pass=n,null!=i&&this.pass.setBlendMode(i);for(var a=this.shaders;null!=a.next;)a=a.next;a.next=this.pass.shaders,this.render(),this.pass=r,a.next=null}else this.pass.setBlendMode(null==i?et.None:i),this.render();this.shader.texture__=null,null!=e&&this.get_engine().popTarget()},__class__:_i});var ci=function(){this.mat__=new Gt,ai.call(this)};i["h3d.pass._CubeCopy.CubeCopyShader"]=ci,ci.__name__="h3d.pass._CubeCopy.CubeCopyShader",ci.__super__=ai,ci.prototype=r(ai.prototype,{get_texture:function(){return this.texture__},set_texture:function(t){return this.texture__=t},get_mat:function(){return this.mat__},set_mat:function(t){return this.mat__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.flipY__;case 1:return this.texture__;case 2:return this.mat__}return null},getParamFloatValue:function(t){return 0==t?this.flipY__:0},clone:function(){var t=Object.create(ci.prototype);return t.shader=this.shader,t.flipY__=this.flipY__,t.texture__=this.texture__,t.mat__=this.mat__,t},__class__:ci});var di=function(){this.cubeDir=[Gt.L([0,0,-1,0,0,-1,0,0,1,0,0,0]),Gt.L([0,0,1,0,0,-1,0,0,-1,0,0,0]),Gt.L([1,0,0,0,0,0,1,0,0,1,0,0]),Gt.L([1,0,0,0,0,0,-1,0,0,-1,0,0]),Gt.L([1,0,0,0,0,-1,0,0,0,0,1,0]),Gt.L([-1,0,0,0,0,-1,0,0,0,0,-1,0])],ni.call(this,new ci)};i["h3d.pass.CubeCopy"]=di,di.__name__="h3d.pass.CubeCopy",di.run=function(t,e,i,n){var s=Ut.CURRENT;if(null==e||null==t||null!=i&&i!=et.None||null!=n||!s.driver.copyTexture(t,e)){var r=s.resCache.h[di.__id__];null==r&&(r=new di,s.resCache.set(di,r)),r.apply(t,e,i,n)}},di.__super__=ni,di.prototype=r(ni.prototype,{apply:function(t,e,i,n){this.shader.texture__=t;for(var s=0;s<6;){var r=s++;if(null!=e&&this.get_engine().pushTarget(e,r),this.shader.mat__=this.cubeDir[r],null!=n){var a=this.pass;this.pass=n,null!=i&&this.pass.setBlendMode(i);for(var A=this.shaders;null!=A.next;)A=A.next;A.next=this.pass.shaders,this.render(),this.pass=a,A.next=null}else this.pass.setBlendMode(null==i?et.None:i),this.render();null!=e&&this.get_engine().popTarget()}this.shader.texture__=null},__class__:di});var fi=function(t){this.defaultSort=XA(e=new Si,e.sort),ii.call(this,t),this.manager=new Mi(this.getOutputs()),this.initGlobals()};i["h3d.pass.Default"]=fi,fi.__name__="h3d.pass.Default",fi.__super__=ii,fi.prototype=r(ii.prototype,{get_globals:function(){return this.manager.globals},getCurrentPixelSize:function(){var t=this.ctx.engine.getCurrentTarget();return new Yt(2/(null==t?this.ctx.engine.width:t.width),2/(null==t?this.ctx.engine.height:t.height))},getOutputs:function(){return[CA.Value("output.color")]},compileShader:function(t){var e=new wi;return e.pass=t,this.setupShaders(new bi(e)),this.manager.compileShaders(e.shaders,t.batchMode)},processShaders:function(t,e){for(t=this.ctx.extraShaders;null!=t;)e=this.ctx.allocShaderList(t.s,e),t=t.next;return e},setupShaders:function(t){for(var e=!1,i=t.current;null!=i;){var n=i;i=i.next;var s=n,r=s.pass.getShadersRec();r=this.processShaders(s,r),s.pass.enableLights&&null!=this.ctx.lightSystem&&(e||(this.ctx.lightSystem.initGlobals(this.manager.globals),e=!0),r=this.ctx.lightSystem.computeLight(s.obj,r)),s.shader=this.manager.compileShaders(r,s.pass.batchMode),s.shaders=r;var a=s.shader.fragment.textures;if(null==a)s.texture=0;else{var A,h=this.manager,o=!0;if(null==o&&(o=!1),null!=a.perObjectGlobal){var l=h.globals.map.h[a.perObjectGlobal.gid];if(null==l)throw kn.thrown("Missing global value "+a.perObjectGlobal.path+" for shader "+h.shaderInfo(r,a.perObjectGlobal.path));var u,_=a.type;if(17==_._hx_index){_.size;u=!0}else u=!1;A=u?l.texture:l}else{for(var c=r,d=a.instance;--d>0;)c=c.next;var f=c.s.getParamValue(a.index);if(null==f&&!o)throw kn.thrown("Missing param value "+x.string(c.s)+"."+a.name);A=f}s.texture=null==A?0:A.id}}},log:function(t){var e=this.ctx.engine.driver;e.logEnable&&e.logImpl(t)},drawObject:function(t){this.ctx.drawPass=t,this.ctx.engine.selectMaterial(t.pass),t.obj.draw(this.ctx)},draw:function(t,e){if(null!=t.current){for(var i=0,n=this.ctx.sharedGlobals;i<n.length;){var s=n[i];++i,this.manager.globals.map.h[s.gid]=s.value}this.setGlobals(),this.setupShaders(t),null==e?this.defaultSort(t):e(t),this.ctx.currentManager=this.manager;for(var r=this.ctx.shaderBuffers,a=null,A=t.current;null!=A;){var h=A;A=A.next;var o=h,l=o.obj.absPos;if(this.manager.globals.map.h[this.globalModelView_id]=l,o.shader.globals.h.hasOwnProperty(this.globalModelViewInverse_id)){var u=o.obj.getInvPos();this.manager.globals.map.h[this.globalModelViewInverse_id]=u}if(a!=o.shader){if(a=o.shader,this.ctx.engine.selectShader(o.shader),null==r)r=this.ctx.shaderBuffers=new hn(o.shader);else{var _=o.shader;r.vertex.grow(_.vertex),r.fragment.grow(_.fragment)}this.manager.fillGlobals(r,o.shader),this.ctx.engine.uploadShaderBuffers(r,0)}o.pass.dynamicParameters||(this.manager.fillParams(r,o.shader,o.shaders),this.ctx.engine.uploadShaderBuffers(r,1),this.ctx.engine.uploadShaderBuffers(r,2),this.ctx.engine.uploadShaderBuffers(r,3)),this.drawObject(o)}var c=this.ctx;c.cachedPos=0,c.drawPass=null}},get_cameraView:function(){return this.manager.globals.map.h[this.cameraView_id]},set_cameraView:function(t){return this.manager.globals.map.h[this.cameraView_id]=t,t},get_cameraNear:function(){return this.manager.globals.map.h[this.cameraNear_id]},set_cameraNear:function(t){return this.manager.globals.map.h[this.cameraNear_id]=t,t},get_cameraFar:function(){return this.manager.globals.map.h[this.cameraFar_id]},set_cameraFar:function(t){return this.manager.globals.map.h[this.cameraFar_id]=t,t},get_cameraProj:function(){return this.manager.globals.map.h[this.cameraProj_id]},set_cameraProj:function(t){return this.manager.globals.map.h[this.cameraProj_id]=t,t},get_cameraPos:function(){return this.manager.globals.map.h[this.cameraPos_id]},set_cameraPos:function(t){return this.manager.globals.map.h[this.cameraPos_id]=t,t},get_cameraProjDiag:function(){return this.manager.globals.map.h[this.cameraProjDiag_id]},set_cameraProjDiag:function(t){return this.manager.globals.map.h[this.cameraProjDiag_id]=t,t},get_cameraProjFlip:function(){return this.manager.globals.map.h[this.cameraProjFlip_id]},set_cameraProjFlip:function(t){return this.manager.globals.map.h[this.cameraProjFlip_id]=t,t},get_cameraViewProj:function(){return this.manager.globals.map.h[this.cameraViewProj_id]},set_cameraViewProj:function(t){return this.manager.globals.map.h[this.cameraViewProj_id]=t,t},get_cameraInverseViewProj:function(){return this.manager.globals.map.h[this.cameraInverseViewProj_id]},set_cameraInverseViewProj:function(t){return this.manager.globals.map.h[this.cameraInverseViewProj_id]=t,t},get_globalTime:function(){return this.manager.globals.map.h[this.globalTime_id]},set_globalTime:function(t){return this.manager.globals.map.h[this.globalTime_id]=t,t},get_pixelSize:function(){return this.manager.globals.map.h[this.pixelSize_id]},set_pixelSize:function(t){return this.manager.globals.map.h[this.pixelSize_id]=t,t},get_globalModelView:function(){return this.manager.globals.map.h[this.globalModelView_id]},set_globalModelView:function(t){return this.manager.globals.map.h[this.globalModelView_id]=t,t},get_globalModelViewInverse:function(){return this.manager.globals.map.h[this.globalModelViewInverse_id]},set_globalModelViewInverse:function(t){return this.manager.globals.map.h[this.globalModelViewInverse_id]=t,t},initGlobals:function(){var t=vA.allocID("camera.view");this.cameraView_id=t;t=vA.allocID("camera.zNear");this.cameraNear_id=t;t=vA.allocID("camera.zFar");this.cameraFar_id=t;t=vA.allocID("camera.proj");this.cameraProj_id=t;t=vA.allocID("camera.position");this.cameraPos_id=t;t=vA.allocID("camera.projDiag");this.cameraProjDiag_id=t;t=vA.allocID("camera.projFlip");this.cameraProjFlip_id=t;t=vA.allocID("camera.viewProj");this.cameraViewProj_id=t;t=vA.allocID("camera.inverseViewProj");this.cameraInverseViewProj_id=t;t=vA.allocID("global.time");this.globalTime_id=t;t=vA.allocID("global.pixelSize");this.pixelSize_id=t;t=vA.allocID("global.modelView");this.globalModelView_id=t;t=vA.allocID("global.modelViewInverse");this.globalModelViewInverse_id=t},setGlobals:function(){var t=this.ctx.camera.mcam;this.manager.globals.map.h[this.cameraView_id]=t;t=this.ctx.camera.zNear;this.manager.globals.map.h[this.cameraNear_id]=t;t=this.ctx.camera.zFar;this.manager.globals.map.h[this.cameraFar_id]=t;t=this.ctx.camera.mproj;this.manager.globals.map.h[this.cameraProj_id]=t;t=this.ctx.camera.pos;this.manager.globals.map.h[this.cameraPos_id]=t;t=new Yt(this.ctx.camera.mproj._11,this.ctx.camera.mproj._22,this.ctx.camera.mproj._33,this.ctx.camera.mproj._44);this.manager.globals.map.h[this.cameraProjDiag_id]=t;t=this.ctx.engine.driver.hasFeature(ge.BottomLeftCoords)&&null!=this.ctx.engine.getCurrentTarget()?-1:1;this.manager.globals.map.h[this.cameraProjFlip_id]=t;t=this.ctx.camera.m;this.manager.globals.map.h[this.cameraViewProj_id]=t;t=this.ctx.camera.getInverseViewProj();this.manager.globals.map.h[this.cameraInverseViewProj_id]=t;t=this.ctx.time;this.manager.globals.map.h[this.globalTime_id]=t;t=this.getCurrentPixelSize();this.manager.globals.map.h[this.pixelSize_id]=t},__class__:fi});var xi=function(t){this.pcfScale=1,this.pcfQuality=1,this.bias=.01,this.power=30,this.samplingKind=Ci.None,this.size=1024,this.mode=Bi.None,this.enabled=!0,null==this.format&&(this.format=$e.R16F),Ut.CURRENT.driver.isSupportedFormat(this.format)||(this.format=ti.nativeFormat),fi.call(this,"shadow"),this.light=t,this.blur=new si(5),this.blur.set_quality(.5);var e=this.blur.shader;e.constModified=!0,e.isDepth__=this.format==ti.nativeFormat};i["h3d.pass.Shadows"]=xi,xi.__name__="h3d.pass.Shadows",xi.__super__=fi,xi.prototype=r(fi.prototype,{set_mode:function(t){if(t!=Bi.None)throw kn.thrown("Shadow mode "+x.string(t)+" not supported for "+x.string(this.light));return this.mode=t},set_enabled:function(t){return this.enabled=t},set_size:function(t){return t!=this.size&&null!=this.staticTexture&&(this.staticTexture.dispose(),this.staticTexture=null),this.size=t},dispose:function(){fi.prototype.dispose.call(this),this.blur.dispose(),null!=this.staticTexture&&this.staticTexture.dispose()},getShadowProj:function(){return this.lightCamera.m},getShadowTex:function(){return null},isUsingWorldDist:function(){return!1},getOutputs:function(){return this.isUsingWorldDist()?[CA.Swiz(CA.Value("output.worldDist",1),[iA.X,iA.X,iA.X,iA.X])]:this.format==ti.nativeFormat?[CA.PackFloat(CA.Value("output.depth"))]:[CA.Swiz(CA.Value("output.depth",1),[iA.X,iA.X,iA.X,iA.X])]},loadStaticData:function(t){return!1},saveStaticData:function(){return null},computeStatic:function(t){throw kn.thrown("Not implemented")},createDefaultShadowMap:function(){var t=ti.fromColor(16777215);return t.name="defaultShadowMap",t},syncShader:function(t){},filterPasses:function(t){if(this.ctx.computingStatic)switch(this.mode._hx_index){case 0:case 2:return!1;case 1:for(var e=null,i=null,n=t.discarded,s=t.lastDisc,r=t.current;null!=r;)1==r.pass.isStatic?null==e?e=i=r:(i.next=r,i=r):null==n?n=s=r:(s.next=r,s=r),r=r.next;return null!=i&&(i.next=null),null!=s&&(s.next=null),t.current=e,t.discarded=n,t.lastDisc=s,!0;case 3:for(e=null,i=null,n=t.discarded,s=t.lastDisc,r=t.current;null!=r;)1==r.pass.isStatic?null==e?e=i=r:(i.next=r,i=r):null==n?n=s=r:(s.next=r,s=r),r=r.next;return null!=i&&(i.next=null),null!=s&&(s.next=null),t.current=e,t.discarded=n,t.lastDisc=s,!0}else switch(this.mode._hx_index){case 0:return!1;case 1:if(null!=this.staticTexture)a=null==(A=this.staticTexture).t&&null==A.realloc;else a=!0;return a&&(this.staticTexture=this.createDefaultShadowMap()),this.syncShader(this.staticTexture),!1;case 2:return!0;case 3:var a,A;if(null!=this.staticTexture)a=null==(A=this.staticTexture).t&&null==A.realloc;else a=!0;return a&&(this.staticTexture=this.createDefaultShadowMap()),!0}},cullPasses:function(t,e){for(var i=null,n=!0,s=null,r=null,a=t.discarded,A=t.lastDisc,h=t.current;null!=h;){var o,l=h.obj.cullingCollider;null==l?o=!0:(l!=i&&(i=l,n=e(l)),o=n),o?null==s?s=r=h:(r.next=h,r=h):null==a?a=A=h:(A.next=h,A=h),h=h.next}null!=r&&(r.next=null),null!=A&&(A.next=null),t.current=s,t.discarded=a,t.lastDisc=A},__class__:xi});var pi=function(t){this.minDist=-1,this.maxDist=-1,this.autoShrink=!0,this.mergePass=new ni(new fn),xi.call(this,t),this.lightCamera=new Vt,this.lightCamera.orthoBounds=new se,this.shader=this.dshader=new _n,this.border=new hi(this.size,this.size),this.customDepth=Ut.CURRENT.driver.hasFeature(ge.AllocDepthBuffer),this.customDepth||(this.depth=He.getDefault())};i["h3d.pass.DirShadowMap"]=pi,pi.__name__="h3d.pass.DirShadowMap",pi.__super__=xi,pi.prototype=r(xi.prototype,{set_mode:function(t){var e=this.dshader;return e.constModified=!0,e.enable__=t!=Bi.None,this.mode=t},set_enabled:function(t){var e=this.dshader;return e.constModified=!0,e.enable__=t&&this.mode!=Bi.None,this.enabled=t},set_size:function(t){return null!=this.border&&this.size!=t&&(this.border.dispose(),this.border=new hi(t,t)),xi.prototype.set_size.call(this,t)},dispose:function(){xi.prototype.dispose.call(this),this.customDepth&&null!=this.depth&&this.depth.dispose(),this.border.dispose()},getShadowTex:function(){return this.dshader.shadowMap__},calcShadowBounds:function(t){var e=t.orthoBounds;if(this.autoShrink){var i=new Gt;this.ctx.scene.iterVisibleMeshes((function(n){if(null!=n.primitive&&n.material.castShadows){var s=n.primitive.getBounds();if(!(s.xMin>s.xMax)){i.multiply3x4(n.getAbsPos(),t.mcam);var r=s.xMin,a=s.yMin;null==(_=s.zMin)&&(_=0),null==a&&(a=0),null==r&&(r=0);var A=a,h=_,o=(c=r)*i._11+A*i._21+h*i._31+i._41,l=c*i._12+A*i._22+h*i._32+i._42,u=c*i._13+A*i._23+h*i._33+i._43;A=l,h=u,(c=o)<e.xMin&&(e.xMin=c),c>e.xMax&&(e.xMax=c),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A),h<e.zMin&&(e.zMin=h),h>e.zMax&&(e.zMax=h);r=s.xMin,a=s.yMin;null==(_=s.zMax)&&(_=0),null==a&&(a=0),null==r&&(r=0);A=a,h=_,o=(c=r)*i._11+A*i._21+h*i._31+i._41,l=c*i._12+A*i._22+h*i._32+i._42,u=c*i._13+A*i._23+h*i._33+i._43;A=l,h=u,(c=o)<e.xMin&&(e.xMin=c),c>e.xMax&&(e.xMax=c),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A),h<e.zMin&&(e.zMin=h),h>e.zMax&&(e.zMax=h);r=s.xMin,a=s.yMax;null==(_=s.zMin)&&(_=0),null==a&&(a=0),null==r&&(r=0);A=a,h=_,o=(c=r)*i._11+A*i._21+h*i._31+i._41,l=c*i._12+A*i._22+h*i._32+i._42,u=c*i._13+A*i._23+h*i._33+i._43;A=l,h=u,(c=o)<e.xMin&&(e.xMin=c),c>e.xMax&&(e.xMax=c),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A),h<e.zMin&&(e.zMin=h),h>e.zMax&&(e.zMax=h);r=s.xMin,a=s.yMax;null==(_=s.zMax)&&(_=0),null==a&&(a=0),null==r&&(r=0);A=a,h=_,o=(c=r)*i._11+A*i._21+h*i._31+i._41,l=c*i._12+A*i._22+h*i._32+i._42,u=c*i._13+A*i._23+h*i._33+i._43;A=l,h=u,(c=o)<e.xMin&&(e.xMin=c),c>e.xMax&&(e.xMax=c),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A),h<e.zMin&&(e.zMin=h),h>e.zMax&&(e.zMax=h);r=s.xMax,a=s.yMin;null==(_=s.zMin)&&(_=0),null==a&&(a=0),null==r&&(r=0);A=a,h=_,o=(c=r)*i._11+A*i._21+h*i._31+i._41,l=c*i._12+A*i._22+h*i._32+i._42,u=c*i._13+A*i._23+h*i._33+i._43;A=l,h=u,(c=o)<e.xMin&&(e.xMin=c),c>e.xMax&&(e.xMax=c),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A),h<e.zMin&&(e.zMin=h),h>e.zMax&&(e.zMax=h);r=s.xMax,a=s.yMin;null==(_=s.zMax)&&(_=0),null==a&&(a=0),null==r&&(r=0);A=a,h=_,o=(c=r)*i._11+A*i._21+h*i._31+i._41,l=c*i._12+A*i._22+h*i._32+i._42,u=c*i._13+A*i._23+h*i._33+i._43;A=l,h=u,(c=o)<e.xMin&&(e.xMin=c),c>e.xMax&&(e.xMax=c),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A),h<e.zMin&&(e.zMin=h),h>e.zMax&&(e.zMax=h);r=s.xMax,a=s.yMax;null==(_=s.zMin)&&(_=0),null==a&&(a=0),null==r&&(r=0);A=a,h=_,o=(c=r)*i._11+A*i._21+h*i._31+i._41,l=c*i._12+A*i._22+h*i._32+i._42,u=c*i._13+A*i._23+h*i._33+i._43;A=l,h=u,(c=o)<e.xMin&&(e.xMin=c),c>e.xMax&&(e.xMax=c),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A),h<e.zMin&&(e.zMin=h),h>e.zMax&&(e.zMax=h);var _;r=s.xMax,a=s.yMax;null==(_=s.zMax)&&(_=0),null==a&&(a=0),null==r&&(r=0);var c;A=a,h=_,o=(c=r)*i._11+A*i._21+h*i._31+i._41,l=c*i._12+A*i._22+h*i._32+i._42,u=c*i._13+A*i._23+h*i._33+i._43;A=l,h=u,(c=o)<e.xMin&&(e.xMin=c),c>e.xMax&&(e.xMax=c),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A),h<e.zMin&&(e.zMin=h),h>e.zMax&&(e.zMax=h)}}}))}else this.mode==Bi.Dynamic&&(e.xMin=-1e20,e.xMax=1e20,e.yMin=-1e20,e.yMax=1e20,e.zMin=-1e20,e.zMax=1e20);if(this.mode==Bi.Dynamic){var n,s,r,a=new se,A=1,h=0,o=this.ctx.camera.zNear,l=this.ctx.camera.zFar;if(this.maxDist>0)null==(r=l)&&(r=1),null==(s=o)&&(s=0),A=((l+o-2*o*l/((n=this.maxDist)<s?s:n>r?r:n))/(l-o)+1)/2;if(this.minDist>0)null==(r=l)&&(r=1),null==(s=o)&&(s=0),h=((l+o-2*o*l/((n=this.minDist)<s?s:n>r?r:n))/(l-o)+1)/2;for(var u=0,_=this.ctx.camera.getFrustumCorners(A,h);u<_.length;){var c=_[u];++u;var d=t.mcam,f=c.x*d._11+c.y*d._21+c.z*d._31+c.w*d._41,x=c.x*d._12+c.y*d._22+c.z*d._32+c.w*d._42,p=c.x*d._13+c.y*d._23+c.z*d._33+c.w*d._43,g=c.x*d._14+c.y*d._24+c.z*d._34+c.w*d._44;c.x=f,c.y=x,c.z=p,c.w=g;var m=c.x,v=c.y,y=c.z;m<a.xMin&&(a.xMin=m),m>a.xMax&&(a.xMax=m),v<a.yMin&&(a.yMin=v),v>a.yMax&&(a.yMax=v),y<a.zMin&&(a.zMin=y),y>a.zMax&&(a.zMax=y)}this.autoShrink?(a.zMin=e.zMin,e.intersection(e,a)):e.load(a)}e.scaleCenter(1.01)},setGlobals:function(){if(xi.prototype.setGlobals.call(this),this.mode!=Bi.Mixed||this.ctx.computingStatic){var t=this.lightCamera.orthoBounds;t.xMin=1e20,t.xMax=-1e20,t.yMin=1e20,t.yMax=-1e20,t.zMin=1e20,t.zMax=-1e20,this.calcShadowBounds(this.lightCamera),this.lightCamera.update()}var e=this.getShadowProj();this.manager.globals.map.h[this.cameraViewProj_id]=e},syncShader:function(t){(e=this.dshader).constModified=!0,e.shadowMap__=t,(e=this.dshader).constModified=!0,e.shadowMapChannel__=this.format==ti.nativeFormat?uA.PackedFloat:uA.R,this.dshader.shadowBias__=this.bias,this.dshader.shadowPower__=this.power,this.dshader.shadowProj__=this.getShadowProj(),(e=this.dshader).constModified=!0,e.USE_ESM__=this.samplingKind==Ci.ESM,this.dshader.shadowPower__=this.power,(e=this.dshader).constModified=!0,e.USE_PCF__=this.samplingKind==Ci.PCF;var e=this.dshader.shadowRes__,i=t.width,n=t.height;null==n&&(n=0),null==i&&(i=0),e.x=i,e.y=n,e.z=0,e.w=1,this.dshader.pcfScale__=this.pcfScale,(e=this.dshader).constModified=!0,e.pcfQuality__=this.pcfQuality},saveStaticData:function(){if(this.mode!=Bi.Mixed&&this.mode!=Bi.Static)return null;if(null==this.staticTexture)throw kn.thrown("Data not computed");var t=ds.run(this.staticTexture.capturePixels().bytes,9),e=new is;return e.addInt32(this.staticTexture.width),e.addFloat(this.lightCamera.pos.x),e.addFloat(this.lightCamera.pos.y),e.addFloat(this.lightCamera.pos.z),e.addFloat(this.lightCamera.target.x),e.addFloat(this.lightCamera.target.y),e.addFloat(this.lightCamera.target.z),e.addFloat(this.lightCamera.orthoBounds.xMin),e.addFloat(this.lightCamera.orthoBounds.yMin),e.addFloat(this.lightCamera.orthoBounds.zMin),e.addFloat(this.lightCamera.orthoBounds.xMax),e.addFloat(this.lightCamera.orthoBounds.yMax),e.addFloat(this.lightCamera.orthoBounds.zMax),e.addInt32(t.length),e.add(t),e.getBytes()},loadStaticData:function(t){if(this.mode!=Bi.Mixed&&this.mode!=Bi.Static||null==t)return!1;var e=new ss(t),i=e.readInt32();if(i!=this.size)return!1;this.lightCamera.pos.x=e.readFloat(),this.lightCamera.pos.y=e.readFloat(),this.lightCamera.pos.z=e.readFloat(),this.lightCamera.target.x=e.readFloat(),this.lightCamera.target.y=e.readFloat(),this.lightCamera.target.z=e.readFloat(),this.lightCamera.orthoBounds.xMin=e.readFloat(),this.lightCamera.orthoBounds.yMin=e.readFloat(),this.lightCamera.orthoBounds.zMin=e.readFloat(),this.lightCamera.orthoBounds.xMax=e.readFloat(),this.lightCamera.orthoBounds.yMax=e.readFloat(),this.lightCamera.orthoBounds.zMax=e.readFloat(),this.lightCamera.update();var n=e.readInt32(),s=new Ps(i,i,vs.run(e.read(n)),this.format);return null!=this.staticTexture&&this.staticTexture.dispose(),this.staticTexture=new ti(i,i,[Ye.Target],this.format),this.staticTexture.uploadPixels(s),this.staticTexture.name="staticTexture",this.staticTexture.preventAutoDispose(),this.syncShader(this.staticTexture),!0},draw:function(t,e){var i=this;if(this.enabled&&this.filterPasses(t)){for(var n=function(t){return t.inFrustum(i.lightCamera.frustum)},s=null,r=!0,a=null,A=null,h=t.discarded,o=t.lastDisc,l=t.current;null!=l;){var u,_=l.obj.cullingCollider;null==_?u=!0:(_!=s&&(s=_,r=n(_)),u=r),u?null==a?a=A=l:(A.next=l,A=l):null==h?h=o=l:(o.next=l,o=l),l=l.next}null!=A&&(A.next=null),null!=o&&(o.next=null),t.current=a,t.discarded=h,t.lastDisc=o;var c=this.ctx.textures.allocTarget("dirShadowMap",this.size,this.size,!1,this.format);if(this.customDepth&&(null==this.depth||this.depth.width!=this.size||this.depth.height!=this.size||this.depth.isDisposed())&&(null!=this.depth&&this.depth.dispose(),this.depth=new He(this.size,this.size)),c.depthBuffer=this.depth,this.mode!=Bi.Mixed||this.ctx.computingStatic){var d=this.ctx.camera.target,f=null==this.light?this.ctx.lightSystem.shadowLight:this.light,x=null==f?null:f.getShadowDirection();if(null==x){null==(p=-1)&&(p=0),null==(v=0)&&(v=0),null==(m=0)&&(m=0),(g=this.lightCamera.target).x=m,g.y=v,g.z=p,g.w=1}else{var p,g=this.lightCamera.target,m=x.x,v=x.y;null==(p=x.z)&&(p=0),null==v&&(v=0),null==m&&(m=0),g.x=m,g.y=v,g.z=p,g.w=1;var y=(g=this.lightCamera.target).x*g.x+g.y*g.y+g.z*g.z;y=y<1e-10?0:1/Math.sqrt(y),g.x*=y,g.y*=y,g.z*=y}this.lightCamera.target.x+=d.x,this.lightCamera.target.y+=d.y,this.lightCamera.target.z+=d.z,(g=this.lightCamera.pos).x=d.x,g.y=d.y,g.z=d.z,g.w=d.w,this.lightCamera.update()}if(this.ctx.engine.pushTarget(c),this.ctx.engine.clear(16777215,1),xi.prototype.draw.call(this,t,e),null!=this.border&&this.border.render(),this.ctx.engine.popTarget(),this.mode==Bi.Mixed&&!this.ctx.computingStatic){var b=this.ctx.textures.allocTarget("mergedDirShadowMap",this.size,this.size,!1,this.format);this.mergePass.shader.texA__=c,this.mergePass.shader.texB__=this.staticTexture,this.ctx.engine.pushTarget(b),this.mergePass.render(),this.ctx.engine.popTarget(),c=b}this.blur.radius>0&&(this.mode!=Bi.Mixed||!this.ctx.computingStatic)&&this.blur.apply(this.ctx,c),this.syncShader(c)}},computeStatic:function(t){if(this.mode==Bi.Static||this.mode==Bi.Mixed){this.draw(t);var e=this.dshader.shadowMap__,i=this.staticTexture;this.staticTexture=e.clone(),this.staticTexture.name="StaticDirShadowMap",this.staticTexture.preventAutoDispose();var n=this.dshader;n.constModified=!0,n.shadowMap__=this.staticTexture,null!=i&&i.dispose()}},__class__:pi});var gi=function(t,e){null==t&&(t=1024),null!=e&&(this.format=e),pi.call(this,null),this.set_size(t),this.color=new Yt,this.set_mode(Bi.Dynamic),this.shadowMapId=vA.allocID("shadow.map"),this.shadowProjId=vA.allocID("shadow.proj"),this.shadowColorId=vA.allocID("shadow.color"),this.shadowPowerId=vA.allocID("shadow.power"),this.shadowBiasId=vA.allocID("shadow.bias")};i["h3d.pass.DefaultShadowMap"]=gi,gi.__name__="h3d.pass.DefaultShadowMap",gi.__super__=pi,gi.prototype=r(pi.prototype,{draw:function(t,e){pi.prototype.draw.call(this,t,e),this.ctx.setGlobalID(this.shadowMapId,{texture:this.dshader.shadowMap__,channel:this.format==ti.nativeFormat?uA.PackedFloat:uA.R}),this.ctx.setGlobalID(this.shadowProjId,this.getShadowProj()),this.ctx.setGlobalID(this.shadowColorId,this.color),this.ctx.setGlobalID(this.shadowPowerId,this.power),this.ctx.setGlobalID(this.shadowBiasId,this.bias)},__class__:gi});var mi=function(){this.viewport__=new Yt,this.colorID__=new Yt,ri.call(this)};i["h3d.pass._HardwarePick.FixedColor"]=mi,mi.__name__="h3d.pass._HardwarePick.FixedColor",mi.__super__=ri,mi.prototype=r(ri.prototype,{get_colorID:function(){return this.colorID__},set_colorID:function(t){return this.colorID__=t},get_viewport:function(){return this.viewport__},set_viewport:function(t){return this.viewport__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.colorID__;case 1:return this.viewport__}return null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(mi.prototype);return t.shader=this.shader,t.colorID__=this.colorID__,t.viewport__=this.viewport__,t},__class__:mi});var vi=function(){this.pickedIndex=-1,this.fixedColor=new mi,fi.call(this,"hwpick"),this.material=new qe("");var t=this.material,e=Le.One,i=Le.Zero;t.set_blendSrc(e),t.set_blendAlphaSrc(e),t.set_blendDst(i),t.set_blendAlphaDst(i),this.texOut=new ti(3,3,[Ye.Target]),this.texOut.depthBuffer=new He(3,3)};i["h3d.pass.HardwarePick"]=vi,vi.__name__="h3d.pass.HardwarePick",vi.__super__=fi,vi.prototype=r(fi.prototype,{dispose:function(){fi.prototype.dispose.call(this),this.texOut.dispose(),this.texOut.depthBuffer.dispose()},getOutputs:function(){return[CA.Value("output.colorID")]},drawObject:function(t){fi.prototype.drawObject.call(this,t);var e=this.fixedColor.colorID__,i=-16777216|++this.colorID;e.x=(i>>16&255)/255,e.y=(i>>8&255)/255,e.z=(255&i)/255,e.w=(i>>>24)/255},nextID:function(){var t=this.fixedColor.colorID__,e=-16777216|++this.colorID;t.x=(e>>16&255)/255,t.y=(e>>8&255)/255,t.z=(255&e)/255,t.w=(e>>>24)/255},draw:function(t,e){for(var i=t.current;null!=i;){var n=i;i=i.next;var s=268435392;(_=n).pass.bits&=~s,_.pass.bits|=this.material.bits&s}this.colorID=0;var r=this.fixedColor.colorID__,a=-16777216|++this.colorID;r.x=(a>>16&255)/255,r.y=(a>>8&255)/255,r.z=(255&a)/255,r.w=(a>>>24)/255;r=this.fixedColor.viewport__;var A=-(2*this.pickX/this.ctx.engine.width-1),h=2*this.pickY/this.ctx.engine.height-1,o=this.ctx.engine.width/this.texOut.width,l=this.ctx.engine.height/this.texOut.height;null==l&&(l=1),null==o&&(o=0),null==h&&(h=0),null==A&&(A=0),r.x=A,r.y=h,r.z=o,r.w=l,this.ctx.engine.pushTarget(this.texOut),this.ctx.engine.clear(-16777216,1),this.ctx.extraShaders=this.ctx.allocShaderList(this.fixedColor),fi.prototype.draw.call(this,t,e),this.ctx.extraShaders=null,this.ctx.engine.popTarget();for(var u=t.current;null!=u;){var _;n=u;u=u.next,(_=n).pass.set_blendSrc(_.pass.blendSrc),_.pass.set_blendDst(_.pass.blendDst),_.pass.set_blendOp(_.pass.blendOp),_.pass.set_blendAlphaSrc(_.pass.blendAlphaSrc),_.pass.set_blendAlphaDst(_.pass.blendAlphaDst),_.pass.set_blendAlphaOp(_.pass.blendAlphaOp),_.pass.colorMask=_.pass.colorMask}this.ctx.engine.clear(null,null,0);var c=this.texOut.capturePixels();this.pickedIndex=(16777215&c.getPixel(c.width>>1,c.height>>1))-1},__class__:vi});var yi=function(t){this.o=t};i["h3d.pass.PassListIterator"]=yi,yi.__name__="h3d.pass.PassListIterator",yi.prototype={hasNext:function(){return null!=this.o},next:function(){var t=this.o;return this.o=this.o.next,t},__class__:yi};var bi=function(t){this.current=t,this.discarded=this.lastDisc=null};i["h3d.pass.PassList"]=bi,bi.__name__="h3d.pass.PassList",bi.prototype={init:function(t){this.current=t,this.discarded=this.lastDisc=null},reset:function(){null!=this.discarded&&(this.lastDisc.next=this.current,this.current=this.discarded,this.discarded=this.lastDisc=null)},save:function(){return this.lastDisc},load:function(t){this.lastDisc!=t&&(this.lastDisc.next=this.current,null==t?(this.current=this.discarded,this.discarded=null):(this.current=t.next,t.next=null),this.lastDisc=t)},isEmpty:function(){return null==this.current},clear:function(){if(null!=this.current){null==this.discarded?this.discarded=this.current:this.lastDisc.next=this.current;for(var t=this.current;null!=t.next;)t=t.next;this.lastDisc=t,this.current=null}},sort:function(t){var e,i=this.current;if(null==i)e=null;else{for(var n,s,r,a,A,h=1,o=0,l=0;;){for(s=i,i=null,A=null,n=0;null!=s;){++n,r=s,o=0;for(var u=0,_=h;u<_;){u++;if(++o,null==(r=r.next))break}for(l=h;o>0||l>0&&null!=r;)0==o?(a=r,r=r.next,--l):0==l||null==r||t(s,r)<=0?(a=s,s=s.next,--o):(a=r,r=r.next,--l),null!=A?A.next=a:i=a,A=a;s=r}if(A.next=null,n<=1)break;h*=2}e=i}this.current=e},filter:function(t){for(var e=null,i=null,n=this.discarded,s=this.lastDisc,r=this.current;null!=r;)t(r)?null==e?e=i=r:(i.next=r,i=r):null==n?n=s=r:(s.next=r,s=r),r=r.next;null!=i&&(i.next=null),null!=s&&(s.next=null),this.current=e,this.discarded=n,this.lastDisc=s},iterator:function(){return new yi(this.current)},getFiltered:function(){return new yi(this.discarded)},__class__:bi};var wi=function(){this.texture=0};i["h3d.pass.PassObject"]=wi,wi.__name__="h3d.pass.PassObject",wi.prototype={__class__:wi};var Mi=function(t){this.shaderCache=lA.get(),this.globals=new vA,this.currentOutput=new PA(null),this.setOutput(t)};i["h3d.pass.ShaderManager"]=Mi,Mi.__name__="h3d.pass.ShaderManager",Mi.prototype={setOutput:function(t){null==t&&(t=[CA.Value("output.color")]),this.currentOutput.s=this.shaderCache.getLinkShader(t)},fillRec:function(t,e,i,n){switch(e._hx_index){case 1:case 3:return i[n]=t,1;case 5:var s=e.t,r=e.size,a=t;switch(i[n++]=a.x,i[n++]=a.y,r){case 3:i[n++]=a.z;break;case 4:i[n++]=a.z,i[n++]=a.w}return r;case 6:var A=t;return i[n++]=A._11,i[n++]=A._21,i[n++]=A._31,i[n++]=0,i[n++]=A._12,i[n++]=A._22,i[n++]=A._32,i[n++]=0,i[n++]=A._13,i[n++]=A._23,i[n++]=A._33,i[n++]=0,12;case 7:A=t;return i[n++]=A._11,i[n++]=A._21,i[n++]=A._31,i[n++]=A._41,i[n++]=A._12,i[n++]=A._22,i[n++]=A._32,i[n++]=A._42,i[n++]=A._13,i[n++]=A._23,i[n++]=A._33,i[n++]=A._43,i[n++]=A._14,i[n++]=A._24,i[n++]=A._34,i[n++]=A._44,16;case 8:A=t;return i[n++]=A._11,i[n++]=A._21,i[n++]=A._31,i[n++]=A._41,i[n++]=A._12,i[n++]=A._22,i[n++]=A._32,i[n++]=A._42,i[n++]=A._13,i[n++]=A._23,i[n++]=A._33,i[n++]=A._43,12;case 13:var h=e.vl,o=0;for(s=0;s<h.length;){var l=h[s];++s,o+=this.fillRec(f.field(t,l.name),l.type,i,n+o)}return o;case 15:s=e.t;var u=e.size;switch(s._hx_index){case 3:if(0==u._hx_index){for(var _=u.v,c=0,d=0,p=(a=t).length<_?a.length:_;d<p;){var g=d++;i[n++]=a[g]}return _}throw kn.thrown("assert "+x.string(e));case 5:if(4==s.size){if(1==s.t._hx_index){if(0==u._hx_index){for(a=t,d=0,p=_=u.v;d<p;){if(null==(r=a[g=d++]))break;i[n++]=r.x,i[n++]=r.y,i[n++]=r.z,i[n++]=r.w}return 4*_}throw kn.thrown("assert "+x.string(e))}if(0==u._hx_index){var m=s;for(a=t,c=0,d=0,p=_=u.v;d<p;){if(null==(r=a[g=d++]))break;n+=c=this.fillRec(r,m,i,n)}return _*c}throw kn.thrown("assert "+x.string(e))}if(0==u._hx_index){for(m=s,a=t,c=0,d=0,p=_=u.v;d<p;){if(null==(r=a[g=d++]))break;n+=c=this.fillRec(r,m,i,n)}return _*c}throw kn.thrown("assert "+x.string(e));case 8:if(0==u._hx_index){for(a=t,d=0,p=_=u.v;d<p;){if(null==(A=a[g=d++]))break;i[n++]=A._11,i[n++]=A._21,i[n++]=A._31,i[n++]=A._41,i[n++]=A._12,i[n++]=A._22,i[n++]=A._32,i[n++]=A._42,i[n++]=A._13,i[n++]=A._23,i[n++]=A._33,i[n++]=A._43}return 12*_}throw kn.thrown("assert "+x.string(e));default:if(0==u._hx_index){for(m=s,a=t,c=0,s=0,u=_=u.v;s<u;){if(null==(r=a[g=s++]))break;n+=c=this.fillRec(r,m,i,n)}return _*c}throw kn.thrown("assert "+x.string(e))}break;default:throw kn.thrown("assert "+x.string(e))}},shaderInfo:function(t,e){for(var i=e.split(".").pop();null!=t;){for(var n=0,s=t.s.instance.shader.vars;n<s.length;){var r=s[n];if(++n,r.name==i)return t.s.toString()}t=t.next}return"(not found)"},getPtr:function(t){return t},getParamValue:function(t,e,i){if(null==i&&(i=!1),null!=t.perObjectGlobal){if(null==(A=this.globals.map.h[t.perObjectGlobal.gid]))throw kn.thrown("Missing global value "+t.perObjectGlobal.path+" for shader "+this.shaderInfo(e,t.perObjectGlobal.path));var n,s=t.type;if(17==s._hx_index){s.size;n=!0}else n=!1;return n?A.texture:A}for(var r=e,a=t.instance;--a>0;)r=r.next;var A;if(null==(A=r.s.getParamValue(t.index))&&!i)throw kn.thrown("Missing param value "+x.string(r.s)+"."+t.name);return A},fillGlobals:function(t,e){for(var i=this,n=(r=e.vertex).globals,s=t.vertex.globals;null!=n;){if(null==(a=i.globals.map.h[n.gid])){if("__consts__"==n.path){i.fillRec(r.consts,n.type,s,n.pos),n=n.next;continue}throw kn.thrown("Missing global value "+n.path)}i.fillRec(a,n.type,s,n.pos),n=n.next}var r;for(n=(r=e.fragment).globals,s=t.fragment.globals;null!=n;){var a;if(null==(a=i.globals.map.h[n.gid])){if("__consts__"==n.path){i.fillRec(r.consts,n.type,s,n.pos),n=n.next;continue}throw kn.thrown("Missing global value "+n.path)}i.fillRec(a,n.type,s,n.pos),n=n.next}},fillParams:function(t,e,i){for(var n=this,s=-1,r=null,a=t.vertex,A=(v=e.vertex).params,h=a.params;null!=A;){if(null==A.perObjectGlobal){if(A.type==Xa.TFloat){if(s==(y=A.instance))g=r;else{var o=i;for(s=y;--y>0;)o=o.next;g=r=o.s}h[A.pos]=g.getParamFloatValue(A.index),A=A.next;continue}if(s==(b=A.instance))D=r;else{var l=i;for(s=b;--b>0;)l=l.next;D=r=l.s}if(null==(E=D.getParamValue(A.index)))throw kn.thrown("Missing param value "+x.string(r)+"."+A.name)}else if(null!=A.perObjectGlobal){if(null==(w=n.globals.map.h[A.perObjectGlobal.gid]))throw kn.thrown("Missing global value "+A.perObjectGlobal.path+" for shader "+n.shaderInfo(i,A.perObjectGlobal.path));if(17==(F=A.type)._hx_index){F.size;M=!0}else M=!1;E=M?w.texture:w}else{for(var u=i,_=A.instance;--_>0;)u=u.next;if(null==(B=u.s.getParamValue(A.index)))throw kn.thrown("Missing param value "+x.string(u.s)+"."+A.name);E=B}n.fillRec(E,A.type,h,A.pos),A=A.next}var c=0;for(A=v.textures;null!=A;){if(null==(I=!Mi.STRICT)&&(I=!1),null!=A.perObjectGlobal){if(null==(E=n.globals.map.h[A.perObjectGlobal.gid]))throw kn.thrown("Missing global value "+A.perObjectGlobal.path+" for shader "+n.shaderInfo(i,A.perObjectGlobal.path));if(17==(F=A.type)._hx_index){F.size;S=!0}else S=!1;C=S?E.texture:E}else{for(o=i,_=A.instance;--_>0;)o=o.next;if(null==(D=o.s.getParamValue(A.index))&&!I)throw kn.thrown("Missing param value "+x.string(o.s)+"."+A.name);C=D}if(A.pos<0)for(var d=C,f=0,p=-A.pos;f<p;){var g=f++;a.tex[c++]=d[g]}else a.tex[c++]=C;A=A.next}A=v.buffers;for(var m=0;null!=A;){if(null==(I=!Mi.STRICT)&&(I=!1),null!=A.perObjectGlobal){if(null==(E=n.globals.map.h[A.perObjectGlobal.gid]))throw kn.thrown("Missing global value "+A.perObjectGlobal.path+" for shader "+n.shaderInfo(i,A.perObjectGlobal.path));if(17==(F=A.type)._hx_index){F.size;T=!0}else T=!1;k=T?E.texture:E}else{for(o=i,_=A.instance;--_>0;)o=o.next;if(null==(D=o.s.getParamValue(A.index))&&!I)throw kn.thrown("Missing param value "+x.string(o.s)+"."+A.name);k=D}a.buffers[m++]=k,A=A.next}var v;for(a=t.fragment,A=(v=e.fragment).params,h=a.params;null!=A;){if(null==A.perObjectGlobal){if(A.type==Xa.TFloat){var y;if(s==(y=A.instance))g=r;else{o=i;for(s=y;--y>0;)o=o.next;g=r=o.s}h[A.pos]=g.getParamFloatValue(A.index),A=A.next;continue}var b;if(s==(b=A.instance))D=r;else{l=i;for(s=b;--b>0;)l=l.next;D=r=l.s}if(null==(E=D.getParamValue(A.index)))throw kn.thrown("Missing param value "+x.string(r)+"."+A.name)}else if(null!=A.perObjectGlobal){var w,M;if(null==(w=n.globals.map.h[A.perObjectGlobal.gid]))throw kn.thrown("Missing global value "+A.perObjectGlobal.path+" for shader "+n.shaderInfo(i,A.perObjectGlobal.path));if(17==(F=A.type)._hx_index){F.size;M=!0}else M=!1;E=M?w.texture:w}else{for(u=i,_=A.instance;--_>0;)u=u.next;var B;if(null==(B=u.s.getParamValue(A.index)))throw kn.thrown("Missing param value "+x.string(u.s)+"."+A.name);E=B}n.fillRec(E,A.type,h,A.pos),A=A.next}for(c=0,A=v.textures;null!=A;){var C;if(null==(I=!Mi.STRICT)&&(I=!1),null!=A.perObjectGlobal){var S;if(null==(E=n.globals.map.h[A.perObjectGlobal.gid]))throw kn.thrown("Missing global value "+A.perObjectGlobal.path+" for shader "+n.shaderInfo(i,A.perObjectGlobal.path));if(17==(F=A.type)._hx_index){F.size;S=!0}else S=!1;C=S?E.texture:E}else{for(o=i,_=A.instance;--_>0;)o=o.next;if(null==(D=o.s.getParamValue(A.index))&&!I)throw kn.thrown("Missing param value "+x.string(o.s)+"."+A.name);C=D}if(A.pos<0)for(d=C,f=0,p=-A.pos;f<p;){g=f++;a.tex[c++]=d[g]}else a.tex[c++]=C;A=A.next}for(A=v.buffers,m=0;null!=A;){var I,k;if(null==(I=!Mi.STRICT)&&(I=!1),null!=A.perObjectGlobal){var E,F,T;if(null==(E=n.globals.map.h[A.perObjectGlobal.gid]))throw kn.thrown("Missing global value "+A.perObjectGlobal.path+" for shader "+n.shaderInfo(i,A.perObjectGlobal.path));if(17==(F=A.type)._hx_index){F.size;T=!0}else T=!1;k=T?E.texture:E}else{for(o=i,_=A.instance;--_>0;)o=o.next;var D;if(null==(D=o.s.getParamValue(A.index))&&!I)throw kn.thrown("Missing param value "+x.string(o.s)+"."+A.name);k=D}a.buffers[m++]=k,A=A.next}},compileShaders:function(t,e){null==e&&(e=!1),this.globals.maxChannels=0;for(var i=t;null!=i;){var n=i.s;i=i.next,n.updateConstants(this.globals)}this.currentOutput.next=t;n=this.shaderCache.link(this.currentOutput,e);return this.currentOutput.next=null,n},__class__:Mi};var Bi=s["h3d.pass.RenderMode"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"h3d.pass.RenderMode",toString:n},Static:{_hx_name:"Static",_hx_index:1,__enum__:"h3d.pass.RenderMode",toString:n},Dynamic:{_hx_name:"Dynamic",_hx_index:2,__enum__:"h3d.pass.RenderMode",toString:n},Mixed:{_hx_name:"Mixed",_hx_index:3,__enum__:"h3d.pass.RenderMode",toString:n}};Bi.__constructs__=[Bi.None,Bi.Static,Bi.Dynamic,Bi.Mixed],Bi.__empty_constructs__=[Bi.None,Bi.Static,Bi.Dynamic,Bi.Mixed];var Ci=s["h3d.pass.ShadowSamplingKind"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"h3d.pass.ShadowSamplingKind",toString:n},PCF:{_hx_name:"PCF",_hx_index:1,__enum__:"h3d.pass.ShadowSamplingKind",toString:n},ESM:{_hx_name:"ESM",_hx_index:2,__enum__:"h3d.pass.ShadowSamplingKind",toString:n}};Ci.__constructs__=[Ci.None,Ci.PCF,Ci.ESM],Ci.__empty_constructs__=[Ci.None,Ci.PCF,Ci.ESM];var Si=function(){this.textureCount=1,this.shaderCount=1,this.shaderIdMap=[],this.textureIdMap=[]};i["h3d.pass.SortByMaterial"]=Si,Si.__name__="h3d.pass.SortByMaterial",Si.prototype={sort:function(t){for(var e=this,i=this.shaderCount,n=this.textureCount,s=t.current;null!=s;){var r=s;s=s.next;var a=r;(this.shaderIdMap[a.shader.id]<i||null==this.shaderIdMap[a.shader.id])&&(this.shaderIdMap[a.shader.id]=this.shaderCount++),(this.textureIdMap[a.texture]<n||null==this.textureIdMap[a.shader.id])&&(this.textureIdMap[a.texture]=this.textureCount++)}var A=t.current;if(null==A)r=null;else{for(var h,o,l,u,_=1,c=0,d=0;;){for(a=A,A=null,u=null,h=0;null!=a;){++h,o=a,c=0;for(var f=0,x=_;f<x;){f++;if(++c,null==(o=o.next))break}for(d=_;c>0||d>0&&null!=o;){if(0==c)l=o,o=o.next,--d;else{var p;if(0!=d&&null!=o){var g=e.shaderIdMap[a.shader.id]-e.shaderIdMap[o.shader.id];p=(0!=g?g:e.textureIdMap[a.texture]-e.textureIdMap[o.texture])<=0}else p=!0;p?(l=a,a=a.next,--c):(l=o,o=o.next,--d)}null!=u?u.next=l:A=l,u=l}a=o}if(u.next=null,h<=1)break;_*=2}r=A}t.current=r},__class__:Si};var Ii=function(t,e){if(null==e&&(e=!1),this.isStatic=!0,this.hasTangents=!1,this.startIndex=0,this.idxPos=0,this.bufPos=0,ft.call(this),this.isRaw=e,this.buffers=[],this.allIndexes=[],this.bounds=new se,this.stride=t,t<3)throw kn.thrown("Minimum stride = 3")};i["h3d.prim.BigPrimitive"]=Ii,Ii.__name__="h3d.prim.BigPrimitive",Ii.__super__=ft,Ii.prototype=r(ft.prototype,{begin:function(t,e){if(this.startIndex=this.bufPos/this.stride|0,this.startIndex+t>=65535){if(t>=65535)throw kn.thrown("Too many vertices in begin()");this.flush()}if(null==this.tmpBuf){if(this.tmpBuf=Ii.PREV_BUFFER,null==this.tmpBuf){var i=Cs._new(0);this.tmpBuf=i}else Ii.PREV_BUFFER=null;if(this.isStatic)for(var n=(i=this.tmpBuf).pos,s=65535*this.stride;n<s;){n++;if(i.pos==i.array.length)(r=i.array.length<<1)<128&&(r=128),(a=new Float32Array(r)).set(i.array),i.array=a;i.array[i.pos++]=0}}if(!this.isStatic)for(n=(i=this.tmpBuf).pos,s=t*this.stride+this.bufPos;n<s;){var r,a;n++;if(i.pos==i.array.length)(r=i.array.length<<1)<128&&(r=128),(a=new Float32Array(r)).set(i.array),i.array=a;i.array[i.pos++]=0}if(null==this.tmpIdx)if(this.tmpIdx=Ii.PREV_INDEX,null==this.tmpIdx){i=new Array(0);this.tmpIdx=i}else Ii.PREV_INDEX=null;if(this.idxPos+e>this.tmpIdx.length){for(var A=0==this.tmpIdx.length?1024:this.tmpIdx.length,h=this.idxPos+e;A<h;)A<<=1;for(i=this.tmpIdx;i.length<A;)i.push(0)}},addPoint:function(t,e,i){this.tmpBuf.array[this.bufPos++]=t,this.tmpBuf.array[this.bufPos++]=e,this.tmpBuf.array[this.bufPos++]=i;var n=this.bounds;t<n.xMin&&(n.xMin=t),t>n.xMax&&(n.xMax=t),e<n.yMin&&(n.yMin=e),e>n.yMax&&(n.yMax=e),i<n.zMin&&(n.zMin=i),i>n.zMax&&(n.zMax=i)},addBounds:function(t,e,i){var n=this.bounds;t<n.xMin&&(n.xMin=t),t>n.xMax&&(n.xMax=t),e<n.yMin&&(n.yMin=e),e>n.yMax&&(n.yMax=e),i<n.zMin&&(n.zMin=i),i>n.zMax&&(n.zMax=i)},addVertexValue:function(t){this.tmpBuf.array[this.bufPos++]=t},addIndex:function(t){this.tmpIdx[this.idxPos++]=t+this.startIndex},triCount:function(){for(var t=0,e=0,i=this.allIndexes;e<i.length;){var n=i[e];++e,t+=n.count}return(t+=this.idxPos)/3|0},vertexCount:function(){for(var t=0,e=0,i=this.buffers;e<i.length;){var n=i[e];++e,t+=n.vertices}return t+=this.bufPos/this.stride|0},flush:function(){if(null!=this.tmpBuf){if(this.bufPos>0&&this.idxPos>0){this.flushing=!0;var t=Rt.ofSubFloats(this.tmpBuf,this.stride,this.bufPos/this.stride|0);this.isRaw&&(t.flags|=1<<zt.RawFormat._hx_index),this.buffers.push(t);var e=Ot.alloc(this.tmpIdx,0,this.idxPos);this.allIndexes.push(e),this.flushing=!1}(null==Ii.PREV_BUFFER||Ii.PREV_BUFFER.pos<this.tmpBuf.pos)&&(Ii.PREV_BUFFER=this.tmpBuf),(null==Ii.PREV_INDEX||Ii.PREV_INDEX.length<this.tmpIdx.length)&&(Ii.PREV_INDEX=this.tmpIdx),this.tmpBuf=null,this.tmpIdx=null,this.bufPos=0,this.idxPos=0,this.startIndex=0}},render:function(t){null!=this.tmpBuf&&this.flush();for(var e=0,i=this.buffers.length;e<i;){var n=e++;t.renderIndexed(this.buffers[n],this.allIndexes[n])}},getBounds:function(){return this.bounds},dispose:function(){this.clear()},clear:function(){if(this.flushing)throw kn.thrown("Cannot clear() BigPrimitive while it's flushing");var t=this.bounds;t.xMin=1e20,t.xMax=-1e20,t.yMin=1e20,t.yMax=-1e20,t.zMin=1e20,t.zMax=-1e20;for(var e=0,i=this.buffers;e<i.length;){var n=i[e];++e,n.dispose()}for(e=0,i=this.allIndexes;e<i.length;){var s=i[e];++e,s.dispose()}this.buffers=[],this.allIndexes=[],this.bufPos=0,this.idxPos=0,this.tmpBuf=null,this.tmpIdx=null},add:function(t,e,i,n,s,r,a,A){null==A&&(A=-1),null==a&&(a=1),null==r&&(r=0),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0),this.addSub(t,e,0,0,t.pos/(A<0?this.stride:A)|0,e.length/3|0,i,n,s,r,a,A)},addSub:function(t,e,i,n,s,r,a,A,h,o,l,u,_,c,d,f){if(null==d&&(d=1),null==c&&(c=0),null==_&&(_=0),null==u&&(u=-1),null==l&&(l=1),null==o&&(o=0),null==h&&(h=0),null==A&&(A=0),null==a&&(a=0),u<0&&(u=this.stride),u<this.stride)throw kn.thrown("only stride >= "+this.stride+" allowed");this.begin(s,3*r);for(var x=this.startIndex,p=Math.cos(o),g=Math.sin(o),m=this.bufPos,v=this.tmpBuf,y=0,b=s;y<b;){var w=(y+++i)*u,M=t.array[w++],B=t.array[w++],C=t.array[w++];if(null!=f){var S=M,I=B,k=C;null==k&&(k=0),null==I&&(I=0),null==S&&(S=0);var E=S,F=I,T=k,D=E*f._11+F*f._21+T*f._31+f._41,P=E*f._12+F*f._22+T*f._32+f._42,z=E*f._13+F*f._23+T*f._33+f._43;E=D,F=P,T=z,v.array[m++]=E,v.array[m++]=F,v.array[m++]=T;var R=this.bounds;E<R.xMin&&(R.xMin=E),E>R.xMax&&(R.xMax=E),F<R.yMin&&(R.yMin=F),F>R.yMax&&(R.yMax=F),T<R.zMin&&(R.zMin=T),T>R.zMax&&(R.zMax=T)}else{var L=a+(M*p-B*g)*l,V=A+(M*g+B*p)*l,Q=h+C*l;v.array[m++]=L,v.array[m++]=V,v.array[m++]=Q;var U=this.bounds;L<U.xMin&&(U.xMin=L),L>U.xMax&&(U.xMax=L),V<U.yMin&&(U.yMin=V),V>U.yMax&&(U.yMax=V),Q<U.zMin&&(U.zMin=Q),Q>U.zMax&&(U.zMax=Q)}if(this.stride>=6){var O=t.array[w++],G=t.array[w++],N=t.array[w++];if(null!=f){var Y=O,X=G,j=N;null==j&&(j=0),null==X&&(X=0),null==Y&&(Y=0);var H=Y,W=X,Z=j,J=H*f._11+W*f._21+Z*f._31,q=H*f._12+W*f._22+Z*f._32,K=H*f._13+W*f._23+Z*f._33,$=(H=J)*H+(W=q)*W+(Z=K)*Z;H*=$=$<1e-10?0:1/Math.sqrt($),W*=$,Z*=$,v.array[m++]=H,v.array[m++]=W,v.array[m++]=Z}else{var tt=O*p-G*g,et=O*g+G*p;v.array[m++]=tt,v.array[m++]=et,v.array[m++]=N}}var it=this.stride;if(this.hasTangents){var nt=t.array[w++],st=t.array[w++],rt=t.array[w++];if(null!=f){var at=nt,At=st,ht=rt;null==ht&&(ht=0),null==At&&(At=0),null==at&&(at=0);var ot=at,lt=At,ut=ht,_t=ot*ot+lt*lt+ut*ut,ct=ot*f._11+lt*f._21+ut*f._31,dt=ot*f._12+lt*f._22+ut*f._32,ft=ot*f._13+lt*f._23+ut*f._33,xt=(ot=ct)*ot+(lt=dt)*lt+(ut=ft)*ut;ot*=xt=xt<1e-10?0:1/Math.sqrt(xt),lt*=xt,ut*=xt,_t<.5&&(ot*=.5,lt*=.5,ut*=.5),v.array[m++]=ot,v.array[m++]=lt,v.array[m++]=ut}else{var pt=nt*p-st*g,gt=nt*g+st*p;v.array[m++]=pt,v.array[m++]=gt,v.array[m++]=rt}it-=3}switch(it){case 3:case 6:continue;case 4:case 7:v.array[m++]=t.array[w++]+_;break;case 5:case 8:case 9:case 10:v.array[m++]=t.array[w++]+_,v.array[m++]=t.array[w++]+c;for(var mt=8,vt=it;mt<vt;){mt++;v.array[m++]=t.array[w++]}break;default:v.array[m++]=t.array[w++]+_,v.array[m++]=t.array[w++]+c,v.array[m++]=t.array[w++]*d,v.array[m++]=t.array[w++]*d,v.array[m++]=t.array[w++]*d;for(var yt=11,bt=it;yt<bt;){yt++;v.array[m++]=t.array[w++]}}}this.bufPos=m,x-=i;for(y=0,b=3*r;y<b;){var wt=e[y+++3*n]+x;this.tmpIdx[this.idxPos++]=wt}},__class__:Ii});var ki=function(){ft.call(this)};i["h3d.prim.MeshPrimitive"]=ki,ki.__name__="h3d.prim.MeshPrimitive",ki.__super__=ft,ki.prototype=r(ft.prototype,{allocBuffer:function(t,e){return null},hasBuffer:function(t){if(null==this.bufferCache)return!1;var e=this.bufferCache,i=vA.allocID(t);return e.h.hasOwnProperty(i)},addBuffer:function(t,e,i){null==i&&(i=0),null==this.bufferCache&&(this.bufferCache=new Wn);var n=vA.allocID(t),s=this.bufferCache.h[n];null!=s&&s.dispose();var r=this.bufferCache,a=new Lt(e,i);r.h[n]=a,this.layouts=null},dispose:function(){if(ft.prototype.dispose.call(this),null!=this.bufferCache)for(var t=this.bufferCache.iterator();t.hasNext();){t.next().dispose()}this.bufferCache=null,this.layouts=null},getBuffers:function(t){null==this.bufferCache&&(this.bufferCache=new Wn),null==this.layouts&&(this.layouts=new Wn);var e=t.driver.getShaderInputNames(),i=this.layouts.h[e.id];if(null!=i)return i;for(var n=null,s=0,r=e.names;s<r.length;){var a=r[s];++s;var A=vA.allocID(a),h=this.bufferCache.h[A];if(null==h){if(null==(h=this.allocBuffer(t,a)))throw kn.thrown("Buffer "+a+" is not available");this.bufferCache.h[A]=h}h=new Lt(h.buffer,h.offset),null==n?i=n=h:(n.next=h,n=h)}return this.layouts.h[e.id]=i,i},render:function(t){(null==this.indexes||this.indexes.isDisposed())&&this.alloc(t),t.renderMultiBuffers(this.getBuffers(t),this.indexes)},__class__:ki});var Ei=function(t,e,i){this.bufferAliases=new Kn,ki.call(this),this.data=t,this.dataPosition=e,this.lib=i};i["h3d.prim.HMDModel"]=Ei,Ei.__name__="h3d.prim.HMDModel",Ei.__super__=ki,Ei.prototype=r(ki.prototype,{triCount:function(){return this.data.get_indexCount()/3|0},vertexCount:function(){return this.data.vertexCount},getBounds:function(){return this.data.bounds},selectMaterial:function(t){this.curMaterial=t},getDataBuffers:function(t,e,i){return this.lib.getBuffers(this.data,t,e,i)},loadSkin:function(t){this.lib.loadSkin(this.data,t)},addAlias:function(t,e,i){null==i&&(i=0);var n=this.bufferAliases.h[t];if(null==n)this.bufferAliases.h[t]={realName:e,offset:i},null!=this.bufferCache&&this.allocAlias(t);else if(n.realName!=e||n.offset!=i)throw kn.thrown("Conflicting alias "+t)},alloc:function(t){this.dispose(),this.buffer=new Rt(this.data.vertexCount,this.data.vertexStride,[zt.LargeBuffer]);var e=this.lib.resource.entry;e.open(),e.skip(this.dataPosition+this.data.vertexPosition);var i=this.data.vertexCount*this.data.vertexStride*4,n=new Qn(new ArrayBuffer(i));e.read(n,0,i),this.buffer.uploadBytes(n,0,this.data.vertexCount),this.indexCount=0,this.indexesTriPos=[];for(var s=0,r=this.data.indexCounts;s<r.length;){var a=r[s];++s,this.indexesTriPos.push(this.indexCount/3|0),this.indexCount+=a}var A=this.data.vertexCount>65536;this.indexes=new Ot(this.indexCount,A),e.skip(this.data.indexPosition-(this.data.vertexPosition+i));var h=A?4:2;n=new Qn(new ArrayBuffer(this.indexCount*h));e.read(n,0,this.indexCount*h),this.indexes.uploadBytes(n,0,this.indexCount),e.close();var o=0;for(s=0,r=this.data.vertexFormat;s<r.length;){var l=r[s];++s,this.addBuffer(l.name,this.buffer,o),o+=7&l.format}null!=this.normalsRecomputed&&this.recomputeNormals(this.normalsRecomputed);for(var u=this.bufferAliases.h,_=Object.keys(u),c=_.length,d=0;d<c;){var f=_[d++];this.allocAlias(f)}},allocAlias:function(t){var e=this.bufferAliases.h[t],i=this.bufferCache,n=vA.allocID(e.realName),s=i.h[n];if(null==s)throw kn.thrown("Buffer "+e.realName+" not found for alias "+t);if(s.offset+e.offset>s.buffer.buffer.stride)throw kn.thrown("Alias "+t+" for buffer "+e.realName+" outside stride");this.addBuffer(t,s.buffer,s.offset+e.offset)},recomputeNormals:function(t){null==t&&(t="normal");for(var e=this.lib.getBuffers(this.data,[new gr("position",3)]),i=[],n=[],s=0,r=this.data.vertexCount;s<r;){for(var a=s++,A=!1,h=e.vertexes[3*a],o=e.vertexes[3*a+1],l=e.vertexes[3*a+2],u=0,_=n.length;u<_;){var c=u++,d=n[c];if(d.x==h&&d.y==o&&d.z==l){i.push(c),A=!0;break}}A||(i.push(n.length),n.push(new _e(h,o,l)))}var f=new Array(0);for(s=0,r=e.indexes;s<r.length;){a=r[s];++s,f.push(i[a])}var x=new Ti(n,f);x.addNormals();var p=Cs._new(0);for(s=p.pos,r=3*this.data.vertexCount;s<r;){a=s++;if(p.pos==p.array.length){var g=p.array.length<<1;g<128&&(g=128);var m=new Float32Array(g);m.set(p.array),p.array=m}p.array[p.pos++]=0}var v=0;for(s=0,r=this.data.vertexCount;s<r;){a=s++;var y=x.normals[i[a]];p.array[v++]=y.x,p.array[v++]=y.y,p.array[v++]=y.z}var b=Rt.ofFloats(p,3);this.addBuffer(t,b,0),this.normalsRecomputed=t},render:function(t){this.curMaterial<0?ki.prototype.render.call(this,t):((null==this.indexes||this.indexes.isDisposed())&&this.alloc(t),t.renderMultiBuffers(this.getBuffers(t),this.indexes,this.indexesTriPos[this.curMaterial],this.data.indexCounts[this.curMaterial]/3|0),this.curMaterial=-1)},initCollider:function(t){var e=this.lib.getBuffers(this.data,[new gr("position",3)]);if(t.setData(e.vertexes,e.indexes),null==this.collider){var i=this.data.bounds,n=i.xMax-i.xMin,s=i.yMax-i.yMin,r=i.zMax-i.zMin,a=new pe(.5*(i.xMin+i.xMax),.5*(i.yMin+i.yMax),.5*(i.zMin+i.zMax),.5*Math.sqrt(n*n+s*s+r*r));this.collider=new re(a,t)}},getCollider:function(){if(null!=this.collider)return this.collider;var t=new fe;t.source={entry:this.lib.resource.entry,geometryName:null};for(var e=0,i=this.lib.header.models;e<i.length;){var n=i[e];if(++e,this.lib.header.geometries[n.geometry]==this.data){t.source.geometryName=n.name;break}}return this.initCollider(t),this.collider},__class__:Ei});var Fi=function(){ft.call(this)};i["h3d.prim.Plane2D"]=Fi,Fi.__name__="h3d.prim.Plane2D",Fi.get=function(){var t=Ut.CURRENT,e=t.resCache.h[Fi.__id__];return null==e&&(e=new Fi,t.resCache.set(Fi,e)),e},Fi.__super__=ft,Fi.prototype=r(ft.prototype,{triCount:function(){return 2},vertexCount:function(){return 4},alloc:function(t){var e,i,n=Cs._new(0);n.pos==n.array.length&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=-1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=-1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=0,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=-1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=0,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=0,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=-1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);(n.array[n.pos++]=1,n.pos==n.array.length)&&((e=n.array.length<<1)<128&&(e=128),(i=new Float32Array(e)).set(n.array),n.array=i);n.array[n.pos++]=0,this.buffer=Rt.ofFloats(n,4,[zt.Quads,zt.RawFormat])},render:function(t){var e;if(null!=this.buffer){var i=this.buffer;e=null==i.buffer||null==i.buffer.vbuf}else e=!0;e&&this.alloc(t),t.renderBuffer(this.buffer,t.mem.quadIndexes,2,0,-1)},__class__:Fi});var Ti=function(t,e){this.translatedZ=0,this.translatedY=0,this.translatedX=0,this.scaled=1,ki.call(this),this.points=t,this.idx=e};i["h3d.prim.Polygon"]=Ti,Ti.__name__="h3d.prim.Polygon",Ti.__super__=ki,Ti.prototype=r(ki.prototype,{getBounds:function(){for(var t=new se,e=0,i=this.points;e<i.length;){var n=i[e];++e,n.x<t.xMin&&(t.xMin=n.x),n.x>t.xMax&&(t.xMax=n.x),n.y<t.yMin&&(t.yMin=n.y),n.y>t.yMax&&(t.yMax=n.y),n.z<t.zMin&&(t.zMin=n.z),n.z>t.zMax&&(t.zMax=n.z)}return t},alloc:function(t){this.dispose();var e=3,i=["position"],n=[0];null!=this.normals&&(i.push("normal"),n.push(e),e+=3),null!=this.tangents&&(i.push("tangent"),n.push(e),e+=3),null!=this.uvs&&(i.push("uv"),n.push(e),e+=2),null!=this.colors&&(i.push("color"),n.push(e),e+=3);for(var s=Cs._new(0),r=0,a=this.points.length;r<a;){var A=r++,h=this.points[A],o=h.x;if(s.pos==s.array.length){var l=s.array.length<<1;l<128&&(l=128);var u=new Float32Array(l);u.set(s.array),s.array=u}s.array[s.pos++]=o;var _=h.y;if(s.pos==s.array.length){var c=s.array.length<<1;c<128&&(c=128);var d=new Float32Array(c);d.set(s.array),s.array=d}s.array[s.pos++]=_;var f=h.z;if(s.pos==s.array.length){var x=s.array.length<<1;x<128&&(x=128);var p=new Float32Array(x);p.set(s.array),s.array=p}if(s.array[s.pos++]=f,null!=this.normals){var g=this.normals[A],m=g.x;if(s.pos==s.array.length){var v=s.array.length<<1;v<128&&(v=128);var y=new Float32Array(v);y.set(s.array),s.array=y}s.array[s.pos++]=m;var b=g.y;if(s.pos==s.array.length){var w=s.array.length<<1;w<128&&(w=128);var M=new Float32Array(w);M.set(s.array),s.array=M}s.array[s.pos++]=b;var B=g.z;if(s.pos==s.array.length){var C=s.array.length<<1;C<128&&(C=128);var S=new Float32Array(C);S.set(s.array),s.array=S}s.array[s.pos++]=B}if(null!=this.tangents){var I=this.tangents[A],k=I.x;if(s.pos==s.array.length){var E=s.array.length<<1;E<128&&(E=128);var F=new Float32Array(E);F.set(s.array),s.array=F}s.array[s.pos++]=k;var T=I.y;if(s.pos==s.array.length){var D=s.array.length<<1;D<128&&(D=128);var P=new Float32Array(D);P.set(s.array),s.array=P}s.array[s.pos++]=T;var z=I.z;if(s.pos==s.array.length){var R=s.array.length<<1;R<128&&(R=128);var L=new Float32Array(R);L.set(s.array),s.array=L}s.array[s.pos++]=z}if(null!=this.uvs){var V=this.uvs[A],Q=V.u;if(s.pos==s.array.length){var U=s.array.length<<1;U<128&&(U=128);var O=new Float32Array(U);O.set(s.array),s.array=O}s.array[s.pos++]=Q;var G=V.v;if(s.pos==s.array.length){var N=s.array.length<<1;N<128&&(N=128);var Y=new Float32Array(N);Y.set(s.array),s.array=Y}s.array[s.pos++]=G}if(null!=this.colors){var X=this.colors[A],j=X.x;if(s.pos==s.array.length){var H=s.array.length<<1;H<128&&(H=128);var W=new Float32Array(H);W.set(s.array),s.array=W}s.array[s.pos++]=j;var Z=X.y;if(s.pos==s.array.length){var J=s.array.length<<1;J<128&&(J=128);var q=new Float32Array(J);q.set(s.array),s.array=q}s.array[s.pos++]=Z;var K=X.z;if(s.pos==s.array.length){var $=s.array.length<<1;$<128&&($=128);var tt=new Float32Array($);tt.set(s.array),s.array=tt}s.array[s.pos++]=K}}var et=[];null==this.idx&&et.push(zt.Triangles),null!=this.normals&&null==this.tangents||et.push(zt.RawFormat),this.buffer=Rt.ofFloats(s,e,et);for(r=0,a=i.length;r<a;){var it=r++;this.addBuffer(i[it],this.buffer,n[it])}null!=this.idx&&(this.indexes=Ot.alloc(this.idx))},unindex:function(){if(null!=this.idx&&this.points.length!=this.idx.length){for(var t=[],e=0,i=this.idx.length;e<i;){var n=e++,s=this.points[this.idx[n]];t.push(new _e(s.x,s.y,s.z))}if(null!=this.normals){var r=[];for(e=0,i=this.idx.length;e<i;){n=e++,s=this.normals[this.idx[n]];r.push(new _e(s.x,s.y,s.z))}this.normals=r}if(null!=this.tangents){var a=[];for(e=0,i=this.idx.length;e<i;){n=e++,s=this.tangents[this.idx[n]];a.push(new _e(s.x,s.y,s.z))}this.tangents=a}if(null!=this.colors){for(r=[],e=0,i=this.idx.length;e<i;){n=e++,s=this.colors[this.idx[n]];r.push(new _e(s.x,s.y,s.z))}this.colors=r}if(null!=this.uvs){for(a=[],e=0,i=this.idx.length;e<i;){n=e++;a.push(this.uvs[this.idx[n]].clone())}this.uvs=a}this.points=t,this.idx=null}},translate:function(t,e,i){this.translatedX+=t,this.translatedY+=e,this.translatedZ+=i;for(var n=0,s=this.points;n<s.length;){var r=s[n];++n,r.x+=t,r.y+=e,r.z+=i}},scale:function(t){this.scaled*=t;for(var e=0,i=this.points;e<i.length;){var n=i[e];++e,n.x*=t,n.y*=t,n.z*=t}},addNormals:function(){this.normals=[];for(var t=0,e=this.points.length;t<e;){var i=t++;this.normals[i]=new _e}var n=0;for(t=0,e=this.triCount();t<e;){var s,r,a;i=t++;null==this.idx?(s=++n-1,r=++n-1,a=++n-1):(s=this.idx[n++],r=this.idx[n++],a=this.idx[n++]);var A=this.points[s],h=this.points[r],o=this.points[a],l=h.x-A.x,u=h.y-A.y,_=h.z-A.z;null==_&&(_=0),null==u&&(u=0),null==l&&(l=0);var c=l,d=u,f=_,x=o.x-A.x,p=o.y-A.y,g=o.z-A.z;null==g&&(g=0),null==p&&(p=0),null==x&&(x=0);var m=d*g-f*p,v=f*x-c*g,y=c*p-d*x;null==y&&(y=0),null==v&&(v=0),null==m&&(m=0);var b=m,w=v,M=y;this.normals[s].x+=b,this.normals[s].y+=w,this.normals[s].z+=M,this.normals[r].x+=b,this.normals[r].y+=w,this.normals[r].z+=M,this.normals[a].x+=b,this.normals[a].y+=w,this.normals[a].z+=M}for(t=0,e=this.normals;t<e.length;){var B=e[t];++t;var C=B.x*B.x+B.y*B.y+B.z*B.z;C=C<1e-10?0:1/Math.sqrt(C),B.x*=C,B.y*=C,B.z*=C}},addTangents:function(){null==this.normals&&this.addNormals(),null==this.uvs&&this.addUVs(),this.tangents=[];for(var t=0,e=this.points.length;t<e;){var i=t++;this.tangents[i]=new _e}var n=0;for(t=0,e=this.triCount();t<e;){var s,r,a;i=t++;null==this.idx?(s=++n-1,r=++n-1,a=++n-1):(s=this.idx[n++],r=this.idx[n++],a=this.idx[n++]);var A=this.points[s],h=this.points[r],o=this.points[a],l=this.uvs[s],u=this.uvs[r],_=this.uvs[a],c=this.normals[s],d=h.x-A.x,f=h.y-A.y,x=h.z-A.z;null==x&&(x=0),null==f&&(f=0),null==d&&(d=0);var p=d,g=f,m=x,v=o.x-A.x,y=o.y-A.y,b=o.z-A.z;null==b&&(b=0),null==y&&(y=0),null==v&&(v=0);var w=v,M=y,B=b,C=_.v-l.v;p*=C,g*=C,m*=C;var S=u.v-l.v,I=new _e(p-(w*=S),g-(M*=S),m-(B*=S)),k=c.y*I.z-c.z*I.y,E=c.z*I.x-c.x*I.z,F=c.x*I.y-c.y*I.x;null==F&&(F=0),null==E&&(E=0),null==k&&(k=0);var T=k,D=E,P=F;T*=R=(R=T*T+D*D+P*P)<1e-10?0:1/Math.sqrt(R),P*=R;var z=(I=new _e((D*=R)*c.z-P*c.y,P*c.x-T*c.z,T*c.y-D*c.x)).x*I.x+I.y*I.y+I.z*I.z;z=z<1e-10?0:1/Math.sqrt(z),I.x*=z,I.y*=z,I.z*=z,this.tangents[s].x+=I.x,this.tangents[s].y+=I.y,this.tangents[s].z+=I.z,this.tangents[r].x+=I.x,this.tangents[r].y+=I.y,this.tangents[r].z+=I.z,this.tangents[a].x+=I.x,this.tangents[a].y+=I.y,this.tangents[a].z+=I.z}for(t=0,e=this.tangents;t<e.length;){var R;I=e[t];++t,R=(R=I.x*I.x+I.y*I.y+I.z*I.z)<1e-10?0:1/Math.sqrt(R),I.x*=R,I.y*=R,I.z*=R}},addUVs:function(){this.uvs=[];for(var t=0,e=this.points.length;t<e;){var i=t++;this.uvs[i]=new Pi(this.points[i].x,this.points[i].y)}},uvScale:function(t,e){if(null==this.uvs)throw kn.thrown("Missing UVs");for(var i=new qn,n=0,s=this.uvs;n<s.length;){var r=s[n];++n,null==i.h.__keys__[r.__id__]&&(i.set(r,!0),r.u*=t,r.v*=e)}},triCount:function(){var t=ki.prototype.triCount.call(this);return 0!=t?t:(null==this.idx?this.points.length:this.idx.length)/3|0},vertexCount:function(){return this.points.length},getCollider:function(){for(var t=new Array(3*this.points.length),e=new Array(this.idx.length),i=0,n=0,s=this.points;n<s.length;){var r=s[n];++n,t[i++]=r.x,t[i++]=r.y,t[i++]=r.z}for(n=0,s=this.idx.length;n<s;){var a=n++;e[a]=this.idx[a]}var A=new de;return A.addBuffers(t,e),A},render:function(t){var e;if(null!=this.buffer){var i=this.buffer;e=null==i.buffer||null==i.buffer.vbuf}else e=!0;e&&this.alloc(t);var n=this.getBuffers(t);null!=this.indexes?t.renderMultiBuffers(n,this.indexes):0!=(this.buffer.flags&1<<zt.Quads._hx_index)?t.renderMultiBuffers(n,t.mem.quadIndexes,0,this.triCount()):t.renderMultiBuffers(n,t.mem.triIndexes,0,this.triCount())},__class__:Ti});var Di=function(t,e){null==e&&(e=!1),ft.call(this),this.onContextLost=function(){return t},this.bounds=t.bounds,this.alloc(null),e||(this.onContextLost=null)};i["h3d.prim.RawPrimitive"]=Di,Di.__name__="h3d.prim.RawPrimitive",Di.__super__=ft,Di.prototype=r(ft.prototype,{alloc:function(t){if(null==this.onContextLost)throw kn.thrown("Cannot realloc "+x.string(this));var e=this.onContextLost(),i=[];null==e.ibuf&&i.push(e.quads?zt.Quads:zt.Triangles),e.stride<8&&i.push(zt.RawFormat),this.buffer=Rt.ofFloats(e.vbuf,e.stride,i),this.vcount=this.buffer.vertices,this.tcount=null!=e.ibuf?e.ibuf.length/3|0:e.quads?this.vcount>>1:this.vcount/3|0,null!=e.ibuf?this.indexes=Ot.alloc(e.ibuf):null!=this.indexes&&(this.indexes.dispose(),this.indexes=null)},getBounds:function(){if(null==this.bounds)throw kn.thrown("Bounds not defined for "+x.string(this));return this.bounds},triCount:function(){return this.tcount},vertexCount:function(){return this.vcount},__class__:Di});var Pi=function(t,e){this.u=t,this.v=e};i["h3d.prim.UV"]=Pi,Pi.__name__="h3d.prim.UV",Pi.prototype={clone:function(){return new Pi(this.u,this.v)},toString:function(){return"{"+Es.fmt(this.u)+","+Es.fmt(this.v)+"}"},__class__:Pi};var zi=function(t,e,i,n,s,r,a){this.x=t,this.y=e,this.z=i,this.r=n,this.g=s,this.b=r,this.a=a};i["h3d.scene._Graphics.GPoint"]=zi,zi.__name__="h3d.scene._Graphics.GPoint",zi.prototype={__class__:zi};var Ri=function(t){this.flags=0,this.absPos=new Gt,this.absPos.identity(),this.x=0;var e=1;!0?this.flags|=e:this.flags&=~e,this.y=0;e=1;!0?this.flags|=e:this.flags&=~e,this.z=0;e=1;!0?this.flags|=e:this.flags&=~e,this.scaleX=1;e=1;!0?this.flags|=e:this.flags&=~e,this.scaleY=1;e=1;!0?this.flags|=e:this.flags&=~e,this.scaleZ=1;e=1;!0?this.flags|=e:this.flags&=~e,this.qRot=new Nt;e=1;null!=this.follow?this.flags|=e:this.flags&=~e;e=2;this.flags|=e,this.children=[],null!=t&&t.addChild(this)};i["h3d.scene.Object"]=Ri,Ri.__name__="h3d.scene.Object",Ri.__interfaces__=[dt],Ri.prototype={set_cullingCollider:function(t){this.cullingCollider=t;return this.flags&=-4097,t},get_visible:function(){return 0!=(2&this.flags)},get_allocated:function(){return 0!=(32&this.flags)},get_posChanged:function(){return 0!=(1&this.flags)},get_culled:function(){return 0!=(4&this.flags)},get_followPositionOnly:function(){return 0!=(8&this.flags)},get_lightCameraCenter:function(){return 0!=(16&this.flags)},get_alwaysSync:function(){return 0!=(64&this.flags)},get_inheritCulled:function(){return 0!=(128&this.flags)},get_ignoreBounds:function(){return 0!=(512&this.flags)},get_ignoreCollide:function(){return 0!=(1024&this.flags)},get_allowSerialize:function(){return 0==(256&this.flags)},get_ignoreParentTransform:function(){return 0!=(2048&this.flags)},get_cullingColliderInherited:function(){return 0!=(4096&this.flags)},set_posChanged:function(t){var e=t||null!=this.follow;return e?this.flags|=1:this.flags&=-2,e},set_culled:function(t){return t?this.flags|=4:this.flags&=-5,t},set_visible:function(t){return t?this.flags|=2:this.flags&=-3,t},set_allocated:function(t){return t?this.flags|=32:this.flags&=-33,t},set_followPositionOnly:function(t){return t?this.flags|=8:this.flags&=-9,t},set_lightCameraCenter:function(t){return t?this.flags|=16:this.flags&=-17,t},set_alwaysSync:function(t){return t?this.flags|=64:this.flags&=-65,t},set_ignoreBounds:function(t){return t?this.flags|=512:this.flags&=-513,t},set_inheritCulled:function(t){return t?this.flags|=128:this.flags&=-129,t},set_ignoreCollide:function(t){return t?this.flags|=1024:this.flags&=-1025,t},set_allowSerialize:function(t){var e=!t;return e?this.flags|=256:this.flags&=-257,!e},set_ignoreParentTransform:function(t){return t?this.flags|=2048:this.flags&=-2049,t},set_cullingColliderInherited:function(t){return t?this.flags|=4096:this.flags&=-4097,t},playAnimation:function(t){return this.currentAnimation=t.createInstance(this)},switchToAnimation:function(t){return this.currentAnimation=t},stopAnimation:function(t){if(null==t&&(t=!1),this.currentAnimation=null,t)for(var e=0,i=this.children;e<i.length;){var n=i[e];++e,n.stopAnimation(!0)}},applyAnimationTransform:function(t){if(null==t&&(t=!0),null!=this.defaultTransform){var e=this.defaultTransform;null==(n=null)&&(n=new Yt),n.x=Math.sqrt(e._11*e._11+e._12*e._12+e._13*e._13),n.y=Math.sqrt(e._21*e._21+e._22*e._22+e._23*e._23),n.z=Math.sqrt(e._31*e._31+e._32*e._32+e._33*e._33),e._11*(e._22*e._33-e._23*e._32)+e._12*(e._23*e._31-e._21*e._33)+e._13*(e._21*e._32-e._22*e._31)<0&&(n.x*=-1,n.y*=-1,n.z*=-1);var i=n,n=i.x;this.scaleX=n;var s=1;!0?this.flags|=s:this.flags&=~s;n=i.y;this.scaleY=n;s=1;!0?this.flags|=s:this.flags&=~s;n=i.z;this.scaleZ=n;s=1;!0?this.flags|=s:this.flags&=~s,this.qRot.initRotateMatrix(this.defaultTransform);n=this.defaultTransform._41;this.x=n;s=1;!0?this.flags|=s:this.flags&=~s;n=this.defaultTransform._42;this.y=n;s=1;!0?this.flags|=s:this.flags&=~s;n=this.defaultTransform._43;this.z=n;s=1;!0?this.flags|=s:this.flags&=~s;n=null;this.defaultTransform=n;s=1;!0?this.flags|=s:this.flags&=~s}if(t)for(var r=0,a=this.children;r<a.length;){var A=a[r];++r,A.applyAnimationTransform()}},getObjectsCount:function(){for(var t=0,e=0,i=this.children;e<i.length;){var n=i[e];++e,t+=n.getObjectsCount()+1}return t},getMaterialByName:function(t){for(var e=0,i=this.children;e<i.length;){var n=i[e];++e;var s=n.getMaterialByName(t);if(null!=s)return s}return null},contains:function(t){for(;null!=t;)if((t=t.parent)==this)return!0;return!1},find:function(t){if(null!=(n=t(this)))return n;for(var e=0,i=this.children;e<i.length;){var n,s=i[e];if(++e,null!=(n=s.find(t)))return n}return null},findAll:function(t,e){null==e&&(e=[]);var i=t(this);null!=i&&e.push(i);for(var n=0,s=this.children;n<s.length;){var r=s[n];++n,r.findAll(t,e)}return e},getMaterials:function(t,e){if(null==e&&(e=!0),null==t&&(t=[]),e)for(var i=0,n=this.children;i<n.length;){var s=n[i];++i,s.getMaterials(t)}return t},localToGlobal:function(t){this.syncPos(),null==t&&(t=new _e);var e=this.absPos,i=t.x*e._11+t.y*e._21+t.z*e._31+e._41,n=t.x*e._12+t.y*e._22+t.z*e._32+e._42,s=t.x*e._13+t.y*e._23+t.z*e._33+e._43;return t.x=i,t.y=n,t.z=s,t},globalToLocal:function(t){var e=this.getInvPos(),i=t.x*e._11+t.y*e._21+t.z*e._31+e._41,n=t.x*e._12+t.y*e._22+t.z*e._32+e._42,s=t.x*e._13+t.y*e._23+t.z*e._33+e._43;return t.x=i,t.y=n,t.z=s,t},getInvPos:function(){return this.syncPos(),null==this.invPos&&(this.invPos=new Gt,this.invPos._44=0),0==this.invPos._44&&this.invPos.inverse3x4(this.absPos),this.invPos},getBounds:function(t){return null==t&&(t=new se),null!=this.parent&&this.parent.syncPos(),this.getBoundsRec(t)},getBoundsRec:function(t){if(0!=(1&this.flags)){for(var e=0,i=this.children;e<i.length;){var n=i[e];++e;var s=1;!0?n.flags|=s:n.flags&=~s}s=1;null!=this.follow?this.flags|=s:this.flags&=~s,this.calcAbsPos()}for(e=0,i=this.children;e<i.length;){n=i[e];++e,n.getBoundsRec(t)}return t},getMeshes:function(t){null==t&&(t=[]);var e=this instanceof Li?this:null;null!=e&&t.push(e);for(var i=0,n=this.children;i<n.length;){var s=n[i];++i,s.getMeshes(t)}return t},getMeshByName:function(t){var e=this.getObjectByName(t);return e instanceof Li?e:null},getObjectByName:function(t){if(this.name==t)return this;for(var e=0,i=this.children;e<i.length;){var n=i[e];++e;var s=n.getObjectByName(t);if(null!=s)return s}return null},clone:function(t){if(null==t&&(t=new Ri),yA.getClass(t)!=yA.getClass(this))throw kn.thrown(x.string(this)+" is missing clone()");var e=this.x;t.x=e;var i=1;!0?t.flags|=i:t.flags&=~i;e=this.y;t.y=e;i=1;!0?t.flags|=i:t.flags&=~i;e=this.z;t.z=e;i=1;!0?t.flags|=i:t.flags&=~i;e=this.scaleX;t.scaleX=e;i=1;!0?t.flags|=i:t.flags&=~i;e=this.scaleY;t.scaleY=e;i=1;!0?t.flags|=i:t.flags&=~i;e=this.scaleZ;t.scaleZ=e;i=1;!0?t.flags|=i:t.flags&=~i;var n=t.qRot,s=this.qRot;n.x=s.x,n.y=s.y,n.z=s.z,n.w=s.w,t.name=this.name,t.set_follow(this.follow);i=8;0!=(8&this.flags)?t.flags|=i:t.flags&=~i;i=2;if(0!=(2&this.flags)?t.flags|=i:t.flags&=~i,null!=this.defaultTransform){e=this.defaultTransform.clone();t.defaultTransform=e;i=1;!0?t.flags|=i:t.flags&=~i}for(var r=0,a=this.children;r<a.length;){var A=a[r];++r;var h=A.clone();h.parent=t,t.children.push(h)}return t},addChild:function(t){this.addChildAt(t,this.children.length)},addChildAt:function(t,e){e<0&&(e=0),e>this.children.length&&(e=this.children.length);for(var i=this;null!=i;){if(i==t)throw kn.thrown("Recursive addChild");i=i.parent}if(null!=t.parent){var n=0!=(32&t.flags),s=32;t.flags&=~s,t.parent.removeChild(t);s=32;n?t.flags|=s:t.flags&=~s}this.children.splice(e,0,t),0==(32&this.flags)&&0!=(32&t.flags)&&t.onRemove(),t.parent=this;s=1;t.flags|=s,0!=(32&this.flags)&&(0==(32&t.flags)?t.onAdd():t.onParentChanged())},iterVisibleMeshes:function(t){if(0!=(2&this.flags)&&(0==(4&this.flags)||0==(128&this.flags))){if(0==(4&this.flags)){var e=this instanceof Li?this:null;null!=e&&t(e)}for(var i=0,n=this.children;i<n.length;){var s=n[i];++i,s.iterVisibleMeshes(t)}}},onParentChanged:function(){for(var t=0,e=this.children;t<e.length;){var i=e[t];++t,i.onParentChanged()}},onAdd:function(){this.flags|=32;for(var t=0,e=this.children;t<e.length;){var i=e[t];++t,i.onAdd()}},onRemove:function(){this.flags&=-33;for(var t=0,e=this.children;t<e.length;){var i=e[t];++t,i.onRemove()}},removeChild:function(t){if(l.remove(this.children,t)){0!=(32&t.flags)&&t.onRemove(),t.parent=null;t.flags|=1}},removeChildren:function(){for(;this.children.length>0;)this.removeChild(this.children[0])},remove:function(){null!=this.parent&&this.parent.removeChild(this)},getScene:function(){for(var t=this;null!=t.parent;)t=t.parent;return t instanceof Zi?t:null},getAbsPos:function(){return this.syncPos(),this.absPos},getRelPos:function(t){if(null==t)return this.getAbsPos();this.syncPos();var e=new Gt;return e.multiply(this.absPos,t.getInvPos()),e},isMesh:function(){return null!=(this instanceof Li?this:null)},toMesh:function(){var t=this instanceof Li?this:null;if(null!=t)return t;throw kn.thrown(x.string(this)+" is not a Mesh")},getCollider:function(){if(0!=(1024&this.flags))return null;var t=[],e=this.getGlobalCollider();null!=e&&t.push(e);for(var i=0,n=this.children;i<n.length;){var s=n[i];++i;var r=s.getCollider();if(null!=r){var a=r instanceof ae?r:null;if(null!=a)for(var A=0,h=a.colliders;A<h.length;){var o=h[A];++A,t.push(o)}else t.push(r)}}return 0==t.length?null:1==t.length?t[0]:new ae(t)},getGlobalCollider:function(){if(0!=(1024&this.flags))return null;var t=this.getLocalCollider();return null==t?null:new le(this,t)},getLocalCollider:function(){return null},draw:function(t){},set_follow:function(t){return this.flags|=1,this.follow=t},calcAbsPos:function(){if(this.qRot.toMatrix(this.absPos),this.absPos._11*=this.scaleX,this.absPos._12*=this.scaleX,this.absPos._13*=this.scaleX,this.absPos._21*=this.scaleY,this.absPos._22*=this.scaleY,this.absPos._23*=this.scaleY,this.absPos._31*=this.scaleZ,this.absPos._32*=this.scaleZ,this.absPos._33*=this.scaleZ,this.absPos._41=this.x,this.absPos._42=this.y,this.absPos._43=this.z,null!=this.follow)if(this.follow.syncPos(),0!=(8&this.flags)){var t=this.absPos,e=this.absPos,i=this.parent.absPos,n=e._11,s=e._12,r=e._13,a=e._21,A=e._22,h=e._23,o=e._31,l=e._32,u=e._33,_=e._41,c=e._42,d=e._43,f=i._11,x=i._12,p=i._13,g=i._21,m=i._22,v=i._23,y=i._31,b=i._32,w=i._33,M=i._41,B=i._42,C=i._43;t._11=n*f+s*g+r*y,t._12=n*x+s*m+r*b,t._13=n*p+s*v+r*w,t._14=0,t._21=a*f+A*g+h*y,t._22=a*x+A*m+h*b,t._23=a*p+A*v+h*w,t._24=0,t._31=o*f+l*g+u*y,t._32=o*x+l*m+u*b,t._33=o*p+l*v+u*w,t._34=0,t._41=_*f+c*g+d*y+M,t._42=_*x+c*m+d*b+B,t._43=_*p+c*v+d*w+C,t._44=1,this.absPos._41=this.x+this.follow.absPos._41,this.absPos._42=this.y+this.follow.absPos._42,this.absPos._43=this.z+this.follow.absPos._43}else this.absPos.multiply3x4(this.absPos,this.follow.absPos);else if(null!=this.parent&&0==(2048&this.flags)){t=this.absPos,e=this.absPos,i=this.parent.absPos,n=e._11,s=e._12,r=e._13,a=e._21,A=e._22,h=e._23,o=e._31,l=e._32,u=e._33,_=e._41,c=e._42,d=e._43,f=i._11,x=i._12,p=i._13,g=i._21,m=i._22,v=i._23,y=i._31,b=i._32,w=i._33,M=i._41,B=i._42,C=i._43;t._11=n*f+s*g+r*y,t._12=n*x+s*m+r*b,t._13=n*p+s*v+r*w,t._14=0,t._21=a*f+A*g+h*y,t._22=a*x+A*m+h*b,t._23=a*p+A*v+h*w,t._24=0,t._31=o*f+l*g+u*y,t._32=o*x+l*m+u*b,t._33=o*p+l*v+u*w,t._34=0,t._41=_*f+c*g+d*y+M,t._42=_*x+c*m+d*b+B,t._43=_*p+c*v+d*w+C,t._44=1}if(null!=this.defaultTransform){t=this.absPos,e=this.defaultTransform,i=this.absPos,n=e._11,s=e._12,r=e._13,a=e._21,A=e._22,h=e._23,o=e._31,l=e._32,u=e._33,_=e._41,c=e._42,d=e._43,f=i._11,x=i._12,p=i._13,g=i._21,m=i._22,v=i._23,y=i._31,b=i._32,w=i._33,M=i._41,B=i._42,C=i._43;t._11=n*f+s*g+r*y,t._12=n*x+s*m+r*b,t._13=n*p+s*v+r*w,t._14=0,t._21=a*f+A*g+h*y,t._22=a*x+A*m+h*b,t._23=a*p+A*v+h*w,t._24=0,t._31=o*f+l*g+u*y,t._32=o*x+l*m+u*b,t._33=o*p+l*v+u*w,t._34=0,t._41=_*f+c*g+d*y+M,t._42=_*x+c*m+d*b+B,t._43=_*p+c*v+d*w+C,t._44=1}null!=this.invPos&&(this.invPos._44=0)},sync:function(t){},syncRec:function(t){if(null!=this.currentAnimation){for(var e=this.parent,i=t.elapsedTime;i>0&&null!=this.currentAnimation;)i=this.currentAnimation.update(i);if(null!=this.currentAnimation&&(t.visibleFlag&&0!=(2&this.flags)&&0==(4&this.flags)||0!=(64&this.flags))&&this.currentAnimation.sync(),null==this.parent&&null!=e)return}e=t.visibleFlag;if((0==(2&this.flags)||0!=(4&this.flags)&&0!=(128&this.flags))&&(t.visibleFlag=!1),null==t.cullingCollider||null!=this.cullingCollider&&0==(4096&this.flags))0!=(4096&this.flags)&&this.set_cullingCollider(null);else{this.set_cullingCollider(t.cullingCollider);var n=4096;this.flags|=n}var s=t.cullingCollider;0!=(128&this.flags)&&(t.cullingCollider=this.cullingCollider);var r=0!=(1&this.flags);r&&this.calcAbsPos(),this.sync(t);n=1;null!=this.follow?this.flags|=n:this.flags&=~n,this.lastFrame=t.frame;for(var a=0,A=this.children.length;a<A;){var h=this.children[a];if(null==h)break;if(h.lastFrame!=t.frame){if(r){n=1;!0?h.flags|=n:h.flags&=~n}h.syncRec(t)}this.children[a]!=h?(a=0,A=this.children.length):++a}t.visibleFlag=e,t.cullingCollider=s},syncPos:function(){if(null!=this.parent&&this.parent.syncPos(),0!=(1&this.flags)){var t=1;null!=this.follow?this.flags|=t:this.flags&=~t,this.calcAbsPos();for(var e=0,i=this.children;e<i.length;){var n=i[e];++e;t=1;!0?n.flags|=t:n.flags&=~t}}},emit:function(t){},emitRec:function(t){if(0!=(2&this.flags)&&(0==(4&this.flags)||0==(128&this.flags)||t.computingStatic)){if(0!=(1&this.flags)){null!=this.currentAnimation&&this.currentAnimation.sync();var e=1;null!=this.follow?this.flags|=e:this.flags&=~e,this.calcAbsPos();for(var i=0,n=this.children;i<n.length;){var s=n[i];++i;e=1;!0?s.flags|=e:s.flags&=~e}}(0==(4&this.flags)||t.computingStatic)&&this.emit(t);for(i=0,n=this.children;i<n.length;){s=n[i];++i,s.emitRec(t)}}},set_x:function(t){this.x=t;return this.flags|=1,t},set_y:function(t){this.y=t;return this.flags|=1,t},set_z:function(t){this.z=t;return this.flags|=1,t},set_scaleX:function(t){this.scaleX=t;return this.flags|=1,t},set_scaleY:function(t){this.scaleY=t;return this.flags|=1,t},set_scaleZ:function(t){this.scaleZ=t;return this.flags|=1,t},set_defaultTransform:function(t){this.defaultTransform=t;return this.flags|=1,t},setPosition:function(t,e,i){this.x=t;var n=1;!0?this.flags|=n:this.flags&=~n,this.y=e;n=1;!0?this.flags|=n:this.flags&=~n,this.z=i;n=1;!0?this.flags|=n:this.flags&=~n;n=1;!0?this.flags|=n:this.flags&=~n},setTransform:function(t){null==(i=Ri.tmpVec)&&(i=new Yt),i.x=Math.sqrt(t._11*t._11+t._12*t._12+t._13*t._13),i.y=Math.sqrt(t._21*t._21+t._22*t._22+t._23*t._23),i.z=Math.sqrt(t._31*t._31+t._32*t._32+t._33*t._33),t._11*(t._22*t._33-t._23*t._32)+t._12*(t._23*t._31-t._21*t._33)+t._13*(t._21*t._32-t._22*t._31)<0&&(i.x*=-1,i.y*=-1,i.z*=-1);var e=i,i=t._41;this.x=i;var n=1;!0?this.flags|=n:this.flags&=~n;i=t._42;this.y=i;n=1;!0?this.flags|=n:this.flags&=~n;i=t._43;this.z=i;n=1;!0?this.flags|=n:this.flags&=~n;i=e.x;this.scaleX=i;n=1;!0?this.flags|=n:this.flags&=~n;i=e.y;this.scaleY=i;n=1;!0?this.flags|=n:this.flags&=~n;i=e.z;this.scaleZ=i;n=1;!0?this.flags|=n:this.flags&=~n,Ri.tmpMat.load(t),Ri.tmpMat.prependScale(1/e.x,1/e.y,1/e.z),this.qRot.initRotateMatrix(Ri.tmpMat);n=1;!0?this.flags|=n:this.flags&=~n},getTransform:function(t){return null==t&&(t=new Gt),t.initScale(this.scaleX,this.scaleY,this.scaleZ),this.qRot.toMatrix(Ri.tmpMat),t.multiply3x4(t,Ri.tmpMat),t._41=this.x,t._42=this.y,t._43=this.z,t},rotate:function(t,e,i){var n=new Nt;n.initRotation(t,e,i),this.qRot.multiply(n,this.qRot);this.flags|=1},setRotation:function(t,e,i){this.qRot.initRotation(t,e,i);this.flags|=1},setRotationAxis:function(t,e,i,n){this.qRot.initRotateAxis(t,e,i,n);this.flags|=1},setDirection:function(t){this.qRot.initDirection(t);this.flags|=1},getLocalDirection:function(){var t=this.qRot;return new Yt(1-2*(t.y*t.y+t.z*t.z),2*(t.x*t.y+t.z*t.w),2*(t.x*t.z-t.y*t.w))},getRotationQuat:function(){return this.qRot},setRotationQuat:function(t){this.qRot=t;this.flags|=1},scale:function(t){var e=this.scaleX*t;this.scaleX=e;var i=1;!0?this.flags|=i:this.flags&=~i;e=this.scaleY*t;this.scaleY=e;i=1;!0?this.flags|=i:this.flags&=~i;e=this.scaleZ*t;this.scaleZ=e;i=1;!0?this.flags|=i:this.flags&=~i;i=1;!0?this.flags|=i:this.flags&=~i},setScale:function(t){this.scaleX=t;var e=1;!0?this.flags|=e:this.flags&=~e,this.scaleY=t;e=1;!0?this.flags|=e:this.flags&=~e,this.scaleZ=t;e=1;!0?this.flags|=e:this.flags&=~e;e=1;!0?this.flags|=e:this.flags&=~e},toString:function(){return yA.getClass(this).__name__.split(".").pop()+(null==this.name?"":"("+this.name+")")},getChildAt:function(t){return this.children[t]},getChildIndex:function(t){for(var e=0,i=this.children.length;e<i;){var n=e++;if(this.children[n]==t)return n}return-1},get_numChildren:function(){return this.children.length},iterator:function(){return new $r(this.children)},__class__:Ri};var Li=function(t,e,i){Ri.call(this,i),this.set_primitive(t),null==e&&(e=Je.current.createMaterial()).set_props(e.getDefaultProps()),this.material=e};i["h3d.scene.Mesh"]=Li,Li.__name__="h3d.scene.Mesh",Li.__super__=Ri,Li.prototype=r(Ri.prototype,{getMeshMaterials:function(){return[this.material]},getBoundsRec:function(t){if(t=Ri.prototype.getBoundsRec.call(this,t),null==this.primitive||0!=(512&this.flags))return t;var e=this.primitive.getBounds(),i=new se;i.xMin=e.xMin,i.xMax=e.xMax,i.yMin=e.yMin,i.yMax=e.yMax,i.zMin=e.zMin,i.zMax=e.zMax;var n=i;return n.transform(this.absPos),n.xMin<t.xMin&&(t.xMin=n.xMin),n.xMax>t.xMax&&(t.xMax=n.xMax),n.yMin<t.yMin&&(t.yMin=n.yMin),n.yMax>t.yMax&&(t.yMax=n.yMax),n.zMin<t.zMin&&(t.zMin=n.zMin),n.zMax>t.zMax&&(t.zMax=n.zMax),t},clone:function(t){var e=null==t?new Li(null,this.material):t;return e.set_primitive(this.primitive),e.material=this.material.clone(),Ri.prototype.clone.call(this,e),e},getLocalCollider:function(){return this.primitive.getCollider()},draw:function(t){this.primitive.render(t.engine)},emit:function(t){for(var e=this.material.passes;null!=e;)t.emitPass(e,this).index=0,e=e.nextPass},getMaterialByName:function(t){return null!=this.material&&this.material.name==t?this.material:Ri.prototype.getMaterialByName.call(this,t)},getMaterials:function(t,e){return null==e&&(e=!0),null==t&&(t=[]),null!=this.material&&t.indexOf(this.material)<0&&t.push(this.material),Ri.prototype.getMaterials.call(this,t,e)},onAdd:function(){Ri.prototype.onAdd.call(this),null!=this.primitive&&this.primitive.incref()},onRemove:function(){null!=this.primitive&&this.primitive.decref(),Ri.prototype.onRemove.call(this)},set_primitive:function(t){return t!=this.primitive&&0!=(32&this.flags)&&(null!=this.primitive&&this.primitive.decref(),null!=t&&t.incref()),this.primitive=t},__class__:Li});var Vi=function(t){this.lineSize=0,this.curR=0,this.curZ=0,this.curY=0,this.curX=0,this.bprim=new Ii(12),this.bprim.isStatic=!1,Li.call(this,this.bprim,null,t),this.tmpPoints=[],this.lineShader=new dn,this.lineShader.setPriority(-100);var e=this.material;e.set_castShadows(!1),e.set_receiveShadows(!1),this.material.passes.set_enableLights(!1),this.material.passes.addShader(this.lineShader);var i=new Bn;i.setPriority(-100),this.material.passes.addShader(i),this.material.passes.set_culling(Re.None)};i["h3d.scene.Graphics"]=Vi,Vi.__name__="h3d.scene.Graphics",Vi.__super__=Li,Vi.prototype=r(Li.prototype,{onRemove:function(){Li.prototype.onRemove.call(this),this.bprim.clear()},set_is3D:function(t){return this.is3D==t?t:(t?this.material.passes.removeShader(this.lineShader):this.material.passes.addShader(this.lineShader),this.bprim.clear(),this.tmpPoints=[],this.is3D=t)},flushLine:function(){var t=this,e=this.tmpPoints,i=e.length-1,n=e[i],s=e[0],r=s.x==n.x&&s.y==n.y&&s.z==n.z,a=e.length;if(r)s!=n&&(--a,n=e[--i]);else{var A=e[i-1];null==A&&(A=s),e.push(new zi(2*n.x-A.x,2*n.y-A.y,2*n.z-A.z,0,0,0,0));var h=e[1];null==h&&(h=s),n=new zi(2*s.x-h.x,2*s.y-h.y,2*s.z-h.z,0,0,0,0)}for(var o=this.bprim.vertexCount(),l=o,u=0,_=0,c=a;_<c;){var d=_++,f=e[(d+1)%e.length],x=n.y-s.y,p=s.x-n.x,g=1/Math.sqrt(x*x+p*p),m=s.y-f.y,v=f.x-s.x,y=1/Math.sqrt(m*m+v*v),b=x*g+m*y,w=p*g+v*y,M=1/Math.sqrt(b*b+w*w),B=(b*=M)*x*g+(w*=M)*p*g,C=.5*this.lineSize/B;b*=C,w*=C;var S=d<a-1||r;this.bprim.begin(2,S?6:0);var I=t.bprim;I.tmpBuf.array[I.bufPos++]=s.x+b;var k=t.bprim;k.tmpBuf.array[k.bufPos++]=s.y+w;var E=t.bprim;E.tmpBuf.array[E.bufPos++]=s.z;var F=t.bprim;F.tmpBuf.array[F.bufPos++]=0;var T=t.bprim;T.tmpBuf.array[T.bufPos++]=0;var D=t.bprim;D.tmpBuf.array[D.bufPos++]=1;var P=t.bprim;P.tmpBuf.array[P.bufPos++]=0;var z=t.bprim;z.tmpBuf.array[z.bufPos++]=u;var R=t.bprim;R.tmpBuf.array[R.bufPos++]=s.r;var L=t.bprim;L.tmpBuf.array[L.bufPos++]=s.g;var V=t.bprim;V.tmpBuf.array[V.bufPos++]=s.b;var Q=t.bprim;Q.tmpBuf.array[Q.bufPos++]=s.a;var U=t.bprim;U.tmpBuf.array[U.bufPos++]=s.x-b;var O=t.bprim;O.tmpBuf.array[O.bufPos++]=s.y-w;var G=t.bprim;G.tmpBuf.array[G.bufPos++]=s.z;var N=t.bprim;N.tmpBuf.array[N.bufPos++]=0;var Y=t.bprim;Y.tmpBuf.array[Y.bufPos++]=0;var X=t.bprim;X.tmpBuf.array[X.bufPos++]=1;var j=t.bprim;j.tmpBuf.array[j.bufPos++]=1;var H=t.bprim;H.tmpBuf.array[H.bufPos++]=u;var W=t.bprim;W.tmpBuf.array[W.bufPos++]=s.r;var Z=t.bprim;Z.tmpBuf.array[Z.bufPos++]=s.g;var J=t.bprim;J.tmpBuf.array[J.bufPos++]=s.b;var q=t.bprim;if(q.tmpBuf.array[q.bufPos++]=s.a,u=1-u,S){var K=d==i?o-l:2,$=this.bprim;$.tmpIdx[$.idxPos++]=$.startIndex;var tt=this.bprim;tt.tmpIdx[tt.idxPos++]=1+tt.startIndex;var et=this.bprim;et.tmpIdx[et.idxPos++]=K+et.startIndex;var it=this.bprim;it.tmpIdx[it.idxPos++]=K+it.startIndex;var nt=this.bprim;nt.tmpIdx[nt.idxPos++]=1+nt.startIndex;var st=this.bprim;st.tmpIdx[st.idxPos++]=K+1+st.startIndex}l+=2,n=s,s=f}},flush:function(){0!=this.tmpPoints.length&&this.is3D&&(this.flushLine(),this.tmpPoints=[])},sync:function(t){Li.prototype.sync.call(this,t),this.flush(),this.bprim.flush()},draw:function(t){this.flush(),this.bprim.flush(),Li.prototype.draw.call(this,t)},clear:function(){this.flush(),this.bprim.clear()},lineStyle:function(t,e,i){null==i&&(i=1),null==e&&(e=0),null==t&&(t=0),this.flush(),t>0&&this.lineSize!=t&&(this.lineSize=t,this.is3D||(this.lineShader.width__=this.lineSize)),this.setColor(e,i)},setColor:function(t,e){null==e&&(e=1),this.curA=e,this.curR=(t>>16&255)/255,this.curG=(t>>8&255)/255,this.curB=(255&t)/255},drawLine:function(t,e){this.moveTo(t.x,t.y,t.z),this.lineTo(e.x,e.y,e.z)},moveTo:function(t,e,i){this.is3D?(this.flush(),this.lineTo(t,e,i)):(this.curX=t,this.curY=e,this.curZ=i)},addVertex:function(t,e,i,n,s,r,a){this.tmpPoints.push(new zi(t,e,i,n,s,r,a))},lineTo:function(t,e,i){var n=this;if(this.is3D)this.tmpPoints.push(new zi(t,e,i,this.curR,this.curG,this.curB,this.curA));else{this.bprim.begin(4,6);var s,r=t-this.curX,a=e-this.curY,A=i-this.curZ,h=this.curX,o=this.curY,l=this.curZ;h<(s=this.bprim.bounds).xMin&&(s.xMin=h),h>s.xMax&&(s.xMax=h),o<s.yMin&&(s.yMin=o),o>s.yMax&&(s.yMax=o),l<s.zMin&&(s.zMin=l),l>s.zMax&&(s.zMax=l),t<(s=this.bprim.bounds).xMin&&(s.xMin=t),t>s.xMax&&(s.xMax=t),e<s.yMin&&(s.yMin=e),e>s.yMax&&(s.yMax=e),i<s.zMin&&(s.zMin=i),i>s.zMax&&(s.zMax=i),(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curX,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curY,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curZ,(s=n.bprim).tmpBuf.array[s.bufPos++]=r,(s=n.bprim).tmpBuf.array[s.bufPos++]=a,(s=n.bprim).tmpBuf.array[s.bufPos++]=A,(s=n.bprim).tmpBuf.array[s.bufPos++]=0,(s=n.bprim).tmpBuf.array[s.bufPos++]=0,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curR,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curG,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curB,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curA,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curX,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curY,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curZ,(s=n.bprim).tmpBuf.array[s.bufPos++]=r,(s=n.bprim).tmpBuf.array[s.bufPos++]=a,(s=n.bprim).tmpBuf.array[s.bufPos++]=A,(s=n.bprim).tmpBuf.array[s.bufPos++]=0,(s=n.bprim).tmpBuf.array[s.bufPos++]=1,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curR,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curG,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curB,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curA,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curX,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curY,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curZ,(s=n.bprim).tmpBuf.array[s.bufPos++]=r,(s=n.bprim).tmpBuf.array[s.bufPos++]=a,(s=n.bprim).tmpBuf.array[s.bufPos++]=A,(s=n.bprim).tmpBuf.array[s.bufPos++]=1,(s=n.bprim).tmpBuf.array[s.bufPos++]=0,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curR,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curG,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curB,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curA,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curX,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curY,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curZ,(s=n.bprim).tmpBuf.array[s.bufPos++]=r,(s=n.bprim).tmpBuf.array[s.bufPos++]=a,(s=n.bprim).tmpBuf.array[s.bufPos++]=A,(s=n.bprim).tmpBuf.array[s.bufPos++]=1,(s=n.bprim).tmpBuf.array[s.bufPos++]=1,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curR,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curG,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curB,(s=n.bprim).tmpBuf.array[s.bufPos++]=n.curA,(s=this.bprim).tmpIdx[s.idxPos++]=s.startIndex,(s=this.bprim).tmpIdx[s.idxPos++]=1+s.startIndex,(s=this.bprim).tmpIdx[s.idxPos++]=2+s.startIndex,(s=this.bprim).tmpIdx[s.idxPos++]=2+s.startIndex,(s=this.bprim).tmpIdx[s.idxPos++]=3+s.startIndex,(s=this.bprim).tmpIdx[s.idxPos++]=1+s.startIndex,this.curX=t,this.curY=e,this.curZ=i}},__class__:Vi});var Qi=function(t,e){this.hitPoint=new Yt,this.mouseDownButton=-1,this.propagateEvents=!1,this.cancelEvents=!1,Ri.call(this,e),this.shape=t,this.set_cursor(bs.Button)};i["h3d.scene.Interactive"]=Qi,Qi.__name__="h3d.scene.Interactive",Qi.__interfaces__=[nt],Qi.__super__=Ri,Qi.prototype=r(Ri.prototype,{onAdd:function(){this.scene=this.getScene(),null!=this.scene&&this.scene.addEventTarget(this),Ri.prototype.onAdd.call(this)},onRemove:function(){null!=this.scene&&(this.scene.removeEventTarget(this),this.scene=null),Ri.prototype.onRemove.call(this)},preventClick:function(){this.mouseDownButton=-1},getInteractiveScene:function(){return this.scene},handleEvent:function(t){switch(this.propagateEvents&&(t.propagate=!0),this.cancelEvents&&(t.cancel=!0),t.kind._hx_index){case 0:(this.enableRightButton||0==t.button)&&(this.mouseDownButton=t.button,this.onPush(t),t.cancel&&(this.mouseDownButton=-1));break;case 1:(this.enableRightButton||0==t.button)&&(this.onRelease(t),this.mouseDownButton==t.button&&this.onClick(t)),this.mouseDownButton=-1;break;case 2:this.onMove(t);break;case 3:this.onOver(t);break;case 4:this.onOut(t);break;case 5:this.onWheel(t);break;case 6:this.onFocus(t);break;case 7:this.onFocusLost(t);break;case 8:this.onKeyDown(t);break;case 9:this.onKeyUp(t);break;case 10:(this.enableRightButton||0==t.button)&&(this.onRelease(t),this.mouseDownButton==t.button&&this.onReleaseOutside(t)),this.mouseDownButton=-1;break;case 11:this.onTextInput(t);break;case 12:this.onCheck(t)}},set_cursor:function(t){return this.cursor=t,null!=this.scene&&null!=this.scene.events&&this.scene.events.updateCursor(this),t},focus:function(){null!=this.scene&&null!=this.scene.events&&this.scene.events.focus(this)},blur:function(){this.hasFocus()&&this.scene.events.blur()},isOver:function(){return null!=this.scene&&null!=this.scene.events&&-1!=this.scene.events.overList.indexOf(this)},hasFocus:function(){return null!=this.scene&&null!=this.scene.events&&this.scene.events.currentFocus==this},onOver:function(t){},onOut:function(t){},onPush:function(t){},onRelease:function(t){},onReleaseOutside:function(t){},onClick:function(t){},onMove:function(t){},onWheel:function(t){},onFocus:function(t){},onFocusLost:function(t){},onKeyUp:function(t){},onKeyDown:function(t){},onCheck:function(t){},onTextInput:function(t){},__class__:Qi});var Ui=function(t,e){this.priority=0,this.cullingDistance=-1,Ri.call(this,e),this.shader=t};i["h3d.scene.Light"]=Ui,Ui.__name__="h3d.scene.Light",Ui.__super__=Ri,Ui.prototype=r(Ri.prototype,{get_color:function(){return new Yt},set_color:function(t){return t},get_enableSpecular:function(){return!1},set_enableSpecular:function(t){if(t)throw kn.thrown("Not implemented for this light");return!1},emit:function(t){t.emitLight(this)},getShadowDirection:function(){return null},__class__:Ui});var Oi=function(){this.drawPasses=0,this.ambientLight=new Yt(1,1,1)};i["h3d.scene.LightSystem"]=Oi,Oi.__name__="h3d.scene.LightSystem",Oi.prototype={initGlobals:function(t){},cullLights:function(){for(var t=this.ctx.lights,e=null,i=new pe;null!=t;)i.x=t.absPos._41,i.y=t.absPos._42,i.z=t.absPos._43,i.r=t.cullingDistance,t.cullingDistance>0&&!this.ctx.computingStatic&&!this.ctx.camera.frustum.hasSphere(i)?(null==e?this.ctx.lights=t.next:e.next=t.next,t=t.next):(this.lightCount++,t.objectDistance=0,e=t,t=t.next)},initLights:function(t){if(this.lightCount=0,this.ctx=t,this.cullLights(),null==this.shadowLight||0==(32&this.shadowLight.flags))for(var e=t.lights;null!=e;){if(null!=e.getShadowDirection()){this.shadowLight=e;break}e=e.next}},computeLight:function(t,e){return e},__class__:Oi};var Gi=function(t,e,i){Li.call(this,t,null==e?null:e[0],i),this.materials=null==e?[this.material]:e};i["h3d.scene.MultiMaterial"]=Gi,Gi.__name__="h3d.scene.MultiMaterial",Gi.__super__=Li,Gi.prototype=r(Li.prototype,{getMeshMaterials:function(){return this.materials.slice()},clone:function(t){var e=null==t?new Gi(null,this.materials):t;e.materials=[];for(var i=0,n=this.materials;i<n.length;){var s=n[i];++i,e.materials.push(null==s?null:s.clone())}return Li.prototype.clone.call(this,e),e.material=e.materials[0],e},emit:function(t){for(var e=0,i=this.materials.length;e<i;){var n=e++,s=this.materials[n];if(null!=s){var r=n;null==r&&(r=0);for(var a=s.passes;null!=a;)t.emitPass(a,this).index=r,a=a.nextPass}}},getMaterialByName:function(t){for(var e=0,i=this.materials;e<i.length;){var n=i[e];if(++e,null!=n&&n.name==t)return n}return Li.prototype.getMaterialByName.call(this,t)},getMaterials:function(t,e){null==e&&(e=!0),null==t&&(t=[]);for(var i=0,n=this.materials;i<n.length;){var s=n[i];++i,null!=s&&t.indexOf(s)<0&&t.push(s)}if(e)for(i=0,n=this.children;i<n.length;){var r=n[i];++i,r.getMaterials(t)}return t},draw:function(t){this.materials.length>1&&this.primitive.selectMaterial(t.drawPass.index),Li.prototype.draw.call(this,t)},__class__:Gi});var Ni={_new:function(t){return t},toInt:function(t){return t},has:function(t,e){return 0!=(t&e)},set:function(t,e,i){return i?e:~e,i}},Yi=function(t,e){this.gid=t,this.value=e};i["h3d.scene._RenderContext.SharedGlobal"]=Yi,Yi.__name__="h3d.scene._RenderContext.SharedGlobal",Yi.prototype={__class__:Yi};var Xi=function(){At.call(this),this.cachedShaderList=[],this.cachedPassObjects=[]};i["h3d.scene.RenderContext"]=Xi,Xi.__name__="h3d.scene.RenderContext",Xi.__super__=At,Xi.prototype=r(At.prototype,{emit:function(t,e,i){null==i&&(i=0);for(var n=t.passes;null!=n;)this.emitPass(n,e).index=i,n=n.nextPass},start:function(){this.sharedGlobals=[],this.lights=null,this.drawPass=null,this.passes=null,this.lights=null,this.cachedPos=0,this.visibleFlag=!0,this.time+=this.elapsedTime,this.frame++},nextPass:function(){this.cachedPos=0,this.drawPass=null},getGlobal:function(t){for(var e=vA.allocID(t),i=0,n=this.sharedGlobals;i<n.length;){var s=n[i];if(++i,s.gid==e)return s.value}return null},setGlobal:function(t,e){this.setGlobalID(vA.allocID(t),e)},setGlobalID:function(t,e){for(var i=0,n=this.sharedGlobals;i<n.length;){var s=n[i];if(++i,s.gid==t)return void(s.value=e)}this.sharedGlobals.push(new Yi(t,e))},emitPass:function(t,e){var i=this.allocPool;return null==i?((i=new wi).nextAlloc=this.allocFirst,this.allocFirst=i):this.allocPool=i.nextAlloc,i.pass=t,i.obj=e,i.next=this.passes,this.passes=i,i},allocShaderList:function(t,e){var i=this.cachedShaderList[this.cachedPos++];return null==i&&(i=new PA(null),this.cachedShaderList[this.cachedPos-1]=i),i.s=t,i.next=e,i},emitLight:function(t){t.next=this.lights,this.lights=t},uploadParams:function(){this.currentManager.fillParams(this.shaderBuffers,this.drawPass.shader,this.drawPass.shaders),this.engine.uploadShaderBuffers(this.shaderBuffers,1),this.engine.uploadShaderBuffers(this.shaderBuffers,2),this.engine.uploadShaderBuffers(this.shaderBuffers,3)},done:function(){this.drawPass=null;for(var t=this.allocFirst;null!=t&&t!=this.allocPool;)t.obj=null,t.pass=null,t.shader=null,t.shaders=null,t.next=null,t.index=0,t.texture=0,t=t.nextAlloc;null!=this.allocPool&&(this.allocFirst=this.allocFirst.nextAlloc),this.allocPool=this.allocFirst;for(var e=0,i=this.cachedShaderList;e<i.length;){var n=i[e];++e,n.s=null,n.next=null}this.passes=null,this.lights=null},__class__:Xi});var ji=function(){this.passes=new bi};i["h3d.scene.PassObjects"]=ji,ji.__name__="h3d.scene.PassObjects",ji.prototype={__class__:ji};var Hi=s["h3d.scene.RenderMode"]={__ename__:!0,__constructs__:null,Default:{_hx_name:"Default",_hx_index:0,__enum__:"h3d.scene.RenderMode",toString:n},LightProbe:{_hx_name:"LightProbe",_hx_index:1,__enum__:"h3d.scene.RenderMode",toString:n}};Hi.__constructs__=[Hi.Default,Hi.LightProbe],Hi.__empty_constructs__=[Hi.Default,Hi.LightProbe];var Wi=function(){this.renderMode=Hi.Default,this.effects=[],this.hasSetTarget=!1,this.emptyPasses=new bi,this.allPasses=[],this.passObjects=new Kn,this.set_props(this.getDefaultProps());var t=XA(this,this.depthSort);this.frontToBack=function(e){t(true,e)};var e=XA(this,this.depthSort);this.backToFront=function(t){e(false,t)}};i["h3d.scene.Renderer"]=Wi,Wi.__name__="h3d.scene.Renderer",Wi.__super__=Pe,Wi.prototype=r(Pe.prototype,{getEffect:function(t){for(var e=0,i=this.effects;e<i.length;){var n=i[e];++e;var s=yA.__downcastCheck(n,t)?n:null;if(null!=s)return s}return null},dispose:function(){for(var t=0,e=this.allPasses;t<e.length;){var i=e[t];++t,i.dispose()}for(t=0,e=this.effects;t<e.length;){var n=e[t];++t,n.dispose()}this.passObjects=new Kn},mark:function(t){},addShader:function(t){},getPass:function(t){for(var e=0,i=this.allPasses;e<i.length;){var n=i[e];if(++e,yA.__instanceof(n,t))return n}return null},getPassByName:function(t){for(var e=0,i=this.allPasses;e<i.length;){var n=i[e];if(++e,n.name==t)return n}return null},debugCompileShader:function(t){var e=this.getPassByName(t.name);return null==e&&(e=this.defaultPass),e.setContext(this.ctx),e.compileShader(t)},hasFeature:function(t){return Ut.CURRENT.driver.hasFeature(t)},getDefaultLight:function(t){return t},getLightSystem:function(){return this.ctx.scene.lightSystem},depthSort:function(t,e){for(var i=this.ctx.camera.m,n=e.current;null!=n;){var s=n;n=n.next;var r=(d=s).obj.absPos._41*i._13+d.obj.absPos._42*i._23+d.obj.absPos._43*i._33+i._43,a=d.obj.absPos._41*i._14+d.obj.absPos._42*i._24+d.obj.absPos._43*i._34+i._44;d.depth=r/a}if(t){if(null==(_=e.current))s=null;else{for(var A=1,h=0,o=0;;){for(d=_,_=null,p=null,c=0;null!=d;){++c,f=d,h=0;for(var l=0,u=A;l<u;){l++;if(++h,null==(f=f.next))break}for(o=A;h>0||o>0&&null!=f;)0==h?(x=f,f=f.next,--o):0==o||null==f||(d.pass.layer==f.pass.layer?d.depth>f.depth?1:-1:d.pass.layer-f.pass.layer)<=0?(x=d,d=d.next,--h):(x=f,f=f.next,--o),null!=p?p.next=x:_=x,p=x;d=f}if(p.next=null,c<=1)break;A*=2}s=_}e.current=s}else{var _;if(null==(_=e.current))s=null;else{var c,d,f,x,p;for(A=1,h=0,o=0;;){for(d=_,_=null,p=null,c=0;null!=d;){++c,f=d,h=0;for(l=0,u=A;l<u;){l++;if(++h,null==(f=f.next))break}for(o=A;h>0||o>0&&null!=f;)0==h?(x=f,f=f.next,--o):0==o||null==f||(d.pass.layer==f.pass.layer?d.depth>f.depth?-1:1:d.pass.layer-f.pass.layer)<=0?(x=d,d=d.next,--h):(x=f,f=f.next,--o),null!=p?p.next=x:_=x,p=x;d=f}if(p.next=null,c<=1)break;A*=2}s=_}e.current=s}},clear:function(t,e,i){this.ctx.engine.clear(t,e,i)},allocTarget:function(t,e,i,n){return null==i&&(i=1),null==e&&(e=!0),this.ctx.textures.allocTarget(t,Math.round(this.ctx.engine.width*i),Math.round(this.ctx.engine.height*i),e,n)},copy:function(t,e,i){_i.run(t,e,i)},setTarget:function(t){this.hasSetTarget&&this.ctx.engine.popTarget(),this.ctx.engine.pushTarget(t),this.hasSetTarget=!0},setTargets:function(t){this.hasSetTarget&&this.ctx.engine.popTarget(),this.ctx.engine.pushTargets(t),this.hasSetTarget=!0},resetTarget:function(){this.hasSetTarget&&(this.ctx.engine.popTarget(),this.hasSetTarget=!1)},has:function(t){return null!=this.passObjects.h[t]},get:function(t){var e=this.passObjects.h[t];return null==e?this.emptyPasses:(e.rendered=!0,e.passes)},draw:function(t){this.defaultPass.draw(this.get(t))},render:function(){throw kn.thrown("Not implemented")},computeStatic:function(){throw kn.thrown("Not implemented")},start:function(){},process:function(t){this.hasSetTarget=!1;for(var e=0,i=this.allPasses;e<i.length;){var n=i[e];++e,n.setContext(this.ctx)}for(e=0;e<t.length;){n=t[e];++e,this.passObjects.h[n.name]=n}this.ctx.textures.begin(),this.ctx.computingStatic?this.computeStatic():this.render(),this.resetTarget();for(e=0;e<t.length;){n=t[e];++e,this.passObjects.h[n.name]=null}},__class__:Wi});var Zi=function(t,e){null==e&&(e=!0),null==t&&(t=!0),this.checkPasses=!0,Ri.call(this,null),this.window=Us.getInstance(),this.eventListeners=[],this.hitInteractives=[],this.interactives=[],this.camera=new Vt;var i=Ut.CURRENT;null!=i&&(this.camera.screenRatio=i.width/i.height),this.ctx=new Xi,t&&this.set_renderer(Je.current.createRenderer()),e&&(this.lightSystem=Je.current.createLightSystem())};i["h3d.scene.Scene"]=Zi,Zi.__name__="h3d.scene.Scene",Zi.__interfaces__=[ut,_],Zi.__super__=Ri,Zi.prototype=r(Ri.prototype,{setEvents:function(t){this.events=t},addEventListener:function(t){this.eventListeners.push(t)},removeEventListener:function(t){for(var e=0,i=this.eventListeners;e<i.length;){var n=i[e];if(++e,f.compareMethods(n,t))return l.remove(this.eventListeners,n),!0}return!1},dispatchListeners:function(t){for(var e=0,i=this.eventListeners;e<i.length;){var n=i[e];if(++e,n(t),!t.propagate)break}},set_renderer:function(t){return this.renderer=t,null!=t&&(t.ctx=this.ctx),t},sortHitPointByCameraDistance:function(t,e){return t.hitPoint.w>e.hitPoint.w?-1:1},dispatchEvent:function(t,e){e.handleEvent(t)},isInteractiveVisible:function(t){for(var e=t;e!=this;){if(null==e||0==(2&e.flags))return!1;e=e.parent}return!0},handleEvent:function(t,e){if(0==this.interactives.length)return null;if(0==this.hitInteractives.length){var i=2*(t.relX/this.window.get_width()-.5),n=2*-(t.relY/this.window.get_height()-.5),s=this.camera.unproject(i,n,0),r=this.camera.unproject(i,n,1),a=s.x,A=s.y;null==(W=s.z)&&(W=0),null==A&&(A=0),null==a&&(a=0);var h=a,o=A,l=W;a=r.x,A=r.y;null==(W=r.z)&&(W=0),null==A&&(A=0),null==a&&(a=0);var u=a,_=A,c=W,d=new oe;d.px=h,d.py=o,d.pz=l,d.lx=u-h,d.ly=_-o,d.lz=c-l,d.normalize();for(var f=d,x=f.px,p=f.py,g=f.pz,m=f.lx,v=f.ly,y=f.lz,b=-2147483648,w=0,M=this.interactives;w<M.length;){var B=M[w];if(++w,!(B.priority<b)){for(var C=B;null!=C&&0!=(2&C.flags);)C=C.parent;if(null==C){var S=B.getInvPos();a=f.px,A=f.py;null==(W=f.pz)&&(W=0),null==A&&(A=0),null==a&&(a=0);var I=A,k=W,E=1,F=(Z=a)*S._11+I*S._21+k*S._31+E*S._41,T=Z*S._12+I*S._22+k*S._32+E*S._42,D=Z*S._13+I*S._23+k*S._33+E*S._43;Z=F,I=T,k=D,f.px=Z,f.py=I,f.pz=k;var P=f.lx,z=f.ly;null==(J=f.lz)&&(J=0),null==z&&(z=0),null==P&&(P=0);var R=z,L=J,V=(q=P)*S._11+R*S._21+L*S._31,Q=q*S._12+R*S._22+L*S._32,U=q*S._13+R*S._23+L*S._33;if(q=V,R=Q,L=U,f.lx=q,f.ly=R,f.lz=L,f.normalize(),f.lx==f.lx)if((K=B.shape.rayIntersection(f,B.bestMatch))<0)f.px=x,f.py=p,f.pz=g,f.lx=m,f.ly=v,f.lz=y;else{var O=f.px+K*f.lx,G=f.py+K*f.ly;null==($=f.pz+K*f.lz)&&($=0),null==G&&(G=0),null==O&&(O=0);var N=O,Y=G,X=$;if(f.px=x,f.py=p,f.pz=g,f.lx=m,f.ly=v,f.lz=y,B.hitPoint.x=N,B.hitPoint.y=Y,B.hitPoint.z=X,B.priority>b){for(;this.hitInteractives.length>0;)this.hitInteractives.pop();b=B.priority}this.hitInteractives.push(B)}else f.px=x,f.py=p,f.pz=g,f.lx=m,f.ly=v,f.lz=y}}}if(0==this.hitInteractives.length)return null;if(this.hitInteractives.length>1){for(w=0,M=this.hitInteractives;w<M.length;){B=M[w];++w;var j=B.invPos,H=0;if(null!=B.preciseShape){var W;a=f.px,A=f.py;null==(W=f.pz)&&(W=0),null==A&&(A=0),null==a&&(a=0);var Z;I=A,k=W,E=1,F=(Z=a)*j._11+I*j._21+k*j._31+E*j._41,T=Z*j._12+I*j._22+k*j._32+E*j._42,D=Z*j._13+I*j._23+k*j._33+E*j._43;Z=F,I=T,k=D,f.px=Z,f.py=I,f.pz=k;var J;P=f.lx,z=f.ly;null==(J=f.lz)&&(J=0),null==z&&(z=0),null==P&&(P=0);var q,K;R=z,L=J,V=(q=P)*j._11+R*j._21+L*j._31,Q=q*j._12+R*j._22+L*j._32,U=q*j._13+R*j._23+L*j._33;if(q=V,R=Q,L=U,f.lx=q,f.ly=R,f.lz=L,f.normalize(),(K=B.preciseShape.rayIntersection(f,B.bestMatch))>0){var $;O=f.px+K*f.lx,G=f.py+K*f.ly;null==($=f.pz+K*f.lz)&&($=0),null==G&&(G=0),null==O&&(O=0);N=O,Y=G,X=$;B.hitPoint.x=N,B.hitPoint.y=Y,B.hitPoint.z=X}else H=1;f.px=x,f.py=p,f.pz=g,f.lx=m,f.ly=v,f.lz=y}var tt=B.hitPoint,et=tt.x,it=tt.y,nt=tt.z,st=tt.w;null==st&&(st=1),null==nt&&(nt=0),null==it&&(it=0),null==et&&(et=0);var rt=et,at=it,At=nt,ht=st;ht=1;var ot=B.absPos,lt=rt*ot._11+at*ot._21+At*ot._31+ht*ot._41,ut=rt*ot._12+at*ot._22+At*ot._32+ht*ot._42,_t=rt*ot._13+at*ot._23+At*ot._33+ht*ot._43;rt=lt,at=ut,At=_t;var ct=this.camera.m,dt=rt*ct._11+at*ct._21+At*ct._31+ht*ct._41,ft=rt*ct._12+at*ct._22+At*ct._32+ht*ct._42,xt=rt*ct._13+at*ct._23+At*ct._33+ht*ct._43,pt=1/(rt*ct._14+at*ct._24+At*ct._34+ht*ct._44);rt=dt*pt,at=ft*pt,At=xt*pt,ht=1,B.hitPoint.w=At+H}this.hitInteractives.sort(XA(this,this.sortHitPointByCameraDistance))}this.hitInteractives.unshift(null)}for(;this.hitInteractives.length>0;){if(null==(B=this.hitInteractives.pop()))return null;if(t.relX=B.hitPoint.x,t.relY=B.hitPoint.y,t.relZ=B.hitPoint.z,B.handleEvent(t),!t.cancel){if(!t.propagate)for(;this.hitInteractives.length>0;)this.hitInteractives.pop();return B}t.cancel=!1,t.propagate=!1}return null},clone:function(t){var e=null==t?new Zi:t;return e.camera=this.camera.clone(),Ri.prototype.clone.call(this,e),e},dispose:function(){0!=(32&this.flags)&&this.onRemove(),null!=this.hardwarePass&&(this.hardwarePass.dispose(),this.hardwarePass=null),this.ctx.dispose(),null!=this.renderer&&(this.renderer.dispose(),this.set_renderer(new Wi))},addEventTarget:function(t){if(this.interactives.indexOf(t)>=0)throw kn.thrown("assert");this.interactives.push(t)},removeEventTarget:function(t){l.remove(this.interactives,t)&&(null!=this.events&&this.events.onRemove(t),l.remove(this.hitInteractives,t))},setElapsedTime:function(t){this.ctx.elapsedTime=t},hardwarePick:function(t,e){var i=this,n=Ut.CURRENT;this.camera.screenRatio=n.width/n.height,this.camera.update(),this.ctx.camera=this.camera,this.ctx.engine=n,this.ctx.scene=this,this.ctx.start();var s,r,a,A,h,o,l=this.camera.rayFromScreen(t,e);a=l.px,r=l.py,s=l.pz,o=l.lx,h=l.ly,A=l.lz,this.iterVisibleMeshes((function(t){if(null!=t.primitive){var e=t.getInvPos(),n=l.px,u=l.py;null==(g=l.pz)&&(g=0),null==u&&(u=0),null==n&&(n=0);var _=n,c=u,d=g,f=_*e._11+c*e._21+d*e._31+1*e._41,x=_*e._12+c*e._22+d*e._32+1*e._42,p=_*e._13+c*e._23+d*e._33+1*e._43;_=f,c=x,d=p,l.px=_,l.py=c,l.pz=d;var g;n=l.lx,u=l.ly;null==(g=l.lz)&&(g=0),null==u&&(u=0),null==n&&(n=0);var m=n,v=u,y=g;f=m*e._11+v*e._21+y*e._31,x=m*e._12+v*e._22+y*e._32,p=m*e._13+v*e._23+y*e._33;m=f,v=x,y=p,l.lx=m,l.ly=v,l.lz=y,l.normalize(),t.primitive.getBounds().rayIntersection(l,!1)>=0&&i.ctx.emitPass(t.material.passes,t),l.px=a,l.py=r,l.pz=s,l.lx=o,l.ly=h,l.lz=A}})),this.ctx.lightSystem=null;var u=null,_=new bi(this.ctx.passes);if(null!=_.current){var c=this.hardwarePass;null==c&&(c=new vi,this.hardwarePass=c);var d=this.ctx,f={texture:ti.fromColor(267386880,0)};if(d.setGlobalID(vA.allocID("depthMap"),f),c.pickX=t,c.pickY=e,c.setContext(this.ctx),c.draw(_),c.pickedIndex>=0)for(var x=_.current;null!=x;){var p=x;x=x.next;var g=p;if(0==c.pickedIndex--){u=g.obj;break}}}return this.ctx.done(),this.ctx.camera=null,this.ctx.engine=null,this.ctx.scene=null,u},syncOnly:function(t){var e=Ut.CURRENT;this.setElapsedTime(t);var i=e.getCurrentTarget();this.camera.screenRatio=null==i?e.width/e.height:i.width/i.height,this.camera.update(),this.ctx.camera=this.camera,this.ctx.engine=e,this.ctx.scene=this,this.ctx.start(),this.syncRec(this.ctx),this.ctx.camera=null,this.ctx.engine=null,this.ctx.scene=null},computeStatic:function(){var t=this.ctx.elapsedTime;this.ctx.elapsedTime=0,this.ctx.computingStatic=!0,this.render(Ut.CURRENT),this.ctx.computingStatic=!1,this.ctx.elapsedTime=t},render:function(t){0==(32&this.flags)&&this.onAdd();var e=t.getCurrentTarget();this.camera.screenRatio=null==e?t.width/t.height:e.width/e.height,this.camera.update(),this.camera.rightHanded&&t.driver.setRenderFlag(ve.CameraHandness,1),this.ctx.camera=this.camera,this.ctx.engine=t,this.ctx.scene=this,this.ctx.start(),this.renderer.start(),this.syncRec(this.ctx),this.emitRec(this.ctx);var i,n=this.ctx.passes;if(null==n)i=null;else{for(var s,r,a,A,h=1,o=0,l=0;;){for(g=n,n=null,A=null,s=0;null!=g;){++s,r=g,o=0;for(var u=0,_=h;u<_;){var c=u++;if(++o,null==(r=r.next))break}for(l=h;o>0||l>0&&null!=r;)0==o?(a=r,r=r.next,--l):0==l||null==r||g.pass.passId-r.pass.passId<=0?(a=g,g=g.next,--o):(a=r,r=r.next,--l),null!=A?A.next=a:n=a,A=a;g=r}if(A.next=null,s<=1)break;h*=2}i=n}this.ctx.passes=i;for(var d=this.ctx.passes,f=[],x=-1;null!=d;){for(var p=d.pass.passId,g=d,m=null;null!=g&&g.pass.passId==p;)m=g,g=g.next;m.next=null;var v=this.ctx.cachedPassObjects[++x];null==v&&(v=new ji,this.ctx.cachedPassObjects[x]=v),v.name=d.pass.name,(y=v.passes).current=d,y.discarded=y.lastDisc=null,f.push(v),d=g}if(null!=this.lightSystem&&(this.ctx.lightSystem=this.lightSystem,this.lightSystem.initLights(this.ctx)),this.renderer.process(f),!this.ctx.computingStatic&&this.checkPasses)for(u=0;u<f.length;){g=f[u];++u,g.rendered||En.trace("Pass "+g.name+" has not been rendered : don't know how to handle.",{fileName:"h3d/scene/Scene.hx",lineNumber:438,className:"h3d.scene.Scene",methodName:"render"})}this.camera.rightHanded&&t.driver.setRenderFlag(ve.CameraHandness,0),this.ctx.done(),this.ctx.scene=null,this.ctx.camera=null,this.ctx.engine=null;for(u=0,_=x;u<_;){var y;c=u++;(g=this.ctx.cachedPassObjects[c]).name=null,(y=g.passes).current=null,y.discarded=y.lastDisc=null}},serializeScene:function(){throw kn.thrown("You need -lib hxbit to serialize the scene data")},__class__:Zi});var Ji=function(t,e){Ri.call(this,null),this.name=e.name,this.skin=t,this.parent=t,this.index=e.index};i["h3d.scene.Joint"]=Ji,Ji.__name__="h3d.scene.Joint",Ji.__super__=Ri,Ji.prototype=r(Ri.prototype,{getObjectByName:function(t){var e=this.skin.getSkinData(),i=e.namedJoints.h[t];if(null==i)return null;var n=e.allJoints[this.index];if(n.index!=this.index)throw kn.thrown("assert");for(var s=i.parent;null!=s;){if(s==n){var r=new Ji(this.skin,i);return r.parent=this,r}s=s.parent}return null},syncPos:function(){for(var t=this.parent;null!=t;){if(0!=(1&t.flags)){null==this.skin.jointsAbsPosInv&&(this.skin.jointsAbsPosInv=new Gt,this.skin.jointsAbsPosInv.zero()),0==this.skin.jointsAbsPosInv._44&&this.skin.jointsAbsPosInv.inverse3x4(this.parent.absPos),this.parent.syncPos(),this.lastFrame=-1;break}t=t.parent}this.lastFrame!=this.skin.lastFrame&&(this.lastFrame=this.skin.lastFrame,this.absPos.load(this.skin.currentAbsPose[this.index]),null!=this.skin.jointsAbsPosInv&&0!=this.skin.jointsAbsPosInv._44&&(this.absPos.multiply3x4(this.absPos,this.skin.jointsAbsPosInv),this.absPos.multiply3x4(this.absPos,this.parent.absPos)))},__class__:Ji});var qi=function(t,e,i){Gi.call(this,null,e,i),null!=t&&this.setSkinData(t)};i["h3d.scene.Skin"]=qi,qi.__name__="h3d.scene.Skin",qi.__super__=Gi,qi.prototype=r(Gi.prototype,{clone:function(t){var e=null==t?new qi(null,this.materials.slice()):t;return Gi.prototype.clone.call(this,e),e.setSkinData(this.skinData),e.currentRelPose=this.currentRelPose.slice(),e},getBoundsRec:function(t){var e=this.primitive;if(this.set_primitive(null),t=Gi.prototype.getBoundsRec.call(this,t),this.set_primitive(e),0!=(512&this.flags))return t;this.syncJoints(),null==this.skinData.vertexWeights&&yA.__cast(this.primitive,Ei).loadSkin(this.skinData);for(var i=0,n=this.skinData.allJoints;i<n.length;){var s=n[i];if(++i,!(s.offsetRay<0)){var r=this.currentPalette[s.bindIndex],a=s.offsets,A=a.xMin,h=a.yMin,o=a.zMin;null==o&&(o=0),null==h&&(h=0),null==A&&(A=0);var l=A,u=h,_=o,c=l*r._11+u*r._21+_*r._31+r._41,d=l*r._12+u*r._22+_*r._32+r._42,f=l*r._13+u*r._23+_*r._33+r._43,x=l=c,p=u=d,g=_=f,m=s.offsetRay;x-m<t.xMin&&(t.xMin=x-m),x+m>t.xMax&&(t.xMax=x+m),p-m<t.yMin&&(t.yMin=p-m),p+m>t.yMax&&(t.yMax=p+m),g-m<t.zMin&&(t.zMin=g-m),g+m>t.zMax&&(t.zMax=g+m);var v=s.offsets,y=v.xMax,b=v.yMax,w=v.zMax;null==w&&(w=0),null==b&&(b=0),null==y&&(y=0);var M=y,B=b,C=w,S=M*r._11+B*r._21+C*r._31+r._41,I=M*r._12+B*r._22+C*r._32+r._42,k=M*r._13+B*r._23+C*r._33+r._43,E=M=S,F=B=I,T=C=k,D=s.offsetRay;E-D<t.xMin&&(t.xMin=E-D),E+D>t.xMax&&(t.xMax=E+D),F-D<t.yMin&&(t.yMin=F-D),F+D>t.yMax&&(t.yMax=F+D),T-D<t.zMin&&(t.zMin=T-D),T+D>t.zMax&&(t.zMax=T+D)}}return t},getCurrentSkeletonBounds:function(){this.syncJoints();for(var t=new se,e=0,i=this.skinData.allJoints;e<i.length;){var n=i[e];if(++e,!(n.bindIndex<0)){var s=this.currentAbsPose[n.index],r=s._41,a=s._42,A=s._43;r<t.xMin&&(t.xMin=r),r>t.xMax&&(t.xMax=r),a<t.yMin&&(t.yMin=a),a>t.yMax&&(t.yMax=a),A<t.zMin&&(t.zMin=A),A>t.zMax&&(t.zMax=A)}}return t},getObjectByName:function(t){if(null!=this.skinData&&this.skinData.name==t)return this;var e=Gi.prototype.getObjectByName.call(this,t);if(null!=e)return e;if(null!=this.skinData){var i=this.skinData.namedJoints.h[t];if(null!=i)return new Ji(this,i)}return null},getLocalCollider:function(){throw kn.thrown("Not implemented")},getGlobalCollider:function(){var t=yA.__cast(this.primitive.getCollider(),re);return yA.__cast(this.primitive,Ei).loadSkin(this.skinData),new xe(this,yA.__cast(t.b,fe))},calcAbsPos:function(){Gi.prototype.calcAbsPos.call(this),this.jointsUpdated=!0},getSkinData:function(){return this.skinData},setSkinData:function(t,e){if(null==e&&(e=!0),this.skinData=t,this.jointsUpdated=!0,this.set_primitive(t.primitive),e){for(var i=!1,n=0,s=this.materials;n<s.length;){var r=s[n];if(++n,null!=r&&null!=r.get_normalMap()){i=!0;break}}this.skinShader=i?new yn:new vn;var a=0;if(null!=this.skinData.splitJoints)for(n=0,s=this.skinData.splitJoints;n<s.length;){t=s[n];++n,t.joints.length>a&&(a=t.joints.length)}else a=this.skinData.boundJoints.length;if(this.skinShader.MaxBones__<a){var A=this.skinShader;A.constModified=!0,A.MaxBones__=a}for(n=0,s=this.materials;n<s.length;){r=s[n];++n,null!=r&&(null!=r.get_normalMap()?r.passes.addShaderAtIndex(this.skinShader,r.passes.getShaderIndex(r.normalShader)+1):r.passes.addShader(this.skinShader),null!=this.skinData.splitJoints&&r.passes.set_dynamicParameters(!0))}}this.currentRelPose=[],this.currentAbsPose=[],this.currentPalette=[],this.paletteChanged=!0;for(n=0,s=this.skinData.allJoints;n<s.length;){var h=s[n];++n,this.currentAbsPose.push(Gt.I())}for(n=0,s=this.skinData.boundJoints.length;n<s;){n++;this.currentPalette.push(Gt.I())}if(null!=this.skinData.splitJoints){this.splitPalette=[];for(n=0,s=this.skinData.splitJoints;n<s.length;){var o=s[n];++n;for(var l=this.splitPalette,u=[],_=0,c=o.joints;_<c.length;){h=c[_];++_,u.push(this.currentPalette[h.bindIndex])}l.push(u)}}else this.splitPalette=null},sync:function(t){(t.visibleFlag||0!=(64&this.flags))&&this.syncJoints()},syncJoints:function(){if(this.jointsUpdated){for(var t=qi.TMP_MAT,e=0,i=this.skinData.allJoints;e<i.length;){var n=i[e];++e;var s=n.index,r=this.currentAbsPose[s],a=this.currentRelPose[s],A=n.bindIndex;if(null==a?a=n.defMat:n.retargetAnim&&(t.load(a),(a=t)._41=n.defMat._41,a._42=n.defMat._42,a._43=n.defMat._43),null==n.parent){var h=this.absPos,o=a._11,l=a._12,u=a._13,_=a._21,c=a._22,d=a._23,f=a._31,x=a._32,p=a._33,g=a._41,m=a._42,v=a._43,y=h._11,b=h._12,w=h._13,M=h._21,B=h._22,C=h._23,S=h._31,I=h._32,k=h._33,E=h._41,F=h._42,T=h._43;r._11=o*y+l*M+u*S,r._12=o*b+l*B+u*I,r._13=o*w+l*C+u*k,r._14=0,r._21=_*y+c*M+d*S,r._22=_*b+c*B+d*I,r._23=_*w+c*C+d*k,r._24=0,r._31=f*y+x*M+p*S,r._32=f*b+x*B+p*I,r._33=f*w+x*C+p*k,r._34=0,r._41=g*y+m*M+v*S+E,r._42=g*b+m*B+v*I+F,r._43=g*w+m*C+v*k+T,r._44=1}else{var D=this.currentAbsPose[n.parent.index],P=a._11,z=a._12,R=a._13,L=a._21,V=a._22,Q=a._23,U=a._31,O=a._32,G=a._33,N=a._41,Y=a._42,X=a._43,j=D._11,H=D._12,W=D._13,Z=D._21,J=D._22,q=D._23,K=D._31,$=D._32,tt=D._33,et=D._41,it=D._42,nt=D._43;r._11=P*j+z*Z+R*K,r._12=P*H+z*J+R*$,r._13=P*W+z*q+R*tt,r._14=0,r._21=L*j+V*Z+Q*K,r._22=L*H+V*J+Q*$,r._23=L*W+V*q+Q*tt,r._24=0,r._31=U*j+O*Z+G*K,r._32=U*H+O*J+G*$,r._33=U*W+O*q+G*tt,r._34=0,r._41=N*j+Y*Z+X*K+et,r._42=N*H+Y*J+X*$+it,r._43=N*W+Y*q+X*tt+nt,r._44=1}if(A>=0){var st=this.currentPalette[A],rt=n.transPos,at=rt._11,At=rt._12,ht=rt._13,ot=rt._21,lt=rt._22,ut=rt._23,_t=rt._31,ct=rt._32,dt=rt._33,ft=rt._41,xt=rt._42,pt=rt._43,gt=r._11,mt=r._12,vt=r._13,yt=r._21,bt=r._22,wt=r._23,Mt=r._31,Bt=r._32,Ct=r._33,St=r._41,It=r._42,kt=r._43;st._11=at*gt+At*yt+ht*Mt,st._12=at*mt+At*bt+ht*Bt,st._13=at*vt+At*wt+ht*Ct,st._14=0,st._21=ot*gt+lt*yt+ut*Mt,st._22=ot*mt+lt*bt+ut*Bt,st._23=ot*vt+lt*wt+ut*Ct,st._24=0,st._31=_t*gt+ct*yt+dt*Mt,st._32=_t*mt+ct*bt+dt*Bt,st._33=_t*vt+ct*wt+dt*Ct,st._34=0,st._41=ft*gt+xt*yt+pt*Mt+St,st._42=ft*mt+xt*bt+pt*Bt+It,st._43=ft*vt+xt*wt+pt*Ct+kt,st._44=1}}this.skinShader.bonesMatrixes__=this.currentPalette,null!=this.jointsAbsPosInv&&(this.jointsAbsPosInv._44=0),this.jointsUpdated=!1}},emit:function(t){if(null==this.splitPalette)Gi.prototype.emit.call(this,t);else for(var e=0,i=this.splitPalette.length;e<i;){var n=e++;if(null!=(o=this.materials[this.skinData.splitJoints[n].material])){var s=n;null==s&&(s=0);for(var r=o.passes;null!=r;)t.emitPass(r,this).index=s,r=r.nextPass}}if(this.showJoints){null==this.jointsGraphics&&(this.jointsGraphics=new Vi(this),this.jointsGraphics.material.passes.depth(!1,Ve.Always),this.jointsGraphics.material.passes.setPassName("add"));for(var a=this;null!=a.parent;)a=a.parent;this.jointsGraphics.set_follow(a);var A=this.jointsGraphics;A.clear();for(e=0,i=this.skinData.allJoints;e<i.length;){var h=i[e];++e;var o=this.currentAbsPose[h.index],l=null==h.parent?this.absPos:this.currentAbsPose[h.parent.index];A.lineStyle(1,null==h.parent?-16776961:-256),A.moveTo(l._41,l._42,l._43),A.lineTo(o._41,o._42,o._43)}}else if(null!=this.jointsGraphics){var u=this.jointsGraphics;null!=u&&null!=u.parent&&u.parent.removeChild(u),this.jointsGraphics=null}},draw:function(t){if(null==this.splitPalette)Gi.prototype.draw.call(this,t);else{var e=t.drawPass.index;this.skinShader.bonesMatrixes__=this.splitPalette[e],this.primitive.selectMaterial(e),t.uploadParams(),this.primitive.render(t.engine)}},__class__:qi});var Ki=function(){this.perPixelLighting=!0,this.maxLightsPerObject=6,Oi.call(this);var t=this.ambientLight,e=.5,i=.5,n=.5;null==n&&(n=0),null==i&&(i=0),null==e&&(e=0),t.x=e,t.y=i,t.z=n,t.w=1,this.ambientShader=new nn,this.set_additiveLighting(!0)};i["h3d.scene.fwd.LightSystem"]=Ki,Ki.__name__="h3d.scene.fwd.LightSystem",Ki.__super__=Oi,Ki.prototype=r(Oi.prototype,{get_additiveLighting:function(){var t=this.ambientShader;return(t instanceof nn?t:null).additive__},set_additiveLighting:function(t){var e=this.ambientShader,i=e instanceof nn?e:null;return i.constModified=!0,i.additive__=t},initLights:function(t){if(Oi.prototype.initLights.call(this,t),this.lightCount<=this.maxLightsPerObject){var e,i=t.lights,n=XA(this,this.sortLight);if(null==i)e=null;else{for(var s,r,a,A,h,o=1,l=0,u=0;;){for(r=i,i=null,h=null,s=0;null!=r;){++s,a=r,l=0;for(var _=0,c=o;_<c;){_++;if(++l,null==(a=a.next))break}for(u=o;l>0||u>0&&null!=a;)0==l?(A=a,a=a.next,--u):0==u||null==a||n(r,a)<=0?(A=r,r=r.next,--l):(A=a,a=a.next,--u),null!=h?h.next=A:i=A,h=A;r=a}if(h.next=null,s<=1)break;o*=2}e=i}t.lights=e}},initGlobals:function(t){t.set("global.ambientLight",this.ambientLight),t.set("global.perPixelLighting",this.perPixelLighting)},sortLight:function(t,e){var i=t.priority-e.priority;return 0!=i?-i:t.objectDistance<e.objectDistance?-1:1},computeLight:function(t,e){if(this.lightCount>this.maxLightsPerObject){for(var i=this.ctx.lights;null!=i;){if(0!=(16&t.flags)){var n=i.absPos._41-this.ctx.camera.target.x,s=i.absPos._42-this.ctx.camera.target.y,r=i.absPos._43-this.ctx.camera.target.z;null==r&&(r=0),i.objectDistance=n*n+s*s+r*r}else{var a=i.absPos._41-t.absPos._41,A=i.absPos._42-t.absPos._42,h=i.absPos._43-t.absPos._43;null==h&&(h=0),i.objectDistance=a*a+A*A+h*h}i=i.next}var o,l=this.ctx.lights,u=XA(this,this.sortLight);if(null==l)o=null;else{for(var _,c,d,f,x,p=1,g=0,m=0;;){for(c=l,l=null,x=null,_=0;null!=c;){++_,d=c,g=0;for(var v=0,y=p;v<y;){var b=v++;if(++g,null==(d=d.next))break}for(m=p;g>0||m>0&&null!=d;)0==g?(f=d,d=d.next,--m):0==m||null==d||u(c,d)<=0?(f=c,c=c.next,--g):(f=d,d=d.next,--m),null!=x?x.next=f:l=f,x=f;c=d}if(x.next=null,_<=1)break;p*=2}o=l}this.ctx.lights=o}e=this.ctx.allocShaderList(this.ambientShader,e);for(i=this.ctx.lights,b=0;null!=i&&b++!=this.maxLightsPerObject;)e=this.ctx.allocShaderList(i.shader,e),i=i.next;return e},__class__:Ki});var $i=function(){this.enableSky=!1,fi.call(this,"depth"),this.depthMapId=vA.allocID("depthMap")};i["h3d.scene.fwd.DepthPass"]=$i,$i.__name__="h3d.scene.fwd.DepthPass",$i.__super__=fi,$i.prototype=r(fi.prototype,{getOutputs:function(){return[CA.PackFloat(CA.Value("output.depth"))]},draw:function(t,e){var i=this.ctx.textures.allocTarget("depthMap",this.ctx.engine.width,this.ctx.engine.height,!0);this.ctx.engine.pushTarget(i),this.ctx.engine.clear(this.enableSky?0:16711680,1),fi.prototype.draw.call(this,t,e),this.ctx.engine.popTarget(),this.ctx.setGlobalID(this.depthMapId,{texture:i})},__class__:$i});var tn=function(){fi.call(this,"normal"),this.normalMapId=vA.allocID("normalMap")};i["h3d.scene.fwd.NormalPass"]=tn,tn.__name__="h3d.scene.fwd.NormalPass",tn.__super__=fi,tn.prototype=r(fi.prototype,{getOutputs:function(){return[CA.PackNormal(CA.Value("output.normal"))]},draw:function(t,e){var i=this.ctx.textures.allocTarget("normalMap",this.ctx.engine.width,this.ctx.engine.height);this.ctx.engine.pushTarget(i),this.ctx.engine.clear(8421504,1),fi.prototype.draw.call(this,t,e),this.ctx.engine.popTarget(),this.ctx.setGlobalID(this.normalMapId,i)},__class__:tn});var en=function(){this.shadow=new gi(1024),this.normal=new tn,this.depth=new $i,Wi.call(this),this.defaultPass=new fi("default"),this.allPasses=[this.defaultPass,this.depth,this.normal,this.shadow]};i["h3d.scene.fwd.Renderer"]=en,en.__name__="h3d.scene.fwd.Renderer",en.__super__=Wi,en.prototype=r(Wi.prototype,{get_def:function(){return this.defaultPass},renderPass:function(t,e,i){t.draw(e,i)},getPassByName:function(t){return"alpha"==t||"additive"==t?this.defaultPass:Wi.prototype.getPassByName.call(this,t)},render:function(){this.has("shadow")&&this.renderPass(this.shadow,this.get("shadow")),this.has("depth")&&this.renderPass(this.depth,this.get("depth")),this.has("normal")&&this.renderPass(this.normal,this.get("normal")),this.renderPass(this.defaultPass,this.get("default")),this.renderPass(this.defaultPass,this.get("alpha"),this.backToFront),this.renderPass(this.defaultPass,this.get("additive"))},__class__:en});var nn=function(){ri.call(this)};i["h3d.shader.AmbientLight"]=nn,nn.__name__="h3d.shader.AmbientLight",nn.__super__=ri,nn.prototype=r(ri.prototype,{get_additive:function(){return this.additive__},set_additive:function(t){return this.constModified=!0,this.additive__=t},updateConstants:function(t){this.constBits=0,this.additive__&&(this.constBits|=2),this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.additive__:null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(nn.prototype);return t.shader=this.shader,t.additive__=this.additive__,t},__class__:nn});var sn=function(){this.viewportB__=new Yt,this.viewportA__=new Yt,this.halfPixelInverse__=new Yt,this.uvPos__=new Yt,this.filterMatrixB__=new Yt,this.filterMatrixA__=new Yt,this.absoluteMatrixB__=new Yt,this.absoluteMatrixA__=new Yt,this.color__=new Yt,this.zValue__=0,ri.call(this)};i["h3d.shader.Base2d"]=sn,sn.__name__="h3d.shader.Base2d",sn.__super__=ri,sn.prototype=r(ri.prototype,{get_zValue:function(){return this.zValue__},set_zValue:function(t){return this.zValue__=t},get_texture:function(){return this.texture__},set_texture:function(t){return this.texture__=t},get_isRelative:function(){return this.isRelative__},set_isRelative:function(t){return this.constModified=!0,this.isRelative__=t},get_color:function(){return this.color__},set_color:function(t){return this.color__=t},get_absoluteMatrixA:function(){return this.absoluteMatrixA__},set_absoluteMatrixA:function(t){return this.absoluteMatrixA__=t},get_absoluteMatrixB:function(){return this.absoluteMatrixB__},set_absoluteMatrixB:function(t){return this.absoluteMatrixB__=t},get_filterMatrixA:function(){return this.filterMatrixA__},set_filterMatrixA:function(t){return this.filterMatrixA__=t},get_filterMatrixB:function(){return this.filterMatrixB__},set_filterMatrixB:function(t){return this.filterMatrixB__=t},get_hasUVPos:function(){return this.hasUVPos__},set_hasUVPos:function(t){return this.constModified=!0,this.hasUVPos__=t},get_uvPos:function(){return this.uvPos__},set_uvPos:function(t){return this.uvPos__=t},get_killAlpha:function(){return this.killAlpha__},set_killAlpha:function(t){return this.constModified=!0,this.killAlpha__=t},get_pixelAlign:function(){return this.pixelAlign__},set_pixelAlign:function(t){return this.constModified=!0,this.pixelAlign__=t},get_halfPixelInverse:function(){return this.halfPixelInverse__},set_halfPixelInverse:function(t){return this.halfPixelInverse__=t},get_viewportA:function(){return this.viewportA__},set_viewportA:function(t){return this.viewportA__=t},get_viewportB:function(){return this.viewportB__},set_viewportB:function(t){return this.viewportB__=t},updateConstants:function(t){this.constBits=0,this.isRelative__&&(this.constBits|=1),this.hasUVPos__&&(this.constBits|=2),this.killAlpha__&&(this.constBits|=4),this.pixelAlign__&&(this.constBits|=8),this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.zValue__;case 1:return this.texture__;case 2:return this.isRelative__;case 3:return this.color__;case 4:return this.absoluteMatrixA__;case 5:return this.absoluteMatrixB__;case 6:return this.filterMatrixA__;case 7:return this.filterMatrixB__;case 8:return this.hasUVPos__;case 9:return this.uvPos__;case 10:return this.killAlpha__;case 11:return this.pixelAlign__;case 12:return this.halfPixelInverse__;case 13:return this.viewportA__;case 14:return this.viewportB__}return null},getParamFloatValue:function(t){return 0==t?this.zValue__:0},clone:function(){var t=Object.create(sn.prototype);return t.shader=this.shader,t.zValue__=this.zValue__,t.texture__=this.texture__,t.isRelative__=this.isRelative__,t.color__=this.color__,t.absoluteMatrixA__=this.absoluteMatrixA__,t.absoluteMatrixB__=this.absoluteMatrixB__,t.filterMatrixA__=this.filterMatrixA__,t.filterMatrixB__=this.filterMatrixB__,t.hasUVPos__=this.hasUVPos__,t.uvPos__=this.uvPos__,t.killAlpha__=this.killAlpha__,t.pixelAlign__=this.pixelAlign__,t.halfPixelInverse__=this.halfPixelInverse__,t.viewportA__=this.viewportA__,t.viewportB__=this.viewportB__,t},__class__:sn});var rn=function(){var t,e,i,n;this.specularColor__=new Yt,this.specularAmount__=0,this.specularPower__=0,this.color__=new Yt,ri.call(this),null==(n=1)&&(n=0),null==(i=1)&&(i=0),null==(e=1)&&(e=0),(t=this.color__).x=e,t.y=i,t.z=n,t.w=1,null==(n=1)&&(n=0),null==(i=1)&&(i=0),null==(e=1)&&(e=0),(t=this.specularColor__).x=e,t.y=i,t.z=n,t.w=1,this.specularPower__=50,this.specularAmount__=1};i["h3d.shader.BaseMesh"]=rn,rn.__name__="h3d.shader.BaseMesh",rn.__super__=ri,rn.prototype=r(ri.prototype,{get_color:function(){return this.color__},set_color:function(t){return this.color__=t},get_specularPower:function(){return this.specularPower__},set_specularPower:function(t){return this.specularPower__=t},get_specularAmount:function(){return this.specularAmount__},set_specularAmount:function(t){return this.specularAmount__=t},get_specularColor:function(){return this.specularColor__},set_specularColor:function(t){return this.specularColor__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.color__;case 1:return this.specularPower__;case 2:return this.specularAmount__;case 3:return this.specularColor__}return null},getParamFloatValue:function(t){switch(t){case 1:return this.specularPower__;case 2:return this.specularAmount__}return 0},clone:function(){var t=Object.create(rn.prototype);return t.shader=this.shader,t.color__=this.color__,t.specularPower__=this.specularPower__,t.specularAmount__=this.specularAmount__,t.specularColor__=this.specularColor__,t},__class__:rn});var an=function(){this.cubeDir__=new Gt,this.fixedColor__=new Yt,this.pixel__=new Yt,this.offsets__=[],this.values__=[],this.Quality__=0,this.cameraInverseViewProj__=new Gt,ai.call(this)};i["h3d.shader.Blur"]=an,an.__name__="h3d.shader.Blur",an.__super__=ai,an.prototype=r(ai.prototype,{get_cameraInverseViewProj:function(){return this.cameraInverseViewProj__},set_cameraInverseViewProj:function(t){return this.cameraInverseViewProj__=t},get_texture:function(){return this.texture__},set_texture:function(t){return this.texture__=t},get_depthTexture:function(){return this.depthTexture__},set_depthTexture:function(t){return this.depthTexture__=t},get_Quality:function(){return this.Quality__},set_Quality:function(t){return this.constModified=!0,this.Quality__=t},get_isDepth:function(){return this.isDepth__},set_isDepth:function(t){return this.constModified=!0,this.isDepth__=t},get_values:function(){return this.values__},set_values:function(t){return this.values__=t},get_offsets:function(){return this.offsets__},set_offsets:function(t){return this.offsets__=t},get_pixel:function(){return this.pixel__},set_pixel:function(t){return this.pixel__=t},get_hasFixedColor:function(){return this.hasFixedColor__},set_hasFixedColor:function(t){return this.constModified=!0,this.hasFixedColor__=t},get_smoothFixedColor:function(){return this.smoothFixedColor__},set_smoothFixedColor:function(t){return this.constModified=!0,this.smoothFixedColor__=t},get_fixedColor:function(){return this.fixedColor__},set_fixedColor:function(t){return this.fixedColor__=t},get_isDepthDependant:function(){return this.isDepthDependant__},set_isDepthDependant:function(t){return this.constModified=!0,this.isDepthDependant__=t},get_hasNormal:function(){return this.hasNormal__},set_hasNormal:function(t){return this.constModified=!0,this.hasNormal__=t},get_normalTexture:function(){return this.normalTexture__},set_normalTexture:function(t){return this.normalTexture__=t},get_isCube:function(){return this.isCube__},set_isCube:function(t){return this.constModified=!0,this.isCube__=t},get_cubeTexture:function(){return this.cubeTexture__},set_cubeTexture:function(t){return this.cubeTexture__=t},get_cubeDir:function(){return this.cubeDir__},set_cubeDir:function(t){return this.cubeDir__=t},updateConstants:function(t){this.constBits=0;var e=this.Quality__;if(e>>>8!=0)throw kn.thrown("Quality is out of range "+e+">255");this.constBits|=e,this.isDepth__&&(this.constBits|=256),this.hasFixedColor__&&(this.constBits|=512),this.smoothFixedColor__&&(this.constBits|=1024),this.isDepthDependant__&&(this.constBits|=2048),this.hasNormal__&&(this.constBits|=4096),this.isCube__&&(this.constBits|=8192),this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.flipY__;case 1:return this.cameraInverseViewProj__;case 2:return this.texture__;case 3:return this.depthTexture__;case 4:return this.Quality__;case 5:return this.isDepth__;case 6:return this.values__;case 7:return this.offsets__;case 8:return this.pixel__;case 9:return this.hasFixedColor__;case 10:return this.smoothFixedColor__;case 11:return this.fixedColor__;case 12:return this.isDepthDependant__;case 13:return this.hasNormal__;case 14:return this.normalTexture__;case 15:return this.isCube__;case 16:return this.cubeTexture__;case 17:return this.cubeDir__}return null},getParamFloatValue:function(t){return 0==t?this.flipY__:0},clone:function(){var t=Object.create(an.prototype);return t.shader=this.shader,t.flipY__=this.flipY__,t.cameraInverseViewProj__=this.cameraInverseViewProj__,t.texture__=this.texture__,t.depthTexture__=this.depthTexture__,t.Quality__=this.Quality__,t.isDepth__=this.isDepth__,t.values__=this.values__,t.offsets__=this.offsets__,t.pixel__=this.pixel__,t.hasFixedColor__=this.hasFixedColor__,t.smoothFixedColor__=this.smoothFixedColor__,t.fixedColor__=this.fixedColor__,t.isDepthDependant__=this.isDepthDependant__,t.hasNormal__=this.hasNormal__,t.normalTexture__=this.normalTexture__,t.isCube__=this.isCube__,t.cubeTexture__=this.cubeTexture__,t.cubeDir__=this.cubeDir__,t},__class__:an});var An=function(t){this.globals=new Float32Array(t.globalsSize<<2),this.params=new Float32Array(t.paramsSize<<2);var e,i=new Array(t.texturesCount);(this.tex=i,t.bufferCount>0)?e=i=new Array(t.bufferCount):e=null;this.buffers=e};i["h3d.shader.ShaderBuffers"]=An,An.__name__="h3d.shader.ShaderBuffers",An.prototype={grow:function(t){var e=t.globalsSize<<2,i=t.paramsSize<<2,n=t.texturesCount,s=t.bufferCount;if(this.globals.length<e&&(this.globals=new Float32Array(e)),this.params.length<i&&(this.params=new Float32Array(i)),this.tex.length<n){var r=new Array(n);this.tex=r}if(s>0&&(null==this.buffers||this.buffers.length<s)){r=new Array(s);this.buffers=r}},__class__:An};var hn=function(t){this.vertex=new An(t.vertex),this.fragment=new An(t.fragment)};i["h3d.shader.Buffers"]=hn,hn.__name__="h3d.shader.Buffers",hn.prototype={grow:function(t){this.vertex.grow(t.vertex),this.fragment.grow(t.fragment)},__class__:hn};var on=function(t){null==t&&(t=0),this.color__=new Yt,ri.call(this);var e=this.color__;e.x=(t>>16&255)/255,e.y=(t>>8&255)/255,e.z=(255&t)/255,e.w=(t>>>24)/255};i["h3d.shader.ColorAdd"]=on,on.__name__="h3d.shader.ColorAdd",on.__super__=ri,on.prototype=r(ri.prototype,{get_color:function(){return this.color__},set_color:function(t){return this.color__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.color__:null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(on.prototype);return t.shader=this.shader,t.color__=this.color__,t},__class__:on});var ln=function(t){null==t&&(t=0),this.colorKey__=new Yt,ri.call(this);var e=this.colorKey__;e.x=(t>>16&255)/255,e.y=(t>>8&255)/255,e.z=(255&t)/255,e.w=(t>>>24)/255};i["h3d.shader.ColorKey"]=ln,ln.__name__="h3d.shader.ColorKey",ln.__super__=ri,ln.prototype=r(ri.prototype,{get_colorKey:function(){return this.colorKey__},set_colorKey:function(t){return this.colorKey__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.colorKey__:null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(ln.prototype);return t.shader=this.shader,t.colorKey__=this.colorKey__,t},__class__:ln});var un=function(t){this.matrix__=new Gt,ri.call(this),null!=t?this.matrix__.loadValues(t):this.matrix__.identity()};i["h3d.shader.ColorMatrix"]=un,un.__name__="h3d.shader.ColorMatrix",un.__super__=ri,un.prototype=r(ri.prototype,{get_matrix:function(){return this.matrix__},set_matrix:function(t){return this.matrix__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.matrix__:null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(un.prototype);return t.shader=this.shader,t.matrix__=this.matrix__,t},__class__:un});var _n=function(){this.poissonDiskVeryHigh__=[],this.poissonDiskHigh__=[],this.poissonDiskLow__=[],this.shadowBias__=0,this.shadowProj__=new Gt,this.shadowMapChannel__=uA.Unknown,this.shadowRes__=new Yt,this.pcfScale__=0,this.pcfQuality__=0,this.shadowPower__=0,ri.call(this),this.poissonDiskLow__=[new Yt(-.942,-.399),new Yt(.945,-.768),new Yt(-.094,-.929),new Yt(.344,.293)],this.poissonDiskHigh__=[new Yt(-.326,-.406),new Yt(-.84,-.074),new Yt(-.696,.457),new Yt(-.203,.621),new Yt(.962,-.195),new Yt(.473,-.48),new Yt(.519,.767),new Yt(.185,-.893),new Yt(.507,.064),new Yt(.896,.412),new Yt(-.322,-.933),new Yt(-.792,-.598)],this.poissonDiskVeryHigh__=[new Yt(-.613392,.617481),new Yt(.170019,-.040254),new Yt(-.299417,.791925),new Yt(.64568,.49321),new Yt(-.651784,.717887),new Yt(.421003,.02707),new Yt(-.817194,-.271096),new Yt(-.705374,-.668203),new Yt(.97705,-.108615),new Yt(.063326,.142369),new Yt(.203528,.214331),new Yt(-.667531,.32609),new Yt(-.098422,-.295755),new Yt(-.885922,.215369),new Yt(.566637,.605213),new Yt(.039766,-.3961),new Yt(.751946,.453352),new Yt(.078707,-.715323),new Yt(-.075838,-.529344),new Yt(.724479,-.580798),new Yt(.222999,-.215125),new Yt(-.467574,-.405438),new Yt(-.248268,-.814753),new Yt(.354411,-.88757),new Yt(.175817,.382366),new Yt(.487472,-.063082),new Yt(-.084078,.898312),new Yt(.488876,-.783441),new Yt(.470016,.217933),new Yt(-.69689,-.549791),new Yt(-.149693,.605762),new Yt(.034211,.97998),new Yt(.503098,-.308878),new Yt(-.016205,-.872921),new Yt(.385784,-.393902),new Yt(-.146886,-.859249),new Yt(.643361,.164098),new Yt(.634388,-.049471),new Yt(-.688894,.007843),new Yt(.464034,-.188818),new Yt(-.44084,.137486),new Yt(.364483,.511704),new Yt(.034028,.325968),new Yt(.099094,-.308023),new Yt(.69396,-.366253),new Yt(.678884,-.204688),new Yt(.001801,.780328),new Yt(.145177,-.898984),new Yt(.062655,-.611866),new Yt(.315226,-.604297),new Yt(-.780145,.486251),new Yt(-.371868,.882138),new Yt(.200476,.49443),new Yt(-.494552,-.711051),new Yt(.612476,.705252),new Yt(-.578845,-.768792),new Yt(-.772454,-.090976),new Yt(.50444,.372295),new Yt(.155736,.065157),new Yt(.391522,.849605),new Yt(-.620106,-.328104),new Yt(.789239,-.419965),new Yt(-.545396,.538133),new Yt(-.178564,-.596057)]};i["h3d.shader.DirShadow"]=_n,_n.__name__="h3d.shader.DirShadow",_n.__super__=ri,_n.prototype=r(ri.prototype,{get_enable:function(){return this.enable__},set_enable:function(t){return this.constModified=!0,this.enable__=t},get_USE_ESM:function(){return this.USE_ESM__},set_USE_ESM:function(t){return this.constModified=!0,this.USE_ESM__=t},get_shadowPower:function(){return this.shadowPower__},set_shadowPower:function(t){return this.shadowPower__=t},get_USE_PCF:function(){return this.USE_PCF__},set_USE_PCF:function(t){return this.constModified=!0,this.USE_PCF__=t},get_pcfQuality:function(){return this.pcfQuality__},set_pcfQuality:function(t){return this.constModified=!0,this.pcfQuality__=t},get_pcfScale:function(){return this.pcfScale__},set_pcfScale:function(t){return this.pcfScale__=t},get_shadowRes:function(){return this.shadowRes__},set_shadowRes:function(t){return this.shadowRes__=t},get_shadowMap:function(){return this.shadowMap__},set_shadowMap:function(t){return this.constModified=!0,this.shadowMap__=t},get_shadowMapChannel:function(){return this.shadowMapChannel__},set_shadowMapChannel:function(t){return this.constModified=!0,this.shadowMapChannel__=t},get_shadowProj:function(){return this.shadowProj__},set_shadowProj:function(t){return this.shadowProj__=t},get_shadowBias:function(){return this.shadowBias__},set_shadowBias:function(t){return this.shadowBias__=t},get_poissonDiskLow:function(){return this.poissonDiskLow__},set_poissonDiskLow:function(t){return this.poissonDiskLow__=t},get_poissonDiskHigh:function(){return this.poissonDiskHigh__},set_poissonDiskHigh:function(t){return this.poissonDiskHigh__=t},get_poissonDiskVeryHigh:function(){return this.poissonDiskVeryHigh__},set_poissonDiskVeryHigh:function(t){return this.poissonDiskVeryHigh__=t},updateConstants:function(t){this.constBits=0,this.enable__&&(this.constBits|=1),this.USE_ESM__&&(this.constBits|=2),this.USE_PCF__&&(this.constBits|=4);var e=this.pcfQuality__;if(e>>>8!=0)throw kn.thrown("pcfQuality is out of range "+e+">255");if(this.constBits|=e<<3,null==this.shadowMap__)this.shadowMapChannel__=uA.Unknown;else if(this.shadowMapChannel__==uA.Unknown){if(this.shadowMap__.format!=ti.nativeFormat)throw kn.thrown("shadowMapChannel is not set");this.shadowMapChannel__=uA.PackedFloat}this.constBits|=(t.allocChannelID(this.shadowMap__)<<3|this.shadowMapChannel__._hx_index)<<11,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.enable__;case 1:return this.USE_ESM__;case 2:return this.shadowPower__;case 3:return this.USE_PCF__;case 4:return this.pcfQuality__;case 5:return this.pcfScale__;case 6:return this.shadowRes__;case 7:return this.shadowMap__;case 8:return this.shadowProj__;case 9:return this.shadowBias__;case 10:return this.poissonDiskLow__;case 11:return this.poissonDiskHigh__;case 12:return this.poissonDiskVeryHigh__}return null},getParamFloatValue:function(t){switch(t){case 2:return this.shadowPower__;case 5:return this.pcfScale__;case 9:return this.shadowBias__}return 0},clone:function(){var t=Object.create(_n.prototype);return t.shader=this.shader,t.enable__=this.enable__,t.USE_ESM__=this.USE_ESM__,t.shadowPower__=this.shadowPower__,t.USE_PCF__=this.USE_PCF__,t.pcfQuality__=this.pcfQuality__,t.pcfScale__=this.pcfScale__,t.shadowRes__=this.shadowRes__,t.shadowMap__=this.shadowMap__,t.shadowProj__=this.shadowProj__,t.shadowBias__=this.shadowBias__,t.poissonDiskLow__=this.poissonDiskLow__,t.poissonDiskHigh__=this.poissonDiskHigh__,t.poissonDiskVeryHigh__=this.poissonDiskVeryHigh__,t},__class__:_n});var cn=function(){this.color__=new Yt,this.mode__=0,ai.call(this)};i["h3d.shader.GenTexture"]=cn,cn.__name__="h3d.shader.GenTexture",cn.__super__=ai,cn.prototype=r(ai.prototype,{get_mode:function(){return this.mode__},set_mode:function(t){return this.constModified=!0,this.mode__=t},get_color:function(){return this.color__},set_color:function(t){return this.color__=t},updateConstants:function(t){this.constBits=0;var e=this.mode__;if(e>>>8!=0)throw kn.thrown("mode is out of range "+e+">255");this.constBits|=e,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.flipY__;case 1:return this.mode__;case 2:return this.color__}return null},getParamFloatValue:function(t){return 0==t?this.flipY__:0},clone:function(){var t=Object.create(cn.prototype);return t.shader=this.shader,t.flipY__=this.flipY__,t.mode__=this.mode__,t.color__=this.color__,t},__class__:cn});var dn=function(t,e){null==e&&(e=1),null==t&&(t=1.5),this.width__=0,this.lengthScale__=0,ri.call(this),this.width__=t,this.lengthScale__=e};i["h3d.shader.LineShader"]=dn,dn.__name__="h3d.shader.LineShader",dn.__super__=ri,dn.prototype=r(ri.prototype,{get_lengthScale:function(){return this.lengthScale__},set_lengthScale:function(t){return this.lengthScale__=t},get_width:function(){return this.width__},set_width:function(t){return this.width__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.lengthScale__;case 1:return this.width__}return null},getParamFloatValue:function(t){switch(t){case 0:return this.lengthScale__;case 1:return this.width__}return 0},clone:function(){var t=Object.create(dn.prototype);return t.shader=this.shader,t.lengthScale__=this.lengthScale__,t.width__=this.width__,t},__class__:dn});var fn=function(){ai.call(this)};i["h3d.shader.MinMaxShader"]=fn,fn.__name__="h3d.shader.MinMaxShader",fn.__super__=ai,fn.prototype=r(ai.prototype,{get_texA:function(){return this.texA__},set_texA:function(t){return this.texA__=t},get_texB:function(){return this.texB__},set_texB:function(t){return this.texB__=t},get_isMax:function(){return this.isMax__},set_isMax:function(t){return this.constModified=!0,this.isMax__=t},updateConstants:function(t){this.constBits=0,this.isMax__&&(this.constBits|=1),this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.flipY__;case 1:return this.texA__;case 2:return this.texB__;case 3:return this.isMax__}return null},getParamFloatValue:function(t){return 0==t?this.flipY__:0},clone:function(){var t=Object.create(fn.prototype);return t.shader=this.shader,t.flipY__=this.flipY__,t.texA__=this.texA__,t.texB__=this.texB__,t.isMax__=this.isMax__,t},__class__:fn});var xn=function(){this.mat__=new Gt,ai.call(this)};i["h3d.shader.CubeMinMaxShader"]=xn,xn.__name__="h3d.shader.CubeMinMaxShader",xn.__super__=ai,xn.prototype=r(ai.prototype,{get_texA:function(){return this.texA__},set_texA:function(t){return this.texA__=t},get_texB:function(){return this.texB__},set_texB:function(t){return this.texB__=t},get_isMax:function(){return this.isMax__},set_isMax:function(t){return this.constModified=!0,this.isMax__=t},get_mat:function(){return this.mat__},set_mat:function(t){return this.mat__=t},updateConstants:function(t){this.constBits=0,this.isMax__&&(this.constBits|=1),this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.flipY__;case 1:return this.texA__;case 2:return this.texB__;case 3:return this.isMax__;case 4:return this.mat__}return null},getParamFloatValue:function(t){return 0==t?this.flipY__:0},clone:function(){var t=Object.create(xn.prototype);return t.shader=this.shader,t.flipY__=this.flipY__,t.texA__=this.texA__,t.texB__=this.texB__,t.isMax__=this.isMax__,t.mat__=this.mat__,t},__class__:xn});var pn=function(t){ri.call(this),this.texture__=t};i["h3d.shader.NormalMap"]=pn,pn.__name__="h3d.shader.NormalMap",pn.__super__=ri,pn.prototype=r(ri.prototype,{get_texture:function(){return this.texture__},set_texture:function(t){return this.texture__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.texture__:null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(pn.prototype);return t.shader=this.shader,t.texture__=this.texture__,t},__class__:pn});var gn=function(){ri.call(this)};i["h3d.shader.Shadow"]=gn,gn.__name__="h3d.shader.Shadow",gn.__super__=ri,gn.prototype=r(ri.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return null},getParamFloatValue:function(t){return 0},__class__:gn});var mn=function(){this.bonesMatrixes__=[],this.MaxBones__=0,ri.call(this),this.constModified=!0,this.MaxBones__=34};i["h3d.shader.SkinBase"]=mn,mn.__name__="h3d.shader.SkinBase",mn.__super__=ri,mn.prototype=r(ri.prototype,{get_MaxBones:function(){return this.MaxBones__},set_MaxBones:function(t){return this.constModified=!0,this.MaxBones__=t},get_bonesMatrixes:function(){return this.bonesMatrixes__},set_bonesMatrixes:function(t){return this.bonesMatrixes__=t},updateConstants:function(t){this.constBits=0;var e=this.MaxBones__;if(e>>>8!=0)throw kn.thrown("MaxBones is out of range "+e+">255");this.constBits|=e,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.MaxBones__;case 1:return this.bonesMatrixes__}return null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(mn.prototype);return t.shader=this.shader,t.MaxBones__=this.MaxBones__,t.bonesMatrixes__=this.bonesMatrixes__,t},__class__:mn});var vn=function(){mn.call(this)};i["h3d.shader.Skin"]=vn,vn.__name__="h3d.shader.Skin",vn.__super__=mn,vn.prototype=r(mn.prototype,{updateConstants:function(t){this.constBits=0;var e=this.MaxBones__;if(e>>>8!=0)throw kn.thrown("MaxBones is out of range "+e+">255");this.constBits|=e,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.MaxBones__;case 1:return this.bonesMatrixes__}return null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(vn.prototype);return t.shader=this.shader,t.MaxBones__=this.MaxBones__,t.bonesMatrixes__=this.bonesMatrixes__,t},__class__:vn});var yn=function(){mn.call(this)};i["h3d.shader.SkinTangent"]=yn,yn.__name__="h3d.shader.SkinTangent",yn.__super__=mn,yn.prototype=r(mn.prototype,{updateConstants:function(t){this.constBits=0;var e=this.MaxBones__;if(e>>>8!=0)throw kn.thrown("MaxBones is out of range "+e+">255");this.constBits|=e,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.MaxBones__;case 1:return this.bonesMatrixes__}return null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(yn.prototype);return t.shader=this.shader,t.MaxBones__=this.MaxBones__,t.bonesMatrixes__=this.bonesMatrixes__,t},__class__:yn});var bn=function(t){ri.call(this),this.texture__=t};i["h3d.shader.SpecularTexture"]=bn,bn.__name__="h3d.shader.SpecularTexture",bn.__super__=ri,bn.prototype=r(ri.prototype,{get_texture:function(){return this.texture__},set_texture:function(t){return this.texture__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.texture__:null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(bn.prototype);return t.shader=this.shader,t.texture__=this.texture__,t},__class__:bn});var wn=function(t){this.killAlphaThreshold__=0,ri.call(this),this.texture__=t,this.killAlphaThreshold__=Xe.defaultKillAlphaThreshold};i["h3d.shader.Texture"]=wn,wn.__name__="h3d.shader.Texture",wn.__super__=ri,wn.prototype=r(ri.prototype,{get_additive:function(){return this.additive__},set_additive:function(t){return this.constModified=!0,this.additive__=t},get_killAlpha:function(){return this.killAlpha__},set_killAlpha:function(t){return this.constModified=!0,this.killAlpha__=t},get_specularAlpha:function(){return this.specularAlpha__},set_specularAlpha:function(t){return this.constModified=!0,this.specularAlpha__=t},get_killAlphaThreshold:function(){return this.killAlphaThreshold__},set_killAlphaThreshold:function(t){return this.killAlphaThreshold__=t},get_texture:function(){return this.texture__},set_texture:function(t){return this.texture__=t},updateConstants:function(t){this.constBits=0,this.additive__&&(this.constBits|=1),this.killAlpha__&&(this.constBits|=2),this.specularAlpha__&&(this.constBits|=4),this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.additive__;case 1:return this.killAlpha__;case 2:return this.specularAlpha__;case 3:return this.killAlphaThreshold__;case 4:return this.texture__}return null},getParamFloatValue:function(t){return 3==t?this.killAlphaThreshold__:0},clone:function(){var t=Object.create(wn.prototype);return t.shader=this.shader,t.additive__=this.additive__,t.killAlpha__=this.killAlpha__,t.specularAlpha__=this.specularAlpha__,t.killAlphaThreshold__=this.killAlphaThreshold__,t.texture__=this.texture__,t},__class__:wn});var Mn=function(t,e,i,n){var s,r,a;null==n&&(n=1),null==i&&(i=1),null==e&&(e=0),null==t&&(t=0),this.uvScale__=new Yt,this.uvDelta__=new Yt,ri.call(this),null==(a=e)&&(a=0),null==(r=t)&&(r=0),(s=this.uvDelta__).x=r,s.y=a,s.z=0,s.w=1,null==(a=n)&&(a=0),null==(r=i)&&(r=0),(s=this.uvScale__).x=r,s.y=a,s.z=0,s.w=1};i["h3d.shader.UVDelta"]=Mn,Mn.__name__="h3d.shader.UVDelta",Mn.__super__=ri,Mn.prototype=r(ri.prototype,{get_uvDelta:function(){return this.uvDelta__},set_uvDelta:function(t){return this.uvDelta__=t},get_uvScale:function(){return this.uvScale__},set_uvScale:function(t){return this.uvScale__=t},updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.uvDelta__;case 1:return this.uvScale__}return null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(Mn.prototype);return t.shader=this.shader,t.uvDelta__=this.uvDelta__,t.uvScale__=this.uvScale__,t},__class__:Mn});var Bn=function(){ri.call(this)};i["h3d.shader.VertexColorAlpha"]=Bn,Bn.__name__="h3d.shader.VertexColorAlpha",Bn.__super__=ri,Bn.prototype=r(ri.prototype,{get_additive:function(){return this.additive__},set_additive:function(t){return this.constModified=!0,this.additive__=t},updateConstants:function(t){this.constBits=0,this.additive__&&(this.constBits|=1),this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.additive__:null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(Bn.prototype);return t.shader=this.shader,t.additive__=this.additive__,t},__class__:Bn});var Cn=function(t,e){var i,n,s,r;this.isCentered__=!0,this.tangent__=new Yt,this.normal__=new Yt,this.scale__=new Yt,ri.call(this),null==(i=1)&&(i=0),null==(r=0)&&(r=0),null==(s=0)&&(s=0),(n=this.normal__).x=s,n.y=r,n.z=i,n.w=1,null==(i=0)&&(i=0),null==(r=0)&&(r=0),null==(s=1)&&(s=0),(n=this.tangent__).x=s,n.y=r,n.z=i,n.w=1,null==(r=1/e)&&(r=0),null==(s=1/t)&&(s=0),(n=this.scale__).x=s,n.y=r,n.z=0,n.w=1};i["h3d.shader.VolumeDecal"]=Cn,Cn.__name__="h3d.shader.VolumeDecal",Cn.__super__=ri,Cn.prototype=r(ri.prototype,{get_scale:function(){return this.scale__},set_scale:function(t){return this.scale__=t},get_normal:function(){return this.normal__},set_normal:function(t){return this.normal__=t},get_tangent:function(){return this.tangent__},set_tangent:function(t){return this.tangent__=t},get_isCentered:function(){return this.isCentered__},set_isCentered:function(t){return this.constModified=!0,this.isCentered__=t},updateConstants:function(t){this.constBits=0,this.isCentered__&&(this.constBits|=64),this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.scale__;case 1:return this.normal__;case 2:return this.tangent__;case 3:return this.isCentered__}return null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(Cn.prototype);return t.shader=this.shader,t.scale__=this.scale__,t.normal__=this.normal__,t.tangent__=this.tangent__,t.isCentered__=this.isCentered__,t},__class__:Cn});var Sn=function(){};i["haxe.IMap"]=Sn,Sn.__name__="haxe.IMap",Sn.__isInterface__=!0;var In=function(){};i["haxe.EntryPoint"]=In,In.__name__="haxe.EntryPoint",In.processEvents=function(){for(;;){var t=In.pending.shift();if(null==t)break;t()}var e=Tn.tick();return Tn.hasEvents()||0!=In.threadCount?e:-1},In.run=function(){var t=In.processEvents();if("undefined"!=typeof window){var e=window,i=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame;null!=i?i(In.run):t>=0&&setTimeout(In.run,1e3*t)}else t>=0&&setTimeout(In.run,1e3*t)};var kn=function(t,e,i){Error.call(this,t),this.message=t,this.__previousException=e,this.__nativeException=null!=i?i:this};i["haxe.Exception"]=kn,kn.__name__="haxe.Exception",kn.caught=function(t){return t instanceof kn?t:t instanceof Error?new kn(t.message,null,t):new Ln(t,null,t)},kn.thrown=function(t){return t instanceof kn?t.get_native():t instanceof Error?t:new Ln(t)},kn.__super__=Error,kn.prototype=r(Error.prototype,{unwrap:function(){return this.__nativeException},toString:function(){return this.get_message()},get_message:function(){return this.message},get_native:function(){return this.__nativeException},__class__:kn});var En=function(){};i["haxe.Log"]=En,En.__name__="haxe.Log",En.formatOutput=function(t,e){var i=x.string(t);if(null==e)return i;var n=e.fileName+":"+e.lineNumber;if(null!=e.customParams)for(var s=0,r=e.customParams;s<r.length;){t=r[s];++s,i+=", "+x.string(t)}return n+": "+i},En.trace=function(t,e){var i=En.formatOutput(t,e);"undefined"!=typeof console&&null!=console.log&&console.log(i)};var Fn=function(t,e){this.isBlocking=!0,this.f=t,this.priority=e,this.nextRun=-1/0};i["haxe.MainEvent"]=Fn,Fn.__name__="haxe.MainEvent",Fn.prototype={stop:function(){null!=this.f&&(this.f=null,this.nextRun=-1/0,null==this.prev?Tn.pending=this.next:this.prev.next=this.next,null!=this.next&&(this.next.prev=this.prev))},__class__:Fn};var Tn=function(){};i["haxe.MainLoop"]=Tn,Tn.__name__="haxe.MainLoop",Tn.hasEvents=function(){for(var t=Tn.pending;null!=t;){if(t.isBlocking)return!0;t=t.next}return!1},Tn.add=function(t,e){if(null==e&&(e=0),null==t)throw kn.thrown("Event function is null");var i=new Fn(t,e),n=Tn.pending;return null!=n&&(n.prev=i),i.next=n,Tn.pending=i,Tn.injectIntoEventLoop(0),i},Tn.injectIntoEventLoop=function(t){},Tn.sortEvents=function(){var t=Tn.pending;if(null!=t){for(var e,i,n,s,r,a=1,A=0,h=0;;){for(i=t,t=null,r=null,e=0;null!=i;){++e,n=i,A=0;for(var o=0,l=a;o<l;){o++;if(++A,null==(n=n.next))break}for(h=a;A>0||h>0&&null!=n;)0==A?(s=n,n=n.next,--h):0==h||null==n||i.priority>n.priority||i.priority==n.priority&&i.nextRun<=n.nextRun?(s=i,i=i.next,--A):(s=n,n=n.next,--h),null!=r?r.next=s:t=s,s.prev=r,r=s;i=n}if(r.next=null,e<=1)break;a*=2}t.prev=null,Tn.pending=t}},Tn.tick=function(){Tn.sortEvents();for(var t=Tn.pending,e=l.now()/1e3,i=1e9;null!=t;){var n=t.next,s=t.nextRun-e;s<=0?(i=0,null!=t.f&&t.f()):i>s&&(i=s),t=n}return i};var Dn=function(){};i["haxe.Resource"]=Dn,Dn.__name__="haxe.Resource",Dn.getBytes=function(t){for(var e=0,i=Dn.content;e<i.length;){var n=i[e];if(++e,n.name==t)return null!=n.str?Qn.ofString(n.str):On.decode(n.data)}return null};var Pn=function(t){var e=this;this.id=setInterval((function(){e.run()}),t)};i["haxe.Timer"]=Pn,Pn.__name__="haxe.Timer",Pn.delay=function(t,e){var i=new Pn(e);return i.run=function(){i.stop(),t()},i},Pn.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:Pn};var zn=function(){};i["haxe._Unserializer.DefaultResolver"]=zn,zn.__name__="haxe._Unserializer.DefaultResolver",zn.prototype={resolveClass:function(t){return i[t]},resolveEnum:function(t){return s[t]},__class__:zn};var Rn=function(t){this.buf=t,this.length=this.buf.length,this.pos=0,this.scache=[],this.cache=[];var e=Rn.DEFAULT_RESOLVER;null==e&&(e=new zn,Rn.DEFAULT_RESOLVER=e),this.resolver=e};i["haxe.Unserializer"]=Rn,Rn.__name__="haxe.Unserializer",Rn.initCodes=function(){for(var t=[],e=0,i=Rn.BASE64.length;e<i;){var n=e++;t[Rn.BASE64.charCodeAt(n)]=n}return t},Rn.run=function(t){return new Rn(t).unserialize()},Rn.prototype={readDigits:function(){for(var t=0,e=!1,i=this.pos;;){var n=this.buf.charCodeAt(this.pos);if(n!=n)break;if(45!=n){if(n<48||n>57)break;t=10*t+(n-48),this.pos++}else{if(this.pos!=i)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(e!=e)break;if(!(e>=43&&e<58||101==e||69==e))break;this.pos++}return parseFloat(l.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw kn.thrown("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw kn.thrown("Invalid object key");var i=this.unserialize();t[e]=i}this.pos++},unserializeEnum:function(t,e){if(58!=this.buf.charCodeAt(this.pos++))throw kn.thrown("Invalid enum format");var i=this.readDigits();if(0==i)return m.createEnum(t,e);for(var n=[];i-- >0;)n.push(this.unserialize());return m.createEnum(t,e,n)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var t=this.unserialize();if(null==(h=this.resolver.resolveClass(t)))throw kn.thrown("Class not found "+t);return h;case 66:t=this.unserialize();if(null==(x=this.resolver.resolveEnum(t)))throw kn.thrown("Enum not found "+t);return x;case 67:t=this.unserialize();if(null==(h=this.resolver.resolveClass(t)))throw kn.thrown("Class not found "+t);var e=Object.create(h.prototype);if(this.cache.push(e),e.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw kn.thrown("Invalid custom data");return e;case 77:var i=new qn;this.cache.push(i);for(var n=this.buf;104!=this.buf.charCodeAt(this.pos);){var s=this.unserialize();i.set(s,this.unserialize())}return this.pos++,i;case 82:if((a=this.readDigits())<0||a>=this.scache.length)throw kn.thrown("Invalid string reference");return this.scache[a];case 97:n=this.buf;var r=[];for(this.cache.push(r);;){if(104==(g=this.buf.charCodeAt(this.pos))){this.pos++;break}if(117==g){this.pos++;var a=this.readDigits();r[r.length+a-1]=null}else r.push(this.unserialize())}return r;case 98:i=new Kn;this.cache.push(i);for(n=this.buf;104!=this.buf.charCodeAt(this.pos);){s=this.unserialize();var A=this.unserialize();i.h[s]=A}return this.pos++,i;case 99:var h;t=this.unserialize();if(null==(h=this.resolver.resolveClass(t)))throw kn.thrown("Class not found "+t);e=Object.create(h.prototype);return this.cache.push(e),this.unserializeObject(e),e;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:t=this.unserialize();if(null==(F=this.resolver.resolveEnum(t)))throw kn.thrown("Enum not found "+t);this.pos++;for(var o=this.readDigits(),u=F.__constructs__,_=new Array(u.length),c=0,d=u.length;c<d;){_[m=c++]=u[m]._hx_name}var f=_[o];if(null==f)throw kn.thrown("Unknown enum index "+t+"@"+o);var x=this.unserializeEnum(F,f);return this.cache.push(x),x;case 107:return NaN;case 108:var p=new Zn;this.cache.push(p);for(n=this.buf;104!=this.buf.charCodeAt(this.pos);)p.add(this.unserialize());return this.pos++,p;case 109:return-1/0;case 110:return null;case 111:e={};return this.cache.push(e),this.unserializeObject(e),e;case 112:return 1/0;case 113:i=new Wn;this.cache.push(i);n=this.buf;for(var g=this.buf.charCodeAt(this.pos++);58==g;){var m=this.readDigits();A=this.unserialize();i.h[m]=A,g=this.buf.charCodeAt(this.pos++)}if(104!=g)throw kn.thrown("Invalid IntMap format");return i;case 114:if((a=this.readDigits())<0||a>=this.cache.length)throw kn.thrown("Invalid reference");return this.cache[a];case 115:var v=this.readDigits();n=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<v)throw kn.thrown("Invalid bytes length");var y=Rn.CODES;null==y&&(y=Rn.initCodes(),Rn.CODES=y);for(var b=3&v,w=(m=this.pos)+(v-b),M=new Qn(new ArrayBuffer(3*(v>>2)+(b>=2?b-1:0))),B=0;m<w;){var C=y[n.charCodeAt(m++)],S=y[n.charCodeAt(m++)];M.b[B++]=C<<2|S>>4;var I=y[n.charCodeAt(m++)];M.b[B++]=S<<4|I>>2;var k=y[n.charCodeAt(m++)];M.b[B++]=I<<6|k}if(b>=2){C=y[n.charCodeAt(m++)],S=y[n.charCodeAt(m++)];if(M.b[B++]=C<<2|S>>4,3==b){I=y[n.charCodeAt(m++)];M.b[B++]=S<<4|I>>2}}return this.pos+=v,this.cache.push(M),M;case 116:return!0;case 118:var E;return this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(E=l.strDate(l.substr(this.buf,this.pos,19)),this.pos+=19):E=new Date(this.readFloat()),this.cache.push(E),E;case 119:var F;t=this.unserialize();if(null==(F=this.resolver.resolveEnum(t)))throw kn.thrown("Enum not found "+t);x=this.unserializeEnum(F,this.unserialize());return this.cache.push(x),x;case 120:throw kn.thrown(this.unserialize());case 121:v=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<v)throw kn.thrown("Invalid string length");s=l.substr(this.buf,this.pos,v);return this.pos+=v,s=decodeURIComponent(s.split("+").join(" ")),this.scache.push(s),s;case 122:return 0}throw this.pos--,kn.thrown("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:Rn};var Ln=function(t,e,i){kn.call(this,String(t),e,i),this.value=t};i["haxe.ValueException"]=Ln,Ln.__name__="haxe.ValueException",Ln.__super__=kn,Ln.prototype=r(kn.prototype,{unwrap:function(){return this.value},__class__:Ln});var Vn=function(){this.a1=1,this.a2=0};i["haxe.crypto.Adler32"]=Vn,Vn.__name__="haxe.crypto.Adler32",Vn.read=function(t){var e=new Vn,i=t.readByte(),n=t.readByte(),s=t.readByte(),r=t.readByte();return e.a1=s<<8|r,e.a2=i<<8|n,e},Vn.prototype={update:function(t,e,i){for(var n=this.a1,s=this.a2,r=e,a=e+i;r<a;){var A=r++;s=(s+(n=(n+t.b[A])%65521))%65521}this.a1=n,this.a2=s},equals:function(t){return t.a1==this.a1&&t.a2==this.a2},__class__:Vn};var Qn=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};i["haxe.io.Bytes"]=Qn,Qn.__name__="haxe.io.Bytes",Qn.ofString=function(t,e){if(e==Un.RawNative){for(var i=new Uint8Array(t.length<<1),n=0,s=t.length;n<s;){var r=n++,a=t.charCodeAt(r);i[r<<1]=255&a,i[r<<1|1]=a>>8}return new Qn(i.buffer)}var A=[];for(r=0;r<t.length;){55296<=(a=t.charCodeAt(r++))&&a<=56319&&(a=a-55232<<10|1023&t.charCodeAt(r++)),a<=127?A.push(a):a<=2047?(A.push(192|a>>6),A.push(128|63&a)):a<=65535?(A.push(224|a>>12),A.push(128|a>>6&63),A.push(128|63&a)):(A.push(240|a>>18),A.push(128|a>>12&63),A.push(128|a>>6&63),A.push(128|63&a))}return new Qn(new Uint8Array(A).buffer)},Qn.ofData=function(t){var e=t.hxBytes;return null!=e?e:new Qn(t)},Qn.prototype={blit:function(t,e,i,n){if(t<0||i<0||n<0||t+n>this.length||i+n>e.length)throw kn.thrown(hs.OutsideBounds);0==i&&n==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(i,i+n),t)},fill:function(t,e,i){for(var n=0,s=e;n<s;){n++;this.b[t++]=i}},getFloat:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(t,!0)},setFloat:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat32(t,e,!0)},getUInt16:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getUint16(t,!0)},setUInt16:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setUint16(t,e,!0)},getInt32:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(t,!0)},setInt32:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(t,e,!0)},getString:function(t,e,i){if(t<0||e<0||t+e>this.length)throw kn.thrown(hs.OutsideBounds);null==i&&(i=Un.UTF8);var n="",s=this.b,r=t,a=t+e;switch(i._hx_index){case 0:for(;r<a;){if((l=s[r++])<128){if(0==l)break;n+=String.fromCodePoint(l)}else if(l<224){var A=(63&l)<<6|127&s[r++];n+=String.fromCodePoint(A)}else if(l<240){var h=(31&l)<<12|(127&s[r++])<<6|127&s[r++];n+=String.fromCodePoint(h)}else{var o=(15&l)<<18|(127&s[r++])<<12|(127&s[r++])<<6|127&s[r++];n+=String.fromCodePoint(o)}}break;case 1:for(;r<a;){var l=s[r++]|s[r++]<<8;n+=String.fromCodePoint(l)}}return n},toString:function(){return this.getString(0,this.length)},__class__:Qn};var Un=s["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:n},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:n}};Un.__constructs__=[Un.UTF8,Un.RawNative],Un.__empty_constructs__=[Un.UTF8,Un.RawNative];var On=function(){};i["haxe.crypto.Base64"]=On,On.__name__="haxe.crypto.Base64",On.encode=function(t,e){null==e&&(e=!0);var i=new Gn(On.BYTES).encodeBytes(t).toString();if(e)switch(t.length%3){case 1:i+="==";break;case 2:i+="="}return i},On.decode=function(t,e){if(null==e&&(e=!0),e)for(;61==l.cca(t,t.length-1);)t=l.substr(t,0,-1);return new Gn(On.BYTES).decodeBytes(Qn.ofString(t))};var Gn=function(t){for(var e=t.length,i=1;e>1<<i;)++i;if(i>8||e!=1<<i)throw kn.thrown("BaseCode : base length must be a power of two.");this.base=t,this.nbits=i};i["haxe.crypto.BaseCode"]=Gn,Gn.__name__="haxe.crypto.BaseCode",Gn.prototype={encodeBytes:function(t){for(var e=this.nbits,i=this.base,n=8*t.length/e|0,s=new Qn(new ArrayBuffer(n+(8*t.length%e==0?0:1))),r=0,a=0,A=(1<<e)-1,h=0,o=0;o<n;){for(;a<e;)a+=8,r<<=8,r|=t.b[h++];a-=e,s.b[o++]=i.b[r>>a&A]}return a>0&&(s.b[o++]=i.b[r<<e-a&A]),s},initTable:function(){for(var t=[],e=0;e<256;){t[n=e++]=-1}e=0;for(var i=this.base.length;e<i;){var n=e++;t[this.base.b[n]]=n}this.tbl=t},decodeBytes:function(t){var e=this.nbits;this.base;null==this.tbl&&this.initTable();for(var i=this.tbl,n=t.length*e>>3,s=new Qn(new ArrayBuffer(n)),r=0,a=0,A=0,h=0;h<n;){for(;a<8;){a+=e,r<<=e;var o=i[t.b[A++]];if(-1==o)throw kn.thrown("BaseCode : invalid encoded char");r|=o}a-=8,s.b[h++]=r>>a&255}return s},__class__:Gn};var Nn=function(){};i["haxe.crypto.Md5"]=Nn,Nn.__name__="haxe.crypto.Md5",Nn.encode=function(t){var e=new Nn,i=e.doEncode(Nn.str2blks(t));return e.hex(i)},Nn.str2blks=function(t){for(var e=Qn.ofString(t),i=1+(e.length+8>>6),n=[],s=0,r=16*i;s<r;){n[a=s++]=0}for(var a=0,A=e.length,h=8*A;a<A;)n[a>>2]|=e.b[a]<<(h+a)%4*8,++a;n[a>>2]|=128<<(h+a)%4*8;var o=16*i-2;return n[o]=255&h,n[o]|=(h>>>8&255)<<8,n[o]|=(h>>>16&255)<<16,n[o]|=(h>>>24&255)<<24,n},Nn.prototype={bitOR:function(t,e){return(t>>>1|e>>>1)<<1|(1&t|1&e)},bitXOR:function(t,e){return(t>>>1^e>>>1)<<1|1&t^1&e},bitAND:function(t,e){return(t>>>1&e>>>1)<<1|1&t&e},addme:function(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i},hex:function(t){for(var e="",i="0123456789abcdef",n=0;n<t.length;){var s=t[n];++n,e+=i.charAt(s>>4&15)+i.charAt(15&s),e+=i.charAt(s>>12&15)+i.charAt(s>>8&15),e+=i.charAt(s>>20&15)+i.charAt(s>>16&15),e+=i.charAt(s>>28&15)+i.charAt(s>>24&15)}return e},rol:function(t,e){return t<<e|t>>>32-e},cmn:function(t,e,i,n,s,r){return this.addme(this.rol(this.addme(this.addme(e,t),this.addme(n,r)),s),i)},ff:function(t,e,i,n,s,r,a){return this.cmn(this.bitOR(this.bitAND(e,i),this.bitAND(~e,n)),t,e,s,r,a)},gg:function(t,e,i,n,s,r,a){return this.cmn(this.bitOR(this.bitAND(e,n),this.bitAND(i,~n)),t,e,s,r,a)},hh:function(t,e,i,n,s,r,a){return this.cmn(this.bitXOR(this.bitXOR(e,i),n),t,e,s,r,a)},ii:function(t,e,i,n,s,r,a){return this.cmn(this.bitXOR(i,this.bitOR(e,~n)),t,e,s,r,a)},doEncode:function(t){for(var e=1732584193,i=-271733879,n=-1732584194,s=271733878,r=0;r<t.length;){var a=e,A=i,h=n,o=s;0,e=this.ff(e,i,n,s,t[r],7,-680876936),s=this.ff(s,e,i,n,t[r+1],12,-389564586),n=this.ff(n,s,e,i,t[r+2],17,606105819),i=this.ff(i,n,s,e,t[r+3],22,-1044525330),e=this.ff(e,i,n,s,t[r+4],7,-176418897),s=this.ff(s,e,i,n,t[r+5],12,1200080426),n=this.ff(n,s,e,i,t[r+6],17,-1473231341),i=this.ff(i,n,s,e,t[r+7],22,-45705983),e=this.ff(e,i,n,s,t[r+8],7,1770035416),s=this.ff(s,e,i,n,t[r+9],12,-1958414417),n=this.ff(n,s,e,i,t[r+10],17,-42063),i=this.ff(i,n,s,e,t[r+11],22,-1990404162),e=this.ff(e,i,n,s,t[r+12],7,1804603682),s=this.ff(s,e,i,n,t[r+13],12,-40341101),n=this.ff(n,s,e,i,t[r+14],17,-1502002290),i=this.ff(i,n,s,e,t[r+15],22,1236535329),e=this.gg(e,i,n,s,t[r+1],5,-165796510),s=this.gg(s,e,i,n,t[r+6],9,-1069501632),n=this.gg(n,s,e,i,t[r+11],14,643717713),i=this.gg(i,n,s,e,t[r],20,-373897302),e=this.gg(e,i,n,s,t[r+5],5,-701558691),s=this.gg(s,e,i,n,t[r+10],9,38016083),n=this.gg(n,s,e,i,t[r+15],14,-660478335),i=this.gg(i,n,s,e,t[r+4],20,-405537848),e=this.gg(e,i,n,s,t[r+9],5,568446438),s=this.gg(s,e,i,n,t[r+14],9,-1019803690),n=this.gg(n,s,e,i,t[r+3],14,-187363961),i=this.gg(i,n,s,e,t[r+8],20,1163531501),e=this.gg(e,i,n,s,t[r+13],5,-1444681467),s=this.gg(s,e,i,n,t[r+2],9,-51403784),n=this.gg(n,s,e,i,t[r+7],14,1735328473),i=this.gg(i,n,s,e,t[r+12],20,-1926607734),e=this.hh(e,i,n,s,t[r+5],4,-378558),s=this.hh(s,e,i,n,t[r+8],11,-2022574463),n=this.hh(n,s,e,i,t[r+11],16,1839030562),i=this.hh(i,n,s,e,t[r+14],23,-35309556),e=this.hh(e,i,n,s,t[r+1],4,-1530992060),s=this.hh(s,e,i,n,t[r+4],11,1272893353),n=this.hh(n,s,e,i,t[r+7],16,-155497632),i=this.hh(i,n,s,e,t[r+10],23,-1094730640),e=this.hh(e,i,n,s,t[r+13],4,681279174),s=this.hh(s,e,i,n,t[r],11,-358537222),n=this.hh(n,s,e,i,t[r+3],16,-722521979),i=this.hh(i,n,s,e,t[r+6],23,76029189),e=this.hh(e,i,n,s,t[r+9],4,-640364487),s=this.hh(s,e,i,n,t[r+12],11,-421815835),n=this.hh(n,s,e,i,t[r+15],16,530742520),i=this.hh(i,n,s,e,t[r+2],23,-995338651),e=this.ii(e,i,n,s,t[r],6,-198630844),s=this.ii(s,e,i,n,t[r+7],10,1126891415),n=this.ii(n,s,e,i,t[r+14],15,-1416354905),i=this.ii(i,n,s,e,t[r+5],21,-57434055),e=this.ii(e,i,n,s,t[r+12],6,1700485571),s=this.ii(s,e,i,n,t[r+3],10,-1894986606),n=this.ii(n,s,e,i,t[r+10],15,-1051523),i=this.ii(i,n,s,e,t[r+1],21,-2054922799),e=this.ii(e,i,n,s,t[r+8],6,1873313359),s=this.ii(s,e,i,n,t[r+15],10,-30611744),n=this.ii(n,s,e,i,t[r+6],15,-1560198380),i=this.ii(i,n,s,e,t[r+13],21,1309151649),e=this.ii(e,i,n,s,t[r+4],6,-145523070),s=this.ii(s,e,i,n,t[r+11],10,-1120210379),n=this.ii(n,s,e,i,t[r+2],15,718787259),i=this.ii(i,n,s,e,t[r+9],21,-343485551),e=this.addme(e,a),i=this.addme(i,A),n=this.addme(n,h),s=this.addme(s,o),r+=16}return[e,i,n,s]},__class__:Nn};var Yn=function(){};i["haxe.ds.ArraySort"]=Yn,Yn.__name__="haxe.ds.ArraySort",Yn.sort=function(t,e){Yn.rec(t,e,0,t.length)},Yn.rec=function(t,e,i,n){var s=i+n>>1;if(n-i<12){if(n<=i)return;for(var r=i+1,a=n;r<a;)for(var A=r++;A>i&&e(t[A],t[A-1])<0;)Yn.swap(t,A-1,A),--A}else Yn.rec(t,e,i,s),Yn.rec(t,e,s,n),Yn.doMerge(t,e,i,s,n,s-i,n-s)},Yn.doMerge=function(t,e,i,n,s,r,a){var A,h,o,l;if(0!=r&&0!=a)if(r+a!=2){r>a?(A=i+(o=r>>1),l=(h=Yn.lower(t,e,n,s,A))-n):(h=n+(l=a>>1),o=(A=Yn.upper(t,e,i,n,h))-i),Yn.rotate(t,e,A,n,h);var u=A+l;Yn.doMerge(t,e,i,A,u,o,l),Yn.doMerge(t,e,u,h,s,r-o,a-l)}else e(t[n],t[i])<0&&Yn.swap(t,n,i)},Yn.rotate=function(t,e,i,n,s){if(i!=n&&n!=s)for(var r=Yn.gcd(s-i,n-i);0!=r--;){for(var a=t[i+r],A=n-i,h=i+r,o=i+r+A;o!=i+r;)t[h]=t[o],h=o,s-o>A?o+=A:o=i+(A-(s-o));t[h]=a}},Yn.gcd=function(t,e){for(;0!=e;){var i=t%e;t=e,e=i}return t},Yn.upper=function(t,e,i,n,s){for(var r,a,A=n-i;A>0;)a=i+(r=A>>1),e(t[s],t[a])<0?A=r:(i=a+1,A=A-r-1);return i},Yn.lower=function(t,e,i,n,s){for(var r,a,A=n-i;A>0;)e(t[a=i+(r=A>>1)],t[s])<0?(i=a+1,A=A-r-1):A=r;return i},Yn.swap=function(t,e,i){var n=t[e];t[e]=t[i],t[i]=n};var Xn=function(){};i["haxe.ds.BalancedTree"]=Xn,Xn.__name__="haxe.ds.BalancedTree",Xn.__interfaces__=[Sn],Xn.iteratorLoop=function(t,e){null!=t&&(Xn.iteratorLoop(t.left,e),e.push(t.value),Xn.iteratorLoop(t.right,e))},Xn.prototype={set:function(t,e){this.root=this.setLoop(t,e,this.root)},get:function(t){for(var e=this.root;null!=e;){var i=this.compare(t,e.key);if(0==i)return e.value;e=i<0?e.left:e.right}return null},iterator:function(){var t=[];return Xn.iteratorLoop(this.root,t),new us(t)},setLoop:function(t,e,i){if(null==i)return new jn(null,t,e,null);var n=this.compare(t,i.key);if(0==n)return new jn(i.left,t,e,i.right,null==i?0:i._height);if(n<0){var s=this.setLoop(t,e,i.left);return this.balance(s,i.key,i.value,i.right)}var r=this.setLoop(t,e,i.right);return this.balance(i.left,i.key,i.value,r)},balance:function(t,e,i,n){var s=null==t?0:t._height,r=null==n?0:n._height;if(s>r+2){var a=t.left,A=t.right;return(null==a?0:a._height)>=(null==A?0:A._height)?new jn(t.left,t.key,t.value,new jn(t.right,e,i,n)):new jn(new jn(t.left,t.key,t.value,t.right.left),t.right.key,t.right.value,new jn(t.right.right,e,i,n))}if(r>s+2){a=n.right,A=n.left;return(null==a?0:a._height)>(null==A?0:A._height)?new jn(new jn(t,e,i,n.left),n.key,n.value,n.right):new jn(new jn(t,e,i,n.left.left),n.left.key,n.left.value,new jn(n.left.right,n.key,n.value,n.right))}return new jn(t,e,i,n,(s>r?s:r)+1)},compare:function(t,e){return f.compare(t,e)},__class__:Xn};var jn=function(t,e,i,n,s){if(null==s&&(s=-1),this.left=t,this.key=e,this.value=i,this.right=n,-1==s){var r,a=this.left,A=this.right;if((null==a?0:a._height)>(null==A?0:A._height))r=null==(a=this.left)?0:a._height;else r=null==(a=this.right)?0:a._height;this._height=r+1}else this._height=s};i["haxe.ds.TreeNode"]=jn,jn.__name__="haxe.ds.TreeNode",jn.prototype={__class__:jn};var Hn=function(){Xn.call(this)};i["haxe.ds.EnumValueMap"]=Hn,Hn.__name__="haxe.ds.EnumValueMap",Hn.__interfaces__=[Sn],Hn.__super__=Xn,Hn.prototype=r(Xn.prototype,{compare:function(t,e){var i=t._hx_index-e._hx_index;if(0!=i)return i;var n=m.enumParameters(t),s=m.enumParameters(e);return 0==n.length&&0==s.length?0:this.compareArgs(n,s)},compareArgs:function(t,e){var i=t.length-e.length;if(0!=i)return i;for(var n=0,s=t.length;n<s;){var r=n++,a=this.compareArg(t[r],e[r]);if(0!=a)return a}return 0},compareArg:function(t,e){return f.isEnumValue(t)&&f.isEnumValue(e)?this.compare(t,e):t instanceof Array&&e instanceof Array?this.compareArgs(t,e):f.compare(t,e)},__class__:Hn});var Wn=function(){this.h={}};i["haxe.ds.IntMap"]=Wn,Wn.__name__="haxe.ds.IntMap",Wn.__interfaces__=[Sn],Wn.prototype={remove:function(t){return!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(+e);return new us(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},__class__:Wn};var Zn=function(){this.length=0};i["haxe.ds.List"]=Zn,Zn.__name__="haxe.ds.List",Zn.prototype={add:function(t){var e=new Jn(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},push:function(t){var e=new Jn(t,this.h);this.h=e,null==this.q&&(this.q=e),this.length++},remove:function(t){for(var e=null,i=this.h;null!=i;){if(i.item==t)return null==e?this.h=i.next:e.next=i.next,this.q==i&&(this.q=e),this.length--,!0;e=i,i=i.next}return!1},__class__:Zn};var Jn=function(t,e){this.item=t,this.next=e};i["haxe.ds._List.ListNode"]=Jn,Jn.__name__="haxe.ds._List.ListNode",Jn.prototype={__class__:Jn};var qn=function(){this.h={__keys__:{}}};i["haxe.ds.ObjectMap"]=qn,qn.__name__="haxe.ds.ObjectMap",qn.__interfaces__=[Sn],qn.prototype={set:function(e,i){var n=e.__id__;null==n&&(n=e.__id__=t.$haxeUID++),this.h[n]=i,this.h.__keys__[n]=e},remove:function(t){var e=t.__id__;return null!=this.h.__keys__[e]&&(delete this.h[e],delete this.h.__keys__[e],!0)},keys:function(){var t=[];for(var e in this.h.__keys__)this.h.hasOwnProperty(e)&&t.push(this.h.__keys__[e]);return new us(t)},__class__:qn};var Kn=function(){this.h=Object.create(null)};i["haxe.ds.StringMap"]=Kn,Kn.__name__="haxe.ds.StringMap",Kn.__interfaces__=[Sn],Kn.prototype={__class__:Kn};var $n={blit:function(t,e,i,n,s){if(t==i){if(e<n)for(var r=e+s,a=n+s,A=0,h=s;A<h;){A++;--r,t[--a]=t[r]}else if(e>n)for(r=e,a=n,A=0,h=s;A<h;){A++;t[a]=t[r],++r,++a}}else for(A=0,h=s;A<h;){i[n+(r=A++)]=t[e+r]}}},ts=function(t,e,i){kn.call(this,t,e),this.posInfos=null==i?{fileName:"(unknown)",lineNumber:0,className:"(unknown)",methodName:"(unknown)"}:i};i["haxe.exceptions.PosException"]=ts,ts.__name__="haxe.exceptions.PosException",ts.__super__=kn,ts.prototype=r(kn.prototype,{toString:function(){return kn.prototype.toString.call(this)+" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber},__class__:ts});var es=function(t,e,i){null==t&&(t="Not implemented"),ts.call(this,t,e,i)};i["haxe.exceptions.NotImplementedException"]=es,es.__name__="haxe.exceptions.NotImplementedException",es.__super__=ts,es.prototype=r(ts.prototype,{__class__:es});var is=function(){this.pos=0,this.size=0};i["haxe.io.BytesBuffer"]=is,is.__name__="haxe.io.BytesBuffer",is.prototype={addByte:function(t){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,t)},add:function(t){if(this.pos+t.length>this.size&&this.grow(t.length),0!=this.size){var e=new Uint8Array(t.b.buffer,t.b.byteOffset,t.length);this.u8.set(e,this.pos),this.pos+=t.length}},addInt32:function(t){this.pos+4>this.size&&this.grow(4),this.view.setInt32(this.pos,t,!0),this.pos+=4},addFloat:function(t){this.pos+4>this.size&&this.grow(4),this.view.setFloat32(this.pos,t,!0),this.pos+=4},addDouble:function(t){this.pos+8>this.size&&this.grow(8),this.view.setFloat64(this.pos,t,!0),this.pos+=8},addBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw kn.thrown(hs.OutsideBounds);if(this.pos+i>this.size&&this.grow(i),0!=this.size){var n=new Uint8Array(t.b.buffer,t.b.byteOffset+e,i);this.u8.set(n,this.pos),this.pos+=i}},grow:function(t){for(var e=this.pos+t,i=0==this.size?16:this.size;i<e;)i=3*i>>1;var n=new ArrayBuffer(i),s=new Uint8Array(n);this.size>0&&s.set(this.u8),this.size=i,this.buffer=n,this.u8=s,this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new Qn(new ArrayBuffer(0));var t=new Qn(this.buffer);return t.length=this.pos,t},__class__:is};var ns=function(){};i["haxe.io.Input"]=ns,ns.__name__="haxe.io.Input",ns.prototype={readByte:function(){throw new es(null,null,{fileName:"haxe/io/Input.hx",lineNumber:53,className:"haxe.io.Input",methodName:"readByte"})},readBytes:function(t,e,i){var n=i,s=t.b;if(e<0||i<0||e+i>t.length)throw kn.thrown(hs.OutsideBounds);try{for(;n>0;)s[e]=this.readByte(),++e,--n}catch(t){if(!(kn.caught(t).unwrap()instanceof As))throw t}return i-n},set_bigEndian:function(t){return this.bigEndian=t,t},readFullBytes:function(t,e,i){for(;i>0;){var n=this.readBytes(t,e,i);if(0==n)throw kn.thrown(hs.Blocked);e+=n,i-=n}},read:function(t){for(var e=new Qn(new ArrayBuffer(t)),i=0;t>0;){var n=this.readBytes(e,i,t);if(0==n)throw kn.thrown(hs.Blocked);i+=n,t-=n}return e},readLine:function(){var t,e,i=new is;try{for(;10!=(t=this.readByte());)i.addByte(t);e=i.getBytes().toString(),13==l.cca(e,e.length-1)&&(e=l.substr(e,0,-1))}catch(t){var n=kn.caught(t).unwrap();if(!(n instanceof As))throw t;var s=n;if(0==(e=i.getBytes().toString()).length)throw kn.thrown(s)}return e},readFloat:function(){return os.i32ToFloat(this.readInt32())},readDouble:function(){var t=this.readInt32(),e=this.readInt32();return this.bigEndian?os.i64ToDouble(e,t):os.i64ToDouble(t,e)},readInt16:function(){var t=this.readByte(),e=this.readByte(),i=this.bigEndian?e|t<<8:t|e<<8;return 0!=(32768&i)?i-65536:i},readUInt16:function(){var t=this.readByte(),e=this.readByte();return this.bigEndian?e|t<<8:t|e<<8},readUInt24:function(){var t=this.readByte(),e=this.readByte(),i=this.readByte();return this.bigEndian?i|e<<8|t<<16:t|e<<8|i<<16},readInt32:function(){var t=this.readByte(),e=this.readByte(),i=this.readByte(),n=this.readByte();return this.bigEndian?n|i<<8|e<<16|t<<24:t|e<<8|i<<16|n<<24},readString:function(t,e){var i=new Qn(new ArrayBuffer(t));return this.readFullBytes(i,0,t),i.getString(0,t,e)},__class__:ns};var ss=function(t,e,i){if(null==e&&(e=0),null==i&&(i=t.length-e),e<0||i<0||e+i>t.length)throw kn.thrown(hs.OutsideBounds);this.b=t.b,this.pos=e,this.len=i,this.totlen=i};i["haxe.io.BytesInput"]=ss,ss.__name__="haxe.io.BytesInput",ss.__super__=ns,ss.prototype=r(ns.prototype,{readByte:function(){if(0==this.len)throw kn.thrown(new As);return this.len--,this.b[this.pos++]},readBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw kn.thrown(hs.OutsideBounds);if(0==this.len&&i>0)throw kn.thrown(new As);this.len<i&&(i=this.len);for(var n=this.b,s=t.b,r=0,a=i;r<a;){var A=r++;s[e+A]=n[this.pos+A]}return this.pos+=i,this.len-=i,i},__class__:ss});var rs=function(){};i["haxe.io.Output"]=rs,rs.__name__="haxe.io.Output",rs.prototype={writeByte:function(t){throw new es(null,null,{fileName:"haxe/io/Output.hx",lineNumber:47,className:"haxe.io.Output",methodName:"writeByte"})},writeBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw kn.thrown(hs.OutsideBounds);for(var n=t.b,s=i;s>0;)this.writeByte(n[e]),++e,--s;return i},flush:function(){},close:function(){},set_bigEndian:function(t){return this.bigEndian=t,t},write:function(t){for(var e=t.length,i=0;e>0;){var n=this.writeBytes(t,i,e);if(0==n)throw kn.thrown(hs.Blocked);i+=n,e-=n}},writeFullBytes:function(t,e,i){for(;i>0;){var n=this.writeBytes(t,e,i);e+=n,i-=n}},writeInt32:function(t){this.bigEndian?(this.writeByte(t>>>24),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)):(this.writeByte(255&t),this.writeByte(t>>8&255),this.writeByte(t>>16&255),this.writeByte(t>>>24))},writeString:function(t,e){var i=Qn.ofString(t,e);this.writeFullBytes(i,0,i.length)},__class__:rs};var as=function(){this.b=new is};i["haxe.io.BytesOutput"]=as,as.__name__="haxe.io.BytesOutput",as.__super__=rs,as.prototype=r(rs.prototype,{writeByte:function(t){this.b.addByte(t)},writeBytes:function(t,e,i){return this.b.addBytes(t,e,i),i},getBytes:function(){return this.b.getBytes()},__class__:as});var As=function(){};i["haxe.io.Eof"]=As,As.__name__="haxe.io.Eof",As.prototype={toString:function(){return"Eof"},__class__:As};var hs=s["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:(e=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:n}},e._hx_name="Custom",e.__params__=["e"],e)};hs.__constructs__=[hs.Blocked,hs.Overflow,hs.OutsideBounds,hs.Custom],hs.__empty_constructs__=[hs.Blocked,hs.Overflow,hs.OutsideBounds];var os=function(){};i["haxe.io.FPHelper"]=os,os.__name__="haxe.io.FPHelper",os.i32ToFloat=function(t){return os.helper.setInt32(0,t,!0),os.helper.getFloat32(0,!0)},os.floatToI32=function(t){return os.helper.setFloat32(0,t,!0),os.helper.getInt32(0,!0)},os.i64ToDouble=function(t,e){return os.helper.setInt32(0,t,!0),os.helper.setInt32(4,e,!0),os.helper.getFloat64(0,!0)};var ls=function(t){switch(t){case".":case"..":return this.dir=t,void(this.file="")}var e=t.lastIndexOf("/"),i=t.lastIndexOf("\\");e<i?(this.dir=l.substr(t,0,i),t=l.substr(t,i+1,null),this.backslash=!0):i<e?(this.dir=l.substr(t,0,e),t=l.substr(t,e+1,null)):this.dir=null;var n=t.lastIndexOf(".");-1!=n?(this.ext=l.substr(t,n+1,null),this.file=l.substr(t,0,n)):(this.ext=null,this.file=t)};i["haxe.io.Path"]=ls,ls.__name__="haxe.io.Path",ls.extension=function(t){var e=new ls(t);return null==e.ext?"":e.ext},ls.prototype={__class__:ls};var us=function(t){this.current=0,this.array=t};i["haxe.iterators.ArrayIterator"]=us,us.__name__="haxe.iterators.ArrayIterator",us.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:us};var _s=s["haxe.macro.Binop"]={__ename__:!0,__constructs__:null,OpAdd:{_hx_name:"OpAdd",_hx_index:0,__enum__:"haxe.macro.Binop",toString:n},OpMult:{_hx_name:"OpMult",_hx_index:1,__enum__:"haxe.macro.Binop",toString:n},OpDiv:{_hx_name:"OpDiv",_hx_index:2,__enum__:"haxe.macro.Binop",toString:n},OpSub:{_hx_name:"OpSub",_hx_index:3,__enum__:"haxe.macro.Binop",toString:n},OpAssign:{_hx_name:"OpAssign",_hx_index:4,__enum__:"haxe.macro.Binop",toString:n},OpEq:{_hx_name:"OpEq",_hx_index:5,__enum__:"haxe.macro.Binop",toString:n},OpNotEq:{_hx_name:"OpNotEq",_hx_index:6,__enum__:"haxe.macro.Binop",toString:n},OpGt:{_hx_name:"OpGt",_hx_index:7,__enum__:"haxe.macro.Binop",toString:n},OpGte:{_hx_name:"OpGte",_hx_index:8,__enum__:"haxe.macro.Binop",toString:n},OpLt:{_hx_name:"OpLt",_hx_index:9,__enum__:"haxe.macro.Binop",toString:n},OpLte:{_hx_name:"OpLte",_hx_index:10,__enum__:"haxe.macro.Binop",toString:n},OpAnd:{_hx_name:"OpAnd",_hx_index:11,__enum__:"haxe.macro.Binop",toString:n},OpOr:{_hx_name:"OpOr",_hx_index:12,__enum__:"haxe.macro.Binop",toString:n},OpXor:{_hx_name:"OpXor",_hx_index:13,__enum__:"haxe.macro.Binop",toString:n},OpBoolAnd:{_hx_name:"OpBoolAnd",_hx_index:14,__enum__:"haxe.macro.Binop",toString:n},OpBoolOr:{_hx_name:"OpBoolOr",_hx_index:15,__enum__:"haxe.macro.Binop",toString:n},OpShl:{_hx_name:"OpShl",_hx_index:16,__enum__:"haxe.macro.Binop",toString:n},OpShr:{_hx_name:"OpShr",_hx_index:17,__enum__:"haxe.macro.Binop",toString:n},OpUShr:{_hx_name:"OpUShr",_hx_index:18,__enum__:"haxe.macro.Binop",toString:n},OpMod:{_hx_name:"OpMod",_hx_index:19,__enum__:"haxe.macro.Binop",toString:n},OpAssignOp:(e=function(t){return{_hx_index:20,op:t,__enum__:"haxe.macro.Binop",toString:n}},e._hx_name="OpAssignOp",e.__params__=["op"],e),OpInterval:{_hx_name:"OpInterval",_hx_index:21,__enum__:"haxe.macro.Binop",toString:n},OpArrow:{_hx_name:"OpArrow",_hx_index:22,__enum__:"haxe.macro.Binop",toString:n},OpIn:{_hx_name:"OpIn",_hx_index:23,__enum__:"haxe.macro.Binop",toString:n}};_s.__constructs__=[_s.OpAdd,_s.OpMult,_s.OpDiv,_s.OpSub,_s.OpAssign,_s.OpEq,_s.OpNotEq,_s.OpGt,_s.OpGte,_s.OpLt,_s.OpLte,_s.OpAnd,_s.OpOr,_s.OpXor,_s.OpBoolAnd,_s.OpBoolOr,_s.OpShl,_s.OpShr,_s.OpUShr,_s.OpMod,_s.OpAssignOp,_s.OpInterval,_s.OpArrow,_s.OpIn],_s.__empty_constructs__=[_s.OpAdd,_s.OpMult,_s.OpDiv,_s.OpSub,_s.OpAssign,_s.OpEq,_s.OpNotEq,_s.OpGt,_s.OpGte,_s.OpLt,_s.OpLte,_s.OpAnd,_s.OpOr,_s.OpXor,_s.OpBoolAnd,_s.OpBoolOr,_s.OpShl,_s.OpShr,_s.OpUShr,_s.OpMod,_s.OpInterval,_s.OpArrow,_s.OpIn];var cs=s["haxe.macro.Unop"]={__ename__:!0,__constructs__:null,OpIncrement:{_hx_name:"OpIncrement",_hx_index:0,__enum__:"haxe.macro.Unop",toString:n},OpDecrement:{_hx_name:"OpDecrement",_hx_index:1,__enum__:"haxe.macro.Unop",toString:n},OpNot:{_hx_name:"OpNot",_hx_index:2,__enum__:"haxe.macro.Unop",toString:n},OpNeg:{_hx_name:"OpNeg",_hx_index:3,__enum__:"haxe.macro.Unop",toString:n},OpNegBits:{_hx_name:"OpNegBits",_hx_index:4,__enum__:"haxe.macro.Unop",toString:n},OpSpread:{_hx_name:"OpSpread",_hx_index:5,__enum__:"haxe.macro.Unop",toString:n}};cs.__constructs__=[cs.OpIncrement,cs.OpDecrement,cs.OpNot,cs.OpNeg,cs.OpNegBits,cs.OpSpread],cs.__empty_constructs__=[cs.OpIncrement,cs.OpDecrement,cs.OpNot,cs.OpNeg,cs.OpNegBits,cs.OpSpread];var ds=function(){};i["haxe.zip.Compress"]=ds,ds.__name__="haxe.zip.Compress",ds.run=function(t,e){throw new es("Not implemented for this platform",null,{fileName:"haxe/zip/Compress.hx",lineNumber:39,className:"haxe.zip.Compress",methodName:"run"})};var fs=s["haxe.zip.Huffman"]={__ename__:!0,__constructs__:null,Found:(e=function(t){return{_hx_index:0,i:t,__enum__:"haxe.zip.Huffman",toString:n}},e._hx_name="Found",e.__params__=["i"],e),NeedBit:(e=function(t,e){return{_hx_index:1,left:t,right:e,__enum__:"haxe.zip.Huffman",toString:n}},e._hx_name="NeedBit",e.__params__=["left","right"],e),NeedBits:(e=function(t,e){return{_hx_index:2,n:t,table:e,__enum__:"haxe.zip.Huffman",toString:n}},e._hx_name="NeedBits",e.__params__=["n","table"],e)};fs.__constructs__=[fs.Found,fs.NeedBit,fs.NeedBits],fs.__empty_constructs__=[];var xs=function(){};i["haxe.zip.HuffTools"]=xs,xs.__name__="haxe.zip.HuffTools",xs.prototype={treeDepth:function(t){switch(t._hx_index){case 0:t.i;return 0;case 1:var e=t.left,i=t.right,n=this.treeDepth(e),s=this.treeDepth(i);return 1+(n<s?n:s);case 2:t.n,t.table;throw kn.thrown("assert")}},treeCompress:function(t){var e=this.treeDepth(t);if(0==e)return t;if(1==e){if(1==t._hx_index){var i=t.left,n=t.right;return fs.NeedBit(this.treeCompress(i),this.treeCompress(n))}throw kn.thrown("assert")}for(var s=[],r=0,a=1<<e;r<a;){r++;s.push(fs.Found(-1))}return this.treeWalk(s,0,0,e,t),fs.NeedBits(e,s)},treeWalk:function(t,e,i,n,s){if(1==s._hx_index){var r=s.left,a=s.right;n>0?(this.treeWalk(t,e,i+1,n-1,r),this.treeWalk(t,e|1<<i,i+1,n-1,a)):t[e]=this.treeCompress(s)}else t[e]=this.treeCompress(s)},treeMake:function(t,e,i,n){if(n>e)throw kn.thrown("Invalid huffman");var s=i<<5|n;return t.h.hasOwnProperty(s)?fs.Found(t.h[s]):(i<<=1,++n,fs.NeedBit(this.treeMake(t,e,i,n),this.treeMake(t,e,1|i,n)))},make:function(t,e,i,n){if(1==i)return fs.NeedBit(fs.Found(0),fs.Found(0));var s=[],r=[];if(n>32)throw kn.thrown("Invalid huffman");for(var a=0,A=n;a<A;){var h=a++;s.push(0),r.push(0)}for(a=0,A=i;a<A;){var o=t[(h=a++)+e];if(o>=n)throw kn.thrown("Invalid huffman");s[o]++}var l=0;for(a=1,A=n-1;a<A;){l=l+s[h=a++]<<1,r[h]=l}var u=new Wn;for(a=0,A=i;a<A;){var _=t[(h=a++)+e];if(0!=_){var c=r[_-1];r[_-1]=c+1,u.h[c<<5|_]=h}}return this.treeCompress(fs.NeedBit(this.treeMake(u,n,0,1),this.treeMake(u,n,1,1)))},__class__:xs};var ps=function(t){this.buffer=new Qn(new ArrayBuffer(65536)),this.pos=0,t&&(this.crc=new Vn)};i["haxe.zip._InflateImpl.Window"]=ps,ps.__name__="haxe.zip._InflateImpl.Window",ps.prototype={slide:function(){null!=this.crc&&this.crc.update(this.buffer,0,32768);var t=new Qn(new ArrayBuffer(65536));this.pos-=32768,t.blit(0,this.buffer,32768,this.pos),this.buffer=t},addBytes:function(t,e,i){this.pos+i>65536&&this.slide(),this.buffer.blit(this.pos,t,e,i),this.pos+=i},addByte:function(t){65536==this.pos&&this.slide(),this.buffer.b[this.pos]=t,this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){return null!=this.crc&&this.crc.update(this.buffer,0,this.pos),this.crc},__class__:ps};var gs=s["haxe.zip._InflateImpl.State"]={__ename__:!0,__constructs__:null,Head:{_hx_name:"Head",_hx_index:0,__enum__:"haxe.zip._InflateImpl.State",toString:n},Block:{_hx_name:"Block",_hx_index:1,__enum__:"haxe.zip._InflateImpl.State",toString:n},CData:{_hx_name:"CData",_hx_index:2,__enum__:"haxe.zip._InflateImpl.State",toString:n},Flat:{_hx_name:"Flat",_hx_index:3,__enum__:"haxe.zip._InflateImpl.State",toString:n},Crc:{_hx_name:"Crc",_hx_index:4,__enum__:"haxe.zip._InflateImpl.State",toString:n},Dist:{_hx_name:"Dist",_hx_index:5,__enum__:"haxe.zip._InflateImpl.State",toString:n},DistOne:{_hx_name:"DistOne",_hx_index:6,__enum__:"haxe.zip._InflateImpl.State",toString:n},Done:{_hx_name:"Done",_hx_index:7,__enum__:"haxe.zip._InflateImpl.State",toString:n}};gs.__constructs__=[gs.Head,gs.Block,gs.CData,gs.Flat,gs.Crc,gs.Dist,gs.DistOne,gs.Done],gs.__empty_constructs__=[gs.Head,gs.Block,gs.CData,gs.Flat,gs.Crc,gs.Dist,gs.DistOne,gs.Done];var ms=function(t,e,i){null==i&&(i=!0),null==e&&(e=!0),this.isFinal=!1,this.htools=new xs,this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.len=0,this.dist=0,this.state=e?gs.Head:gs.Block,this.input=t,this.bits=0,this.nbits=0,this.needed=0,this.output=null,this.outpos=0,this.lengths=[],this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.window=new ps(i)};i["haxe.zip.InflateImpl"]=ms,ms.__name__="haxe.zip.InflateImpl",ms.run=function(t,e){null==e&&(e=65536);for(var i=new Qn(new ArrayBuffer(e)),n=new is,s=new ms(t);;){var r=s.readBytes(i,0,e);if(n.addBytes(i,0,r),r<e)break}return n.getBytes()},ms.prototype={buildFixedHuffman:function(){if(null!=ms.FIXED_HUFFMAN)return ms.FIXED_HUFFMAN;for(var t=[],e=0;e<288;){var i=e++;t.push(i<=143?8:i<=255?9:i<=279?7:8)}return ms.FIXED_HUFFMAN=this.htools.make(t,0,288,10)},readBytes:function(t,e,i){if(this.needed=i,this.outpos=e,this.output=t,i>0)for(;this.inflateLoop(););return i-this.needed},getBits:function(t){for(;this.nbits<t;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var e=this.bits&(1<<t)-1;return this.nbits-=t,this.bits>>=t,e},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var t=1==(1&this.bits);return this.nbits--,this.bits>>=1,t},getRevBits:function(t){return 0==t?0:this.getBit()?1<<t-1|this.getRevBits(t-1):this.getRevBits(t-1)},resetBits:function(){this.bits=0,this.nbits=0},addBytes:function(t,e,i){this.window.addBytes(t,e,i),this.output.blit(this.outpos,t,e,i),this.needed-=i,this.outpos+=i},addByte:function(t){this.window.addByte(t),this.output.b[this.outpos]=t,this.needed--,this.outpos++},addDistOne:function(t){for(var e=this.window.getLastChar(),i=0,n=t;i<n;){i++;this.addByte(e)}},addDist:function(t,e){this.addBytes(this.window.buffer,this.window.pos-t,e)},applyHuffman:function(t){switch(t._hx_index){case 0:return n=t.i;case 1:var e=t.left,i=t.right;return this.applyHuffman(this.getBit()?i:e);case 2:var n=t.n,s=t.table;return this.applyHuffman(s[this.getBits(n)])}},inflateLengths:function(t,e){for(var i=0,n=0;i<e;){var s=this.applyHuffman(this.huffman);switch(s){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:n=s,t[i]=s,++i;break;case 16:var r=i+3+this.getBits(2);if(r>e)throw kn.thrown("Invalid data");for(;i<r;)t[i]=n,++i;break;case 17:if((i+=3+this.getBits(3))>e)throw kn.thrown("Invalid data");break;case 18:if((i+=11+this.getBits(7))>e)throw kn.thrown("Invalid data");break;default:throw kn.thrown("Invalid data")}}},inflateLoop:function(){switch(this.state._hx_index){case 0:var t=this.input.readByte();if(8!=(15&t))throw kn.thrown("Invalid data");var e=this.input.readByte(),i=0!=(32&e);if(((t<<8)+e)%31!=0)throw kn.thrown("Invalid data");if(i)throw kn.thrown("Unsupported dictionary");return this.state=gs.Block,!0;case 1:switch(this.isFinal=this.getBit(),this.getBits(2)){case 0:if(this.len=this.input.readUInt16(),this.input.readUInt16()!=65535-this.len)throw kn.thrown("Invalid data");this.state=gs.Flat;var n=this.inflateLoop();return this.resetBits(),n;case 1:return this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.state=gs.CData,!0;case 2:for(var s=this.getBits(5)+257,r=this.getBits(5)+1,a=this.getBits(4)+4,A=0,h=a;A<h;){var o=A++;this.lengths[ms.CODE_LENGTHS_POS[o]]=this.getBits(3)}for(A=a,h=19;A<h;){o=A++;this.lengths[ms.CODE_LENGTHS_POS[o]]=0}this.huffman=this.htools.make(this.lengths,0,19,8);var l=[];for(A=0,h=s+r;A<h;){o=A++;l.push(0)}return this.inflateLengths(l,s+r),this.huffdist=this.htools.make(l,s,r,16),this.huffman=this.htools.make(l,0,s,16),this.state=gs.CData,!0;default:throw kn.thrown("Invalid data")}break;case 2:var u=this.applyHuffman(this.huffman);if(u<256)return this.addByte(u),this.needed>0;if(256==u)return this.state=this.isFinal?gs.Crc:gs.Block,!0;var _=ms.LEN_EXTRA_BITS_TBL[u-=257];if(-1==_)throw kn.thrown("Invalid data");this.len=ms.LEN_BASE_VAL_TBL[u]+this.getBits(_);var c=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);if(-1==(_=ms.DIST_EXTRA_BITS_TBL[c]))throw kn.thrown("Invalid data");if(this.dist=ms.DIST_BASE_VAL_TBL[c]+this.getBits(_),this.dist>this.window.available())throw kn.thrown("Invalid data");return this.state=1==this.dist?gs.DistOne:gs.Dist,!0;case 3:var d=this.len<this.needed?this.len:this.needed,f=this.input.read(d);return this.len-=d,this.addBytes(f,0,d),0==this.len&&(this.state=this.isFinal?gs.Crc:gs.Block),this.needed>0;case 4:var x=this.window.checksum();if(null==x)return this.state=gs.Done,!0;var p=Vn.read(this.input);if(!x.equals(p))throw kn.thrown("Invalid CRC");return this.state=gs.Done,!0;case 5:for(;this.len>0&&this.needed>0;){var g=this.len<this.dist?this.len:this.dist;d=this.needed<g?this.needed:g;this.addDist(this.dist,d),this.len-=d}return 0==this.len&&(this.state=gs.CData),this.needed>0;case 6:d=this.len<this.needed?this.len:this.needed;return this.addDistOne(d),this.len-=d,0==this.len&&(this.state=gs.CData),this.needed>0;case 7:return!1}},__class__:ms};var vs=function(){};i["haxe.zip.Uncompress"]=vs,vs.__name__="haxe.zip.Uncompress",vs.run=function(t,e){return ms.run(new ss(t),e)};var ys=function(t,e){if(-101!=t||-102!=e){var i=window.document.createElement("canvas");i.width=t,i.height=e,this.ctx=i.getContext("2d",null)}};i["hxd.BitmapData"]=ys,ys.__name__="hxd.BitmapData",ys.notImplemented=function(){throw kn.thrown("Not implemented")},ys.fromNative=function(t){var e=new ys(-101,-102);return e.ctx=t,e},ys.prototype={clear:function(t){this.fill(0,0,this.ctx.canvas.width,this.ctx.canvas.height,t)},fill:function(t,e,i,n,s){this.ctx.fillStyle="rgba("+(s>>16&255)+", "+(s>>8&255)+", "+(255&s)+", "+(s>>>24)/255+")",this.ctx.fillRect(t,e,i,n)},draw:function(t,e,i,n,s,r,a,A){throw kn.thrown("Not implemented")},drawScaled:function(t,e,i,n,s,r,a,A,h,o,l){throw null==l&&(l=!0),null==o&&(o=et.Alpha),kn.thrown("Not implemented")},line:function(t,e,i,n,s){var r=i-t,a=n-e;if(0==r){if(n<e){var A=e;e=n,n=A}e<0&&(e=0),n>this.ctx.canvas.height-1&&(n=this.ctx.canvas.height-1);for(var h=e,o=n+1;h<o;){var l=h++;this.setPixel(t,l,s)}}else if(0==a){if(i<t){A=t;t=i,i=A}t<0&&(t=0),i>this.ctx.canvas.width-1&&(i=this.ctx.canvas.width-1);for(h=t,o=i+1;h<o;){var u=h++;this.setPixel(u,e,s)}}else{var _,c,d,f,x,p;if(t<i){if(t>=this.ctx.canvas.width||i<0)return;_=1,d=0,x=this.ctx.canvas.width-1}else{if(i>=this.ctx.canvas.width||t<0)return;_=-1,i=-i,t=-t,d=1-this.ctx.canvas.width,x=0}if(e<n){if(e>=this.ctx.canvas.height||n<0)return;c=1,f=0,p=this.ctx.canvas.height-1}else{if(n>=this.ctx.canvas.width||e<0)return;c=-1,n=-n,e=-e,f=1-this.ctx.canvas.height,p=0}var g=(r=i-t)<<1,m=(a=n-e)<<1;u=t,l=e;if(r>=a){var v=m-r,y=!1;if(e<f){if((u+=0|(B=(b=(b=g)*(f-e)-r)/m))>x)return;u>=d&&(v-=(0|(b-=B*m))+r,l=f,b>0&&(++u,v+=m),y=!0)}if(!y&&t<d){var b=m,w=(b*=d-t)/g;if(b%=g,(l+=0|w)>p||l==p&&b>r)return;u=d,v+=0|b,b>=r&&(++l,v-=g)}var M=i;if(n>p)M+=0|(B=(b=(b=g)*(p-n)+r)/m),b-B*m==0&&--M;for(M>x?M=x+1:++M,-1==_&&(u=-u,M=-M),-1==c&&(l=-l),g-=m;u!=M;)this.setPixel(u,l,s),v>=0?(l+=c,v-=g):v+=m,u+=_}else{v=g-a,y=!1;if(t<d){if((l+=0|(w=(b=(b=m)*(d-t)-a)/g))>p)return;l>=f&&(v-=(0|(b-=w*g))+a,u=d,b>0&&(++l,v+=g),y=!0)}if(!y&&e<f){b=g;var B=(b*=f-e)/m;if(b%=m,(u+=0|B)>x||u==x&&b>a)return;l=f,v+=0|b,b>=a&&(++u,v-=m)}var C=n;if(i>x)C+=0|(w=(b=(b=m)*(x-i)+a)/g),b-w*g==0&&--C;for(C>p?C=p+1:++C,-1==_&&(u=-u),-1==c&&(l=-l,C=-C),m-=g;l!=C;)this.setPixel(u,l,s),v>=0?(u+=_,v-=m):v+=g,l+=c}}},dispose:function(){this.ctx=null,this.pixel=null},clone:function(){return this.sub(0,0,this.ctx.canvas.width,this.ctx.canvas.height)},sub:function(t,e,i,n){var s=window.document.createElement("canvas");s.width=i,s.height=n;var r=s.getContext("2d",null);return r.drawImage(this.ctx.canvas,t,e,i,n,0,0,i,n),ys.fromNative(r)},lock:function(){null==this.lockImage&&(this.lockImage=this.ctx.getImageData(0,0,this.ctx.canvas.width,this.ctx.canvas.height))},unlock:function(){null!=this.lockImage&&(this.ctx.putImageData(this.lockImage,0,0),this.lockImage=null)},getPixel:function(t,e){var i,n=this.lockImage;return null!=n?i=t+e*n.width<<2:(i=0,n=this.ctx.getImageData(t,e,1,1)),n.data[i]<<16|n.data[1|i]<<8|n.data[2|i]|n.data[3|i]<<24},setPixel:function(t,e,i){var n;if(null!=(n=this.lockImage)){var s=t+e*n.width<<2;return n.data[s]=i>>16&255,n.data[1|s]=i>>8&255,n.data[2|s]=255&i,void(n.data[3|s]=i>>>24&255)}null==(n=this.pixel)&&(n=this.ctx.createImageData(1,1),this.pixel=n),n.data[0]=i>>16&255,n.data[1]=i>>8&255,n.data[2]=255&i,n.data[3]=i>>>24&255,this.ctx.putImageData(n,t,e)},get_width:function(){return this.ctx.canvas.width},get_height:function(){return this.ctx.canvas.height},getPixels:function(){var t=this.ctx.canvas.width,e=this.ctx.canvas.height,i=this.ctx.getImageData(0,0,t,e).data.buffer;return new Ps(t,e,Qn.ofData(i),$e.RGBA)},setPixels:function(t){if(t.width!=this.ctx.canvas.width||t.height!=this.ctx.canvas.height)throw kn.thrown("Invalid pixels size");t.setFlip(!1);var e=this.ctx.createImageData(t.width,t.height);t.convert($e.RGBA);for(var i=0,n=t.width*t.height*4;i<n;){var s=i++;e.data[s]=t.bytes.b[s]}this.ctx.putImageData(e,0,0)},toNative:function(){return this.ctx},toPNG:function(){var t=this.getPixels(),e=t.toPNG();return t.dispose(),e},__class__:ys};var bs=s["hxd.Cursor"]={__ename__:!0,__constructs__:null,Default:{_hx_name:"Default",_hx_index:0,__enum__:"hxd.Cursor",toString:n},Button:{_hx_name:"Button",_hx_index:1,__enum__:"hxd.Cursor",toString:n},Move:{_hx_name:"Move",_hx_index:2,__enum__:"hxd.Cursor",toString:n},TextInput:{_hx_name:"TextInput",_hx_index:3,__enum__:"hxd.Cursor",toString:n},Hide:{_hx_name:"Hide",_hx_index:4,__enum__:"hxd.Cursor",toString:n},Custom:(e=function(t){return{_hx_index:5,custom:t,__enum__:"hxd.Cursor",toString:n}},e._hx_name="Custom",e.__params__=["custom"],e),Callback:(e=function(t){return{_hx_index:6,f:t,__enum__:"hxd.Cursor",toString:n}},e._hx_name="Callback",e.__params__=["f"],e)};bs.__constructs__=[bs.Default,bs.Button,bs.Move,bs.TextInput,bs.Hide,bs.Custom,bs.Callback],bs.__empty_constructs__=[bs.Default,bs.Button,bs.Move,bs.TextInput,bs.Hide];var ws=function(t,e,i,n){this.frames=t,this.speed=e,this.offsetX=i,this.offsetY=n,this.frameDelay=1/e,this.frameTime=0,this.frameIndex=0};i["hxd.CustomCursor"]=ws,ws.__name__="hxd.CustomCursor",ws.getNativeCursor=function(t){var e=new ws([],0,0,0);return e.alloc=[t],bs.Custom(e)},ws.prototype={reset:function(){this.frameTime=0,this.frameIndex=0},update:function(t){for(var e=this.frameTime+t,i=this.frameDelay,n=this.frameIndex;e>=i;)e-=i,++n;return this.frameTime=e,n>=this.frames.length&&(n%=this.frames.length),n!=this.frameIndex?(this.frameIndex=n,n):-1},dispose:function(){for(var t=0,e=this.frames;t<e.length;){var i=e[t];++t,i.ctx=null,i.pixel=null}this.frames=[],null!=this.alloc&&(this.alloc=null)},__class__:ws};var Ms=s["hxd.EventKind"]={__ename__:!0,__constructs__:null,EPush:{_hx_name:"EPush",_hx_index:0,__enum__:"hxd.EventKind",toString:n},ERelease:{_hx_name:"ERelease",_hx_index:1,__enum__:"hxd.EventKind",toString:n},EMove:{_hx_name:"EMove",_hx_index:2,__enum__:"hxd.EventKind",toString:n},EOver:{_hx_name:"EOver",_hx_index:3,__enum__:"hxd.EventKind",toString:n},EOut:{_hx_name:"EOut",_hx_index:4,__enum__:"hxd.EventKind",toString:n},EWheel:{_hx_name:"EWheel",_hx_index:5,__enum__:"hxd.EventKind",toString:n},EFocus:{_hx_name:"EFocus",_hx_index:6,__enum__:"hxd.EventKind",toString:n},EFocusLost:{_hx_name:"EFocusLost",_hx_index:7,__enum__:"hxd.EventKind",toString:n},EKeyDown:{_hx_name:"EKeyDown",_hx_index:8,__enum__:"hxd.EventKind",toString:n},EKeyUp:{_hx_name:"EKeyUp",_hx_index:9,__enum__:"hxd.EventKind",toString:n},EReleaseOutside:{_hx_name:"EReleaseOutside",_hx_index:10,__enum__:"hxd.EventKind",toString:n},ETextInput:{_hx_name:"ETextInput",_hx_index:11,__enum__:"hxd.EventKind",toString:n},ECheck:{_hx_name:"ECheck",_hx_index:12,__enum__:"hxd.EventKind",toString:n}};Ms.__constructs__=[Ms.EPush,Ms.ERelease,Ms.EMove,Ms.EOver,Ms.EOut,Ms.EWheel,Ms.EFocus,Ms.EFocusLost,Ms.EKeyDown,Ms.EKeyUp,Ms.EReleaseOutside,Ms.ETextInput,Ms.ECheck],Ms.__empty_constructs__=[Ms.EPush,Ms.ERelease,Ms.EMove,Ms.EOver,Ms.EOut,Ms.EWheel,Ms.EFocus,Ms.EFocusLost,Ms.EKeyDown,Ms.EKeyUp,Ms.EReleaseOutside,Ms.ETextInput,Ms.ECheck];var Bs=function(t,e,i){null==i&&(i=0),null==e&&(e=0),this.button=0,this.kind=t,this.relX=e,this.relY=i};i["hxd.Event"]=Bs,Bs.__name__="hxd.Event",Bs.prototype={toString:function(){var t,e=x.string(this.kind)+"["+(0|this.relX)+","+(0|this.relY)+"]";switch(this.kind._hx_index){case 5:t=",wheelDelta="+this.wheelDelta;break;case 2:case 3:case 4:case 6:case 7:case 12:t="";break;case 8:case 9:t=",keyCode="+this.keyCode;break;case 0:case 1:case 10:t=",button="+this.button;break;case 11:t=",charCode="+this.charCode}return e+t},__class__:Bs};var Cs={_new:function(t){return{pos:t,array:new Float32Array(new ArrayBuffer(t<<2))}},get_length:function(t){return t.pos},set_length:function(t,e){if(t.pos!=e){var i=new Float32Array(e);i.set(t.array),t.array=i}return t.pos=e,e},push:function(t,e){if(t.pos==t.array.length){var i=t.array.length<<1;i<128&&(i=128);var n=new Float32Array(i);n.set(t.array),t.array=n}t.array[t.pos++]=e},get:function(t,e){return t.array[e]},set:function(t,e,i){return t.array[e]=i},toF32Array:function(t){return t.array},toArray:function(t){for(var e=[],i=0,n=t.pos;i<n;){var s=i++;e.push(t.array[s])}return e}},Ss=function(t){this.b=t,this.len=this.b.pos,this.pos=0};i["hxd._FloatBuffer.InnerIterator"]=Ss,Ss.__name__="hxd._FloatBuffer.InnerIterator",Ss.prototype={hasNext:function(){return this.pos<this.len},next:function(){return this.b.array[this.pos++]},__class__:Ss};var Is=function(t){this.b=t,this.len=this.b.length,this.pos=0};i["hxd._IndexBuffer.InnerIterator"]=Is,Is.__name__="hxd._IndexBuffer.InnerIterator",Is.prototype={hasNext:function(){return this.pos<this.len},next:function(){return this.b[this.pos++]},__class__:Is};var ks=function(){};i["hxd.Key"]=ks,ks.__name__="hxd.Key",ks.isDown=function(t){return ks.keyPressed[t]>0},ks.getFrame=function(){return Qs.frameCount+1},ks.isPressed=function(t){return ks.keyPressed[t]==Qs.frameCount+1-1},ks.isReleased=function(t){return ks.keyPressed[t]==1-(Qs.frameCount+1)},ks.initialize=function(){ks.initDone&&ks.dispose(),ks.initDone=!0,ks.keyPressed=[],Us.getInstance().addEventTarget(ks.onEvent)},ks.dispose=function(){ks.initDone&&(Us.getInstance().removeEventTarget(ks.onEvent),ks.initDone=!1,ks.keyPressed=[])},ks.onEvent=function(t){switch(t.kind._hx_index){case 0:t.button<5&&(ks.keyPressed[t.button]=Qs.frameCount+1);break;case 1:t.button<5&&(ks.keyPressed[t.button]=-(Qs.frameCount+1));break;case 5:ks.keyPressed[t.wheelDelta>0?6:5]=Qs.frameCount+1;break;case 8:if(!ks.ALLOW_KEY_REPEAT&&ks.keyPressed[t.keyCode]>0)return;ks.keyPressed[t.keyCode]=Qs.frameCount+1;break;case 9:ks.keyPressed[t.keyCode]=-(Qs.frameCount+1)}},ks.getKeyName=function(t){var e=t;switch(e){case 0:return"MouseLeft";case 1:return"MouseRight";case 2:return"MouseMiddle";case 3:return"Mouse3";case 4:return"Mouse4";case 8:return"Backspace";case 9:return"Tab";case 13:return"Enter";case 16:return"Shift";case 17:return"Ctrl";case 18:return"Alt";case 19:return"PauseBreak";case 20:return"CapsLock";case 27:return"Escape";case 32:return"Space";case 33:return"PageUp";case 34:return"PageDown";case 35:return"End";case 36:return"Home";case 37:return"Left";case 38:return"Up";case 39:return"Right";case 40:return"Down";case 45:return"Insert";case 46:return"Delete";case 91:return"LeftWindowKey";case 92:return"RightWindowKey";case 93:return"ContextMenu";case 106:return"NumPad*";case 107:return"NumPad+";case 108:return"NumPadEnter";case 109:return"NumPad-";case 110:return"NumPad.";case 111:return"NumPad/";case 144:return"NumLock";case 145:return"ScrollLock";case 186:return"Semicolon";case 187:return"Equals";case 188:return"Comma";case 189:return"Minus";case 190:return"Period";case 191:return"Slash";case 192:return"Tilde";case 219:return"BracketLeft";case 220:return"Backslash";case 221:return"BacketRight";case 222:return"Quote";case 226:return"IntlBackslash";case 272:return"LShift";case 273:return"LCtrl";case 274:return"LAlt";case 528:return"RShift";case 529:return"RCtrl";case 530:return"RAlt";default:return e>=48&&e<=57?""+(e-48):e>=96&&e<=105?"NumPad"+(e-96):e>=65&&e<=90?String.fromCodePoint(65+e-65):e>=112&&e<=135?"F"+(e-112+1):null}};var Es=function(){};i["hxd.Math"]=Es,Es.__name__="hxd.Math",Es.get_POSITIVE_INFINITY=function(){return 1/0},Es.get_NEGATIVE_INFINITY=function(){return-1/0},Es.get_NaN=function(){return NaN},Es.isNaN=function(t){return isNaN(t)},Es.fmt=function(t){var e;if(t<0?(e=-1,t=-t):e=1,isNaN(t)||!isFinite(t))return t;var i=4-Math.log(t)/Math.log(10)|0;if(i<1)i=1;else if(i>=10)return 0;var n=Math.pow(10,i);return Math.floor(t*n+.49999)*e/n},Es.floor=function(t){return Math.floor(t)},Es.ceil=function(t){return Math.ceil(t)},Es.round=function(t){return Math.round(t)},Es.clamp=function(t,e,i){return null==i&&(i=1),null==e&&(e=0),t<e?e:t>i?i:t},Es.pow=function(t,e){return Math.pow(t,e)},Es.cos=function(t){return Math.cos(t)},Es.sin=function(t){return Math.sin(t)},Es.tan=function(t){return Math.tan(t)},Es.acos=function(t){return Math.acos(t)},Es.asin=function(t){return Math.asin(t)},Es.atan=function(t){return Math.atan(t)},Es.sqrt=function(t){return Math.sqrt(t)},Es.invSqrt=function(t){return 1/Math.sqrt(t)},Es.atan2=function(t,e){return Math.atan2(t,e)},Es.abs=function(t){return t<0?-t:t},Es.max=function(t,e){return t<e?e:t},Es.min=function(t,e){return t>e?e:t},Es.iabs=function(t){return t<0?-t:t},Es.imax=function(t,e){return t<e?e:t},Es.imin=function(t,e){return t>e?e:t},Es.iclamp=function(t,e,i){return t<e?e:t>i?i:t},Es.lerp=function(t,e,i){return t+i*(e-t)},Es.lerpTime=function(t,e,i,n){return t+(1-Math.pow(1-i,n*Qs.wantedFPS))*(e-t)},Es.bitCount=function(t){return 16843009*((t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135)>>24},Es.isPOT=function(t){return 0==(t&t-1)},Es.nextPOT=function(t){return--t,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t},Es.distanceSq=function(t,e,i){return null==i&&(i=0),t*t+e*e+i*i},Es.distance=function(t,e,i){null==i&&(i=0);var n=i;return null==n&&(n=0),Math.sqrt(t*t+e*e+n*n)},Es.colorLerp=function(t,e,i){return((t>>>24)*(1-i)+(e>>>24)*i|0)<<24|((t>>16&255)*(1-i)+(e>>16&255)*i|0)<<16|((t>>8&255)*(1-i)+(e>>8&255)*i|0)<<8|((255&t)*(1-i)+(255&e)*i|0)},Es.angle=function(t){return(t%=6.283185307179586)>3.141592653589793?t-=6.283185307179586:t<=-3.141592653589793&&(t+=6.283185307179586),t},Es.angleLerp=function(t,e,i){var n=e-t;return(n%=6.283185307179586)>3.141592653589793?n-=6.283185307179586:n<=-3.141592653589793&&(n+=6.283185307179586),t+n*i},Es.angleMove=function(t,e,i){var n=e-t;(n%=6.283185307179586)>3.141592653589793?n-=6.283185307179586:n<=-3.141592653589793&&(n+=6.283185307179586);return n>-i&&n<i?e:t+(n<0?-i:i)},Es.valueMove=function(t,e,i){return t<e?(t+=i)>e&&(t=e):t>e&&(t-=i)<e&&(t=e),t},Es.shuffle=function(t){for(var e=t.length,i=0,n=e;i<n;){i++;var s=x.random(e),r=x.random(e),a=t[s];t[s]=t[r],t[r]=a}},Es.random=function(t){return null==t&&(t=1),Math.random()*t},Es.srand=function(t){return null==t&&(t=1),(Math.random()-.5)*(2*t)},Es.b2f=function(t){return.00392156862745098*(255&t)},Es.f2b=function(t){return 255*(t<0?0:t>1?1:t)|0},Es.umod=function(t,e){var i=t%e;return i>=0?i:i+e},Es.ufmod=function(t,e){var i=t%e;return i>=0?i:i+e},Es.degToRad=function(t){return 3.141592653589793*t/180},Es.radToDeg=function(t){return 180*t/3.141592653589793};var Fs=s["hxd.Flags"]={__ename__:!0,__constructs__:null,ReadOnly:{_hx_name:"ReadOnly",_hx_index:0,__enum__:"hxd.Flags",toString:n},AlphaPremultiplied:{_hx_name:"AlphaPremultiplied",_hx_index:1,__enum__:"hxd.Flags",toString:n},FlipY:{_hx_name:"FlipY",_hx_index:2,__enum__:"hxd.Flags",toString:n}};Fs.__constructs__=[Fs.ReadOnly,Fs.AlphaPremultiplied,Fs.FlipY],Fs.__empty_constructs__=[Fs.ReadOnly,Fs.AlphaPremultiplied,Fs.FlipY];var Ts={getPixel:function(t,e,i){var n=t.bytes.getInt32((e+i*t.width<<2)+t.offset);return n>>>24|n>>8&65280|n<<8&16711680|n<<24},setPixel:function(t,e,i,n){t.bytes.setInt32((e+i*t.width<<2)+t.offset,n>>>24|n>>8&65280|n<<8&16711680|n<<24)},fromPixels:function(t){return t.convert($e.ARGB),t.setFlip(!1),t}},Ds={toInt:function(t){return t},fromInt:function(t){return t}},Ps=function(t,e,i,n,s){null==s&&(s=0),this.width=t,this.height=e,this.bytes=i,this.set_innerFormat(n),this.offset=s;var r=0;null==r&&(r=0);var a=r;this.flags=a};i["hxd.Pixels"]=Ps,Ps.__name__="hxd.Pixels",Ps.switchEndian=function(t){return t>>>24|t>>8&65280|t<<8&16711680|t<<24},Ps.switchBR=function(t){return-16711936&t|t<<16&16711680|t>>16&255},Ps.calcDataSize=function(t,e,i){if(21==i._hx_index){i.v;return(e+3>>2<<2)*Ps.calcStride(t,i)}return e*Ps.calcStride(t,i)},Ps.calcStride=function(t,e){var i;switch(e._hx_index){case 3:case 20:case 10:i=8;break;case 4:i=16;break;case 5:i=1;break;case 7:case 9:case 0:case 1:case 2:case 14:case 15:case 16:case 17:i=4;break;case 8:case 6:case 18:i=2;break;case 11:i=3;break;case 12:case 19:i=6;break;case 13:i=12;break;case 21:var n=e.v,s=t+3>>2;return 1==n||4==n?s<<1:s<<2}return t*i},Ps.isFloatFormat=function(t){switch(t._hx_index){case 3:case 6:case 9:case 12:case 4:case 7:case 10:case 13:return!0;case 21:return 6==t.v;default:return!1}},Ps.getChannelOffset=function(t,e){switch(t._hx_index){case 0:return[1,2,3,0][e];case 1:return[2,1,0,3][e];case 3:case 20:return 2*e;case 4:return 4*e;case 5:case 6:case 7:case 18:return 0==e?0:-1;case 8:case 9:case 10:return[0,i=Ps.calcStride(1,t),-1,-1][e];case 11:case 12:case 13:case 19:var i;return[0,i=Ps.calcStride(1,t),i<<1,-1][e];case 2:case 14:case 15:return e;case 16:case 17:throw kn.thrown("Bit packed format");case 21:t.v;throw kn.thrown("Not supported")}},Ps.alloc=function(t,e,i){return new Ps(t,e,new Qn(new ArrayBuffer(Ps.calcDataSize(t,e,i))),i)},Ps.toDDS=function(t,e){if(null==e&&(e=!1),0==t.length)throw kn.thrown("Must contain at least one image");for(var i=t[0],n=i.innerFormat,s=[],r=0,a=0;a<t.length;){var A=t[a];if(++a,A.innerFormat!=n)throw kn.thrown("All images must be of the same pixel format");r+=A.dataSize;for(var h=!1,o=0;o<s.length;){var l=s[o];if(++o,l[0].width==A.width&&l[0].height==A.height){l.push(A),h=!0;break}}h||s.push([A])}s.sort((function(t,e){return e[0].width*e[0].height-t[0].width*t[0].height}));var u=s[0].length,_=s[0][0].width,c=s[0][0].height;for(a=1,o=s.length;a<o;){var d=s[B=a++];if(d.length!=u)throw kn.thrown("Invalid number of mipmaps at level "+B+": "+d.length+" should be "+u);var f=_>>B;0==f&&(f=1);var p=c>>B;0==p&&(p=1);var g=d[0].width,m=d[0].height;if(g!=f||m!=p)throw kn.thrown("Invalid mip level size "+B+": "+g+"x"+m+" should be "+f+"x"+p)}r+=128;var v=new Qn(new ArrayBuffer(r)),y=0;switch(v.setInt32(y,542327876),y+=4,v.setInt32(y,124),y+=4,v.setInt32(y,135183),y+=4,v.setInt32(y,_),y+=4,v.setInt32(y,c),y+=4,v.setInt32(y,i.stride),y+=4,v.setInt32(y,1),y+=4,v.setInt32(y,s.length),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,32),y+=4,n._hx_index){case 0:case 1:case 2:v.setInt32(y,65),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,32),y+=4;var b=Ps.getChannelOffset(n,0);v.setInt32(y,255<<8*b),y+=4;b=Ps.getChannelOffset(n,1);v.setInt32(y,255<<8*b),y+=4;b=Ps.getChannelOffset(n,2);v.setInt32(y,255<<8*b),y+=4;b=Ps.getChannelOffset(n,3);v.setInt32(y,255<<8*b),y+=4;break;default:var w;Ps.getChannelOffset(n,3);switch(v.setInt32(y,4),y+=4,n._hx_index){case 3:w=113;break;case 4:w=116;break;case 6:w=111;break;case 7:w=114;break;case 9:w=112;break;case 10:w=115;break;default:throw kn.thrown("Unsupported format "+x.string(n))}v.setInt32(y,w),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4}v.setInt32(y,4096|(1==t.length?0:8)|(1==s.length?0:4194304)),y+=4;var M=1536|(u>1?2048:0)|(u>2?4096:0)|(u>3?8192:0)|(u>4?16384:0)|(u>5?32768:0);v.setInt32(y,e?M:0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4,v.setInt32(y,0),y+=4;for(a=0,o=u;a<o;)for(var B=a++,C=0,S=s.length;C<S;){A=s[C++][B];v.blit(y,A.bytes,A.offset,A.dataSize),y+=A.dataSize}return v},Ps.prototype={get_format:function(){return this.innerFormat},set_innerFormat:function(t){return this.innerFormat=t,this.stride=Ps.calcStride(this.width,t),this.dataSize=Ps.calcDataSize(this.width,this.height,t),this.bytesPerPixel=Ps.calcStride(1,t),t},invalidFormat:function(){throw kn.thrown("Unsupported format for this operation : "+x.string(this.innerFormat))},sub:function(t,e,i,n){if(t<0||e<0||t+i>this.width||e+n>this.height)throw kn.thrown("Pixels.sub() outside bounds");for(var s=new Qn(new ArrayBuffer(n*this.stride)),r=Ps.calcStride(i,this.innerFormat),a=0,A=0,h=n;A<h;){var o=e+A++,l=(t+(0!=(this.flags&1<<Fs.FlipY._hx_index)?this.height-1-o:o)*this.width)*this.bytesPerPixel+this.offset;s.blit(a,this.bytes,l,r),a+=r}return new Ps(i,n,s,this.innerFormat)},yflip:function(t){return 0!=(this.flags&1<<Fs.FlipY._hx_index)?this.height-1-t:t},blit:function(t,e,i,n,s,r,a){if(t<0||e<0||t+r>this.width||e+a>this.height)throw kn.thrown("Pixels.blit() outside bounds");if(n<0||n<0||n+r>i.width||s+a>i.height)throw kn.thrown("Pixels.blit() outside src bounds");0!=(this.flags&1<<Fs.ReadOnly._hx_index)&&this.copyInner(),i.convert(this.innerFormat);var A=this.bytesPerPixel;if(0==A)throw kn.thrown("assert");for(var h=Ps.calcStride(r,this.innerFormat),o=0,l=a;o<l;){var u=o++,_=u+s,c=(n+(0!=(i.flags&1<<Fs.FlipY._hx_index)?i.height-1-_:_)*i.width)*A+i.offset,d=u+e,f=(t+(0!=(this.flags&1<<Fs.FlipY._hx_index)?this.height-1-d:d)*this.width)*A+this.offset;this.bytes.blit(f,i.bytes,c,h)}},clear:function(t,e){null==e&&(e=0);var i=e;if(0!=(this.flags&1<<Fs.ReadOnly._hx_index)&&this.copyInner(),(255&t)!=(t>>8&255)||(65535&t)!=t>>>16||0!=i){switch(this.innerFormat._hx_index){case 0:t=t>>>24|t>>8&65280|t<<8&16711680|t<<24,i=i>>>24|i>>8&65280|i<<8&16711680|i<<24;break;case 1:break;case 2:t=-16711936&t|t<<16&16711680|t>>16&255,i=-16711936&i|i<<16&16711680|i>>16&255;break;default:this.invalidFormat()}var n=this.offset;if(0==i)for(var s=0,r=this.width*this.height;s<r;){s++;this.bytes.setInt32(n,t),n+=4}else for(s=0,r=this.width*this.height;s<r;){s++;this.bytes.setInt32(n,t|this.bytes.getInt32(n)&i),n+=4}}else this.bytes.fill(this.offset,this.width*this.height*this.bytesPerPixel,255&t)},toVector:function(){var t=new Array(this.width*this.height),e=0,i=this.offset,n=0;switch(0!=(this.flags&1<<Fs.FlipY._hx_index)&&(i+=(this.height-1)*this.width*this.bytesPerPixel,n=2*-this.width*this.bytesPerPixel),this.innerFormat._hx_index){case 0:for(var s=0,r=this.height;s<r;){s++;for(var a=0,A=this.width;a<A;){a++;var h=this.bytes.getInt32(i);t[e++]=h>>>24|h>>8&65280|h<<8&16711680|h<<24,i+=4}i+=n}break;case 1:for(s=0,r=this.height;s<r;){for(s++,a=0,A=this.width;a<A;){a++;t[e++]=this.bytes.getInt32(i),i+=4}i+=n}break;case 2:for(s=0,r=this.height;s<r;){for(s++,a=0,A=this.width;a<A;){a++,h=this.bytes.getInt32(i);t[e++]=-16711936&h|h<<16&16711680|h>>16&255,i+=4}i+=n}break;default:this.invalidFormat()}return t},makeSquare:function(t){for(var e=this.width,i=this.height,n=0==e?0:1,s=0==i?0:1;n<e;)n<<=1;for(;s<i;)s<<=1;if(e==n&&i==s)return this;for(var r=this.bytesPerPixel,a=new Qn(new ArrayBuffer(n*s*r)),A=0,h=this.offset,o=0,l=i;o<l;){o++;a.blit(A,this.bytes,h,e*r),A+=e*r,h+=e*r;for(var u=0,_=(n-e)*r>>2;u<_;){u++;a.setInt32(A,0),A+=4}}for(o=0,l=(s-i)*n*r>>2;o<l;){o++;a.setInt32(A,0),A+=4}return t?new Ps(n,s,a,this.innerFormat):(this.bytes=a,this.width=n,this.height=s,this)},copyInner:function(){var t=this.bytes;this.bytes=new Qn(new ArrayBuffer(this.dataSize)),this.bytes.blit(0,t,this.offset,this.dataSize),this.offset=0,this.flags&=-1-(1<<Fs.ReadOnly._hx_index)},willChange:function(){0!=(this.flags&1<<Fs.ReadOnly._hx_index)&&this.copyInner()},setFlip:function(t){if(null==t&&(t=!1),0!=(this.flags&1<<Fs.FlipY._hx_index)!=t){0!=(this.flags&1<<Fs.ReadOnly._hx_index)&&this.copyInner(),t?this.flags|=1<<Fs.FlipY._hx_index:this.flags&=-1-(1<<Fs.FlipY._hx_index),this.stride%4!=0&&this.invalidFormat();for(var e=0,i=this.height>>1;e<i;)for(var n=e++,s=n*this.stride+this.offset,r=(this.height-1-n)*this.stride+this.offset,a=0,A=this.stride>>2;a<A;){a++;var h=this.bytes.getInt32(s);t=this.bytes.getInt32(r);this.bytes.setInt32(s,t),this.bytes.setInt32(r,h),s+=4,r+=4}}},convert:function(t){if(this.innerFormat!=t&&!m.enumEq(this.innerFormat,t)){0!=(this.flags&1<<Fs.ReadOnly._hx_index)&&this.copyInner();var e=this.bytes.b,i=this.innerFormat;switch(i._hx_index){case 0:switch(t._hx_index){case 1:for(var n=0,s=this.width*this.height;n<s;){var r=e[f=((c=n++)<<2)+this.offset],a=e[f+1],A=e[f+2],h=e[f+3];e[f++]=h,e[f++]=A,e[f++]=a,e[f]=r}break;case 2:for(n=0,s=this.width*this.height;n<s;){r=e[f=((c=n++)<<2)+this.offset];var o=e[f+1];e[f]=o;var l=e[f+2];e[f+1]=l;var u=e[f+3];e[f+2]=u,e[f+3]=r}break;default:throw kn.thrown("Cannot convert from "+x.string(this.innerFormat)+" to "+x.string(t))}break;case 1:switch(t._hx_index){case 0:for(n=0,s=this.width*this.height;n<s;){r=e[f=((c=n++)<<2)+this.offset],a=e[f+1],A=e[f+2],h=e[f+3];e[f++]=h,e[f++]=A,e[f++]=a,e[f]=r}break;case 2:for(n=0,s=this.width*this.height;n<s;){h=e[f=((c=n++)<<2)+this.offset],a=e[f+2];e[f]=a,e[f+2]=h}break;default:throw kn.thrown("Cannot convert from "+x.string(this.innerFormat)+" to "+x.string(t))}break;case 2:switch(t._hx_index){case 0:for(n=0,s=this.width*this.height;n<s;){r=e[(f=((c=n++)<<2)+this.offset)+3],o=e[f+2];e[f+3]=o;l=e[f+1];e[f+2]=l;u=e[f];e[f+1]=u,e[f]=r}break;case 1:for(n=0,s=this.width*this.height;n<s;){h=e[f=((c=n++)<<2)+this.offset],a=e[f+2];e[f]=a,e[f+2]=h}break;case 5:var _=(p=new Qn(new ArrayBuffer(this.width*this.height))).b;for(n=0,s=this.width*this.height;n<s;){o=e[(c=n++)<<2];_[c]=o}this.bytes=p;break;default:throw kn.thrown("Cannot convert from "+x.string(this.innerFormat)+" to "+x.string(t))}break;case 4:if(7!=t._hx_index)throw kn.thrown("Cannot convert from "+x.string(this.innerFormat)+" to "+x.string(t));for(_=(p=new Qn(new ArrayBuffer(this.height*this.width*4))).b,n=0,s=this.width*this.height;n<s;){var c=n++;p.setFloat(c<<2,this.bytes.getFloat(c<<4))}this.bytes=p;break;case 7:switch(t._hx_index){case 1:case 2:var d=this.bytes,f=0;for(n=0,s=this.width*this.height;n<s;){c=n++;(o=255*d.getFloat(f)|0)<0?o=0:o>255&&(o=255),e[f++]=o,e[f++]=o,e[f++]=o,e[f++]=255}break;default:throw kn.thrown("Cannot convert from "+x.string(this.innerFormat)+" to "+x.string(t))}break;case 18:if(7!=t._hx_index)throw kn.thrown("Cannot convert from "+x.string(this.innerFormat)+" to "+x.string(t));var p=new Qn(new ArrayBuffer(this.width*this.height*4));for(d=this.bytes,n=0,s=this.width*this.height;n<s;){c=n++;var g=d.getUInt16(c<<1);p.setFloat(c<<2,g/65535)}this.bytes=p;break;case 21:if(21!=t._hx_index)throw kn.thrown("Cannot convert from "+x.string(this.innerFormat)+" to "+x.string(t));h=t.v;if((r=i.v)!=h)throw kn.thrown("Cannot convert from "+x.string(this.innerFormat)+" to "+x.string(t));break;default:throw kn.thrown("Cannot convert from "+x.string(this.innerFormat)+" to "+x.string(t))}this.set_innerFormat(t)}},getPixel:function(t,e){var i=(t+(0!=(this.flags&1<<Fs.FlipY._hx_index)?this.height-1-e:e)*this.width)*this.bytesPerPixel+this.offset;switch(this.innerFormat._hx_index){case 0:return(n=this.bytes.getInt32(i))>>>24|n>>8&65280|n<<8&16711680|n<<24;case 1:return this.bytes.getInt32(i);case 2:var n;return-16711936&(n=this.bytes.getInt32(i))|n<<16&16711680|n>>16&255;default:return this.invalidFormat(),0}},setPixel:function(t,e,i){var n=(t+(0!=(this.flags&1<<Fs.FlipY._hx_index)?this.height-1-e:e)*this.width)*this.bytesPerPixel+this.offset;switch(0!=(this.flags&1<<Fs.ReadOnly._hx_index)&&this.copyInner(),this.innerFormat._hx_index){case 0:this.bytes.setInt32(n,i>>>24|i>>8&65280|i<<8&16711680|i<<24);break;case 1:this.bytes.setInt32(n,i);break;case 2:this.bytes.setInt32(n,-16711936&i|i<<16&16711680|i>>16&255);break;case 5:this.bytes.b[n]=i;break;default:this.invalidFormat()}},getPixelF:function(t,e,i){null==i&&(i=new Yt);var n=(t+(0!=(this.flags&1<<Fs.FlipY._hx_index)?this.height-1-e:e)*this.width)*this.bytesPerPixel+this.offset;switch(this.innerFormat._hx_index){case 4:var s=this.bytes.getFloat(n),r=this.bytes.getFloat(n+4),a=this.bytes.getFloat(n+8);return null==(A=this.bytes.getFloat(n+12))&&(A=1),null==a&&(a=0),null==r&&(r=0),null==s&&(s=0),i.x=s,i.y=r,i.z=a,i.w=A,i;case 7:return null==(A=0)&&(A=1),null==(a=0)&&(a=0),null==(r=0)&&(r=0),null==(s=this.bytes.getFloat(n))&&(s=0),i.x=s,i.y=r,i.z=a,i.w=A,i;case 10:var A;s=this.bytes.getFloat(n);return null==(A=0)&&(A=1),null==(a=0)&&(a=0),null==(r=this.bytes.getFloat(n+4))&&(r=0),null==s&&(s=0),i.x=s,i.y=r,i.z=a,i.w=A,i;default:var h=this.getPixel(t,e);return i.x=(h>>16&255)/255,i.y=(h>>8&255)/255,i.z=(255&h)/255,i.w=(h>>>24)/255,i}},setPixelF:function(t,e,i){0!=(this.flags&1<<Fs.ReadOnly._hx_index)&&this.copyInner();var n=(t+(0!=(this.flags&1<<Fs.FlipY._hx_index)?this.height-1-e:e)*this.width)*this.bytesPerPixel+this.offset;switch(this.innerFormat._hx_index){case 4:this.bytes.setFloat(n,i.x),this.bytes.setFloat(n+4,i.y),this.bytes.setFloat(n+8,i.z),this.bytes.setFloat(n+12,i.w);break;case 7:this.bytes.setFloat(n,i.x);break;default:var s=i.w,r=i.x,a=i.y,A=i.z;this.setPixel(t,e,(255*(s<0?0:s>1?1:s)+.499|0)<<24|(255*(r<0?0:r>1?1:r)+.499|0)<<16|(255*(a<0?0:a>1?1:a)+.499|0)<<8|255*(A<0?0:A>1?1:A)+.499|0)}},dispose:function(){this.bytes=null},toString:function(){return"Pixels("+this.width+"x"+this.height+" "+x.string(this.innerFormat)+")"},toPNG:function(t){var e;null==t&&(t=9),this.setFlip(!1),0==this.innerFormat._hx_index?e=N.build32ARGB(this.width,this.height,this.bytes,t):(this.convert($e.BGRA),e=N.build32BGRA(this.width,this.height,this.bytes,t));var i=new as;return new Y(i).write(e),i.getBytes()},clone:function(){var t=new Ps(this.width,this.height,null,this.innerFormat);return t.flags=this.flags,t.flags&=-1-(1<<Fs.ReadOnly._hx_index),null!=this.bytes&&(t.bytes=new Qn(new ArrayBuffer(this.dataSize)),t.bytes.blit(0,this.bytes,this.offset,this.dataSize)),t},__class__:Ps};var zs=function(){};i["hxd.Res"]=zs,zs.__name__="hxd.Res",zs.load=function(t){return zs.get_loader().load(t)},zs.get_loader=function(){var t=la.currentInstance;if(null==t)throw kn.thrown("Resource loader not initialized: call to hxd.Res.initXXX() required");return t},zs.set_loader=function(t){return la.currentInstance=t};var Rs=function(t){this.defaultCursor=bs.Default,this.mouseCheckMove=!0,this.enablePhysicalMouse=!0,this.isOut=!1,this.onOver=new Bs(Ms.EOver),this.onOut=new Bs(Ms.EOut),this.checkPos=new Bs(Ms.ECheck),this.focusLost=new Bs(Ms.EFocusLost),this.lastTouch=0,this.mouseY=-1,this.mouseX=-1,this.overIndex=-1,this.scenes=[],this.pendingEvents=[],this.pushList=[],this.overList=[],this.overCandidates=[],null==t&&(t=Us.getInstance()),this.window=t,t.addEventTarget(XA(this,this.onEvent))};i["hxd.SceneEvents"]=Rs,Rs.__name__="hxd.SceneEvents",Rs.prototype={setMousePos:function(t,e){this.mouseX=t,this.mouseY=e},onRemove:function(t){if(t==this.currentFocus&&(this.currentFocus=null),this.overIndex>=0){var e=this.overList.indexOf(t);e>=0&&(l.remove(this.overList,t),e<this.overIndex&&this.overIndex--)}else l.remove(this.overList,t),this.selectCursor();l.remove(this.pushList,t)},addScene:function(t,e){t.setEvents(this),null==e?this.scenes.push(t):this.scenes.splice(e,0,t)},removeScene:function(t){l.remove(this.scenes,t)&&t.setEvents(null)},dispose:function(){this.window.removeEventTarget(XA(this,this.onEvent))},focus:function(t){if(this.currentFocus!=t)if(null!=t){if(null==this.currentFocus||(this.blur(),null==this.currentFocus)){var e=new Bs(Ms.EFocus);t.handleEvent(e),e.cancel||(this.currentFocus=t)}}else this.blur()},blur:function(){null!=this.currentFocus&&(this.focusLost.cancel=!1,this.currentFocus.handleEvent(this.focusLost),this.focusLost.cancel||(this.currentFocus=null))},checkFocus:function(){if(null!=this.currentFocus){var t=this.currentFocus.getInteractiveScene();null!=t?t.isInteractiveVisible(this.currentFocus)||this.blur():this.currentFocus=null}},emitEvent:function(t){var e=t.relX,i=t.relY,n=0,s=!1,r=!1,a=!1,A=!1,h=!1,o=!1;switch(this.overIndex=0,t.kind._hx_index){case 0:h=!0,A=!0;break;case 1:A=!0;break;case 2:case 12:r=!0,a=!0;break;case 5:case 8:case 9:case 11:if(null!=this.currentFocus&&(t.relX=t.relY=0,this.currentFocus.handleEvent(t),t.relX=e,t.relY=i,!t.propagate))return}for(var u=0,_=this.scenes;u<_.length;){var c=_[u];++u;for(var d=null;;){if(null==(x=c.handleEvent(t,d))){t.relX=e,t.relY=i;break}if(r){if(a){var f=this.overList.indexOf(x);if(-1==f){if(this.overCandidates.length==n)this.overCandidates[n]={i:x,s:c,x:t.relX,y:t.relY,z:t.relZ};else(g=this.overCandidates[n]).i=x,g.s=c,g.x=t.relX,g.y=t.relY,g.z=t.relZ;++n,this.overList.splice(this.overIndex++,0,x),o=!0}else{if(f<this.overIndex){for(;this.overList[f]=this.overList[f+1],++f<this.overIndex;);this.overList[this.overIndex]=x,o=!0}else if(f>this.overIndex){for(;this.overList[f]=this.overList[f-1],--f>this.overIndex;);this.overList[this.overIndex]=x,o=!0}this.overIndex++}a=t.propagate}}else A&&(t.kind==Ms.EPush?this.pushList.push(x):l.remove(this.pushList,x)),h&&x==this.currentFocus&&(h=!1);if(t.relX=e,t.relY=i,!t.propagate){s=!0;break}d=x,t.propagate=!1}if(s)break}if(h&&null!=this.currentFocus&&this.blur(),r){if(this.overIndex<this.overList.length){for(;this.overIndex<this.overList.length;){this.overList.pop().handleEvent(this.onOut)}o=!0}if(0!=n)for(var x=0,p=this.onOver;;){var g=this.overCandidates[x++];if(p.relX=g.x,p.relY=g.y,p.relZ=g.z,g.s.isInteractiveVisible(g.i)?g.i.handleEvent(p):l.remove(this.overList,g.i),g.i=null,g.s=null,!(x<n))break}}if(this.overIndex=-1,o&&this.selectCursor(),s||t==this.checkPos||(t.kind==Ms.EPush?this.pushList.push(null):t.kind==Ms.ERelease&&l.remove(this.pushList,null),this.dispatchListeners(t)),t.kind==Ms.ERelease&&this.pushList.length>0){for(u=0,_=this.pushList;u<_.length;){x=_[u];if(++u,null==x)t.kind=Ms.EReleaseOutside,this.dispatchListeners(t),t.kind=Ms.ERelease;else{if(null==(c=x.getInteractiveScene()))continue;t.kind=Ms.EReleaseOutside,c.dispatchEvent(t,x),t.kind=Ms.ERelease,t.relX=e,t.relY=i}}this.pushList=[]}},checkEvents:function(){var t=this.pendingEvents,e=!this.mouseCheckMove,i=null==this.currentFocus;if(t.length>0){this.pendingEvents=[];for(var n=0;n<t.length;){var s=t[n];++n;var r=s.relX,a=s.relY;switch(s.kind._hx_index){case 0:case 1:this.mouseX=s.relX,this.mouseY=s.relY,this.lastTouch=s.touchId;break;case 2:e=!0,this.mouseX=s.relX,this.mouseY=s.relY,this.lastTouch=s.touchId;break;case 3:this.isOut=!1,this.selectCursor();continue;case 4:if(this.isOut=!0,this.overList.length>0){for(var A=this.overList.length-1;A>=0;)this.onOut.cancel=!1,this.overList[A].handleEvent(this.onOut),l.remove(this.overList,this.overList[A]),--A;this.selectCursor()}continue;case 5:case 8:case 9:case 11:i||(i=!0,this.checkFocus())}(null==this.currentDrag||null!=this.currentDrag.ref&&this.currentDrag.ref!=s.touchId||(s.propagate=!0,s.cancel=!1,this.currentDrag.f(s),s.relX=r,s.relY=a,s.propagate))&&this.emitEvent(s)}}i||this.checkFocus(),e||this.isOut||null!=this.currentDrag||(this.checkPos.relX=this.mouseX,this.checkPos.relY=this.mouseY,this.checkPos.touchId=this.lastTouch,this.checkPos.cancel=!1,this.checkPos.propagate=!1,this.emitEvent(this.checkPos))},startCapture:function(t,e,i){null!=this.currentDrag&&null!=this.currentDrag.onCancel&&this.currentDrag.onCancel(),this.currentDrag={f:t,ref:i,onCancel:e}},stopCapture:function(){null!=this.currentDrag&&null!=this.currentDrag.onCancel&&this.currentDrag.onCancel(),this.currentDrag=null},startDrag:function(t,e,i){this.startCapture(t,e,null!=i?i.touchId:null)},stopDrag:function(){this.stopCapture()},getFocus:function(){return this.currentFocus},updateCursor:function(t){-1!=this.overList.indexOf(t)&&this.selectCursor()},set_defaultCursor:function(t){return m.enumEq(t,this.defaultCursor)||(this.defaultCursor=t,this.selectCursor()),t},selectCursor:function(){for(var t=this.defaultCursor,e=0,i=this.overList;e<i.length;){var n=i[e];if(++e,null!=n.cursor){t=n.cursor;break}}6==t._hx_index?(0,t.f)():Os.setCursor(t)},onEvent:function(t){(this.enablePhysicalMouse||t.kind!=Ms.EMove)&&this.pendingEvents.push(t)},dispatchListeners:function(t){var e=t.relX,i=t.relY;t.propagate=!0;for(var n=0,s=this.scenes;n<s.length;){var r=s[n];if(++n,t.cancel=!1,r.dispatchListeners(t),t.relX=e,t.relY=i,!t.propagate)break}},__class__:Rs};var Ls=s["hxd.Platform"]={__ename__:!0,__constructs__:null,IOS:{_hx_name:"IOS",_hx_index:0,__enum__:"hxd.Platform",toString:n},Android:{_hx_name:"Android",_hx_index:1,__enum__:"hxd.Platform",toString:n},WebGL:{_hx_name:"WebGL",_hx_index:2,__enum__:"hxd.Platform",toString:n},PC:{_hx_name:"PC",_hx_index:3,__enum__:"hxd.Platform",toString:n},Console:{_hx_name:"Console",_hx_index:4,__enum__:"hxd.Platform",toString:n},FlashPlayer:{_hx_name:"FlashPlayer",_hx_index:5,__enum__:"hxd.Platform",toString:n}};Ls.__constructs__=[Ls.IOS,Ls.Android,Ls.WebGL,Ls.PC,Ls.Console,Ls.FlashPlayer],Ls.__empty_constructs__=[Ls.IOS,Ls.Android,Ls.WebGL,Ls.PC,Ls.Console,Ls.FlashPlayer];var Vs=s["hxd.SystemValue"]={__ename__:!0,__constructs__:null,IsTouch:{_hx_name:"IsTouch",_hx_index:0,__enum__:"hxd.SystemValue",toString:n},IsWindowed:{_hx_name:"IsWindowed",_hx_index:1,__enum__:"hxd.SystemValue",toString:n},IsMobile:{_hx_name:"IsMobile",_hx_index:2,__enum__:"hxd.SystemValue",toString:n}};Vs.__constructs__=[Vs.IsTouch,Vs.IsWindowed,Vs.IsMobile],Vs.__empty_constructs__=[Vs.IsTouch,Vs.IsWindowed,Vs.IsMobile];var Qs=function(){};i["hxd.Timer"]=Qs,Qs.__name__="hxd.Timer",Qs.update=function(){Qs.frameCount++;var t=l.now()/1e3;if(Qs.elapsedTime=t-Qs.lastTimeStamp,Qs.lastTimeStamp=t,Qs.elapsedTime<Qs.maxDeltaTime){var e=Qs.elapsedTime;Qs.currentDT=e+Qs.smoothFactor*(Qs.currentDT-e)}else Qs.elapsedTime=1/Qs.wantedFPS;Qs.dt=Qs.currentDT},Qs.get_tmod=function(){return Qs.dt*Qs.wantedFPS},Qs.set_tmod=function(t){return Qs.dt=t/Qs.wantedFPS,t},Qs.fps=function(){return 1/Qs.currentDT},Qs.skip=function(){Qs.lastTimeStamp=l.now()/1e3},Qs.reset=function(){Qs.lastTimeStamp=l.now()/1e3,Qs.dt=Qs.currentDT=1/Qs.wantedFPS};var Us=function(t,e){this.useScreenPixels=!0,this.curMouseY=0,this.curMouseX=0;var i=this,n=null!=t;if(this.eventTargets=new Zn,this.resizeEvents=new Zn,null==t){if(null==(t=window.document.getElementById("webgl")))throw kn.thrown("Missing canvas #webgl");"1"==t.getAttribute("globalEvents")&&(e=!0)}this.canvas=t,this.propagateKeyEvents=e;var s=t.getAttribute("propagateKeyEvents");null!=s&&(this.propagateKeyEvents="0"!=s&&"false"!=s),this.focused=e,this.element=e?window:t,this.canvasPos=t.getBoundingClientRect(),n?t.addEventListener("mousemove",XA(this,this.onMouseMove)):window.addEventListener("mousemove",XA(this,this.onMouseMove)),this.element.addEventListener("mousedown",XA(this,this.onMouseDown)),this.element.addEventListener("mouseup",XA(this,this.onMouseUp)),this.element.addEventListener("wheel",XA(this,this.onMouseWheel)),this.element.addEventListener("touchstart",XA(this,this.onTouchStart)),this.element.addEventListener("touchmove",XA(this,this.onTouchMove)),this.element.addEventListener("touchend",XA(this,this.onTouchEnd)),this.element.addEventListener("keydown",XA(this,this.onKeyDown)),this.element.addEventListener("keyup",XA(this,this.onKeyUp)),this.element.addEventListener("keypress",XA(this,this.onKeyPress));var r=XA(this,this.onFocus),a=function(){r(false)};this.element.addEventListener("blur",a);var A=XA(this,this.onFocus);a=function(){A(true)};this.element.addEventListener("focus",a),t.oncontextmenu=function(t){return t.stopPropagation(),t.preventDefault(),!1},e?(t.addEventListener("mousedown",(function(t){i.onMouseDown(t),t.stopPropagation(),t.preventDefault()})),this.element.addEventListener("contextmenu",(function(t){return t.stopPropagation(),t.preventDefault(),!1}))):(null==t.getAttribute("tabindex")&&t.setAttribute("tabindex","1"),t.style.outline="none"),this.curW=this.get_width(),this.curH=this.get_height(),this.timer=new Pn(100),this.timer.run=XA(this,this.checkResize)};i["hxd.Window"]=Us,Us.__name__="hxd.Window",Us.getInstance=function(){return null==Us.inst&&(Us.inst=new Us),Us.inst},Us.prototype={checkResize:function(){this.canvasPos=this.canvas.getBoundingClientRect();var t=this.get_width(),e=this.get_height();this.curW==t&&this.curH==e||(this.curW=t,this.curH=e,this.onResize(null))},dispose:function(){this.timer.stop()},onClose:function(){return!0},event:function(t){for(var e=this.eventTargets.h;null!=e;){var i=e.item;e=e.next,i(t)}},addEventTarget:function(t){this.eventTargets.add(t)},removeEventTarget:function(t){for(var e=this.eventTargets.h;null!=e;){var i=e.item;e=e.next;var n=i;if(f.compareMethods(n,t)){this.eventTargets.remove(n);break}}},addResizeEvent:function(t){this.resizeEvents.push(t)},removeResizeEvent:function(t){for(var e=this.resizeEvents.h;null!=e;){var i=e.item;if(e=e.next,f.compareMethods(i,t)){this.resizeEvents.remove(t);break}}},onResize:function(t){for(var e=this.resizeEvents.h;null!=e;){var i=e.item;e=e.next,i()}},resize:function(t,e){},setFullScreen:function(t){var e=window.document,i=e.documentElement;e.fullscreenElement==i!=t&&(t?i.requestFullscreen():e.exitFullscreen())},setCurrent:function(){Us.inst=this},getPixelRatio:function(){return this.useScreenPixels?window.devicePixelRatio:1},get_width:function(){return Math.round(this.canvasPos.width*this.getPixelRatio())},get_height:function(){return Math.round(this.canvasPos.height*this.getPixelRatio())},get_mouseX:function(){return Math.round((this.curMouseX-this.canvasPos.left)*this.getPixelRatio())},get_mouseY:function(){return Math.round((this.curMouseY-this.canvasPos.top)*this.getPixelRatio())},get_mouseLock:function(){return!1},set_mouseLock:function(t){if(t)throw kn.thrown("Not implemented");return!1},get_vsync:function(){return!0},set_vsync:function(t){if(!t)throw kn.thrown("Can't disable vsync on this platform");return!0},onMouseDown:function(t){t.clientX==this.curMouseX&&t.clientY==this.curMouseY||this.onMouseMove(t);var e,i=new Bs(Ms.EPush,this.get_mouseX(),this.get_mouseY()),n=t.button;switch(n){case 1:e=2;break;case 2:e=1;break;default:e=n}i.button=e,this.event(i)},onMouseUp:function(t){t.clientX==this.curMouseX&&t.clientY==this.curMouseY||this.onMouseMove(t);var e,i=new Bs(Ms.ERelease,this.get_mouseX(),this.get_mouseY()),n=t.button;switch(n){case 1:e=2;break;case 2:e=1;break;default:e=n}i.button=e,this.event(i)},onMouseMove:function(t){this.curMouseX=t.clientX,this.curMouseY=t.clientY,this.event(new Bs(Ms.EMove,this.get_mouseX(),this.get_mouseY()))},onMouseWheel:function(t){t.preventDefault();var e=new Bs(Ms.EWheel,this.get_mouseX(),this.get_mouseY());e.wheelDelta=t.deltaY/120,this.event(e)},onTouchStart:function(t){var e,i,n;t.preventDefault();for(var s=0,r=t.changedTouches;s<r.length;){var a=r[s];++s,e=Math.round((a.clientX-this.canvasPos.left)*this.getPixelRatio()),i=Math.round((a.clientY-this.canvasPos.top)*this.getPixelRatio()),(n=new Bs(Ms.EPush,e,i)).touchId=a.identifier,this.event(n)}},onTouchMove:function(t){var e,i,n;t.preventDefault();for(var s=0,r=t.changedTouches;s<r.length;){var a=r[s];++s,e=Math.round((a.clientX-this.canvasPos.left)*this.getPixelRatio()),i=Math.round((a.clientY-this.canvasPos.top)*this.getPixelRatio()),(n=new Bs(Ms.EMove,e,i)).touchId=a.identifier,this.event(n)}},onTouchEnd:function(t){var e,i,n;t.preventDefault();for(var s=0,r=t.changedTouches;s<r.length;){var a=r[s];++s,e=Math.round((a.clientX-this.canvasPos.left)*this.getPixelRatio()),i=Math.round((a.clientY-this.canvasPos.top)*this.getPixelRatio()),(n=new Bs(Ms.ERelease,e,i)).touchId=a.identifier,this.event(n)}},onKeyUp:function(t){var e=new Bs(Ms.EKeyUp,this.get_mouseX(),this.get_mouseY());e.keyCode=t.keyCode,this.event(e),this.propagateKeyEvents||(t.preventDefault(),t.stopPropagation())},onKeyDown:function(t){var e=new Bs(Ms.EKeyDown,this.get_mouseX(),this.get_mouseY());if(e.keyCode=t.keyCode,this.event(e),!this.propagateKeyEvents){switch(e.keyCode){case 8:case 9:case 16:case 17:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:t.preventDefault()}t.stopPropagation()}},onKeyPress:function(t){var e=new Bs(Ms.ETextInput,this.get_mouseX(),this.get_mouseY());e.charCode=t.charCode,this.event(e),this.propagateKeyEvents||(t.preventDefault(),t.stopPropagation())},onFocus:function(t){this.event(new Bs(t?Ms.EFocus:Ms.EFocusLost)),this.focused=t},get_isFocused:function(){return this.focused},get_displayMode:function(){return null!=window.document.fullscreenElement?Gs.Borderless:Gs.Windowed},set_displayMode:function(t){var e=window.document,i=e.documentElement,n=t!=Gs.Windowed;return e.fullscreenElement==i==n?Gs.Windowed:(t!=Gs.Windowed?i.requestFullscreen():e.exitFullscreen(),t)},get_title:function(){return window.document.title},set_title:function(t){return window.document.title=t},__class__:Us};var Os=function(){};i["hxd.System"]=Os,Os.__name__="hxd.System",Os.timeoutTick=function(){},Os.getCurrentLoop=function(){return Os.loopFunc},Os.setLoop=function(t){Os.loopInit||(Os.loopInit=!0,Os.browserLoop()),Os.loopFunc=t},Os.browserLoop=function(){var t=window,e=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame;Os.fpsLimit>0?window.setTimeout((function(){return e(Os.browserLoop)}),1e3/Os.fpsLimit):e(Os.browserLoop),null!=Os.loopFunc&&Os.loopFunc()},Os.start=function(t){t()},Os.setNativeCursor=function(t){if(null==Os.currentNativeCursor||!m.enumEq(t,Os.currentNativeCursor)){Os.currentNativeCursor=t,Os.currentCustomCursor=null;var e=Us.getInstance().canvas;if(null!=e){var i;switch(t._hx_index){case 0:i="default";break;case 1:i="pointer";break;case 2:i="move";break;case 3:i="text";break;case 4:i="none";break;case 5:var n=t.custom;if(null==n.alloc){n.alloc=[];for(var s=0,r=n.frames;s<r.length;){var a=r[s];++s,n.alloc.push('url("'+a.ctx.canvas.toDataURL("image/png")+'") '+n.offsetX+" "+n.offsetY+", default")}}n.frames.length>1&&(Os.currentCustomCursor=n,n.reset()),i=n.alloc[n.frameIndex];break;case 6:s=t.f;throw kn.thrown("assert")}e.style.cursor=i}}},Os.getDeviceName=function(){return"Unknown"},Os.getDefaultFrameRate=function(){return 60},Os.getValue=function(t){switch(t._hx_index){case 0:case 2:return Os.get_platform()==Ls.Android||Os.get_platform()==Ls.IOS;case 1:return!0}},Os.exit=function(){},Os.openURL=function(t){window.open(t,"_blank")},Os.updateCursor=function(){if(null!=Os.currentCustomCursor){var t=Os.currentCustomCursor.update(Qs.elapsedTime);if(-1!=t){var e=Us.getInstance().canvas;null!=e&&(e.style.cursor=Os.currentCustomCursor.alloc[t])}}},Os.get_width=function(){return Math.round(window.document.body.clientWidth*window.devicePixelRatio)},Os.get_height=function(){return Math.round(window.document.body.clientHeight*window.devicePixelRatio)},Os.get_lang=function(){return"en"},Os.get_platform=function(){var e=t.navigator.userAgent.toLowerCase();return e.indexOf("android")>=0?Ls.Android:e.indexOf("ipad")>=0||e.indexOf("iphone")>=0||e.indexOf("ipod")>=0?Ls.IOS:Ls.PC},Os.get_screenDPI=function(){return 72},Os.get_allowTimeout=function(){return!1},Os.set_allowTimeout=function(t){return!1};var Gs=s["hxd.DisplayMode"]={__ename__:!0,__constructs__:null,Windowed:{_hx_name:"Windowed",_hx_index:0,__enum__:"hxd.DisplayMode",toString:n},Borderless:{_hx_name:"Borderless",_hx_index:1,__enum__:"hxd.DisplayMode",toString:n},Fullscreen:{_hx_name:"Fullscreen",_hx_index:2,__enum__:"hxd.DisplayMode",toString:n},FullscreenResize:{_hx_name:"FullscreenResize",_hx_index:3,__enum__:"hxd.DisplayMode",toString:n}};Gs.__constructs__=[Gs.Windowed,Gs.Borderless,Gs.Fullscreen,Gs.FullscreenResize],Gs.__empty_constructs__=[Gs.Windowed,Gs.Borderless,Gs.Fullscreen,Gs.FullscreenResize];var Ns=s["hxd.clipper.ClipType"]={__ename__:!0,__constructs__:null,Intersection:{_hx_name:"Intersection",_hx_index:0,__enum__:"hxd.clipper.ClipType",toString:n},Union:{_hx_name:"Union",_hx_index:1,__enum__:"hxd.clipper.ClipType",toString:n},Difference:{_hx_name:"Difference",_hx_index:2,__enum__:"hxd.clipper.ClipType",toString:n},Xor:{_hx_name:"Xor",_hx_index:3,__enum__:"hxd.clipper.ClipType",toString:n}};Ns.__constructs__=[Ns.Intersection,Ns.Union,Ns.Difference,Ns.Xor],Ns.__empty_constructs__=[Ns.Intersection,Ns.Union,Ns.Difference,Ns.Xor];var Ys=s["hxd.clipper._Clipper.EdgeSide"]={__ename__:!0,__constructs__:null,Left:{_hx_name:"Left",_hx_index:0,__enum__:"hxd.clipper._Clipper.EdgeSide",toString:n},Right:{_hx_name:"Right",_hx_index:1,__enum__:"hxd.clipper._Clipper.EdgeSide",toString:n}};Ys.__constructs__=[Ys.Left,Ys.Right],Ys.__empty_constructs__=[Ys.Left,Ys.Right];var Xs=s["hxd.clipper._Clipper.Direction"]={__ename__:!0,__constructs__:null,RightToLeft:{_hx_name:"RightToLeft",_hx_index:0,__enum__:"hxd.clipper._Clipper.Direction",toString:n},LeftToRight:{_hx_name:"LeftToRight",_hx_index:1,__enum__:"hxd.clipper._Clipper.Direction",toString:n}};Xs.__constructs__=[Xs.RightToLeft,Xs.LeftToRight],Xs.__empty_constructs__=[Xs.RightToLeft,Xs.LeftToRight];var js=function(){var t=[],e=null==t?[]:t;this.polygon=e,this.childs=[]};i["hxd.clipper._Clipper.PolyNode"]=js,js.__name__="hxd.clipper._Clipper.PolyNode",js.prototype={isHoleNode:function(){for(var t=!0,e=this.parent;null!=e;)t=!t,e=e.parent;return t},get_childCount:function(){return this.childs.length},get_contour:function(){return this.polygon},addChild:function(t){var e=this.childs.length;this.childs.push(t),t.parent=this,t.index=e},getNext:function(){return this.childs.length>0?this.childs[0]:this.getNextSiblingUp()},getNextSiblingUp:function(){return null==this.parent?null:this.index==this.parent.childs.length-1?this.parent.getNextSiblingUp():this.parent.childs[this.index+1]},isHole:function(){return this.isHoleNode()},__class__:js};var Hs=function(){js.call(this),this.allPolys=[]};i["hxd.clipper._Clipper.PolyTree"]=Hs,Hs.__name__="hxd.clipper._Clipper.PolyTree",Hs.__super__=js,Hs.prototype=r(js.prototype,{toPolygons:function(t){t=[],this.addRec(this,t)},addRec:function(t,e){t.polygon.length>0&&e.push(t.polygon);for(var i=0,n=t.childs;i<n.length;){var s=n[i];++i,this.addRec(s,e)}},clear:function(){this.allPolys=[],this.childs=[]},getFirst:function(){return this.childs.length>0?this.childs[0]:null},get_total:function(){var t=this.allPolys.length;return t>0&&this.childs[0]!=this.allPolys[0]&&--t,t},__class__:Hs});var Ws=function(t){this.val=t};i["hxd.clipper._Clipper.Ref"]=Ws,Ws.__name__="hxd.clipper._Clipper.Ref",Ws.prototype={__class__:Ws};var Zs=function(){};i["hxd.clipper._Clipper.TEdge"]=Zs,Zs.__name__="hxd.clipper._Clipper.TEdge",Zs.prototype={get_top:function(){return new bt(this.topX,this.topY)},get_bot:function(){return new bt(this.botX,this.botY)},get_curr:function(){return new bt(this.currX,this.currY)},set_top:function(t){return this.topX=t.x,this.topY=t.y,t},set_bot:function(t){return this.botX=t.x,this.botY=t.y,t},set_curr:function(t){return this.currX=t.x,this.currY=t.y,t},__class__:Zs};var Js=function(){};i["hxd.clipper._Clipper.IntersectNode"]=Js,Js.__name__="hxd.clipper._Clipper.IntersectNode",Js.prototype={__class__:Js};var qs=function(){};i["hxd.clipper._Clipper.LocalMinima"]=qs,qs.__name__="hxd.clipper._Clipper.LocalMinima",qs.prototype={__class__:qs};var Ks=function(){};i["hxd.clipper._Clipper.Scanbeam"]=Ks,Ks.__name__="hxd.clipper._Clipper.Scanbeam",Ks.prototype={__class__:Ks};var $s=function(){};i["hxd.clipper._Clipper.OutRec"]=$s,$s.__name__="hxd.clipper._Clipper.OutRec",$s.prototype={__class__:$s};var tr=function(){};i["hxd.clipper._Clipper.OutPt"]=tr,tr.__name__="hxd.clipper._Clipper.OutPt",tr.prototype={__class__:tr};var er=function(){};i["hxd.clipper._Clipper.Join"]=er,er.__name__="hxd.clipper._Clipper.Join",er.prototype={__class__:er};var ir=function(){this.m_edges=[],this.m_MinimaList=null,this.m_CurrentLM=null};i["hxd.clipper._Clipper.ClipperBase"]=ir,ir.__name__="hxd.clipper._Clipper.ClipperBase",ir.nearZero=function(t){return t>-1e-20&&t<1e-20},ir.getBounds=function(t){for(var e=new ur,i=0,n=t.length;i<n&&0==t[i].length;)++i;e.left=e.right=t[i][0].x,e.top=e.bottom=t[i][0].y;for(var s=0,r=n;s<r;)for(var a=0,A=t[i=s++],h=A.length;a<h;){var o=A[a++];o.x<e.left?e.left=o.x:o.x>e.right&&(e.right=o.x),o.y<e.top?e.top=o.y:o.y>e.bottom&&(e.bottom=o.y)}return e},ir.prototype={isHorizontal:function(t){return 0==t.deltaY},abs:function(t){return t<0?-t:t},PointIsVertex:function(t,e){for(var i=e;;){var n=i.pt;if(n.x==t.x&&n.y==t.y)return!0;if((i=i.next)==e)break}return!1},PointOnLineSegment:function(t,e,i){return t.x==e.x&&t.y==e.y||t.x==i.x&&t.y==i.y||t.x>e.x==t.x<i.x&&t.y>e.y==t.y<i.y&&(t.x-e.x)*(i.y-e.y)==(i.x-e.x)*(t.y-e.y)},PointOnPolygon:function(t,e){for(var i=e;;){if(this.PointOnLineSegment(t,i.pt,i.next.pt))return!0;if((i=i.next)==e)break}return!1},SlopesEqual:function(t,e){return t.deltaY*e.deltaX==t.deltaX*e.deltaY},SlopesEqual3:function(t,e,i){return(t.y-e.y)*(e.x-i.x)-(t.x-e.x)*(e.y-i.y)==0},clear:function(){this.disposeLocalMinimaList(),this.m_edges=[]},disposeLocalMinimaList:function(){for(;null!=this.m_MinimaList;){var t=this.m_MinimaList.next;this.m_MinimaList=null,this.m_MinimaList=t}this.m_CurrentLM=null},addPolygons:function(t,e){for(var i=!1,n=0,s=t,r=s.length;n<r;){var a=s[n++];this.addPolygon(a,e)&&(i=!0)}return i},addPolygon:function(t,e){for(var i=t.length-1;i>0&&t[i]==t[0];)--i;for(;i>0&&t[i]==t[i-1];)--i;if(i<2)return!1;for(var n=[],s=0,r=i+1;s<r;){var a=s++;n.push(new Zs)}var A=!0,h=n[1],o=t[1];h.currX=o.x,h.currY=o.y;var l=n[0],u=t[0];l.next=n[1],l.prev=n[i],l.currX=u.x,l.currY=u.y,l.outIdx=-1;l=n[i],u=t[i];l.next=n[0],l.prev=n[i-1],l.currX=u.x,l.currY=u.y,l.outIdx=-1;for(a=i-1;a>0;){l=n[a],u=t[a];l.next=n[a+1],l.prev=n[a-1],l.currX=u.x,l.currY=u.y,l.outIdx=-1,--a}var _,c=n[0],d=c;for(l=c;;)if(l.currX!=l.next.currX||l.currY!=l.next.currY){if(l.prev==l.next)break;var f,x=(h=l.prev).currX,p=h.currY;null==p&&(p=0),null==x&&(x=0);var g=x,m=p,v=l.currX,y=l.currY;null==y&&(y=0),null==v&&(v=0);var b=v,w=y,M=l.next,B=M.currX,C=M.currY;if(null==C&&(C=0),null==B&&(B=0),(m-w)*(b-B)-(g-b)*(w-C)==0)if(this.preserveCollinear){var S=l.prev,I=new bt(S.currX,S.currY),k=new bt(l.currX,l.currY),E=l.next;f=!this.Pt2IsBetweenPt1AndPt3(I,k,new bt(E.currX,E.currY))}else f=!0;else f=!1;if(f)l==c&&(c=l.next),d=l=(l=this.RemoveEdge(l)).prev;else if((l=l.next)==d)break}else{if(l==l.next)break;l==c&&(c=l.next),d=l=this.RemoveEdge(l)}if(l.prev==l.next)return!1;for(l=c;l.currY>=l.next.currY?(l.botX=l.currX,l.botY=l.currY,l.topX=l.next.currX,l.topY=l.next.currY):(l.topX=l.currX,l.topY=l.currY,l.botX=l.next.currX,l.botY=l.next.currY),this.SetDx(l),l.polyType=e,(l=l.next).currY!=c.currY&&(A=!1),l!=c;);if(A)return!1;this.m_edges.push(n);var F=null;l.prev.botX==l.prev.topX&&l.prev.botY==l.prev.topY&&(l=l.next);for(var T=null;(l=this.FindNextLocMin(l))!=F;){if(null==F&&(F=l),l==T)throw kn.thrown("!");T=l;var D=new qs;D.next=null,D.y=l.botY,l.dx<l.prev.dx?(D.leftBound=l.prev,D.rightBound=l,_=!1):(D.leftBound=l,D.rightBound=l.prev,_=!0),D.leftBound.side=Ys.Left,D.rightBound.side=Ys.Right,D.leftBound.next==D.rightBound?D.leftBound.windDelta=-1:D.leftBound.windDelta=1,D.rightBound.windDelta=-D.leftBound.windDelta,-2==(l=this.ProcessBound(D.leftBound,_)).outIdx&&(l=this.ProcessBound(l,_));var P=this.ProcessBound(D.rightBound,!_);-2==P.outIdx&&(P=this.ProcessBound(P,!_)),-2==D.leftBound.outIdx?D.leftBound=null:-2==D.rightBound.outIdx&&(D.rightBound=null),this.InsertLocalMinima(D),_||(l=P)}return!0},InitEdge:function(t,e,i,n){t.next=e,t.prev=i,t.currX=n.x,t.currY=n.y,t.outIdx=-1},InitEdge2:function(t,e){t.currY>=t.next.currY?(t.botX=t.currX,t.botY=t.currY,t.topX=t.next.currX,t.topY=t.next.currY):(t.topX=t.currX,t.topY=t.currY,t.botX=t.next.currX,t.botY=t.next.currY),this.SetDx(t),t.polyType=e},RemoveEdge:function(t){t.prev.next=t.next,t.next.prev=t.prev;var e=t.next;return t.prev=null,e},FindNextLocMin:function(t){for(var e;;){for(;t.botX!=t.prev.botX||t.botY!=t.prev.botY||t.currX==t.topX&&t.currY==t.topY;)t=t.next;if(-9007199254740992!=t.dx&&-9007199254740992!=t.prev.dx)break;for(;-9007199254740992==t.prev.dx;)t=t.prev;for(e=t;-9007199254740992==t.dx;)t=t.next;if(t.topY!=t.prev.botY){e.prev.botX<t.botX&&(t=e);break}}return t},ProcessBound:function(t,e){var i,n,s=t;if(-2==s.outIdx){if(t=s,e){for(;t.topY==t.next.botY;)t=t.next;for(;t!=s&&-9007199254740992==t.dx;)t=t.prev}else{for(;t.topY==t.prev.botY;)t=t.prev;for(;t!=s&&-9007199254740992==t.dx;)t=t.next}if(t==s)s=e?t.next:t.prev;else{t=e?s.next:s.prev;var r=new qs;r.next=null,r.y=t.botY,r.leftBound=null,r.rightBound=t,t.windDelta=0,s=this.ProcessBound(t,e),this.InsertLocalMinima(r)}return s}if(-9007199254740992==t.dx&&-2!=(i=e?t.prev:t.next).outIdx&&(-9007199254740992==i.dx?i.botX!=t.botX&&i.topX!=t.botX&&this.ReverseHorizontal(t):i.botX!=t.botX&&this.ReverseHorizontal(t)),i=t,e){for(;s.topY==s.next.botY&&-2!=s.next.outIdx;)s=s.next;if(-9007199254740992==s.dx&&-2!=s.next.outIdx){for(n=s;-9007199254740992==n.prev.dx;)n=n.prev;n.prev.topX==s.next.topX?e||(s=n.prev):n.prev.topX>s.next.topX&&(s=n.prev)}for(;t!=s;)t.nextInLML=t.next,-9007199254740992==t.dx&&t!=i&&t.botX!=t.prev.topX&&this.ReverseHorizontal(t),t=t.next;-9007199254740992==t.dx&&t!=i&&t.botX!=t.prev.topX&&this.ReverseHorizontal(t),s=s.next}else{for(;s.topY==s.prev.botY&&-2!=s.prev.outIdx;)s=s.prev;if(-9007199254740992==s.dx&&-2!=s.prev.outIdx){for(n=s;-9007199254740992==n.next.dx;)n=n.next;n.next.topX==s.prev.topX?e||(s=n.next):n.next.topX>s.prev.topX&&(s=n.next)}for(;t!=s;)t.nextInLML=t.prev,-9007199254740992==t.dx&&t!=i&&t.botX!=t.next.topX&&this.ReverseHorizontal(t),t=t.prev;-9007199254740992==t.dx&&t!=i&&t.botX!=t.next.topX&&this.ReverseHorizontal(t),s=s.prev}return s},ReverseHorizontal:function(t){var e=t.topX;t.topX=t.botX,t.botX=e},Pt2IsBetweenPt1AndPt3:function(t,e,i){return!(t.x==i.x&&t.y==i.y||t.x==e.x&&t.y==e.y||i.x==e.x&&i.y==e.y)&&(t.x!=i.x?e.x>t.x==e.x<i.x:e.y>t.y==e.y<i.y)},SetDx:function(t){t.deltaX=t.topX-t.botX,t.deltaY=t.topY-t.botY,0==t.deltaY?t.dx=-9007199254740992:t.dx=t.deltaX/t.deltaY},InsertLocalMinima:function(t){if(null==this.m_MinimaList)this.m_MinimaList=t;else if(t.y>=this.m_MinimaList.y)t.next=this.m_MinimaList,this.m_MinimaList=t;else{for(var e=this.m_MinimaList;null!=e.next&&t.y<e.next.y;)e=e.next;t.next=e.next,e.next=t}},PopLocalMinima:function(){null!=this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.next)},SwapX:function(t){t.currX=t.topX,t.topX=t.botX,t.botX=t.currX},equals:function(t,e){return t.x==e.x&&t.y==e.y},Reset:function(){this.m_CurrentLM=this.m_MinimaList;for(var t=this.m_MinimaList;null!=t;){var e=t.leftBound;null!=e&&(e.currX=e.botX,e.currY=e.botY,e.side=Ys.Left,e.outIdx=-1,e=e.nextInLML),null!=(e=t.rightBound)&&(e.currX=e.botX,e.currY=e.botY,e.side=Ys.Right,e.outIdx=-1,e=e.nextInLML),t=t.next}},__class__:ir};var nr=s["hxd.clipper.NodeType"]={__ename__:!0,__constructs__:null,Any:{_hx_name:"Any",_hx_index:0,__enum__:"hxd.clipper.NodeType",toString:n},Open:{_hx_name:"Open",_hx_index:1,__enum__:"hxd.clipper.NodeType",toString:n},Closed:{_hx_name:"Closed",_hx_index:2,__enum__:"hxd.clipper.NodeType",toString:n}};nr.__constructs__=[nr.Any,nr.Open,nr.Closed],nr.__empty_constructs__=[nr.Any,nr.Open,nr.Closed];var sr=s["hxd.clipper.ResultKind"]={__ename__:!0,__constructs__:null,All:{_hx_name:"All",_hx_index:0,__enum__:"hxd.clipper.ResultKind",toString:n},NoHoles:{_hx_name:"NoHoles",_hx_index:1,__enum__:"hxd.clipper.ResultKind",toString:n},HolesOnly:{_hx_name:"HolesOnly",_hx_index:2,__enum__:"hxd.clipper.ResultKind",toString:n}};sr.__constructs__=[sr.All,sr.NoHoles,sr.HolesOnly],sr.__empty_constructs__=[sr.All,sr.NoHoles,sr.HolesOnly];var rr=function(){ir.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=[],this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=[],this.m_Joins=[],this.m_GhostJoins=[],this.reverseSolution=!1,this.strictlySimple=!1,this.preserveCollinear=!1,this.resultKind=sr.All};i["hxd.clipper.Clipper"]=rr,rr.__name__="hxd.clipper.Clipper",rr.compareY=function(t,e){return e.pt.y-t.pt.y>=0?1:-1},rr.Orientation=function(t){return rr.polArea(t)>=0},rr.polArea=function(t){var e=t.length;if(e<3)return 0;for(var i=0,n=e-1,s=0,r=e;s<r;){var a=s++;i+=(t[n].x+t[a].x)*(t[n].y-t[a].y),n=a}return.5*-i},rr.SimplifyPolygon=function(t,e){null==e&&(e=or.EvenOdd);var i=new rr;return i.strictlySimple=!0,i.addPolygon(t,lr.Subject),i.execute(Ns.Union,e,e)},rr.SimplifyPolygons=function(t,e){null==e&&(e=or.EvenOdd);var i=new rr;return i.strictlySimple=!0,i.addPolygons(t,lr.Subject),i.execute(Ns.Union,e,e)},rr.MinkowskiSums=function(t,e,i){var n=new rr;n.resultKind=null==i?sr.All:i;for(var s=0,r=e.length;s<r;){var a=s++,A=n.Minkowski(t,e[a],!0);n.addPolygons(A,lr.Subject);var h=n.TranslatePath(e[a],t[0]);n.addPolygon(h,lr.Clip)}return n.execute(Ns.Union,or.NonZero,or.NonZero)},rr.MinkowskiDiff=function(t,e,i){var n=new rr,s=n.Minkowski(t,e,!1);return n.resultKind=null==i?sr.All:i,n.addPolygons(s,lr.Subject),n.execute(Ns.Union,or.NonZero,or.NonZero)},rr.__super__=ir,rr.prototype=r(ir.prototype,{xor:function(t,e){return t?!e:e},DisposeScanbeamList:function(){for(;null!=this.m_Scanbeam;){var t=this.m_Scanbeam.next;this.m_Scanbeam=null,this.m_Scanbeam=t}},Reset:function(){ir.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var t=this.m_MinimaList;null!=t;)this.InsertScanbeam(t.y),t=t.next},InsertScanbeam:function(t){if(null==this.m_Scanbeam)this.m_Scanbeam=new Ks,this.m_Scanbeam.next=null,this.m_Scanbeam.y=t;else if(t>this.m_Scanbeam.y){(i=new Ks).y=t,i.next=this.m_Scanbeam,this.m_Scanbeam=i}else{for(var e=this.m_Scanbeam;null!=e.next&&t<=e.next.y;)e=e.next;if(t==e.y)return;var i;(i=new Ks).y=t,i.next=e.next,e.next=i}},execute:function(t,e,i){if(null==e&&(e=or.EvenOdd),null==i&&(i=or.EvenOdd),this.m_ExecuteLocked)return[];this.m_ExecuteLocked=!0;var n=[];return this.m_SubjFillType=e,this.m_ClipFillType=i,this.m_ClipType=t,this.m_UsingPolyTree=!1,this.ExecuteInternal()&&(n=this.BuildResult()),this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1,n},ExecuteTree:function(t,e,i,n){if(null==i&&(i=or.EvenOdd),null==n&&(n=or.EvenOdd),this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=i,this.m_ClipFillType=n,this.m_ClipType=t,this.m_UsingPolyTree=!0;var s=this.ExecuteInternal();return s&&this.BuildResult2(e),this.m_ExecuteLocked=!1,s},FixHoleLinkage:function(t){if(null!=t.firstLeft&&(t.isHole==t.firstLeft.isHole||null==t.firstLeft.pts)){for(var e=t.firstLeft;null!=e&&(e.isHole==t.isHole||null==e.pts);)e=e.firstLeft;t.firstLeft=e}},ExecuteInternal:function(){if(this.Reset(),null==this.m_CurrentLM)return!1;for(var t=this.PopScanbeam();this.InsertLocalMinimaIntoAEL(t),this.m_GhostJoins.length>0&&(this.m_GhostJoins=[]),this.ProcessHorizontals(!1),null!=this.m_Scanbeam;){var e=this.PopScanbeam();if(!this.ProcessIntersections(e))return!1;if(this.ProcessEdgesAtTopOfScanbeam(e),t=e,null==this.m_Scanbeam&&null==this.m_CurrentLM)break}for(var i=0,n=this.m_PolyOuts;i<n.length;){var s=n[i];if(++i,null!=s.pts){var r=this.reverseSolution;(s.isHole?!r:r)==this.Area(s)>0&&this.ReversePolyPtLinks(s.pts)}}this.JoinCommonEdges();for(i=0,n=this.m_PolyOuts;i<n.length;){s=n[i];++i,null!=s.pts&&this.FixupOutPolygon(s)}return this.strictlySimple&&this.DoSimplePolygons(),this.m_Joins=[],this.m_GhostJoins=[],!0},PopScanbeam:function(){var t=this.m_Scanbeam.y;return this.m_Scanbeam=this.m_Scanbeam.next,t},DisposeAllPolyPts:function(){for(var t=0,e=this.m_PolyOuts.length;t<e;){var i=t++;this.DisposeOutRec(i)}this.m_PolyOuts=[]},DisposeOutRec:function(t){var e=this.m_PolyOuts[t];e.pts=null,e=null,this.m_PolyOuts[t]=null},AddJoin:function(t,e,i){var n=new er;n.outPt1=t,n.outPt2=e,n.offPt=i,this.m_Joins.push(n)},AddGhostJoin:function(t,e){var i=new er;i.outPt1=t,i.offPt=e,this.m_GhostJoins.push(i)},InsertLocalMinimaIntoAEL:function(t){for(;null!=this.m_CurrentLM&&this.m_CurrentLM.y==t;){var e=this.m_CurrentLM.leftBound,i=this.m_CurrentLM.rightBound;this.PopLocalMinima();var n=null;if(null==e?(this.InsertEdgeIntoAEL(i),this.SetWindingCount(i),this.IsContributing(i)&&(n=this.AddOutPt(i,new bt(i.botX,i.botY)))):null==i?(this.InsertEdgeIntoAEL(e),this.SetWindingCount(e),this.IsContributing(e)&&(n=this.AddOutPt(e,new bt(e.botX,e.botY))),this.InsertScanbeam(e.topY)):(this.InsertEdgeIntoAEL(e),this.InsertEdgeIntoAEL(i,e),this.SetWindingCount(e),i.windCnt=e.windCnt,i.windCnt2=e.windCnt2,this.IsContributing(e)&&(n=this.AddLocalMinPoly(e,i,new bt(e.botX,e.botY))),this.InsertScanbeam(e.topY)),null!=i&&(0==i.deltaY?this.AddEdgeToSEL(i):this.InsertScanbeam(i.topY)),null!=e&&null!=i){if(null!=n&&0==i.deltaY&&this.m_GhostJoins.length>0&&0!=i.windDelta)for(var s=0,r=this.m_GhostJoins;s<r.length;){var a=r[s];++s,this.HorzSegmentsOverlap(a.outPt1.pt.x,a.offPt.x,i.botX,i.topX)&&this.AddJoin(a.outPt1,n,a.offPt)}var A;if(e.outIdx>=0&&null!=e.prevInAEL&&e.prevInAEL.currX==e.botX&&e.prevInAEL.outIdx>=0){var h=e.prevInAEL;A=h.deltaY*e.deltaX==h.deltaX*e.deltaY}else A=!1;if(A&&0!=e.windDelta&&0!=e.prevInAEL.windDelta){var o=this.AddOutPt(e.prevInAEL,new bt(e.botX,e.botY));this.AddJoin(n,o,new bt(e.topX,e.topY))}if(e.nextInAEL!=i){var l;if(i.outIdx>=0&&i.prevInAEL.outIdx>=0){var u=i.prevInAEL;l=u.deltaY*i.deltaX==u.deltaX*i.deltaY}else l=!1;if(l&&0!=i.windDelta&&0!=i.prevInAEL.windDelta){var _=this.AddOutPt(i.prevInAEL,new bt(i.botX,i.botY));this.AddJoin(n,_,new bt(i.topX,i.topY))}var c=e.nextInAEL;if(null!=c)for(;c!=i;)this.IntersectEdges(i,c,new bt(e.currX,e.currY)),c=c.nextInAEL}}}},InsertEdgeIntoAEL:function(t,e){if(null==this.m_ActiveEdges)t.prevInAEL=null,t.nextInAEL=null,this.m_ActiveEdges=t;else if(null==e&&this.E2InsertsBeforeE1(this.m_ActiveEdges,t))t.prevInAEL=null,t.nextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.prevInAEL=t,this.m_ActiveEdges=t;else{for(null==e&&(e=this.m_ActiveEdges);null!=e.nextInAEL&&!this.E2InsertsBeforeE1(e.nextInAEL,t);)e=e.nextInAEL;t.nextInAEL=e.nextInAEL,null!=e.nextInAEL&&(e.nextInAEL.prevInAEL=t),t.prevInAEL=e,e.nextInAEL=t}},E2InsertsBeforeE1:function(t,e){if(e.currX==t.currX){if(e.topY>t.topY){if((n=e.topY)==t.topY)s=t.topX;else{var i=t.dx*(n-t.botY);s=t.botX+(i<0?i-.5|0:i+.5|0)}return e.topX<s}var n,s;if((n=t.topY)==e.topY)s=e.topX;else{i=e.dx*(n-e.botY);s=e.botX+(i<0?i-.5|0:i+.5|0)}return t.topX>s}return e.currX<t.currX},IsEvenOddFillType:function(t){return t.polyType==lr.Subject?this.m_SubjFillType==or.EvenOdd:this.m_ClipFillType==or.EvenOdd},IsEvenOddAltFillType:function(t){return t.polyType==lr.Subject?this.m_ClipFillType==or.EvenOdd:this.m_SubjFillType==or.EvenOdd},IsContributing:function(t){var e,i;switch(t.polyType==lr.Subject?(e=this.m_SubjFillType,i=this.m_ClipFillType):(e=this.m_ClipFillType,i=this.m_SubjFillType),e._hx_index){case 0:if(0==t.windDelta&&1!=t.windCnt)return!1;break;case 1:var n=t.windCnt;if(1!=(n<0?-n:n))return!1;break;case 2:if(1!=t.windCnt)return!1;break;default:if(-1!=t.windCnt)return!1}switch(this.m_ClipType._hx_index){case 0:switch(i._hx_index){case 0:case 1:return 0!=t.windCnt2;case 2:return t.windCnt2>0;default:return t.windCnt2<0}break;case 1:switch(i._hx_index){case 0:case 1:return 0==t.windCnt2;case 2:return t.windCnt2<=0;default:return t.windCnt2>=0}break;case 2:if(t.polyType==lr.Subject)switch(i._hx_index){case 0:case 1:return 0==t.windCnt2;case 2:return t.windCnt2<=0;default:return t.windCnt2>=0}else switch(i._hx_index){case 0:case 1:return 0!=t.windCnt2;case 2:return t.windCnt2>0;default:return t.windCnt2<0}break;case 3:if(0!=t.windDelta)return!0;switch(i._hx_index){case 0:case 1:return 0==t.windCnt2;case 2:return t.windCnt2<=0;default:return t.windCnt2>=0}}},SetWindingCount:function(t){for(var e=t.prevInAEL;null!=e&&(e.polyType!=t.polyType||0==e.windDelta);)e=e.prevInAEL;if(null==e)t.windCnt=0==t.windDelta?1:t.windDelta,t.windCnt2=0,e=this.m_ActiveEdges;else if(0==t.windDelta&&this.m_ClipType!=Ns.Union)t.windCnt=1,t.windCnt2=e.windCnt2,e=e.nextInAEL;else if(t.polyType==lr.Subject?this.m_SubjFillType==or.EvenOdd:this.m_ClipFillType==or.EvenOdd){if(0==t.windDelta){for(var i=!0,n=e.prevInAEL;null!=n;)n.polyType==e.polyType&&0!=n.windDelta&&(i=!i),n=n.prevInAEL;t.windCnt=i?0:1}else t.windCnt=t.windDelta;t.windCnt2=e.windCnt2,e=e.nextInAEL}else e.windCnt*e.windDelta<0?e.windCnt>1||e.windCnt<-1?e.windDelta*t.windDelta<0?t.windCnt=e.windCnt:t.windCnt=e.windCnt+t.windDelta:t.windCnt=0==t.windDelta?1:t.windDelta:0==t.windDelta?t.windCnt=e.windCnt<0?e.windCnt-1:e.windCnt+1:e.windDelta*t.windDelta<0?t.windCnt=e.windCnt:t.windCnt=e.windCnt+t.windDelta,t.windCnt2=e.windCnt2,e=e.nextInAEL;if(t.polyType==lr.Subject?this.m_ClipFillType==or.EvenOdd:this.m_SubjFillType==or.EvenOdd)for(;e!=t;)0!=e.windDelta&&(t.windCnt2=0==t.windCnt2?1:0),e=e.nextInAEL;else for(;e!=t;)t.windCnt2+=e.windDelta,e=e.nextInAEL},AddEdgeToSEL:function(t){null==this.m_SortedEdges?(this.m_SortedEdges=t,t.prevInSEL=null,t.nextInSEL=null):(t.nextInSEL=this.m_SortedEdges,t.prevInSEL=null,this.m_SortedEdges.prevInSEL=t,this.m_SortedEdges=t)},CopyAELToSEL:function(){var t=this.m_ActiveEdges;for(this.m_SortedEdges=t;null!=t;)t.prevInSEL=t.prevInAEL,t.nextInSEL=t.nextInAEL,t=t.nextInAEL},SwapPositionsInAEL:function(t,e){if(t.nextInAEL!=t.prevInAEL&&e.nextInAEL!=e.prevInAEL){if(t.nextInAEL==e)null!=(i=e.nextInAEL)&&(i.prevInAEL=t),null!=(n=t.prevInAEL)&&(n.nextInAEL=e),e.prevInAEL=n,e.nextInAEL=t,t.prevInAEL=e,t.nextInAEL=i;else if(e.nextInAEL==t){null!=(i=t.nextInAEL)&&(i.prevInAEL=e),null!=(n=e.prevInAEL)&&(n.nextInAEL=t),t.prevInAEL=n,t.nextInAEL=e,e.prevInAEL=t,e.nextInAEL=i}else{var i=t.nextInAEL,n=t.prevInAEL;t.nextInAEL=e.nextInAEL,null!=t.nextInAEL&&(t.nextInAEL.prevInAEL=t),t.prevInAEL=e.prevInAEL,null!=t.prevInAEL&&(t.prevInAEL.nextInAEL=t),e.nextInAEL=i,null!=e.nextInAEL&&(e.nextInAEL.prevInAEL=e),e.prevInAEL=n,null!=e.prevInAEL&&(e.prevInAEL.nextInAEL=e)}null==t.prevInAEL?this.m_ActiveEdges=t:null==e.prevInAEL&&(this.m_ActiveEdges=e)}},SwapPositionsInSEL:function(t,e){if(!(null==t.nextInSEL&&null==t.prevInSEL||null==e.nextInSEL&&null==e.prevInSEL)){if(t.nextInSEL==e)null!=(i=e.nextInSEL)&&(i.prevInSEL=t),null!=(n=t.prevInSEL)&&(n.nextInSEL=e),e.prevInSEL=n,e.nextInSEL=t,t.prevInSEL=e,t.nextInSEL=i;else if(e.nextInSEL==t){null!=(i=t.nextInSEL)&&(i.prevInSEL=e),null!=(n=e.prevInSEL)&&(n.nextInSEL=t),t.prevInSEL=n,t.nextInSEL=e,e.prevInSEL=t,e.nextInSEL=i}else{var i=t.nextInSEL,n=t.prevInSEL;t.nextInSEL=e.nextInSEL,null!=t.nextInSEL&&(t.nextInSEL.prevInSEL=t),t.prevInSEL=e.prevInSEL,null!=t.prevInSEL&&(t.prevInSEL.nextInSEL=t),e.nextInSEL=i,null!=e.nextInSEL&&(e.nextInSEL.prevInSEL=e),e.prevInSEL=n,null!=e.prevInSEL&&(e.prevInSEL.nextInSEL=e)}null==t.prevInSEL?this.m_SortedEdges=t:null==e.prevInSEL&&(this.m_SortedEdges=e)}},AddLocalMaxPoly:function(t,e,i){this.AddOutPt(t,i),0==e.windDelta&&this.AddOutPt(e,i),t.outIdx==e.outIdx?(t.outIdx=-1,e.outIdx=-1):t.outIdx<e.outIdx?this.AppendPolygon(t,e):this.AppendPolygon(e,t)},AddLocalMinPoly:function(t,e,i){var n,s,r,a;if(0==e.deltaY||t.dx>e.dx?(n=this.AddOutPt(t,i),e.outIdx=t.outIdx,t.side=Ys.Left,e.side=Ys.Right,r=(s=t).prevInAEL==e?e.prevInAEL:s.prevInAEL):(n=this.AddOutPt(e,i),t.outIdx=e.outIdx,t.side=Ys.Right,e.side=Ys.Left,r=(s=e).prevInAEL==t?t.prevInAEL:s.prevInAEL),null!=r&&r.outIdx>=0){var A,h,o;if((h=i.y)==r.topY)A=r.topX;else{var l=r.dx*(h-r.botY);A=r.botX+(l<0?l-.5|0:l+.5|0)}if((h=i.y)==s.topY)o=s.topX;else{l=s.dx*(h-s.botY);o=s.botX+(l<0?l-.5|0:l+.5|0)}a=A==o}else a=!1;if(a&&s.deltaY*r.deltaX==s.deltaX*r.deltaY&&0!=s.windDelta&&0!=r.windDelta){var u=this.AddOutPt(r,i);this.AddJoin(n,u,new bt(s.topX,s.topY))}return n},CreateOutRec:function(){var t=new $s;return t.idx=-1,t.isHole=!1,t.firstLeft=null,t.pts=null,t.bottomPt=null,t.polyNode=null,this.m_PolyOuts.push(t),t.idx=this.m_PolyOuts.length-1,t},AddOutPt:function(t,e){var i=t.side==Ys.Left;if(t.outIdx<0){var n=this.CreateOutRec(),s=new tr;return n.pts=s,s.idx=n.idx,s.pt=new bt(e.x,e.y),s.next=s,s.prev=s,this.SetHoleState(t,n),t.outIdx=n.idx,s}var r;s=(n=this.m_PolyOuts[t.outIdx]).pts;if(i){var a=s.pt;r=e.x==a.x&&e.y==a.y}else r=!1;if(r)return s;if(i)r=!1;else{a=s.prev.pt;r=e.x==a.x&&e.y==a.y}if(r)return s.prev;var A=new tr;return A.idx=n.idx,A.pt=new bt(e.x,e.y),A.next=s,A.prev=s.prev,A.prev.next=A,s.prev=A,i&&(n.pts=A),A},HorzSegmentsOverlap:function(t,e,i,n){if(t>e){var s=t;t=e,e=s}if(i>n){s=i;i=n,n=s}return t<n&&i<e},SetHoleState:function(t,e){for(var i=!1,n=t.prevInAEL;null!=n;)n.outIdx>=0&&0!=n.windDelta&&(i=!i,null==e.firstLeft&&(e.firstLeft=this.m_PolyOuts[n.outIdx])),n=n.prevInAEL;i&&(e.isHole=!0)},GetDx:function(t,e){return t.y==e.y?-9007199254740992:(e.x-t.x)/(e.y-t.y)},FirstIsBottomPt:function(t,e){for(var i=t.prev;;){var n=i.pt,s=t.pt;if(n.x!=s.x||n.y!=s.y||i==t)break;i=i.prev}var r=(h=this.GetDx(t.pt,i.pt))<0?-h:h;for(i=t.next;;){n=i.pt,s=t.pt;if(n.x!=s.x||n.y!=s.y||i==t)break;i=i.next}var a=(h=this.GetDx(t.pt,i.pt))<0?-h:h;for(i=e.prev;;){n=i.pt,s=e.pt;if(n.x!=s.x||n.y!=s.y||i==e)break;i=i.prev}var A=(h=this.GetDx(e.pt,i.pt))<0?-h:h;for(i=e.next;;){n=i.pt,s=e.pt;if(n.x!=s.x||n.y!=s.y||i==e)break;i=i.next}var h,o=(h=this.GetDx(e.pt,i.pt))<0?-h:h;return r>=A&&r>=o||a>=A&&a>=o},GetBottomPt:function(t){for(var e=null,i=t.next;i!=t;)i.pt.y>t.pt.y?(t=i,e=null):i.pt.y==t.pt.y&&i.pt.x<=t.pt.x&&(i.pt.x<t.pt.x?(e=null,t=i):i.next!=t&&i.prev!=t&&(e=i)),i=i.next;if(null!=e)for(;e!=i;)for(this.FirstIsBottomPt(i,e)||(t=e),e=e.next;;){var n=e.pt,s=t.pt;if(n.x==s.x&&n.y==s.y)break;e=e.next}return t},GetLowermostRec:function(t,e){null==t.bottomPt&&(t.bottomPt=this.GetBottomPt(t.pts)),null==e.bottomPt&&(e.bottomPt=this.GetBottomPt(e.pts));var i=t.bottomPt,n=e.bottomPt;return i.pt.y>n.pt.y?t:i.pt.y<n.pt.y?e:i.pt.x<n.pt.x?t:i.pt.x>n.pt.x||i.next==i?e:n.next==n||this.FirstIsBottomPt(i,n)?t:e},Param1RightOfParam2:function(t,e){for(;;){if((t=t.firstLeft)==e)return!0;if(null==t)break}return!1},GetOutRec:function(t){for(var e=this.m_PolyOuts[t];e!=this.m_PolyOuts[e.idx];)e=this.m_PolyOuts[e.idx];return e},AppendPolygon:function(t,e){var i,n=this.m_PolyOuts[t.outIdx],s=this.m_PolyOuts[e.outIdx];i=this.Param1RightOfParam2(n,s)?s:this.Param1RightOfParam2(s,n)?n:this.GetLowermostRec(n,s);var r,a=n.pts,A=a.prev,h=s.pts,o=h.prev;t.side==Ys.Left?(e.side==Ys.Left?(this.ReversePolyPtLinks(h),h.next=a,a.prev=h,A.next=o,o.prev=A,n.pts=o):(o.next=a,a.prev=o,h.prev=A,A.next=h,n.pts=h),r=Ys.Left):(e.side==Ys.Right?(this.ReversePolyPtLinks(h),A.next=o,o.prev=A,h.next=a,a.prev=h):(A.next=h,h.prev=A,a.prev=o,o.next=a),r=Ys.Right),n.bottomPt=null,i==s&&(s.firstLeft!=n&&(n.firstLeft=s.firstLeft),n.isHole=s.isHole),s.pts=null,s.bottomPt=null,s.firstLeft=n;var l=t.outIdx,u=e.outIdx;t.outIdx=-1,e.outIdx=-1;for(var _=this.m_ActiveEdges;null!=_;){if(_.outIdx==u){_.outIdx=l,_.side=r;break}_=_.nextInAEL}s.idx=n.idx},ReversePolyPtLinks:function(t){if(null!=t)for(var e,i=t;e=i.next,i.next=i.prev,i.prev=e,(i=e)!=t;);},SwapSides:function(t,e){var i=t.side;t.side=e.side,e.side=i},SwapPolyIndexes:function(t,e){var i=t.outIdx;t.outIdx=e.outIdx,e.outIdx=i},IntersectEdges:function(t,e,i){var n,s,r,a,A,h,o=t.outIdx>=0,l=e.outIdx>=0;if(t.polyType==e.polyType)if(t.polyType==lr.Subject?this.m_SubjFillType==or.EvenOdd:this.m_ClipFillType==or.EvenOdd){var u=t.windCnt;t.windCnt=e.windCnt,e.windCnt=u}else t.windCnt+e.windDelta==0?t.windCnt=-t.windCnt:t.windCnt+=e.windDelta,e.windCnt-t.windDelta==0?e.windCnt=-e.windCnt:e.windCnt-=t.windDelta;else(e.polyType==lr.Subject?this.m_SubjFillType==or.EvenOdd:this.m_ClipFillType==or.EvenOdd)?t.windCnt2=0==t.windCnt2?1:0:t.windCnt2+=e.windDelta,(t.polyType==lr.Subject?this.m_SubjFillType==or.EvenOdd:this.m_ClipFillType==or.EvenOdd)?e.windCnt2=0==e.windCnt2?1:0:e.windCnt2-=t.windDelta;switch(t.polyType==lr.Subject?(n=this.m_SubjFillType,r=this.m_ClipFillType):(n=this.m_ClipFillType,r=this.m_SubjFillType),e.polyType==lr.Subject?(s=this.m_SubjFillType,a=this.m_ClipFillType):(s=this.m_ClipFillType,a=this.m_SubjFillType),n._hx_index){case 2:A=t.windCnt;break;case 3:A=-t.windCnt;break;default:A=(f=t.windCnt)<0?-f:f}switch(s._hx_index){case 2:h=e.windCnt;break;case 3:h=-e.windCnt;break;default:h=(f=e.windCnt)<0?-f:f}if(o&&l)if(0!=A&&1!=A||0!=h&&1!=h||t.polyType!=e.polyType&&this.m_ClipType!=Ns.Xor)this.AddLocalMaxPoly(t,e,i);else{this.AddOutPt(t,i),this.AddOutPt(e,i);var _=t.side;t.side=e.side,e.side=_,this.SwapPolyIndexes(t,e)}else if(o){if(0==h||1==h){this.AddOutPt(t,i);_=t.side;t.side=e.side,e.side=_,this.SwapPolyIndexes(t,e)}}else if(l){if(0==A||1==A){this.AddOutPt(e,i);_=t.side;t.side=e.side,e.side=_,this.SwapPolyIndexes(t,e)}}else if(!(0!=A&&1!=A||0!=h&&1!=h)){var c,d;switch(r._hx_index){case 2:c=t.windCnt2;break;case 3:c=-t.windCnt2;break;default:c=(f=t.windCnt2)<0?-f:f}switch(a._hx_index){case 2:d=e.windCnt2;break;case 3:d=-e.windCnt2;break;default:var f;d=(f=e.windCnt2)<0?-f:f}if(t.polyType!=e.polyType)this.AddLocalMinPoly(t,e,i);else if(1==A&&1==h)switch(this.m_ClipType._hx_index){case 0:c>0&&d>0&&this.AddLocalMinPoly(t,e,i);break;case 1:c<=0&&d<=0&&this.AddLocalMinPoly(t,e,i);break;case 2:(t.polyType==lr.Clip&&c>0&&d>0||t.polyType==lr.Subject&&c<=0&&d<=0)&&this.AddLocalMinPoly(t,e,i);break;case 3:this.AddLocalMinPoly(t,e,i)}else{_=t.side;t.side=e.side,e.side=_}}},DeleteFromAEL:function(t){var e=t.prevInAEL,i=t.nextInAEL;null==e&&null==i&&t!=this.m_ActiveEdges||(null!=e?e.nextInAEL=i:this.m_ActiveEdges=i,null!=i&&(i.prevInAEL=e),t.nextInAEL=null,t.prevInAEL=null)},DeleteFromSEL:function(t){var e=t.prevInSEL,i=t.nextInSEL;null==e&&null==i&&t!=this.m_SortedEdges||(null!=e?e.nextInSEL=i:this.m_SortedEdges=i,null!=i&&(i.prevInSEL=e),t.nextInSEL=null,t.prevInSEL=null)},UpdateEdgeIntoAEL:function(t){if(null==t.nextInLML)throw kn.thrown("UpdateEdgeIntoAEL: invalid call");var e=t.prevInAEL,i=t.nextInAEL;return t.nextInLML.outIdx=t.outIdx,null!=e?e.nextInAEL=t.nextInLML:this.m_ActiveEdges=t.nextInLML,null!=i&&(i.prevInAEL=t.nextInLML),t.nextInLML.side=t.side,t.nextInLML.windDelta=t.windDelta,t.nextInLML.windCnt=t.windCnt,t.nextInLML.windCnt2=t.windCnt2,(t=t.nextInLML).currX=t.botX,t.currY=t.botY,t.prevInAEL=e,t.nextInAEL=i,0!=t.deltaY&&this.InsertScanbeam(t.topY),t},GetHorzDirection:function(t){return t.botX<t.topX?{left:t.botX,right:t.topX,dir:Xs.LeftToRight}:{left:t.topX,right:t.botX,dir:Xs.RightToLeft}},ProcessHorizontals:function(t){for(var e=this.m_SortedEdges;null!=e;)this.DeleteFromSEL(e),this.ProcessHorizontal(e,t),e=this.m_SortedEdges},ProcessHorizontal:function(t,e){for(var i=this.GetHorzDirection(t),n=i.dir,s=i.left,r=i.right,a=t,A=null;null!=a.nextInLML&&0==a.nextInLML.deltaY;)a=a.nextInLML;for(null==a.nextInLML&&(A=this.GetMaximaPair(a));;){for(var h=t==a,o=n==Xs.LeftToRight?t.nextInAEL:t.prevInAEL;null!=o&&!(o.currX==t.topX&&null!=t.nextInLML&&o.dx<t.nextInLML.dx);){var l=n==Xs.LeftToRight?o.nextInAEL:o.prevInAEL;if(n==Xs.LeftToRight&&o.currX<=r||n==Xs.RightToLeft&&o.currX>=s){if(o==A&&h){if(t.outIdx>=0){for(var u=this.AddOutPt(t,new bt(t.topX,t.topY)),_=this.m_SortedEdges;null!=_;){if(_.outIdx>=0&&this.HorzSegmentsOverlap(t.botX,t.topX,_.botX,_.topX)){var c=this.AddOutPt(_,new bt(_.botX,_.botY));this.AddJoin(c,u,new bt(_.topX,_.topY))}_=_.nextInSEL}this.AddGhostJoin(u,new bt(t.botX,t.botY)),this.AddLocalMaxPoly(t,A,new bt(t.topX,t.topY))}return this.DeleteFromAEL(t),void this.DeleteFromAEL(A)}if(n==Xs.LeftToRight){var d=new bt(o.currX,t.currY);this.IntersectEdges(t,o,d)}else{var f=new bt(o.currX,t.currY);this.IntersectEdges(o,t,f)}this.SwapPositionsInAEL(t,o)}else if(n==Xs.LeftToRight&&o.currX>=r||n==Xs.RightToLeft&&o.currX<=s)break;o=l}if(null==t.nextInLML||0!=t.nextInLML.deltaY)break;(t=this.UpdateEdgeIntoAEL(t)).outIdx>=0&&this.AddOutPt(t,new bt(t.botX,t.botY));var x=this.GetHorzDirection(t);n=x.dir,s=x.left,r=x.right}if(null!=t.nextInLML)if(t.outIdx>=0){u=this.AddOutPt(t,new bt(t.topX,t.topY));if(e&&this.AddGhostJoin(u,new bt(t.botX,t.botY)),0==(t=this.UpdateEdgeIntoAEL(t)).windDelta)return;var p=t.prevInAEL;l=t.nextInAEL;if(null!=p&&p.currX==t.botX&&p.currY==t.botY&&0!=p.windDelta&&p.outIdx>=0&&p.currY>p.topY&&t.deltaY*p.deltaX==t.deltaX*p.deltaY){c=this.AddOutPt(p,new bt(t.botX,t.botY));this.AddJoin(u,c,new bt(t.topX,t.topY))}else if(null!=l&&l.currX==t.botX&&l.currY==t.botY&&0!=l.windDelta&&l.outIdx>=0&&l.currY>l.topY&&t.deltaY*l.deltaX==t.deltaX*l.deltaY){c=this.AddOutPt(l,new bt(t.botX,t.botY));this.AddJoin(u,c,new bt(t.topX,t.topY))}}else t=this.UpdateEdgeIntoAEL(t);else t.outIdx>=0&&this.AddOutPt(t,new bt(t.topX,t.topY)),this.DeleteFromAEL(t)},GetNextInAEL:function(t,e){return e==Xs.LeftToRight?t.nextInAEL:t.prevInAEL},IsMinima:function(t){return null!=t&&t.prev.nextInLML!=t&&t.next.nextInLML!=t},IsMaxima:function(t,e){return null!=t&&t.topY==e&&null==t.nextInLML},IsIntermediate:function(t,e){return t.topY==e&&null!=t.nextInLML},GetMaximaPair:function(t){var e=null;return t.next.topX==t.topX&&t.next.topY==t.topY&&null==t.next.nextInLML?e=t.next:t.prev.topX==t.topX&&t.prev.topY==t.topY&&null==t.prev.nextInLML&&(e=t.prev),null!=e&&(-2==e.outIdx||e.nextInAEL==e.prevInAEL&&0!=e.deltaY)?null:e},ProcessIntersections:function(t){return null==this.m_ActiveEdges||(this.BuildIntersectList(t),0==this.m_IntersectList.length||!(1!=this.m_IntersectList.length&&!this.FixupIntersectionOrder())&&(this.ProcessIntersectList(),this.m_SortedEdges=null,!0))},BuildIntersectList:function(t){if(null!=this.m_ActiveEdges){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;null!=e;){var i;if(e.prevInSEL=e.prevInAEL,e.nextInSEL=e.nextInAEL,t==e.topY)i=e.topX;else{var n=e.dx*(t-e.botY);i=e.botX+(n<0?n-.5|0:n+.5|0)}e.currX=i,e=e.nextInAEL}for(var s=!0;s&&null!=this.m_SortedEdges;){for(s=!1,e=this.m_SortedEdges;null!=e.nextInSEL;){var r,a=e.nextInSEL;if(e.currX>a.currX){var A,h,o,l;if(e.dx==a.dx){if((h=e.currY)==e.topY)A=e.topX;else{n=e.dx*(h-e.botY);A=e.botX+(n<0?n-.5|0:n+.5|0)}r=new bt(A,h)}else{if(0==e.deltaX)if(A=e.botX,0==a.deltaY)h=a.botY;else{l=a.botY-a.botX/a.dx;var u=A/a.dx+l;h=u<0?u-.5|0:u+.5|0}else if(0==a.deltaX)if(A=a.botX,0==e.deltaY)h=e.botY;else{o=e.botY-e.botX/e.dx;var _=A/e.dx+o;h=_<0?_-.5|0:_+.5|0}else{o=e.botX-e.botY*e.dx;var c=((l=a.botX-a.botY*a.dx)-o)/(e.dx-a.dx);h=c<0?c-.5|0:c+.5|0;var d=e.dx,f=a.dx;if((d<0?-d:d)<(f<0?-f:f)){var x=e.dx*c+o;A=x<0?x-.5|0:x+.5|0}else{var p=a.dx*c+l;A=p<0?p-.5|0:p+.5|0}}if(h<e.topY||h<a.topY){h=e.topY>a.topY?e.topY:a.topY;var g=e.dx,m=a.dx;if((g<0?-g:g)<(m<0?-m:m))if(h==e.topY)A=e.topX;else{var v=e.dx*(h-e.botY);A=e.botX+(v<0?v-.5|0:v+.5|0)}else if(h==a.topY)A=a.topX;else{var y=a.dx*(h-a.botY);A=a.botX+(y<0?y-.5|0:y+.5|0)}}if(h>e.currY){h=e.currY;var b=e.dx,w=a.dx;if((b<0?-b:b)>(w<0?-w:w))if(h==a.topY)A=a.topX;else{var M=a.dx*(h-a.botY);A=a.botX+(M<0?M-.5|0:M+.5|0)}else if(h==e.topY)A=e.topX;else{var B=e.dx*(h-e.botY);A=e.botX+(B<0?B-.5|0:B+.5|0)}}r=new bt(A,h)}var C=new Js;C.edge1=e,C.edge2=a,C.pt=r,this.m_IntersectList.push(C),this.SwapPositionsInSEL(e,a),s=!0}else e=a}if(null==e.prevInSEL)break;e.prevInSEL.nextInSEL=null}this.m_SortedEdges=null}},EdgesAdjacent:function(t){return t.edge1.nextInSEL==t.edge2||t.edge1.prevInSEL==t.edge2},IntersectNodeSort:function(t,e){return e.pt.y-t.pt.y|0},FixupIntersectionOrder:function(){this.m_IntersectList.sort(rr.compareY);var t=this.m_ActiveEdges;for(this.m_SortedEdges=t;null!=t;)t.prevInSEL=t.prevInAEL,t.nextInSEL=t.nextInAEL,t=t.nextInAEL;for(var e=this.m_IntersectList.length,i=0,n=e;i<n;){var s=i++,r=this.m_IntersectList[s];if(r.edge1.nextInSEL!=r.edge2&&r.edge1.prevInSEL!=r.edge2){for(var a=s+1;;){var A;if(a<e){var h=this.m_IntersectList[a];A=!(h.edge1.nextInSEL==h.edge2||h.edge1.prevInSEL==h.edge2)}else A=!1;if(!A)break;++a}if(a==e)return!1;var o=this.m_IntersectList[s];this.m_IntersectList[s]=this.m_IntersectList[a],this.m_IntersectList[a]=o}this.SwapPositionsInSEL(this.m_IntersectList[s].edge1,this.m_IntersectList[s].edge2)}return!0},ProcessIntersectList:function(){for(var t=0,e=this.m_IntersectList.length;t<e;){var i=t++,n=this.m_IntersectList[i];this.IntersectEdges(n.edge1,n.edge2,n.pt),this.SwapPositionsInAEL(n.edge1,n.edge2)}this.m_IntersectList=[]},Round:function(t){return t<0?t-.5|0:t+.5|0},TopX:function(t,e){if(e==t.topY)return t.topX;var i=t.dx*(e-t.botY);return t.botX+(i<0?i-.5|0:i+.5|0)},IntersectPoint:function(t,e){var i,n,s,r;if(t.dx==e.dx){if((n=t.currY)==t.topY)i=t.topX;else{var a=t.dx*(n-t.botY);i=t.botX+(a<0?a-.5|0:a+.5|0)}return new bt(i,n)}if(0==t.deltaX)i=t.botX,0==e.deltaY?n=e.botY:(r=e.botY-e.botX/e.dx,n=(a=i/e.dx+r)<0?a-.5|0:a+.5|0);else if(0==e.deltaX){if(i=e.botX,0==t.deltaY)n=t.botY;else s=t.botY-t.botX/t.dx,n=(a=i/t.dx+s)<0?a-.5|0:a+.5|0}else{s=t.botX-t.botY*t.dx;var A,h,o=((r=e.botX-e.botY*e.dx)-s)/(t.dx-e.dx);if(n=o<0?o-.5|0:o+.5|0,((A=t.dx)<0?-A:A)<((h=e.dx)<0?-h:h))i=(a=t.dx*o+s)<0?a-.5|0:a+.5|0;else i=(a=e.dx*o+r)<0?a-.5|0:a+.5|0}if(n<t.topY||n<e.topY)if(n=t.topY>e.topY?t.topY:e.topY,((A=t.dx)<0?-A:A)<((h=e.dx)<0?-h:h))if(n==t.topY)i=t.topX;else{a=t.dx*(n-t.botY);i=t.botX+(a<0?a-.5|0:a+.5|0)}else if(n==e.topY)i=e.topX;else{a=e.dx*(n-e.botY);i=e.botX+(a<0?a-.5|0:a+.5|0)}if(n>t.currY)if(n=t.currY,((A=t.dx)<0?-A:A)>((h=e.dx)<0?-h:h))if(n==e.topY)i=e.topX;else{a=e.dx*(n-e.botY);i=e.botX+(a<0?a-.5|0:a+.5|0)}else if(n==t.topY)i=t.topX;else{a=t.dx*(n-t.botY);i=t.botX+(a<0?a-.5|0:a+.5|0)}return new bt(i,n)},ProcessEdgesAtTopOfScanbeam:function(t){for(var e=this.m_ActiveEdges;null!=e;){var i=null!=e&&e.topY==t&&null==e.nextInLML;if(i){var n=this.GetMaximaPair(e);i=null==n||0!=n.deltaY}if(i){var s=e.prevInAEL;this.DoMaxima(e),e=null==s?this.m_ActiveEdges:s.nextInAEL}else{if(e.topY==t&&null!=e.nextInLML&&0==e.nextInLML.deltaY)(e=this.UpdateEdgeIntoAEL(e)).outIdx>=0&&this.AddOutPt(e,new bt(e.botX,e.botY)),this.AddEdgeToSEL(e);else{var r;if(t==e.topY)r=e.topX;else{var a=e.dx*(t-e.botY);r=e.botX+(a<0?a-.5|0:a+.5|0)}e.currX=r,e.currY=t}if(this.strictlySimple){var A=e.prevInAEL;if(e.outIdx>=0&&0!=e.windDelta&&null!=A&&A.outIdx>=0&&A.currX==e.currX&&0!=A.windDelta){var h=new bt(e.currX,e.currY),o=this.AddOutPt(A,h),l=this.AddOutPt(e,h);this.AddJoin(o,l,h)}}e=e.nextInAEL}}for(this.ProcessHorizontals(!0),e=this.m_ActiveEdges;null!=e;){if(e.topY==t&&null!=e.nextInLML){o=null;e.outIdx>=0&&(o=this.AddOutPt(e,new bt(e.topX,e.topY)));s=(e=this.UpdateEdgeIntoAEL(e)).prevInAEL;var u=e.nextInAEL;if(null!=s&&s.currX==e.botX&&s.currY==e.botY&&null!=o&&s.outIdx>=0&&s.currY>s.topY&&e.deltaY*s.deltaX==e.deltaX*s.deltaY&&0!=e.windDelta&&0!=s.windDelta){l=this.AddOutPt(s,new bt(e.botX,e.botY));this.AddJoin(o,l,new bt(e.topX,e.topY))}else if(null!=u&&u.currX==e.botX&&u.currY==e.botY&&null!=o&&u.outIdx>=0&&u.currY>u.topY&&e.deltaY*u.deltaX==e.deltaX*u.deltaY&&0!=e.windDelta&&0!=u.windDelta){var _=this.AddOutPt(u,new bt(e.botX,e.botY));this.AddJoin(o,_,new bt(e.topX,e.topY))}}e=e.nextInAEL}},DoMaxima:function(t){var e=this.GetMaximaPair(t);if(null==e)return t.outIdx>=0&&this.AddOutPt(t,new bt(t.topX,t.topY)),void this.DeleteFromAEL(t);for(var i=t.nextInAEL;null!=i&&i!=e;)this.IntersectEdges(t,i,new bt(t.topX,t.topY)),this.SwapPositionsInAEL(t,i),i=t.nextInAEL;if(-1==t.outIdx&&-1==e.outIdx)this.DeleteFromAEL(t),this.DeleteFromAEL(e);else{if(!(t.outIdx>=0&&e.outIdx>=0))throw kn.thrown("DoMaxima error");t.outIdx>=0&&this.AddLocalMaxPoly(t,e,new bt(t.topX,t.topY)),this.DeleteFromAEL(t),this.DeleteFromAEL(e)}},reversePolygons:function(t){for(var e=0,i=t,n=i.length;e<n;){var s=i[e++];Mt.reverse(s)}},PointCount:function(t){if(null==t)return 0;for(var e=0,i=t;++e,(i=i.next)!=t;);return e},BuildResult:function(){for(var t=[],e=0,i=this.m_PolyOuts;e<i.length;){var n=i[e];if(++e,null!=n.pts&&(this.resultKind!=sr.NoHoles||!n.isHole)&&(this.resultKind!=sr.HolesOnly||n.isHole)){var s=n.pts.prev,r=this.PointCount(s);if(!(r<2)){for(var a=[],A=0,h=r;A<h;){A++;a.push(s.pt),s=s.prev}t.push(a)}}}return t},BuildResult2:function(t){t.clear();for(var e=0,i=this.m_PolyOuts;e<i.length;){var n=i[e];++e;var s=this.PointCount(n.pts);if(!(s<3)){this.FixHoleLinkage(n);var r=new js;t.allPolys.push(r),n.polyNode=r;for(var a=n.pts.prev,A=0,h=s;A<h;){A++;r.polygon.push(a.pt),a=a.prev}}}for(e=0,i=this.m_PolyOuts;e<i.length;){n=i[e];++e,null!=n.polyNode&&(null!=n.firstLeft&&null!=n.firstLeft.polyNode?n.firstLeft.polyNode.addChild(n.polyNode):t.addChild(n.polyNode))}},FixupOutPolygon:function(t){var e=null;t.bottomPt=null;for(var i=t.pts;;){if(i.prev==i||i.prev==i.next)return void(t.pts=null);var n,s,r=i.pt,a=i.next.pt;if(r.x!=a.x||r.y!=a.y){var A=i.pt,h=i.prev.pt;s=A.x==h.x&&A.y==h.y}else s=!0;if(s)n=!0;else{var o=i.prev.pt,l=i.pt,u=i.next.pt;n=!((o.y-l.y)*(l.x-u.x)-(o.x-l.x)*(l.y-u.y)!=0||this.preserveCollinear&&this.Pt2IsBetweenPt1AndPt3(i.prev.pt,i.pt,i.next.pt))}if(n){e=null;i.prev.next=i.next,i.next.prev=i.prev,i=i.prev,null}else{if(i==e)break;null==e&&(e=i),i=i.next}}t.pts=i},DupOutPt:function(t,e){var i=new tr;return i.pt=t.pt,i.idx=t.idx,e?(i.next=t.next,i.prev=t,t.next.prev=i,t.next=i):(i.prev=t.prev,i.next=t,t.prev.next=i,t.prev=i),i},GetOverlap:function(t,e,i,n){var s,r;return t<e?i<n?(s=t<i?i:t,r=e>n?n:e):(s=t<n?n:t,r=e>i?i:e):i<n?(s=e<i?i:e,r=t>n?n:t):(s=e<n?n:e,r=t>i?i:t),{left:s,right:r,done:s<r}},JoinHorz:function(t,e,i,n,s,r){var a=t.pt.x>e.pt.x?Xs.RightToLeft:Xs.LeftToRight,A=i.pt.x>n.pt.x?Xs.RightToLeft:Xs.LeftToRight;if(a==A)return!1;if(a==Xs.LeftToRight){for(;t.next.pt.x<=s.x&&t.next.pt.x>=t.pt.x&&t.next.pt.y==s.y;)t=t.next;r&&t.pt.x!=s.x&&(t=t.next),(e=this.DupOutPt(t,!r)).pt!=s&&((t=e).pt=s,e=this.DupOutPt(t,!r))}else{for(;t.next.pt.x>=s.x&&t.next.pt.x<=t.pt.x&&t.next.pt.y==s.y;)t=t.next;r||t.pt.x==s.x||(t=t.next),(e=this.DupOutPt(t,r)).pt!=s&&((t=e).pt=s,e=this.DupOutPt(t,r))}if(A==Xs.LeftToRight){for(;i.next.pt.x<=s.x&&i.next.pt.x>=i.pt.x&&i.next.pt.y==s.y;)i=i.next;r&&i.pt.x!=s.x&&(i=i.next),(n=this.DupOutPt(i,!r)).pt!=s&&((i=n).pt=s,n=this.DupOutPt(i,!r))}else{for(;i.next.pt.x>=s.x&&i.next.pt.x<=i.pt.x&&i.next.pt.y==s.y;)i=i.next;r||i.pt.x==s.x||(i=i.next),(n=this.DupOutPt(i,r)).pt!=s&&((i=n).pt=s,n=this.DupOutPt(i,r))}return a==Xs.LeftToRight==r?(t.prev=i,i.next=t,e.next=n,n.prev=e):(t.next=i,i.prev=t,e.prev=n,n.next=e),!0},JoinPoints:function(t,e,i){var n,s,r,a,A,h=t.outPt1,o=t.outPt2,l=t.outPt1.pt.y==t.offPt.y;if(l){var u=t.offPt,_=t.outPt1.pt;r=u.x==_.x&&u.y==_.y}else r=!1;if(r){u=t.offPt,_=t.outPt2.pt;v=u.x==_.x&&u.y==_.y}else v=!1;if(v){if(e!=i)return!1;for(n=t.outPt1.next;;){if(n!=h){u=n.pt,_=t.offPt;v=u.x==_.x&&u.y==_.y}else v=!1;if(!v)break;n=n.next}var c=n.pt.y>t.offPt.y;for(s=t.outPt2.next;;){if(s!=o){u=s.pt,_=t.offPt;v=u.x==_.x&&u.y==_.y}else v=!1;if(!v)break;s=s.next}return c!=s.pt.y>t.offPt.y&&(c?(n=this.DupOutPt(h,!1),s=this.DupOutPt(o,!0),h.prev=o,o.next=h,n.next=s,s.prev=n,t.outPt1=h,t.outPt2=n,!0):(n=this.DupOutPt(h,!0),s=this.DupOutPt(o,!1),h.next=o,o.prev=h,n.prev=s,s.next=n,t.outPt1=h,t.outPt2=n,!0))}if(l){for(n=h;h.prev.pt.y==h.pt.y&&h.prev!=n&&h.prev!=o;)h=h.prev;for(;n.next.pt.y==n.pt.y&&n.next!=h&&n.next!=o;)n=n.next;if(n.next==h||n.next==o)return!1;for(s=o;o.prev.pt.y==o.pt.y&&o.prev!=s&&o.prev!=n;)o=o.prev;for(;s.next.pt.y==s.pt.y&&s.next!=o&&s.next!=h;)s=s.next;if(s.next==o||s.next==h)return!1;var d=this.GetOverlap(h.pt.x,n.pt.x,o.pt.x,s.pt.x);if(!d.done)return!1;var f,x,p=d.left,g=d.right;return h.pt.x>=p&&h.pt.x<=g?(f=h.pt,x=h.pt.x>n.pt.x):o.pt.x>=p&&o.pt.x<=g?(f=o.pt,x=o.pt.x>s.pt.x):n.pt.x>=p&&n.pt.x<=g?(f=n.pt,x=n.pt.x>h.pt.x):(f=s.pt,x=s.pt.x>o.pt.x),t.outPt1=h,t.outPt2=o,this.JoinHorz(h,n,o,s,f,x)}for(n=h.next;;){u=n.pt,_=h.pt;if(u.x!=_.x||u.y!=_.y||n==h)break;n=n.next}if(n.pt.y<=h.pt.y){u=h.pt,_=n.pt;var m=t.offPt;a=(u.y-_.y)*(_.x-m.x)-(u.x-_.x)*(_.y-m.y)!=0}else a=!0;if(a){for(n=h.prev;;){u=n.pt,_=h.pt;if(u.x!=_.x||u.y!=_.y||n==h)break;n=n.prev}if(n.pt.y<=h.pt.y){u=h.pt,_=n.pt,m=t.offPt;v=(u.y-_.y)*(_.x-m.x)-(u.x-_.x)*(_.y-m.y)!=0}else v=!0;if(v)return!1}for(s=o.next;;){u=s.pt,_=o.pt;if(u.x!=_.x||u.y!=_.y||s==o)break;s=s.next}if(s.pt.y<=o.pt.y){u=o.pt,_=s.pt,m=t.offPt;A=(u.y-_.y)*(_.x-m.x)-(u.x-_.x)*(_.y-m.y)!=0}else A=!0;if(A){for(s=o.prev;;){u=s.pt,_=o.pt;if(u.x!=_.x||u.y!=_.y||s==o)break;s=s.prev}var v;if(s.pt.y<=o.pt.y){u=o.pt,_=s.pt,m=t.offPt;v=(u.y-_.y)*(_.x-m.x)-(u.x-_.x)*(_.y-m.y)!=0}else v=!0;if(v)return!1}return n!=h&&s!=o&&n!=s&&(e!=i||a!=A)&&(a?(n=this.DupOutPt(h,!1),s=this.DupOutPt(o,!0),h.prev=o,o.next=h,n.next=s,s.prev=n,t.outPt1=h,t.outPt2=n,!0):(n=this.DupOutPt(h,!0),s=this.DupOutPt(o,!1),h.next=o,o.prev=h,n.prev=s,s.next=n,t.outPt1=h,t.outPt2=n,!0))},PointInPolygon:function(t,e){var i=0,n=e.length;if(n<3)return 0;for(var s=e[0],r=1,a=n+1;r<a;){var A=r++,h=A==n?e[0]:e[A];if(h.y==t.y&&(h.x==t.x||s.y==t.y&&h.x>t.x==s.x<t.x))return-1;if(s.y<t.y!=h.y<t.y)if(s.x>=t.x)if(h.x>t.x)i=1-i;else{var o=(s.x-t.x)*(h.y-t.y)-(h.x-t.x)*(s.y-t.y);if(0==o)return-1;o>0==h.y>s.y&&(i=1-i)}else if(h.x>t.x){var l=(s.x-t.x)*(h.y-t.y)-(h.x-t.x)*(s.y-t.y);if(0==l)return-1;l>0==h.y>s.y&&(i=1-i)}s=h}return i},PointInPolygon2:function(t,e){for(var i=0,n=e,s=t.x,r=t.y,a=e.pt.x,A=e.pt.y;;){var h=(e=e.next).pt.x,o=e.pt.y;if(o==r&&(h==s||A==r&&h>s==a<s))return-1;if(A<r!=o<r)if(a>=s)if(h>s)i=1-i;else{var l=(a-s)*(o-r)-(h-s)*(A-r);if(0==l)return-1;l>0==o>A&&(i=1-i)}else if(h>s){var u=(a-s)*(o-r)-(h-s)*(A-r);if(0==u)return-1;u>0==o>A&&(i=1-i)}if(a=h,A=o,n==e)break}return i},Poly2ContainsPoly1:function(t,e){for(var i=t;;){var n=this.PointInPolygon2(i.pt,e);if(n>=0)return n>0;if((i=i.next)==t)break}return!0},FixupFirstLefts1:function(t,e){for(var i=0,n=this.m_PolyOuts;i<n.length;){var s=n[i];if(++i,null!=s.pts&&null!=s.firstLeft)this.ParseFirstLeft(s.firstLeft)==t&&this.Poly2ContainsPoly1(s.pts,e.pts)&&(s.firstLeft=e)}},FixupFirstLefts2:function(t,e){for(var i=0,n=this.m_PolyOuts;i<n.length;){var s=n[i];++i,s.firstLeft==t&&(s.firstLeft=e)}},ParseFirstLeft:function(t){for(;null!=t&&null==t.pts;)t=t.firstLeft;return t},JoinCommonEdges:function(){for(var t=0,e=this.m_Joins.length;t<e;){var i,n=t++,s=this.m_Joins[n],r=this.GetOutRec(s.outPt1.idx),a=this.GetOutRec(s.outPt2.idx);if(null!=r.pts&&null!=a.pts)if(i=r==a?r:this.Param1RightOfParam2(r,a)?a:this.Param1RightOfParam2(a,r)?r:this.GetLowermostRec(r,a),this.JoinPoints(s,r,a))if(r==a){if(r.pts=s.outPt1,r.bottomPt=null,(a=this.CreateOutRec()).pts=s.outPt2,this.UpdateOutPtIdxs(a),this.m_UsingPolyTree)for(var A=0,h=this.m_PolyOuts.length-1;A<h;){var o=A++,l=this.m_PolyOuts[o];null!=l.pts&&this.ParseFirstLeft(l.firstLeft)==r&&l.isHole!=r.isHole&&(this.Poly2ContainsPoly1(l.pts,s.outPt2)&&(l.firstLeft=a))}if(this.Poly2ContainsPoly1(a.pts,r.pts)){a.isHole=!r.isHole,a.firstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(a,r);var u=this.reverseSolution;(a.isHole?!u:u)==this.Area(a)>0&&this.ReversePolyPtLinks(a.pts)}else if(this.Poly2ContainsPoly1(r.pts,a.pts)){a.isHole=r.isHole,r.isHole=!a.isHole,a.firstLeft=r.firstLeft,r.firstLeft=a,this.m_UsingPolyTree&&this.FixupFirstLefts2(r,a);var _=this.reverseSolution;(r.isHole?!_:_)==this.Area(r)>0&&this.ReversePolyPtLinks(r.pts)}else a.isHole=r.isHole,a.firstLeft=r.firstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(r,a)}else a.pts=null,a.bottomPt=null,a.idx=r.idx,r.isHole=i.isHole,i==a&&(r.firstLeft=a.firstLeft),a.firstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(a,r)}},UpdateOutPtIdxs:function(t){for(var e=t.pts;e.idx=t.idx,(e=e.prev)!=t.pts;);},DoSimplePolygons:function(){for(var t=0;t<this.m_PolyOuts.length;){var e=this.m_PolyOuts[t++],i=e.pts;if(null!=i)for(;;){for(var n=i.next;n!=e.pts;){var s=i.pt,r=n.pt;if(s.x==r.x&&s.y==r.y&&n.next!=i&&n.prev!=i){var a=i.prev,A=n.prev;i.prev=A,A.next=i,n.prev=a,a.next=n,e.pts=i;var h=this.CreateOutRec();h.pts=n,this.UpdateOutPtIdxs(h),this.Poly2ContainsPoly1(h.pts,e.pts)?(h.isHole=!e.isHole,h.firstLeft=e):this.Poly2ContainsPoly1(e.pts,h.pts)?(h.isHole=e.isHole,e.isHole=!h.isHole,h.firstLeft=e.firstLeft,e.firstLeft=h):(h.isHole=e.isHole,h.firstLeft=e.firstLeft),n=i}n=n.next}if((i=i.next)==e.pts)break}}},Area:function(t){var e=t.pts;if(null==e)return 0;for(var i=0;i+=(e.pt.x+e.prev.pt.x)*(e.prev.pt.y-e.pt.y),(e=e.next)!=t.pts;);return i/2},DistanceFromLineSqrd:function(t,e,i){var n=e.y-i.y,s=i.x-e.x,r=n*e.x+s*e.y;return(r=n*t.x+s*t.y-r)*r/(n*n+s*s)},SlopesNearCollinear:function(t,e,i,n){var s=t.x-e.x,r=t.y-e.y;return(s<0?-s:s)>(r<0?-r:r)?t.x>e.x==t.x<i.x?this.DistanceFromLineSqrd(t,e,i)<n:e.x>t.x==e.x<i.x?this.DistanceFromLineSqrd(e,t,i)<n:this.DistanceFromLineSqrd(i,t,e)<n:t.y>e.y==t.y<i.y?this.DistanceFromLineSqrd(t,e,i)<n:e.y>t.y==e.y<i.y?this.DistanceFromLineSqrd(e,t,i)<n:this.DistanceFromLineSqrd(i,t,e)<n},PointsAreClose:function(t,e,i){var n=t.x-e.x,s=t.y-e.y;return n*n+s*s<=i},ExcludeOp:function(t){var e=t.prev;return e.next=t.next,t.next.prev=e,e.idx=0,e},CleanPolygon:function(t,e){null==e&&(e=1.415);var i=t.length;if(0==i)return null==(h=null)?[]:h;for(var n=[],s=0,r=i;s<r;){n[l=s++]=new tr,n[l].pt=t[l],n[l].next=n[(l+1)%i],n[l].next.prev=n[l],n[l].idx=0}for(var a=e*e,A=n[0];0==A.idx&&A.next!=A.prev;)this.PointsAreClose(A.pt,A.prev.pt,a)?(A=this.ExcludeOp(A),--i):this.PointsAreClose(A.prev.pt,A.next.pt,a)?(this.ExcludeOp(A.next),A=this.ExcludeOp(A),i-=2):this.SlopesNearCollinear(A.prev.pt,A.pt,A.next.pt,a)?(A=this.ExcludeOp(A),--i):(A.idx=1,A=A.next);i<3&&(i=0);var h,o=null==(h=null)?[]:h;for(s=0,r=i;s<r;){var l=s++;o.push(A.pt),A=A.next}return n=null,o},CleanPolygons:function(t,e){null==e&&(e=1.415);for(var i=[],n=0,s=t.length;n<s;){var r=n++;i.push(this.CleanPolygon(t[r],e))}return i},Minkowski:function(t,e,i){for(var n=t.length,s=e.length,r=null==(d=null)?[]:d,a=0,A=s;a<A;){for(var h=a++,o=null==(g=null)?[]:g,l=0,u=t,_=u.length;l<_;){var c=u[l++];i?o.push(new bt(e[h].x+c.x,e[h].y+c.y)):o.push(new bt(e[h].x-c.x,e[h].y-c.y))}r.push(o)}var d,f=null==(d=null)?[]:d;for(a=0,A=s;a<A;){h=a++;for(var x=0,p=n;x<p;){var g,m=x++,v=null==(g=null)?[]:g;v.push(r[h%s][m%n]),v.push(r[(h+1)%s][m%n]),v.push(r[(h+1)%s][(m+1)%n]),v.push(r[h%s][(m+1)%n]),rr.polArea(v)>=0||Mt.reverse(v),f.push(v)}}return f},MinkowskiSum:function(t,e,i){var n=this.Minkowski(t,e,!0),s=new rr;return s.resultKind=null==i?sr.All:i,s.addPolygons(n,lr.Subject),s.execute(Ns.Union,or.NonZero,or.NonZero)},TranslatePath:function(t,e){for(var i=[],n=0,s=t.length;n<s;){var r=n++;i.push(new bt(t[r].x+e.x,t[r].y+e.y))}return i},PolyTreeToPaths:function(t){var e=[];return this.AddPolyNodeToPaths(t,nr.Any,e),e},AddPolyNodeToPaths:function(t,e,i){if(1!=e._hx_index){t.polygon.length>0&&i.push(t.polygon);for(var n=0,s=t.childs;n<s.length;){var r=s[n];++n,this.AddPolyNodeToPaths(r,e,i)}}},__class__:rr});var ar=function(t,e){null==e&&(e=.25),null==t&&(t=2),this.two_pi=6.283185307179586,this.def_arc_tolerance=.25,this.MiterLimit=t,this.ArcTolerance=e,this.m_lowest=new bt(-1,0),this.m_normals=[],this.m_polyNodes=new js,this.resultKind=sr.All};i["hxd.clipper.ClipperOffset"]=ar,ar.__name__="hxd.clipper.ClipperOffset",ar.prototype={clear:function(){this.m_polyNodes=new js,this.m_lowest=new bt(-1,0)},addPolygon:function(t,e,i){var n=t.length-1;if(!(n<0)){var s=new js;if(s.jointype=e,s.endtype=i,i==Ar.ClosedLine||i==Ar.ClosedPol)for(;n>0&&t[0]==t[n];)--n;s.polygon.push(t[0]);for(var r=0,a=0,A=1,h=n+1;A<h;){var o=A++;s.polygon[r]!=t[o]&&(++r,s.polygon.push(t[o]),(t[o].y>s.polygon[a].y||t[o].y==s.polygon[a].y&&t[o].x<s.polygon[a].x)&&(a=r))}if(!(i==Ar.ClosedPol&&r<2)&&(this.m_polyNodes.addChild(s),i==Ar.ClosedPol))if(this.m_lowest.x<0)this.m_lowest=new bt(this.m_polyNodes.childs.length-1,a);else{var l=this.m_polyNodes.childs[this.m_lowest.x].polygon[this.m_lowest.y];(s.polygon[a].y>l.y||s.polygon[a].y==l.y&&s.polygon[a].x<l.x)&&(this.m_lowest=new bt(this.m_polyNodes.childs.length-1,a))}}},addPolygons:function(t,e,i){for(var n=0,s=t,r=s.length;n<r;){var a=s[n++];this.addPolygon(a,e,i)}},fixOrientations:function(){if(this.m_lowest.x>=0&&!(rr.polArea(this.m_polyNodes.childs[this.m_lowest.x].polygon)>=0))for(var t=0,e=this.m_polyNodes.childs;t<e.length;){var i=e[t];++t,(i.endtype==Ar.ClosedPol||i.endtype==Ar.ClosedLine&&rr.polArea(i.polygon)>=0)&&Mt.reverse(i.polygon)}else for(t=0,e=this.m_polyNodes.childs;t<e.length;){i=e[t];++t,i.endtype!=Ar.ClosedLine||rr.polArea(i.polygon)>=0||Mt.reverse(i.polygon)}},getUnitNormal:function(t,e){var i=e.x-t.x,n=e.y-t.y;if(0==i&&0==n)return new Ct;var s=0;null==s&&(s=0);var r=1/Math.sqrt(i*i+n*n+s*s);return new Ct(n*=r,-(i*=r))},doOffset:function(t){var e=[];if(this.m_destPolys=e,this.m_delta=t,t>-1e-20&&t<1e-20)for(var i=0,n=this.m_polyNodes.childs;i<n.length;){var s=n[i];++i,s.endtype==Ar.ClosedPol&&this.m_destPolys.push(s.polygon)}else{var r;this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5,r=this.ArcTolerance<=0?this.def_arc_tolerance:this.ArcTolerance>(t<0?-t:t)*this.def_arc_tolerance?(t<0?-t:t)*this.def_arc_tolerance:this.ArcTolerance;var a=3.141592653589793/Math.acos(1-r/(t<0?-t:t))|0;this.m_sin=Math.sin(this.two_pi/a),this.m_cos=Math.cos(this.two_pi/a),this.m_StepsPerRad=a/this.two_pi,t<0&&(this.m_sin=-this.m_sin);for(i=0,n=this.m_polyNodes.childs;i<n.length;){s=n[i];++i,this.m_srcPoly=s.polygon;var A=this.m_srcPoly.length;if(!(0==A||t<=0&&(A<3||s.endtype!=Ar.ClosedPol))){e=[];if(this.m_destPoly=e,1!=A){this.m_normals=[];for(var h=0,o=A-1;h<o;){var l=h++;this.m_normals.push(this.getUnitNormal(this.m_srcPoly[l],this.m_srcPoly[l+1]))}if(s.endtype==Ar.ClosedLine||s.endtype==Ar.ClosedPol?this.m_normals.push(this.getUnitNormal(this.m_srcPoly[A-1],this.m_srcPoly[0])):this.m_normals.push(this.m_normals[A-2]),s.endtype==Ar.ClosedPol){for(var u=A-1,_=0,c=A;_<c;){var d=_++;u=this.offsetPoint(d,u,s.jointype)}this.m_destPolys.push(this.m_destPoly)}else if(s.endtype==Ar.ClosedLine){for(var f=A-1,x=0,p=A;x<p;){var g=x++;f=this.offsetPoint(g,f,s.jointype)}this.m_destPolys.push(this.m_destPoly);var m=[];this.m_destPoly=m;for(var v=this.m_normals[A-1],y=A-1;y>0;)this.m_normals[y]=new Ct(-this.m_normals[y-1].x,-this.m_normals[y-1].y),--y;this.m_normals[0]=new Ct(-v.x,-v.y),f=0;for(var b=A-1;b>0;)f=this.offsetPoint(b,f,s.jointype),--b;this.m_destPolys.push(this.m_destPoly)}else{for(var w,M=0,B=1,C=A-1;B<C;){var S=B++;M=this.offsetPoint(S,M,s.jointype)}if(s.endtype==Ar.OpenButt){var I=A-1;w=new bt(Math.round(this.m_srcPoly[I].x+this.m_normals[I].x*t),Math.round(this.m_srcPoly[I].y+this.m_normals[I].y*t)),this.m_destPoly.push(w),w=new bt(Math.round(this.m_srcPoly[I].x-this.m_normals[I].x*t),Math.round(this.m_srcPoly[I].y-this.m_normals[I].y*t)),this.m_destPoly.push(w)}else{var k=A-1;if(M=A-2,this.m_sinA=0,this.m_normals[k]=new Ct(-this.m_normals[k].x,-this.m_normals[k].y),s.endtype==Ar.OpenSquare){var E=Math.tan(.25*Math.atan2(this.m_sinA,this.m_normals[M].x*this.m_normals[k].x+this.m_normals[M].y*this.m_normals[k].y));this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[k].x+this.m_delta*(this.m_normals[M].x-this.m_normals[M].y*E)),Math.round(this.m_srcPoly[k].y+this.m_delta*(this.m_normals[M].y+this.m_normals[M].x*E)))),this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[k].x+this.m_delta*(this.m_normals[k].x+this.m_normals[k].y*E)),Math.round(this.m_srcPoly[k].y+this.m_delta*(this.m_normals[k].y-this.m_normals[k].x*E))))}else{for(var F,T=Math.atan2(this.m_sinA,this.m_normals[M].x*this.m_normals[k].x+this.m_normals[M].y*this.m_normals[k].y),D=Math.round(this.m_StepsPerRad*(T<0?-T:T)),P=D<1?1:D,z=this.m_normals[M].x,R=this.m_normals[M].y,L=0,V=P;L<V;){L++;this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[k].x+z*this.m_delta),Math.round(this.m_srcPoly[k].y+R*this.m_delta))),F=z,z=z*this.m_cos-this.m_sin*R,R=F*this.m_sin+R*this.m_cos}this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[k].x+this.m_normals[k].x*this.m_delta),Math.round(this.m_srcPoly[k].y+this.m_normals[k].y*this.m_delta)))}}for(var Q=A-1;Q>0;)this.m_normals[Q]=new Ct(-this.m_normals[Q-1].x,-this.m_normals[Q-1].y),--Q;this.m_normals[0]=new Ct(-this.m_normals[1].x,-this.m_normals[1].y);for(var U=(M=A-1)-1;U>0;)M=this.offsetPoint(U,M,s.jointype),--U;if(s.endtype==Ar.OpenButt)w=new bt(Math.round(this.m_srcPoly[0].x-this.m_normals[0].x*t),Math.round(this.m_srcPoly[0].y-this.m_normals[0].y*t)),this.m_destPoly.push(w),w=new bt(Math.round(this.m_srcPoly[0].x+this.m_normals[0].x*t),Math.round(this.m_srcPoly[0].y+this.m_normals[0].y*t)),this.m_destPoly.push(w);else if(M=1,this.m_sinA=0,s.endtype==Ar.OpenSquare){var O=Math.tan(.25*Math.atan2(this.m_sinA,this.m_normals[1].x*this.m_normals[0].x+this.m_normals[1].y*this.m_normals[0].y));this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[0].x+this.m_delta*(this.m_normals[1].x-this.m_normals[1].y*O)),Math.round(this.m_srcPoly[0].y+this.m_delta*(this.m_normals[1].y+this.m_normals[1].x*O)))),this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[0].x+this.m_delta*(this.m_normals[0].x+this.m_normals[0].y*O)),Math.round(this.m_srcPoly[0].y+this.m_delta*(this.m_normals[0].y-this.m_normals[0].x*O))))}else{for(var G,N=Math.atan2(this.m_sinA,this.m_normals[1].x*this.m_normals[0].x+this.m_normals[1].y*this.m_normals[0].y),Y=Math.round(this.m_StepsPerRad*(N<0?-N:N)),X=Y<1?1:Y,j=this.m_normals[1].x,H=this.m_normals[1].y,W=0,Z=X;W<Z;){W++;this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[0].x+j*this.m_delta),Math.round(this.m_srcPoly[0].y+H*this.m_delta))),G=j,j=j*this.m_cos-this.m_sin*H,H=G*this.m_sin+H*this.m_cos}this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[0].x+this.m_normals[0].x*this.m_delta),Math.round(this.m_srcPoly[0].y+this.m_normals[0].y*this.m_delta)))}this.m_destPolys.push(this.m_destPoly)}}else{if(s.jointype==hr.Round)for(var J=1,q=0,K=1,$=a+1;K<$;){K++;this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[0].x+J*t),Math.round(this.m_srcPoly[0].y+q*t)));var tt=J;J=J*this.m_cos-this.m_sin*q,q=tt*this.m_sin+q*this.m_cos}else{var et=-1,it=-1;this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[0].x+et*t),Math.round(this.m_srcPoly[0].y+it*t))),et<0?et=1:it<0?it=1:et=-1,this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[0].x+et*t),Math.round(this.m_srcPoly[0].y+it*t))),et<0?et=1:it<0?it=1:et=-1,this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[0].x+et*t),Math.round(this.m_srcPoly[0].y+it*t))),et<0?et=1:it<0?it=1:et=-1,this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[0].x+et*t),Math.round(this.m_srcPoly[0].y+it*t))),et<0?et=1:it<0?it=1:et=-1}this.m_destPolys.push(this.m_destPoly)}}}}},execute:function(t){this.fixOrientations(),this.doOffset(t);var e=new rr;if(e.resultKind=this.resultKind,e.addPolygons(this.m_destPolys,lr.Subject),t>0)return e.execute(Ns.Union,or.Positive,or.Positive);var i=ir.getBounds(this.m_destPolys),n=[];n.push(new bt(i.left-10,i.bottom+10)),n.push(new bt(i.right+10,i.bottom+10)),n.push(new bt(i.right+10,i.top-10)),n.push(new bt(i.left-10,i.top-10)),e.addPolygon(n,lr.Subject),e.reverseSolution=!0;var s=e.execute(Ns.Union,or.Negative,or.Negative);return s.length>0&&s.shift(),s},offsetPoint:function(t,e,i){this.m_sinA=this.m_normals[e].x*this.m_normals[t].y-this.m_normals[t].x*this.m_normals[e].y;var n=this.m_sinA*this.m_delta;if((n<0?-n:n)<1){if(this.m_normals[e].x*this.m_normals[t].x+this.m_normals[t].y*this.m_normals[e].y>0)return this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+this.m_normals[e].x*this.m_delta),Math.round(this.m_srcPoly[t].y+this.m_normals[e].y*this.m_delta))),e}else this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1);if(this.m_sinA*this.m_delta<0){var s=new bt(Math.round(this.m_srcPoly[t].x+this.m_normals[e].x*this.m_delta),Math.round(this.m_srcPoly[t].y+this.m_normals[e].y*this.m_delta)),r=new bt(Math.round(this.m_srcPoly[t].x+this.m_normals[t].x*this.m_delta),Math.round(this.m_srcPoly[t].y+this.m_normals[t].y*this.m_delta));this.m_destPoly.push(s);var a=s.x-r.x,A=s.y-r.y;a*a+A*A>1&&(this.m_destPoly.push(this.m_srcPoly[t]),this.m_destPoly.push(r))}else switch(i._hx_index){case 0:a=Math.tan(.25*Math.atan2(this.m_sinA,this.m_normals[e].x*this.m_normals[t].x+this.m_normals[e].y*this.m_normals[t].y));this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+this.m_delta*(this.m_normals[e].x-this.m_normals[e].y*a)),Math.round(this.m_srcPoly[t].y+this.m_delta*(this.m_normals[e].y+this.m_normals[e].x*a)))),this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+this.m_delta*(this.m_normals[t].x+this.m_normals[t].y*a)),Math.round(this.m_srcPoly[t].y+this.m_delta*(this.m_normals[t].y-this.m_normals[t].x*a))));break;case 1:for(var h,o=Math.atan2(this.m_sinA,this.m_normals[e].x*this.m_normals[t].x+this.m_normals[e].y*this.m_normals[t].y),l=Math.round(this.m_StepsPerRad*(o<0?-o:o)),u=l<1?1:l,_=this.m_normals[e].x,c=this.m_normals[e].y,d=0,f=u;d<f;){d++;this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+_*this.m_delta),Math.round(this.m_srcPoly[t].y+c*this.m_delta))),h=_,_=_*this.m_cos-this.m_sin*c,c=h*this.m_sin+c*this.m_cos}this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+this.m_normals[t].x*this.m_delta),Math.round(this.m_srcPoly[t].y+this.m_normals[t].y*this.m_delta)));break;case 2:var x=this.m_normals[t].x*this.m_normals[e].x+this.m_normals[t].y*this.m_normals[e].y+1;if(x>=this.m_miterLim){var p=this.m_delta/x;this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+(this.m_normals[e].x+this.m_normals[t].x)*p),Math.round(this.m_srcPoly[t].y+(this.m_normals[e].y+this.m_normals[t].y)*p)))}else{a=Math.tan(.25*Math.atan2(this.m_sinA,this.m_normals[e].x*this.m_normals[t].x+this.m_normals[e].y*this.m_normals[t].y));this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+this.m_delta*(this.m_normals[e].x-this.m_normals[e].y*a)),Math.round(this.m_srcPoly[t].y+this.m_delta*(this.m_normals[e].y+this.m_normals[e].x*a)))),this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+this.m_delta*(this.m_normals[t].x+this.m_normals[t].y*a)),Math.round(this.m_srcPoly[t].y+this.m_delta*(this.m_normals[t].y-this.m_normals[t].x*a))))}}return t},doSquare:function(t,e){var i=Math.tan(.25*Math.atan2(this.m_sinA,this.m_normals[e].x*this.m_normals[t].x+this.m_normals[e].y*this.m_normals[t].y));this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+this.m_delta*(this.m_normals[e].x-this.m_normals[e].y*i)),Math.round(this.m_srcPoly[t].y+this.m_delta*(this.m_normals[e].y+this.m_normals[e].x*i)))),this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+this.m_delta*(this.m_normals[t].x+this.m_normals[t].y*i)),Math.round(this.m_srcPoly[t].y+this.m_delta*(this.m_normals[t].y-this.m_normals[t].x*i))))},doMiter:function(t,e,i){var n=this.m_delta/i;this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+(this.m_normals[e].x+this.m_normals[t].x)*n),Math.round(this.m_srcPoly[t].y+(this.m_normals[e].y+this.m_normals[t].y)*n)))},doRound:function(t,e){for(var i,n=Math.atan2(this.m_sinA,this.m_normals[e].x*this.m_normals[t].x+this.m_normals[e].y*this.m_normals[t].y),s=Math.round(this.m_StepsPerRad*(n<0?-n:n)),r=s<1?1:s,a=this.m_normals[e].x,A=this.m_normals[e].y,h=0,o=r;h<o;){h++;this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+a*this.m_delta),Math.round(this.m_srcPoly[t].y+A*this.m_delta))),i=a,a=a*this.m_cos-this.m_sin*A,A=i*this.m_sin+A*this.m_cos}this.m_destPoly.push(new bt(Math.round(this.m_srcPoly[t].x+this.m_normals[t].x*this.m_delta),Math.round(this.m_srcPoly[t].y+this.m_normals[t].y*this.m_delta)))},__class__:ar};var Ar=s["hxd.clipper.EndType"]={__ename__:!0,__constructs__:null,ClosedPol:{_hx_name:"ClosedPol",_hx_index:0,__enum__:"hxd.clipper.EndType",toString:n},ClosedLine:{_hx_name:"ClosedLine",_hx_index:1,__enum__:"hxd.clipper.EndType",toString:n},OpenButt:{_hx_name:"OpenButt",_hx_index:2,__enum__:"hxd.clipper.EndType",toString:n},OpenSquare:{_hx_name:"OpenSquare",_hx_index:3,__enum__:"hxd.clipper.EndType",toString:n},OpenRound:{_hx_name:"OpenRound",_hx_index:4,__enum__:"hxd.clipper.EndType",toString:n}};Ar.__constructs__=[Ar.ClosedPol,Ar.ClosedLine,Ar.OpenButt,Ar.OpenSquare,Ar.OpenRound],Ar.__empty_constructs__=[Ar.ClosedPol,Ar.ClosedLine,Ar.OpenButt,Ar.OpenSquare,Ar.OpenRound];var hr=s["hxd.clipper.JoinType"]={__ename__:!0,__constructs__:null,Square:{_hx_name:"Square",_hx_index:0,__enum__:"hxd.clipper.JoinType",toString:n},Round:{_hx_name:"Round",_hx_index:1,__enum__:"hxd.clipper.JoinType",toString:n},Miter:{_hx_name:"Miter",_hx_index:2,__enum__:"hxd.clipper.JoinType",toString:n}};hr.__constructs__=[hr.Square,hr.Round,hr.Miter],hr.__empty_constructs__=[hr.Square,hr.Round,hr.Miter];var or=s["hxd.clipper.PolyFillType"]={__ename__:!0,__constructs__:null,EvenOdd:{_hx_name:"EvenOdd",_hx_index:0,__enum__:"hxd.clipper.PolyFillType",toString:n},NonZero:{_hx_name:"NonZero",_hx_index:1,__enum__:"hxd.clipper.PolyFillType",toString:n},Positive:{_hx_name:"Positive",_hx_index:2,__enum__:"hxd.clipper.PolyFillType",toString:n},Negative:{_hx_name:"Negative",_hx_index:3,__enum__:"hxd.clipper.PolyFillType",toString:n}};or.__constructs__=[or.EvenOdd,or.NonZero,or.Positive,or.Negative],or.__empty_constructs__=[or.EvenOdd,or.NonZero,or.Positive,or.Negative];var lr=s["hxd.clipper.PolyType"]={__ename__:!0,__constructs__:null,Subject:{_hx_name:"Subject",_hx_index:0,__enum__:"hxd.clipper.PolyType",toString:n},Clip:{_hx_name:"Clip",_hx_index:1,__enum__:"hxd.clipper.PolyType",toString:n}};lr.__constructs__=[lr.Subject,lr.Clip],lr.__empty_constructs__=[lr.Subject,lr.Clip];var ur=function(t,e,i,n){null==n&&(n=0),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.left=t,this.top=e,this.right=i,this.bottom=n};i["hxd.clipper.Rect"]=ur,ur.__name__="hxd.clipper.Rect",ur.prototype={__class__:ur};var _r=function(){};i["hxd.earcut.EarNode"]=_r,_r.__name__="hxd.earcut.EarNode",_r.prototype={__class__:_r};var cr=function(){};i["hxd.earcut.Earcut"]=cr,cr.__name__="hxd.earcut.Earcut",cr.prototype={triangulate_h2d_col_Point:function(t,e){var i=null!=e&&e.length>0?e[0]:t.length;if(i<3)return[];var n=this.setLinkedList_triangulate_T(t,0,i,!0);return null!=e&&(n=this.eliminateHoles_triangulate_T(t,e,n)),this.triangulateNode(n,t.length>80)},eliminateHoles_triangulate_T:function(t,e,i){for(var n=[],s=0,r=e.length;s<r;){var a=s++,A=e[a],h=a==e.length-1?t.length:e[a+1],o=this.setLinkedList_eliminateHoles_T(t,A,h,!1);o==o.next&&(o.steiner=!0),n.push(this.getLeftmost(o))}n.sort(XA(this,this.compareX));for(s=0;s<n.length;){var l=n[s];++s,this.eliminateHole(l,i),i=this.filterPoints(i,i.next)}return i},setLinkedList_eliminateHoles_T:function(t,e,i,n){for(var s=0,r=i-1,a=e,A=i;a<A;){var h=a++;s+=(t[r].x-t[h].x)*(t[h].y+t[r].y),r=h}var o=null;null==(f=this.cache)?((f=new _r).allocNext=this.allocated,this.allocated=f):this.cache=f.next,f.i=-1,f.z=-1,f.x=0,f.y=0,f.next=null,f.prev=o,f.steiner=!1,f.prevZ=null,f.nextZ=null;var l=f,u=l;if(n==s>0)for(a=e,A=i;a<A;){var _=(d=t[h=a++]).x,c=d.y;null==(f=this.cache)?((f=new _r).allocNext=this.allocated,this.allocated=f):this.cache=f.next,f.i=h,f.z=-1,f.x=_,f.y=c,f.next=null,f.prev=l,f.steiner=!1,f.prevZ=null,f.nextZ=null,null!=l&&(l.next=f),l=f}else for(h=i-1;h>=e;){var d,f;_=(d=t[h]).x,c=d.y;null==(f=this.cache)?((f=new _r).allocNext=this.allocated,this.allocated=f):this.cache=f.next,f.i=h,f.z=-1,f.x=_,f.y=c,f.next=null,f.prev=l,f.steiner=!1,f.prevZ=null,f.nextZ=null,null!=l&&(l.next=f),l=f,--h}return l.next=u.next,l.next.prev=l,l},setLinkedList_triangulate_T:function(t,e,i,n){for(var s=0,r=i-1,a=e,A=i;a<A;){var h=a++;s+=(t[r].x-t[h].x)*(t[h].y+t[r].y),r=h}var o=null;null==(f=this.cache)?((f=new _r).allocNext=this.allocated,this.allocated=f):this.cache=f.next,f.i=-1,f.z=-1,f.x=0,f.y=0,f.next=null,f.prev=o,f.steiner=!1,f.prevZ=null,f.nextZ=null;var l=f,u=l;if(n==s>0)for(a=e,A=i;a<A;){var _=(d=t[h=a++]).x,c=d.y;null==(f=this.cache)?((f=new _r).allocNext=this.allocated,this.allocated=f):this.cache=f.next,f.i=h,f.z=-1,f.x=_,f.y=c,f.next=null,f.prev=l,f.steiner=!1,f.prevZ=null,f.nextZ=null,null!=l&&(l.next=f),l=f}else for(h=i-1;h>=e;){var d,f;_=(d=t[h]).x,c=d.y;null==(f=this.cache)?((f=new _r).allocNext=this.allocated,this.allocated=f):this.cache=f.next,f.i=h,f.z=-1,f.x=_,f.y=c,f.next=null,f.prev=l,f.steiner=!1,f.prevZ=null,f.nextZ=null,null!=l&&(l.next=f),l=f,--h}return l.next=u.next,l.next.prev=l,l},triangulateNode:function(t,e){if(this.triangles=[],t=this.filterPoints(t),e&&null!=t){var i=t.x;this.minX=i;var n=t.y;this.minY=n;for(var s=t.next;s!=t;){var r=s.x,a=s.y;r<this.minX&&(this.minX=r),a<this.minY&&(this.minY=a),r>i&&(i=r),a>n&&(n=a),s=s.next}var A=i-this.minX,h=n-this.minY;this.size=A<h?h:A,this.hasSize=!0}else this.hasSize=!1;this.earcutLinked(t);var o=this.triangles;this.triangles=null;var l=this.allocated;if(null!=this.cache){for(;l!=this.cache;)l=l.allocNext;l=l.allocNext}for(;null!=l;)l.next=this.cache,this.cache=l,l=l.allocNext;return o},eliminateHole:function(t,e){if(null!=(e=this.findHoleBridge(t,e))){var i=this.splitPolygon(e,t);this.filterPoints(i,i.next)}},findHoleBridge:function(t,e){for(var i=e,n=t.x,s=t.y,r=-1/0,a=null;;){if(s<=i.y&&s>=i.next.y){var A=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);A<=n&&A>r&&(r=A,a=i.x<i.next.x?i:i.next)}if((i=i.next)==e)break}if(null==a)return null;var h,o=a,l=1/0;for(i=a.next;i!=o;){var u;if(n>=i.x&&i.x>=a.x){var _=s<a.y?n:r,c=a.x,d=a.y,f=s<a.y?r:n,x=i.x,p=i.y;u=(f-x)*(s-p)-(_-x)*(s-p)>=0&&(_-x)*(d-p)-(c-x)*(s-p)>=0&&(c-x)*(s-p)-(f-x)*(d-p)>=0}else u=!1;if(u){var g,m=s-i.y;if((h=(m<0?-m:m)/(n-i.x))<l||h==l&&i.x>a.x){var v=i.prev,y=i.next;if((i.y-v.y)*(y.x-i.x)-(i.x-v.x)*(y.y-i.y)<0){var b=i.next;if((t.y-i.y)*(b.x-t.x)-(t.x-i.x)*(b.y-t.y)>=0){var w=i.prev;g=(w.y-i.y)*(t.x-w.x)-(w.x-i.x)*(t.y-w.y)>=0}else g=!1}else{var M=i.prev;if((t.y-i.y)*(M.x-t.x)-(t.x-i.x)*(M.y-t.y)<0)g=!0;else{var B=i.next;g=(B.y-i.y)*(t.x-B.x)-(B.x-i.x)*(t.y-B.y)<0}}}else g=!1;g&&(a=i,l=h)}i=i.next}return a},getLeftmost:function(t){for(var e=t,i=t;e.x<i.x&&(i=e),(e=e.next)!=t;);return i},compareX:function(t,e){return t.x-e.x>0?1:-1},equals:function(t,e){return t.x==e.x&&t.y==e.y},area:function(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)},intersects:function(t,e,i,n){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)>0!=(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)>0&&(n.y-i.y)*(t.x-n.x)-(n.x-i.x)*(t.y-n.y)>0!=(n.y-i.y)*(e.x-n.x)-(n.x-i.x)*(e.y-n.y)>0},locallyInside:function(t,e){var i=t.prev,n=t.next;if((t.y-i.y)*(n.x-t.x)-(t.x-i.x)*(n.y-t.y)<0){n=t.next;return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)>=0&&((s=t.prev).y-t.y)*(e.x-s.x)-(s.x-t.x)*(e.y-s.y)>=0}var s;n=t.prev;return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)<0||((s=t.next).y-t.y)*(e.x-s.x)-(s.x-t.x)*(e.y-s.y)<0},filterPoints:function(t,e){if(null==t)return t;null==e&&(e=t);for(var i,n=t;;){var s;if(i=!1,n.steiner)s=!1;else{var r=n.next;if(n.x!=r.x||n.y!=r.y){var a=n.prev,A=n.next;s=(n.y-a.y)*(A.x-n.x)-(n.x-a.x)*(A.y-n.y)==0}else s=!0}if(s){if(n.next.prev=n.prev,n.prev.next=n.next,null!=n.prevZ&&(n.prevZ.nextZ=n.nextZ),null!=n.nextZ&&(n.nextZ.prevZ=n.prevZ),(n=e=n.prev)==n.next)return null;i=!0}else n=n.next;if(!i&&n==e)break}return e},removeNode:function(t){t.next.prev=t.prev,t.prev.next=t.next,null!=t.prevZ&&(t.prevZ.nextZ=t.nextZ),null!=t.nextZ&&(t.nextZ.prevZ=t.prevZ)},allocNode:function(t,e,i,n){var s=this.cache;return null==s?((s=new _r).allocNext=this.allocated,this.allocated=s):this.cache=s.next,s.i=t,s.z=-1,s.x=e,s.y=i,s.next=null,s.prev=n,s.steiner=!1,s.prevZ=null,s.nextZ=null,null!=n&&(n.next=s),s},earcutLinked:function(t,e){if(null==e&&(e=0),null!=t){0==e&&this.hasSize&&this.indexCurve(t);for(var i,n,s=t;t.prev!=t.next;)if(i=t.prev,n=t.next,this.hasSize?this.isEarHashed(t):this.isEar(t))this.triangles.push(i.i),this.triangles.push(t.i),this.triangles.push(n.i),t.next.prev=t.prev,t.prev.next=t.next,null!=t.prevZ&&(t.prevZ.nextZ=t.nextZ),null!=t.nextZ&&(t.nextZ.prevZ=t.prevZ),t=n.next,s=n.next;else if((t=n)==s){switch(e){case 0:this.earcutLinked(this.filterPoints(t),1);break;case 1:t=this.cureLocalIntersections(t),this.earcutLinked(t,2);break;case 2:this.splitEarcut(t)}break}}},isEar:function(t){var e=t.prev,i=t,n=t.next;if((i.y-e.y)*(n.x-i.x)-(i.x-e.x)*(n.y-i.y)>=0)return!1;for(var s=t.next.next;s!=t.prev;){var r,a=e.x,A=e.y,h=i.x,o=i.y,l=n.x,u=n.y,_=s.x,c=s.y;if((l-_)*(A-c)-(a-_)*(u-c)>=0&&(a-_)*(o-c)-(h-_)*(A-c)>=0&&(h-_)*(u-c)-(l-_)*(o-c)>=0){var d=s.prev,f=s.next;r=(s.y-d.y)*(f.x-s.x)-(s.x-d.x)*(f.y-s.y)>=0}else r=!1;if(r)return!1;s=s.next}return!0},isEarHashed:function(t){var e=t.prev,i=t,n=t.next;if((i.y-e.y)*(n.x-i.x)-(i.x-e.x)*(n.y-i.y)>=0)return!1;for(var s,r,a=e.x<i.x?e.x<n.x?e.x:n.x:i.x<n.x?i.x:n.x,A=e.y<i.y?e.y<n.y?e.y:n.y:i.y<n.y?i.y:n.y,h=e.x>i.x?e.x>n.x?e.x:n.x:i.x>n.x?i.x:n.x,o=e.y>i.y?e.y>n.y?e.y:n.y:i.y>n.y?i.y:n.y,l=(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=32767*(a-this.minX)/this.size|0)|s<<8))|s<<4))|s<<2))|s<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(A-this.minY)/this.size|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1,u=(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=32767*(h-this.minX)/this.size|0)|s<<8))|s<<4))|s<<2))|s<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(o-this.minY)/this.size|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1,_=t.nextZ;null!=_&&_.z<=u;){if(_!=t.prev&&_!=t.next){var c=e.x,d=e.y,f=i.x,x=i.y,p=n.x,g=n.y;b=(p-(w=_.x))*(d-(M=_.y))-(c-w)*(g-M)>=0&&(c-w)*(x-M)-(f-w)*(d-M)>=0&&(f-w)*(g-M)-(p-w)*(x-M)>=0}else b=!1;if(b){var m=_.prev,v=_.next;y=(_.y-m.y)*(v.x-_.x)-(_.x-m.x)*(v.y-_.y)>=0}else y=!1;if(y)return!1;_=_.nextZ}for(_=t.prevZ;null!=_&&_.z>=l;){var y,b;if(_!=t.prev&&_!=t.next){var w,M;c=e.x,d=e.y,f=i.x,x=i.y,p=n.x,g=n.y;b=(p-(w=_.x))*(d-(M=_.y))-(c-w)*(g-M)>=0&&(c-w)*(x-M)-(f-w)*(d-M)>=0&&(f-w)*(g-M)-(p-w)*(x-M)>=0}else b=!1;if(b){m=_.prev,v=_.next;y=(_.y-m.y)*(v.x-_.x)-(_.x-m.x)*(v.y-_.y)>=0}else y=!1;if(y)return!1;_=_.prevZ}return!0},cureLocalIntersections:function(t){for(var e=t;;){var i,n,s=e.prev,r=e.next.next,a=e.next;if((e.y-s.y)*(a.x-e.x)-(e.x-s.x)*(a.y-e.y)>0!=(e.y-s.y)*(r.x-e.x)-(e.x-s.x)*(r.y-e.y)>0&&(r.y-a.y)*(s.x-r.x)-(r.x-a.x)*(s.y-r.y)>0!=(r.y-a.y)*(e.x-r.x)-(r.x-a.x)*(e.y-r.y)>0){var A=s.prev,h=s.next;if((s.y-A.y)*(h.x-s.x)-(s.x-A.x)*(h.y-s.y)<0){var o=s.next;if((r.y-s.y)*(o.x-r.x)-(r.x-s.x)*(o.y-r.y)>=0){var l=s.prev;n=(l.y-s.y)*(r.x-l.x)-(l.x-s.x)*(r.y-l.y)>=0}else n=!1}else{var u=s.prev;if((r.y-s.y)*(u.x-r.x)-(r.x-s.x)*(u.y-r.y)<0)n=!0;else{var _=s.next;n=(_.y-s.y)*(r.x-_.x)-(_.x-s.x)*(r.y-_.y)<0}}}else n=!1;if(n){var c=r.prev,d=r.next;if((r.y-c.y)*(d.x-r.x)-(r.x-c.x)*(d.y-r.y)<0){var f=r.next;if((s.y-r.y)*(f.x-s.x)-(s.x-r.x)*(f.y-s.y)>=0){var x=r.prev;i=(x.y-r.y)*(s.x-x.x)-(x.x-r.x)*(s.y-x.y)>=0}else i=!1}else{var p=r.prev;if((s.y-r.y)*(p.x-s.x)-(s.x-r.x)*(p.y-s.y)<0)i=!0;else{var g=r.next;i=(g.y-r.y)*(s.x-g.x)-(g.x-r.x)*(s.y-g.y)<0}}}else i=!1;if(i){this.triangles.push(s.i),this.triangles.push(e.i),this.triangles.push(r.i),e.next.prev=e.prev,e.prev.next=e.next,null!=e.prevZ&&(e.prevZ.nextZ=e.nextZ),null!=e.nextZ&&(e.nextZ.prevZ=e.prevZ);var m=e.next;m.next.prev=m.prev,m.prev.next=m.next,null!=m.prevZ&&(m.prevZ.nextZ=m.nextZ),null!=m.nextZ&&(m.nextZ.prevZ=m.prevZ),e=t=r}if((e=e.next)==t)break}return e},splitEarcut:function(t){for(var e=t;;){for(var i=e.next.next;i!=e.prev;){if(e.i!=i.i&&this.isValidDiagonal(e,i)){var n=this.splitPolygon(e,i);return e=this.filterPoints(e,e.next),n=this.filterPoints(n,n.next),this.earcutLinked(e),void this.earcutLinked(n)}i=i.next}if((e=e.next)==t)break}},splitPolygon:function(t,e){var i=t.i,n=t.x,s=t.y,r=null;null==(a=this.cache)?((a=new _r).allocNext=this.allocated,this.allocated=a):this.cache=a.next,a.i=i,a.z=-1,a.x=n,a.y=s,a.next=null,a.prev=r,a.steiner=!1,a.prevZ=null,a.nextZ=null,null!=r&&(r.next=a);var a,A=a;i=e.i,n=e.x,s=e.y,r=null;null==(a=this.cache)?((a=new _r).allocNext=this.allocated,this.allocated=a):this.cache=a.next,a.i=i,a.z=-1,a.x=n,a.y=s,a.next=null,a.prev=r,a.steiner=!1,a.prevZ=null,a.nextZ=null,null!=r&&(r.next=a);var h=a,o=t.next,l=e.prev;return t.next=e,e.prev=t,A.next=o,o.prev=A,h.next=A,A.prev=h,l.next=h,h.prev=l,h},pointInTriangle:function(t,e,i,n,s,r,a,A){return(s-a)*(e-A)-(t-a)*(r-A)>=0&&(t-a)*(n-A)-(i-a)*(e-A)>=0&&(i-a)*(r-A)-(s-a)*(n-A)>=0},isValidDiagonal:function(t,e){if(t.x!=e.x||t.y!=e.y){var i,n;if(t.next.i==e.i||t.prev.i==e.i||this.intersectsPolygon(t,e))n=!1;else{var s=t.prev,r=t.next;if((t.y-s.y)*(r.x-t.x)-(t.x-s.x)*(r.y-t.y)<0){r=t.next;if((e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)>=0)n=((a=t.prev).y-t.y)*(e.x-a.x)-(a.x-t.x)*(e.y-a.y)>=0;else n=!1}else{r=t.prev;if((e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)<0)n=!0;else n=((a=t.next).y-t.y)*(e.x-a.x)-(a.x-t.x)*(e.y-a.y)<0}}if(n){s=e.prev,r=e.next;if((e.y-s.y)*(r.x-e.x)-(e.x-s.x)*(r.y-e.y)<0){r=e.next;if((t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)>=0)i=((a=e.prev).y-e.y)*(t.x-a.x)-(a.x-e.x)*(t.y-a.y)>=0;else i=!1}else{var a;r=e.prev;if((t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)<0)i=!0;else i=((a=e.next).y-e.y)*(t.x-a.x)-(a.x-e.x)*(t.y-a.y)<0}}else i=!1;return!!i&&this.middleInside(t,e)}return!0},middleInside:function(t,e){for(var i=t,n=!1,s=(t.x+e.x)/2,r=(t.y+e.y)/2;i.y>r!=i.next.y>r&&s<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),(i=i.next)!=t;);return n},intersectsPolygon:function(t,e){for(var i=t;;){var n;if(i.i!=t.i&&i.next.i!=t.i&&i.i!=e.i&&i.next.i!=e.i){var s=i.next;n=(s.y-i.y)*(t.x-s.x)-(s.x-i.x)*(t.y-s.y)>0!=(s.y-i.y)*(e.x-s.x)-(s.x-i.x)*(e.y-s.y)>0&&(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)>0!=(e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y)>0}else n=!1;if(n)return!0;if((i=i.next)==t)break}return!1},zOrder:function(t,e){var i=32767*(t-this.minX)/this.size|0,n=32767*(e-this.minY)/this.size|0;return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&(i|i<<8))|i<<4))|i<<2))|i<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&(n|n<<8))|n<<4))|n<<2))|n<<1))<<1},indexCurve:function(t){for(var e=t;;){if(e.z<0){var i=32767*(e.x-this.minX)/this.size|0,n=32767*(e.y-this.minY)/this.size|0;i=1431655765&((i=858993459&((i=252645135&((i=16711935&(i|i<<8))|i<<4))|i<<2))|i<<1),n=1431655765&((n=858993459&((n=252645135&((n=16711935&(n|n<<8))|n<<4))|n<<2))|n<<1),e.z=i|n<<1}if(e.prevZ=e.prev,e.nextZ=e.next,(e=e.next)==t)break}e.prevZ.nextZ=null,e.prevZ=null,this.sortLinked(e)},sortLinked:function(t){for(var e,i,n,s,r,a,A,h=1;;){for(e=t,t=null,s=null,r=0;null!=e;){++r,i=e,a=0;for(var o=0,l=h;o<l;){o++;if(++a,null==(i=i.nextZ))break}for(A=h;a>0||A>0&&null!=i;)0==a?(n=i,i=i.nextZ,--A):0==A||null==i||e.z<=i.z?(n=e,e=e.nextZ,--a):(n=i,i=i.nextZ,--A),null!=s?s.nextZ=n:t=n,n.prevZ=s,s=n;e=i}if(s.nextZ=null,h*=2,!(r>1))break}return t},__class__:cr};var dr=function(){};i["hxd.fmt.hdr.Reader"]=dr,dr.__name__="hxd.fmt.hdr.Reader",dr.decode=function(t,e){for(var i,n,s=new ss(t),r=Object.create(null);;){var a=s.readLine();if(""==a)break;if(35!=l.cca(a,0)){var A=a.split("=");A.length>1&&(r[A.shift()]=A.join("="))}}var h=s.readLine().split(" ");n=x.parseInt(h[1]),i=x.parseInt(h[3]);var o="1"==r.GAMMA,u=new Qn(new ArrayBuffer(i*n*4*4)),_=1,c=r.EXPOSURE;if(null!=c){var d=parseFloat(c);(d<1e-12||d<1e12)&&(_=d)}for(var f=e?1:.45454545454545453,p=[],g=0;g<256;){var m=g++;p.push(Math.pow(m,f))}var v=p;for(p=[],g=0;g<256;){m=g++;p.push(Math.pow(Math.pow(2,m-128)/(256*_),f))}var y=p;if(null==(p=r.FORMAT)){var b=p;throw kn.thrown("Unsupported HDR format "+b)}if("32-bit_rle_rgbe"!=p){b=p;throw kn.thrown("Unsupported HDR format "+b)}for(var w=s.pos,M=new Qn(new ArrayBuffer(4*i)),B=i>>8|(255&i)<<8,C=(g=0,n);g<C;){var S=g++,I=t.getInt32(w);if(514!=(65535&I)||I>>>16!=B)M.blit(0,t,w,4*i),w+=4*i;else{w+=4;for(var k=0,E=4*i;k<E;){var F=t.b[w++];F>128?(F-=128,M.fill(k,F,t.b[w++])):(M.blit(k,t,w,F),w+=F),k+=F}}for(var T=S*i*16,D=0,P=i;D<P;){var z=D++;m=y[M.b[z+3*i]];u.setFloat(T,v[M.b[z]]*m),T+=4,u.setFloat(T,v[M.b[z+i]]*m),T+=4,u.setFloat(T,v[M.b[z+(i<<1)]]*m),T+=4,u.setFloat(T,1),T+=4}}return{width:i,height:n,bytes:u,gamma:o}};var fr={_new:function(t){return t},getSize:function(t){return 7&t},toInt:function(t){return t},toString:function(t){switch(t){case 1:return"DFloat";case 2:return"DVec2";case 3:return"DVec3";case 4:return"DVec4";case 9:return"DBytes4"}},fromInt:function(t){return t}},xr=s["hxd.fmt.hmd.Property"]={__ename__:!0,__constructs__:null,CameraFOVY:(e=function(t){return{_hx_index:0,v:t,__enum__:"hxd.fmt.hmd.Property",toString:n}},e._hx_name="CameraFOVY",e.__params__=["v"],e),Unused_HasMaterialFlags:{_hx_name:"Unused_HasMaterialFlags",_hx_index:1,__enum__:"hxd.fmt.hmd.Property",toString:n},HasExtraTextures:{_hx_name:"HasExtraTextures",_hx_index:2,__enum__:"hxd.fmt.hmd.Property",toString:n}};xr.__constructs__=[xr.CameraFOVY,xr.Unused_HasMaterialFlags,xr.HasExtraTextures],xr.__empty_constructs__=[xr.Unused_HasMaterialFlags,xr.HasExtraTextures];var pr=function(){};i["hxd.fmt.hmd.Position"]=pr,pr.__name__="hxd.fmt.hmd.Position",pr.prototype={loadQuaternion:function(t){t.x=this.qx,t.y=this.qy,t.z=this.qz,t.w=this.get_qw()},get_qw:function(){var t=1-(this.qx*this.qx+this.qy*this.qy+this.qz*this.qz);return t<0?-Math.sqrt(-t):Math.sqrt(t)},toMatrix:function(t){null==t&&(t=!1);var e=new Gt,i=pr.QTMP;return i.x=this.qx,i.y=this.qy,i.z=this.qz,i.w=this.get_qw(),i.toMatrix(e),t?(e.translate(this.x,this.y,this.z),e.scale(this.sx,this.sy,this.sz)):(e._11*=this.sx,e._12*=this.sx,e._13*=this.sx,e._21*=this.sy,e._22*=this.sy,e._23*=this.sy,e._31*=this.sz,e._32*=this.sz,e._33*=this.sz,e.translate(this.x,this.y,this.z)),e},__class__:pr};var gr=function(t,e){this.name=t,this.format=e};i["hxd.fmt.hmd.GeometryFormat"]=gr,gr.__name__="hxd.fmt.hmd.GeometryFormat",gr.prototype={__class__:gr};var mr=function(){};i["hxd.fmt.hmd.Geometry"]=mr,mr.__name__="hxd.fmt.hmd.Geometry",mr.prototype={get_indexCount:function(){for(var t=0,e=0,i=this.indexCounts;e<i.length;){var n=i[e];++e,t+=n}return t},__class__:mr};var vr=function(){};i["hxd.fmt.hmd.Material"]=vr,vr.__name__="hxd.fmt.hmd.Material",vr.prototype={__class__:vr};var yr=function(){};i["hxd.fmt.hmd.SkinJoint"]=yr,yr.__name__="hxd.fmt.hmd.SkinJoint",yr.prototype={__class__:yr};var br=function(){};i["hxd.fmt.hmd.SkinSplit"]=br,br.__name__="hxd.fmt.hmd.SkinSplit",br.prototype={__class__:br};var wr=function(){};i["hxd.fmt.hmd.Skin"]=wr,wr.__name__="hxd.fmt.hmd.Skin",wr.prototype={__class__:wr};var Mr=function(){};i["hxd.fmt.hmd.Model"]=Mr,Mr.__name__="hxd.fmt.hmd.Model",Mr.prototype={__class__:Mr};var Br=s["hxd.fmt.hmd.AnimationFlag"]={__ename__:!0,__constructs__:null,HasPosition:{_hx_name:"HasPosition",_hx_index:0,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:n},HasRotation:{_hx_name:"HasRotation",_hx_index:1,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:n},HasScale:{_hx_name:"HasScale",_hx_index:2,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:n},HasUV:{_hx_name:"HasUV",_hx_index:3,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:n},HasAlpha:{_hx_name:"HasAlpha",_hx_index:4,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:n},SingleFrame:{_hx_name:"SingleFrame",_hx_index:5,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:n},HasProps:{_hx_name:"HasProps",_hx_index:6,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:n},Reserved:{_hx_name:"Reserved",_hx_index:7,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:n}};Br.__constructs__=[Br.HasPosition,Br.HasRotation,Br.HasScale,Br.HasUV,Br.HasAlpha,Br.SingleFrame,Br.HasProps,Br.Reserved],Br.__empty_constructs__=[Br.HasPosition,Br.HasRotation,Br.HasScale,Br.HasUV,Br.HasAlpha,Br.SingleFrame,Br.HasProps,Br.Reserved];var Cr=function(){};i["hxd.fmt.hmd.AnimationObject"]=Cr,Cr.__name__="hxd.fmt.hmd.AnimationObject",Cr.prototype={getStride:function(){var t=0;return 0!=(this.flags&1<<Br.HasPosition._hx_index)&&(t+=3),0!=(this.flags&1<<Br.HasRotation._hx_index)&&(t+=3),0!=(this.flags&1<<Br.HasScale._hx_index)&&(t+=3),0!=(this.flags&1<<Br.HasUV._hx_index)&&(t+=2),0!=(this.flags&1<<Br.HasAlpha._hx_index)&&++t,0!=(this.flags&1<<Br.HasProps._hx_index)&&(t+=this.props.length),t},__class__:Cr};var Sr=function(){};i["hxd.fmt.hmd.AnimationEvent"]=Sr,Sr.__name__="hxd.fmt.hmd.AnimationEvent",Sr.prototype={__class__:Sr};var Ir=function(){};i["hxd.fmt.hmd.Animation"]=Ir,Ir.__name__="hxd.fmt.hmd.Animation",Ir.prototype={__class__:Ir};var kr=function(){};i["hxd.fmt.hmd.Data"]=kr,kr.__name__="hxd.fmt.hmd.Data",kr.prototype={__class__:kr};var Er=function(t,e,i,n){this.size=t,this.offset=e,this.def=i,this.next=n};i["hxd.fmt.hmd._Library.FormatMap"]=Er,Er.__name__="hxd.fmt.hmd._Library.FormatMap",Er.prototype={__class__:Er};var Fr=function(){};i["hxd.fmt.hmd.GeometryBuffer"]=Fr,Fr.__name__="hxd.fmt.hmd.GeometryBuffer",Fr.prototype={__class__:Fr};var Tr=function(t,e){this.resource=t,this.header=e,this.cachedPrimitives=[],this.cachedAnimations=new Kn,this.cachedSkin=new Kn};i["hxd.fmt.hmd.Library"]=Tr,Tr.__name__="hxd.fmt.hmd.Library",Tr.prototype={getData:function(){var t=this.resource.entry,e=new Qn(new ArrayBuffer(t.get_size()-this.header.dataPosition));return t.open(),t.skip(this.header.dataPosition),t.read(e,0,e.length),t.close(),e},getDefaultFormat:function(t){var e=[new gr("position",3)],i=[null];if(t>3&&(e.push(new gr("normal",3)),i.push(null)),t>6&&(e.push(new gr("uv",2)),i.push(null)),t>8&&(e.push(new gr("color",3)),i.push(new Yt(1,1,1))),t>11)throw kn.thrown("Unsupported stride");return{format:e,defs:i}},load:function(t,e,i){null==i&&(i=-1);for(var n=0,s=0,r=0,a=i<0?this.header.models:[this.header.models[i]],A=Cs._new(0),h=new Array(0),o=0,l=-1,u=0;u<t.length;){var _=t[u];++u,o+=7&_.format}for(u=0;u<a.length;){var c=a[u];++u;var d=this.header.geometries[c.geometry];if(null!=d){for(var f=0,x=c.materials;f<x.length;){var p=x[f];if(++f,l<0&&(l=p),l!=p)throw kn.thrown("Models have several materials")}for(var g=c.position.toMatrix(),m=this.getBuffers(d,t,e),v=A.pos/o|0,y=0,b=m.vertexes.length/o|0;y<b;){var w=y++*o;n=m.vertexes[w++],s=m.vertexes[w++],r=m.vertexes[w++];var M=n*g._11+s*g._21+r*g._31+1*g._41,B=n*g._12+s*g._22+r*g._32+1*g._42,C=n*g._13+s*g._23+r*g._33+1*g._43;if(n=M,s=B,r=C,A.pos==A.array.length){var S=A.array.length<<1;S<128&&(S=128);var I=new Float32Array(S);I.set(A.array),A.array=I}if(A.array[A.pos++]=n,A.pos==A.array.length){var k=A.array.length<<1;k<128&&(k=128);var E=new Float32Array(k);E.set(A.array),A.array=E}if(A.array[A.pos++]=s,A.pos==A.array.length){var F=A.array.length<<1;F<128&&(F=128);var T=new Float32Array(F);T.set(A.array),A.array=T}A.array[A.pos++]=r;for(var D=0,P=o-3;D<P;){D++;var z=m.vertexes[w++];if(A.pos==A.array.length){var R=A.array.length<<1;R<128&&(R=128);var L=new Float32Array(R);L.set(A.array),A.array=L}A.array[A.pos++]=z}}for(var V=0,Q=m.indexes;V<Q.length;){var U=Q[V];++V,h.push(U+v)}}}return{vertex:A,index:h}},getBuffers:function(t,e,i,n){0==n&&1==t.indexCounts.length&&(n=null);for(var s=null,r=0,a=0,A=e.length;a<A;){for(var h=a++,o=e[L=e.length-1-h],l=7&o.format,u=0,_=!1,c=0,d=t.vertexFormat;c<d.length;){var f=d[c];if(++c,f.name==o.name){if((7&f.format)<l)throw kn.thrown("Requested "+o.name+" data has only "+(7&f.format)+" regs instead of "+l);_=!0;break}u+=7&f.format}if(_)s=new Er(l,u,null,s);else{var x=null==i?null:i[L];if(null==x)throw kn.thrown("Missing required "+o.name);s=new Er(l,0,x,s)}r+=l}var p=t.vertexCount*t.vertexStride*4,g=new Qn(new ArrayBuffer(p)),m=this.resource.entry;m.open(),m.skip(this.header.dataPosition+t.vertexPosition),m.read(g,0,p),m.skip(t.indexPosition-(t.vertexPosition+p));var v,y=t.vertexCount<=65536,b=y?2:4;if(null==n)v=t.get_indexCount()*b;else{var w=0;for(a=0,A=n;a<A;){h=a++;w+=t.indexCounts[h]}m.skip(w*b),v=t.indexCounts[n]*b}var M=new Qn(new ArrayBuffer(v));m.read(M,0,v);var B=new Fr;if(null==n){var C=new Array(r*t.vertexCount);B.vertexes=C;C=new Array(t.get_indexCount());B.indexes=C;var S=0;for(a=0,A=t.vertexCount;a<A;)for(var I=a++,k=s;null!=k;){if(null==k.def){var E=I*t.vertexStride;for(c=0,d=k.size;c<d;){h=c++;B.vertexes[S++]=g.getFloat(E+k.offset+h<<2)}}else switch(k.size){case 1:B.vertexes[S++]=k.def.x;break;case 2:B.vertexes[S++]=k.def.x,B.vertexes[S++]=k.def.y;break;case 3:B.vertexes[S++]=k.def.x,B.vertexes[S++]=k.def.y,B.vertexes[S++]=k.def.z;break;default:B.vertexes[S++]=k.def.x,B.vertexes[S++]=k.def.y,B.vertexes[S++]=k.def.z,B.vertexes[S++]=k.def.w}k=k.next}if(y)for(E=0,a=0,A=B.indexes.length;a<A;){h=a++;B.indexes[h]=M.b[E++]|M.b[E++]<<8}else for(a=0,A=B.indexes.length;a<A;){h=a++;B.indexes[h]=M.getInt32(h<<2)}}else{var F=t.indexCounts[n],T=C=new Array(t.vertexCount),D=C=Cs._new(0);C=new Array(F);B.indexes=C;E=0;var P=0;for(a=0,A=B.indexes.length;a<A;){h=a++;var z=T[I=y?M.b[E++]|M.b[E++]<<8:M.getInt32(h<<2)];if(0==z){z=++P,T[I]=z;for(k=s;null!=k;){if(null==k.def){var R=I*t.vertexStride;for(c=0,d=k.size;c<d;){var L=c++,V=g.getFloat(R+k.offset+L<<2);if(D.pos==D.array.length){var Q=D.array.length<<1;Q<128&&(Q=128);var U=new Float32Array(Q);U.set(D.array),D.array=U}D.array[D.pos++]=V}}else switch(k.size){case 1:var O=k.def.x;if(D.pos==D.array.length){var G=D.array.length<<1;G<128&&(G=128);var N=new Float32Array(G);N.set(D.array),D.array=N}D.array[D.pos++]=O;break;case 2:var Y=k.def.x;if(D.pos==D.array.length){var X=D.array.length<<1;X<128&&(X=128);var j=new Float32Array(X);j.set(D.array),D.array=j}D.array[D.pos++]=Y;var H=k.def.y;if(D.pos==D.array.length){var W=D.array.length<<1;W<128&&(W=128);var Z=new Float32Array(W);Z.set(D.array),D.array=Z}D.array[D.pos++]=H;break;case 3:var J=k.def.x;if(D.pos==D.array.length){var q=D.array.length<<1;q<128&&(q=128);var K=new Float32Array(q);K.set(D.array),D.array=K}D.array[D.pos++]=J;var $=k.def.y;if(D.pos==D.array.length){var tt=D.array.length<<1;tt<128&&(tt=128);var et=new Float32Array(tt);et.set(D.array),D.array=et}D.array[D.pos++]=$;var it=k.def.z;if(D.pos==D.array.length){var nt=D.array.length<<1;nt<128&&(nt=128);var st=new Float32Array(nt);st.set(D.array),D.array=st}D.array[D.pos++]=it;break;default:var rt=k.def.x;if(D.pos==D.array.length){var at=D.array.length<<1;at<128&&(at=128);var At=new Float32Array(at);At.set(D.array),D.array=At}D.array[D.pos++]=rt;var ht=k.def.y;if(D.pos==D.array.length){var ot=D.array.length<<1;ot<128&&(ot=128);var lt=new Float32Array(ot);lt.set(D.array),D.array=lt}D.array[D.pos++]=ht;var ut=k.def.z;if(D.pos==D.array.length){var _t=D.array.length<<1;_t<128&&(_t=128);var ct=new Float32Array(_t);ct.set(D.array),D.array=ct}D.array[D.pos++]=ut;var dt=k.def.w;if(D.pos==D.array.length){var ft=D.array.length<<1;ft<128&&(ft=128);var xt=new Float32Array(ft);xt.set(D.array),D.array=xt}D.array[D.pos++]=dt}k=k.next}}B.indexes[h]=z-1}for(a=[],A=0,c=(C=D).pos;A<c;){h=A++;a.push(C.array[h])}B.vertexes=a}return m.close(),B},makePrimitive:function(t){var e=this.cachedPrimitives[t];return null!=e||((e=new Ei(this.header.geometries[t],this.header.dataPosition,this)).incref(),this.cachedPrimitives[t]=e),e},makeMaterial:function(t,e,i){var n=this.header.materials[e],s=Je.current.createMaterial();s.name=n.name,null!=n.diffuseTexture&&(s.set_texture(i(n.diffuseTexture)),null==s.get_texture()&&s.set_texture(ti.fromColor(16711935))),null!=n.specularTexture&&s.set_specularTexture(i(n.specularTexture)),null!=n.normalMap&&s.set_normalMap(i(n.normalMap)),s.set_blendMode(n.blendMode),s.model=this.resource;var r=Je.current.loadMaterialProps(s);return null==r&&(r=s.getDefaultModelProps()),s.set_props(r),s},makeSkin:function(t){var e=this.cachedSkin.h[t.name];if(null!=e)return e;(e=new ie(t.name,0,3)).namedJoints=new Kn,e.allJoints=[],e.boundJoints=[],e.rootJoints=[];for(var i=0,n=t.joints;i<n.length;){var s=n[i];if(++i,(_=new $t).name=s.name,_.index=e.allJoints.length,_.defMat=s.position.toMatrix(),s.bind>=0&&(_.bindIndex=s.bind,_.transPos=s.transpos.toMatrix(!0),e.boundJoints[_.bindIndex]=_),s.parent>=0){var r=e.allJoints[s.parent];r.subs.push(_),_.parent=r}else e.rootJoints.push(_);e.allJoints.push(_),e.namedJoints.h[_.name]=_}if(null!=t.split){e.splitJoints=[];for(i=0,n=t.split;i<n.length;){var a=n[i];++i;for(var A=e.splitJoints,h=a.materialIndex,o=[],l=0,u=a.joints;l<u.length;){var _=u[l];++l,o.push(e.allJoints[_])}A.push({material:h,joints:o})}}return this.cachedSkin.h[t.name]=e,e},getModelProperty:function(t,e,i){for(var n=0,s=this.header.models;n<s.length;){var r=s[n];if(++n,r.name==t){if(null!=r.props)for(var a=0,A=r.props;a<A.length;){var h=A[a];if(++a,h._hx_index==e._hx_index)return m.enumParameters(h)[0]}return i}}if(null==i)throw kn.thrown("Model "+t+" not found");return i},makeObject:function(t){if(null==t&&(t=function(t){return ti.fromColor(16711935)}),0==this.header.models.length)throw kn.thrown("This file does not contain any model");for(var e=[],i=0,n=this.header.models;i<n.length;){var s,r=n[i];if(++i,r.geometry<0)s=new Ri;else{var a=this.makePrimitive(r.geometry);if(null!=r.skin){var A=this.makeSkin(r.skin);A.primitive=a;for(var h=[],o=0,l=r.materials;o<l.length;){var u=l[o];++o,h.push(this.makeMaterial(r,u,t))}s=new qi(A,h)}else if(1==r.materials.length)s=new Li(a,this.makeMaterial(r,r.materials[0],t));else{for(var _=[],c=0,d=r.materials;c<d.length;){var f=d[c];++c,_.push(this.makeMaterial(r,f,t))}s=new Gi(a,_)}}s.name=r.name;var x=r.position.toMatrix();s.defaultTransform=x;s.flags|=1,e.push(s);var p=e[r.parent];null!=p&&p.addChild(s)}return e[0]},loadAnimation:function(t){if(null!=(e=this.cachedAnimations.h[null==t?"":t]))return e;var e=null;if(null==t){if(0==this.header.animations.length)return null;e=this.header.animations[0]}else{for(var i=0,n=this.header.animations;i<n.length;){var s=n[i];if(++i,s.name==t){e=s;break}}if(null==e)throw kn.thrown("Animation "+t+" not found !")}var r=this.header.version<=2?this.makeLinearAnimation(e):this.makeAnimation(e);return r.speed=e.speed,r.loop=e.loop,null!=e.events&&r.setEvents(e.events),r.resourcePath=this.resource.entry.get_path(),this.cachedAnimations.h[e.name]=r,null==t&&(this.cachedAnimations.h[""]=r),r},makeAnimation:function(t){for(var e=new Zt(t.name,t.frames,t.sampling),i=0,n=[],s=[],r=0,a=t.objects;r<a.length;){var A=a[r];++r;var h=e.addObject(A.name,0),o=1;if(0!=(A.flags&1<<Br.SingleFrame._hx_index)?(h.layout|=1<<Ht.SingleFrame._hx_index,n.push(h),o=0):s.push(h),0!=(A.flags&1<<Br.HasPosition._hx_index)&&(h.layout|=1<<Ht.Position._hx_index,i+=3*o),0!=(A.flags&1<<Br.HasRotation._hx_index)&&(h.layout|=1<<Ht.Rotation._hx_index,i+=3*o),0!=(A.flags&1<<Br.HasScale._hx_index)&&(h.layout|=1<<Ht.Scale._hx_index,i+=3*o),0!=(A.flags&1<<Br.HasUV._hx_index)&&(h.layout|=1<<Ht.UV._hx_index,i+=2*o),0!=(A.flags&1<<Br.HasAlpha._hx_index)&&(h.layout|=1<<Ht.Alpha._hx_index,i+=o),0!=(A.flags&1<<Br.HasProps._hx_index))for(var l=0,u=A.props.length;l<u;){var _=l++,c=h;_>0&&(c=e.addObject(A.name,0),0==o?n.push(c):s.push(c)),c.layout|=1<<Ht.Property._hx_index,c.propName=A.props[_],i+=o}}var d=0;for(r=0;r<n.length;){var f=n[r];++r,f.dataOffset=d,d+=f.getStride()}var x=d;for(r=0;r<s.length;){f=s[r];++r,f.dataOffset=d,d+=f.getStride()}var p=this.resource.entry;p.open(),p.skip(this.header.dataPosition+t.dataPosition);var g=i*t.frames+x,m=new Qn(new ArrayBuffer(4*g));return p.read(m,0,m.length),p.close(),e.setData(new Float32Array(m.b.buffer),i),e},makeLinearAnimation:function(t){var e=new Kt(t.name,t.frames,t.sampling),i=this.resource.entry;i.open(),i.skip(this.header.dataPosition+t.dataPosition);for(var n=0,s=t.objects;n<s.length;){var r=s[n];++n;var a=0!=(r.flags&1<<Br.HasPosition._hx_index),A=0!=(r.flags&1<<Br.HasRotation._hx_index),h=0!=(r.flags&1<<Br.HasScale._hx_index);if(a||A||h){var o=t.frames;0!=(r.flags&1<<Br.SingleFrame._hx_index)&&(o=1);var l=new Array(o),u=4*((a?3:0)+(A?3:0)+(h?3:0))*o,_=new Qn(new ArrayBuffer(u));i.read(_,0,u);for(var c=0,d=0,f=o;d<f;){var x=d++,p=new Jt;if(a?(p.tx=_.getFloat(c),c+=4,p.ty=_.getFloat(c),c+=4,p.tz=_.getFloat(c),c+=4):(p.tx=0,p.ty=0,p.tz=0),A){p.qx=_.getFloat(c),c+=4,p.qy=_.getFloat(c),c+=4,p.qz=_.getFloat(c),c+=4;var g=1-(p.qx*p.qx+p.qy*p.qy+p.qz*p.qz);p.qw=g<0?-Math.sqrt(-g):Math.sqrt(g)}else p.qx=0,p.qy=0,p.qz=0,p.qw=1;h?(p.sx=_.getFloat(c),c+=4,p.sy=_.getFloat(c),c+=4,p.sz=_.getFloat(c),c+=4):(p.sx=1,p.sy=1,p.sz=1),l[x]=p}e.addCurve(r.name,l,!0,A,h)}if(0!=(r.flags&1<<Br.HasUV._hx_index)){var m=new Array(2*t.frames),v=8*t.frames,y=new Qn(new ArrayBuffer(v));i.read(y,0,v);for(var b=0,w=m.length;b<w;){var M=b++;m[M]=y.getFloat(4*M)}e.addUVCurve(r.name,m)}if(0!=(r.flags&1<<Br.HasAlpha._hx_index)){var B=new Array(t.frames),C=4*t.frames,S=new Qn(new ArrayBuffer(C));i.read(S,0,C);for(var I=0,k=B.length;I<k;){var E=I++;B[E]=S.getFloat(4*E)}e.addAlphaCurve(r.name,B)}if(0!=(r.flags&1<<Br.HasProps._hx_index))for(var F=0,T=r.props;F<T.length;){var D=T[F];++F;var P=new Array(t.frames),z=4*t.frames,R=new Qn(new ArrayBuffer(z));i.read(R,0,z);for(var L=0,V=P.length;L<V;){var Q=L++;P[Q]=R.getFloat(4*Q)}e.addPropCurve(r.name,D,P)}}return i.close(),e},loadSkin:function(t,e,i){if(null==i&&(i=!0),null==e.vertexWeights){if(3!=e.bonesPerVertex)throw kn.thrown("assert");e.vertexCount=t.vertexCount;var n=this.getBuffers(t,[new gr("position",3),new gr("weights",3),new gr("indexes",9)]),s=new Array(e.vertexCount*e.bonesPerVertex);e.vertexWeights=s;s=new Array(e.vertexCount*e.bonesPerVertex);e.vertexJoints=s;for(var r=0,a=e.boundJoints;r<a.length;){var A=a[r];++r,A.offsets=new se}var h,o=n.vertexes,l=0,u=1e20,_=-1e20,c=1e20,d=-1e20,f=1e20,x=-1e20;if(null==e.splitJoints){var p=[];for(r=0,a=e.boundJoints;r<a.length;){A=a[r];++r,p[A.bindIndex]=A}h=[{index:0,pos:0,count:n.indexes.length,joints:p}]}else{l=0;var g=[],m=0;for(r=0,a=t.indexCounts;r<a.length;){var v=a[r];++r,g.push(m),m+=v}r=[],a=0;for(var y=e.splitJoints;a<y.length;){A=y[a];++a,r.push({index:l,pos:g[l],count:t.indexCounts[l++],joints:A.joints})}h=r}for(r=0;r<h.length;){var b=h[r];++r;for(a=b.pos,y=b.pos+b.count;a<y;){l=a++;var w=n.indexes[l],M=7*w;if((G=o[M])==G){o[M++]=NaN;var B=o[M++],C=o[M++],S=o[M++],I=o[M++],k=o[M++],E=3*w;e.vertexWeights[E]=S,e.vertexWeights[E+1]=I,e.vertexWeights[E+2]=k;var F=(0==S?1:0)|(0==I?2:0)|(0==k?4:0),T=os.floatToI32(o[M++]);G<u&&(u=G),G>_&&(_=G),B<c&&(c=B),B>d&&(d=B),C<f&&(f=C),C>x&&(x=C);for(var D=0;D<3;){var P=D++;if(0==(F&1<<P)){var z=T>>(P<<3)&255;G<(L=(A=b.joints[z]).offsets).xMin&&(L.xMin=G),G>L.xMax&&(L.xMax=G),B<L.yMin&&(L.yMin=B),B>L.yMax&&(L.yMax=B),C<L.zMin&&(L.zMin=C),C>L.zMax&&(L.zMax=C),e.vertexJoints[E++]=A.bindIndex}else e.vertexJoints[E++]=-1}}}}if(i){l=e.allJoints.length-1;for(var R=(_-u)*(d-c)*(x-f);l>=0;){if(null!=(A=e.allJoints[l--]).offsets&&null!=A.parent&&null!=A.parent.offsets){var L,V=A.parent.offsets,Q=(L=A.offsets).xMax-L.xMin,U=L.yMax-L.yMin,O=L.zMax-L.zMin,G=.5*(L.xMin+L.xMax);B=.5*(L.yMin+L.yMax),C=.5*(L.zMin+L.zMax);null==(b=.5*Math.sqrt(Q*Q+U*U+O*O))&&(b=0),null==C&&(C=0),null==B&&(B=0),null==G&&(G=0);var N=G,Y=B,X=C,j=b;null==j&&(j=0),null==X&&(X=0),null==Y&&(Y=0),null==N&&(N=0);var H=N,W=Y,Z=X,J=j;if(V.xMin<=H-J&&V.yMin<=W-J&&V.zMin<=Z-J&&V.xMax>=H+J&&V.yMax>=W+J&&V.zMax>=Z+J)A.offsets=null;else{(nt=new se).xMin=V.xMin,nt.xMax=V.xMax,nt.yMin=V.yMin,nt.yMax=V.yMax,nt.zMin=V.zMin,nt.zMax=V.zMax;var q=nt,K=H,$=W,tt=Z,et=J;K-et<q.xMin&&(q.xMin=K-et),K+et>q.xMax&&(q.xMax=K+et),$-et<q.yMin&&(q.yMin=$-et),$+et>q.yMax&&(q.yMax=$+et),tt-et<q.zMin&&(q.zMin=tt-et),tt+et>q.zMax&&(q.zMax=tt+et);var it=Math.sqrt(1.5*R/((q.xMax-q.xMin)*(q.yMax-q.yMin)*(q.zMax-q.zMin)));(q.xMax-q.xMin)*(q.yMax-q.yMin)*(q.zMax-q.zMin)/((V.xMax-V.xMin)*(V.yMax-V.yMin)*(V.zMax-V.zMin))<it&&(A.parent.offsets=q,A.offsets=null)}}}}for(r=0,a=e.allJoints;r<a.length;){A=a[r];if(++r,null!=A.offsets){var nt,st,rt;G=.5*((nt=A.offsets).xMin+nt.xMax),B=.5*(nt.yMin+nt.yMax);null==(C=.5*(nt.zMin+nt.zMax))&&(C=0),null==B&&(B=0),null==G&&(G=0);var at=G,At=B,ht=C;if(nt.xMax-nt.xMin>nt.yMax-nt.yMin&&nt.xMax-nt.xMin>nt.zMax-nt.zMin){var ot=nt.yMax-nt.yMin,lt=nt.zMax-nt.zMin;b=.5*(ot<lt?lt:ot),st=new _e(nt.xMin+b,At,ht),rt=new _e(nt.xMax-b,At,ht)}else if(nt.yMax-nt.yMin>nt.zMax-nt.zMin){var ut=nt.xMax-nt.xMin,_t=nt.zMax-nt.zMin;b=.5*(ut<_t?_t:ut),st=new _e(at,nt.yMin+b,ht),rt=new _e(at,nt.yMax-b,ht)}else{var ct=nt.xMax-nt.xMin,dt=nt.yMax-nt.yMin;b=.5*(ct<dt?dt:ct),st=new _e(at,At,nt.zMin+b),rt=new _e(at,At,nt.zMax-b)}nt.xMin=st.x,nt.yMin=st.y,nt.zMin=st.z,nt.xMax=rt.x,nt.yMax=rt.y,nt.zMax=rt.z,A.offsetRay=b}else A.offsetRay=-1}}},__class__:Tr};var Dr=function(t){this.i=t};i["hxd.fmt.hmd.Reader"]=Dr,Dr.__name__="hxd.fmt.hmd.Reader",Dr.prototype={readProperty:function(){var t=this.i.readByte();switch(t){case 0:return xr.CameraFOVY(this.i.readFloat());case 1:throw kn.thrown("Obsolete HasMaterialFlags");case 2:return xr.HasExtraTextures;default:var e=t;throw kn.thrown("Unknown property #"+e)}},readProps:function(){if(1==this.version)return null;var t=this.i.readByte();if(0==t)return null;for(var e=[],i=0,n=t;i<n;){i++;e.push(this.readProperty())}return e},readName:function(){var t=this.i.readByte();return 255==t?null:this.i.readString(t)},readCachedName:function(){var t=this.readName();if(null==t)return null;null==Dr.HMD_STRINGS&&(Dr.HMD_STRINGS=new Kn);var e=Dr.HMD_STRINGS.h[t];return null!=e?e:(Dr.HMD_STRINGS.h[t]=t,t)},readPosition:function(t){null==t&&(t=!0);var e=new pr;return e.x=this.i.readFloat(),e.y=this.i.readFloat(),e.z=this.i.readFloat(),e.qx=this.i.readFloat(),e.qy=this.i.readFloat(),e.qz=this.i.readFloat(),t?(e.sx=this.i.readFloat(),e.sy=this.i.readFloat(),e.sz=this.i.readFloat()):(e.sx=1,e.sy=1,e.sz=1),e},readBounds:function(){var t=new se;return t.xMin=this.i.readFloat(),t.yMin=this.i.readFloat(),t.zMin=this.i.readFloat(),t.xMax=this.i.readFloat(),t.yMax=this.i.readFloat(),t.zMax=this.i.readFloat(),t},readSkin:function(){var t=this.readCachedName();if(null==t)return null;var e=new wr;e.props=this.readProps(),e.name=t,e.joints=[];for(var i=0,n=this.i.readUInt16();i<n;){i++;var s=new yr;s.props=this.readProps(),s.name=this.readCachedName();var r=this.i.readUInt16(),a=0!=(32768&r);a&&(r&=32767),s.parent=r-1,s.position=this.readPosition(a),s.bind=this.i.readUInt16()-1,s.bind>=0&&(s.transpos=this.readPosition(a)),e.joints.push(s)}var A=this.i.readByte();if(A>0){e.split=[];for(i=0,n=A;i<n;){i++;var h=new br;h.materialIndex=this.i.readByte();for(var o=[],l=0,u=this.i.readByte();l<u;){l++;o.push(this.i.readUInt16())}h.joints=o,e.split.push(h)}}return e},readHeader:function(){var t=new kr,e=this.i.readString(3);if("HMD"!=e){if(59==l.cca(e,0))throw kn.thrown("FBX was not converted to HMD");throw kn.thrown("Invalid HMD header "+encodeURIComponent(e))}if(this.version=this.i.readByte(),this.version>3)throw kn.thrown("Can't read HMD v"+this.version);t.version=this.version,t.geometries=[],t.dataPosition=this.i.readInt32(),t.props=this.readProps();for(var i=0,n=this.i.readInt32();i<n;){i++;var s=new mr;s.props=this.readProps(),s.vertexCount=this.i.readInt32(),s.vertexStride=this.i.readByte();for(var r=[],a=0,A=this.i.readByte();a<A;){a++;var h=this.readCachedName(),o=this.i.readByte();r.push(new gr(h,o))}s.vertexFormat=r,s.vertexPosition=this.i.readInt32();for(var u=[],_=0,c=this.i.readByte();_<c;){_++;u.push(this.i.readInt32())}s.indexCounts=u,s.indexPosition=this.i.readInt32(),s.bounds=this.readBounds(),t.geometries.push(s)}t.materials=[];for(i=0,n=this.i.readInt32();i<n;){i++;(d=new vr).props=this.readProps(),d.name=this.readName(),d.diffuseTexture=this.readName(),d.blendMode=Dr.BLEND[this.i.readByte()],this.i.readByte(),this.i.readFloat(),null!=d.props&&d.props.indexOf(xr.HasExtraTextures)>=0&&(d.specularTexture=this.readName(),d.normalMap=this.readName()),t.materials.push(d)}t.models=[];for(i=0,n=this.i.readInt32();i<n;){var d;i++;if((d=new Mr).props=this.readProps(),d.name=this.readCachedName(),d.parent=this.i.readInt32()-1,d.follow=this.readCachedName(),d.position=this.readPosition(),d.geometry=this.i.readInt32()-1,t.models.push(d),!(d.geometry<0)){d.materials=[];for(r=0,a=this.i.readByte();r<a;){r++;d.materials.push(this.i.readInt32())}d.skin=this.readSkin()}}t.animations=[];for(i=0,n=this.i.readInt32();i<n;){i++;var f=new Ir;f.props=this.readProps(),f.name=this.readName(),f.frames=this.i.readInt32(),f.sampling=this.i.readFloat(),f.speed=this.i.readFloat();var x=this.i.readByte();f.loop=0!=(1&x),f.dataPosition=this.i.readInt32(),f.objects=[];for(r=0,a=this.i.readInt32();r<a;){r++;var p=new Cr;p.name=this.readCachedName();var g=this.i.readByte();null==g&&(g=0);o=g;if(p.flags=o,f.objects.push(p),0!=(p.flags&1<<Br.HasProps._hx_index)){for(A=[],u=0,_=this.i.readByte();u<_;){u++;A.push(this.readName())}p.props=A}}if(0!=(2&x)){f.events=[];c=0;for(var m=this.i.readInt32();c<m;){c++;var v=new Sr;v.frame=this.i.readInt32(),v.data=this.readCachedName(),f.events.push(v)}}t.animations.push(f)}return t},read:function(){var t=this.readHeader();return t.data=this.i.read(this.i.readInt32()),t},__class__:Dr};var Pr=function(){};i["hxd.fs.FileEntry"]=Pr,Pr.__name__="hxd.fs.FileEntry",Pr.prototype={getSign:function(){return 0},getBytes:function(){return null},getText:function(){return this.getBytes().toString()},open:function(){},skip:function(t){},readByte:function(){return 0},read:function(t,e,i){},close:function(){},load:function(t){if(!this.get_isAvailable())throw kn.thrown("load() not implemented");null!=t&&t()},loadBitmap:function(t){throw kn.thrown("loadBitmap() not implemented")},watch:function(t){},exists:function(t){return!1},get:function(t){return null},iterator:function(){return null},get_isAvailable:function(){return!0},get_isDirectory:function(){return!1},get_size:function(){return 0},get_path:function(){throw kn.thrown("path() not implemented")},get_directory:function(){var t=this.get_path().lastIndexOf("/");return t<0?"":l.substr(this.get_path(),0,t)},get_extension:function(){var t=this.name.lastIndexOf(".");return t<0?"":l.substr(this.name,t+1,null).toLowerCase()},__class__:Pr};var zr=function(t,e){this.fullPath=t,this.name=t.split("/").pop(),this.bytes=e};i["hxd.fs.BytesFileEntry"]=zr,zr.__name__="hxd.fs.BytesFileEntry",zr.__super__=Pr,zr.prototype=r(Pr.prototype,{get_path:function(){return this.fullPath},getSign:function(){return this.bytes.b[0]|this.bytes.b[1]<<8|this.bytes.b[2]<<16|this.bytes.b[3]<<24},getBytes:function(){return this.bytes},open:function(){this.pos=0},skip:function(t){this.pos+=t},readByte:function(){return this.bytes.b[this.pos++]},read:function(t,e,i){t.blit(e,this.bytes,this.pos,i),this.pos+=i},close:function(){},load:function(t){Pn.delay(t,1)},loadBitmap:function(t){var e;switch(ls.extension(this.fullPath).toLowerCase()){case"gif":e="image/gif";break;case"jpeg":case"jpg":e="image/jpeg";break;case"png":e="image/png";break;default:throw kn.thrown("Cannot determine image encoding, try adding an extension to the resource path")}var i=new Image;i.onload=function(){t(i)};var n=On.encode(this.bytes);i.src="data:"+e+";base64,"+n},exists:function(t){return!1},get:function(t){return null},iterator:function(){return new ta([])},get_size:function(){return this.bytes.length},__class__:zr});var Rr=function(){};i["hxd.fs.FileSystem"]=Rr,Rr.__name__="hxd.fs.FileSystem",Rr.__isInterface__=!0,Rr.prototype={__class__:Rr};var Lr=function(){};i["hxd.fs.BytesFileSystem"]=Lr,Lr.__name__="hxd.fs.BytesFileSystem",Lr.__interfaces__=[Rr],Lr.prototype={getRoot:function(){throw kn.thrown("Not implemented")},getBytes:function(t){throw kn.thrown("Not implemented")},exists:function(t){return null!=this.getBytes(t)},get:function(t){var e=this.getBytes(t);if(null==e)throw kn.thrown("Resource not found '"+t+"'");return new zr(t,e)},dispose:function(){},dir:function(t){throw kn.thrown("Not implemented")},__class__:Lr};var Vr=function(t,e,i,n){this.fs=t,this.name=e,this.relPath=i,this.data=n};i["hxd.fs._EmbedFileSystem.EmbedEntry"]=Vr,Vr.__name__="hxd.fs._EmbedFileSystem.EmbedEntry",Vr.__super__=Pr,Vr.prototype=r(Pr.prototype,{getSign:function(){var t=this.readPos;return this.open(),this.readPos=t,this.bytes.b[0]|this.bytes.b[1]<<8|this.bytes.b[2]<<16|this.bytes.b[3]<<24},getBytes:function(){return null==this.bytes&&this.open(),this.bytes},open:function(){if(null==this.bytes&&(this.bytes=Dn.getBytes(this.data),null==this.bytes))throw kn.thrown("Missing resource "+this.data);this.readPos=0},skip:function(t){this.readPos+=t},readByte:function(){return this.bytes.b[this.readPos++]},read:function(t,e,i){t.blit(e,this.bytes,this.readPos,i),this.readPos+=i},close:function(){this.bytes=null,this.readPos=0},load:function(t){null!=t&&Pn.delay(t,1)},loadBitmap:function(t){for(var e=null,i=0,n=Dn.content;i<n.length;){var s=n[i];if(++i,s.name==this.data){e=s.data;break}}if(null==e)throw kn.thrown("Missing resource "+this.data);var r=new Image;r.onload=function(e){t(r)};var a="";for(i=0,n=(3-4*(6*e.length>>3)%3)%3;i<n;){i++;a+="="}var A="data:image/"+this.get_extension()+";base64,"+e;r.src=A+a},get_isDirectory:function(){return this.fs.isDirectory(this.relPath)},get_path:function(){return"."==this.relPath?"<root>":this.relPath},exists:function(t){return this.fs.exists("."==this.relPath?t:this.relPath+"/"+t)},get:function(t){return this.fs.get("."==this.relPath?t:this.relPath+"/"+t)},get_size:function(){return this.open(),this.bytes.length},iterator:function(){return new ta(this.fs.subFiles(this.relPath))},__class__:Vr});var Qr=function(t){this.root=t};i["hxd.fs.EmbedFileSystem"]=Qr,Qr.__name__="hxd.fs.EmbedFileSystem",Qr.__interfaces__=[Rr],Qr.resolve=function(t){return"R_"+t.replace(Qr.invalidChars.r,"_")},Qr.prototype={getRoot:function(){return new Vr(this,"root",".",null)},splitPath:function(t){return"."==t?[]:t.split("/")},subFiles:function(t){for(var e=this.root,i=0,n=this.splitPath(t);i<n.length;){var s=n[i];++i,e=f.field(e,s)}if(null==e)throw kn.thrown(t+" is not a directory");var r=f.fields(e);r.sort(f.compare);for(i=[],n=0;n<r.length;){var a=r[n];++n,i.push(this.get("."==t?a:t+"/"+a))}return i},isDirectory:function(t){for(var e=this.root,i=0,n=this.splitPath(t);i<n.length;){var s=n[i];++i,e=f.field(e,s)}return null!=e&&1!=e},exists:function(t){for(var e=this.root,i=0,n=this.splitPath(t);i<n.length;){var s=n[i];if(++i,null==(e=f.field(e,s)))return!1}return!0},get:function(t){if(!this.exists(t))throw kn.thrown(new Gr(t));var e=Qr.resolve(t);return new Vr(this,t.split("/").pop(),t,e)},dispose:function(){},dir:function(t){throw kn.thrown("Not Supported")},__class__:Qr};var Ur=function(t){this.f=t,t.open()};i["hxd.fs.FileInput"]=Ur,Ur.__name__="hxd.fs.FileInput",Ur.__super__=ns,Ur.prototype=r(ns.prototype,{skip:function(t){this.f.skip(t)},readByte:function(){return this.f.readByte()},readBytes:function(t,e,i){return this.f.read(t,e,i),i},close:function(){this.f.close()},__class__:Ur});var Or={_new:function(t){return t},toBitmap:function(t){var e=new ys(t.width,t.height);return e.ctx.drawImage(t,0,0),e},toNative:function(t){return t}},Gr=function(t){this.path=t};i["hxd.fs.NotFound"]=Gr,Gr.__name__="hxd.fs.NotFound",Gr.prototype={toString:function(){return"Resource file not found '"+this.path+"'"},__class__:Gr};var Nr={toInt:function(t){return t}},Yr=function(){};i["hxd.impl.Allocator"]=Yr,Yr.__name__="hxd.impl.Allocator",Yr.set=function(t){Yr.inst=t},Yr.get=function(){return null==Yr.inst&&(Yr.inst=new Yr),Yr.inst},Yr.prototype={allocBuffer:function(t,e,i){var n;switch(i){case 0:n=[zt.Dynamic];break;case 1:n=[zt.UniformBuffer,zt.Dynamic];break;case 2:n=[zt.RawFormat];break;case 3:n=[zt.Quads,zt.RawFormat]}return new Rt(t,e,n)},ofFloats:function(t,e,i){var n=t.pos/e|0,s=this.allocBuffer(n,e,i);return s.uploadVector(t,0,n),s},disposeBuffer:function(t){t.dispose()},allocIndexBuffer:function(t){return new Ot(t)},ofIndexes:function(t,e){null==e&&(e=-1),e<0&&null!=t&&(e=t.length);var i=this.allocIndexBuffer(e);return i.upload(t,0,e),i},disposeIndexBuffer:function(t){t.dispose()},onContextLost:function(){},allocFloats:function(t){var e=t;return null==e&&(e=0),Cs._new(e)},disposeFloats:function(t){},allocIndexes:function(t){var e=t;return null==e&&(e=0),new Array(e)},disposeIndexes:function(t){},__class__:Yr};var Xr=function(){};i["hxd.impl.Api"]=Xr,Xr.__name__="hxd.impl.Api",Xr.downcast=function(t,e){return yA.__downcastCheck(t,e)?t:null},Xr.isOfType=function(t,e){return yA.__instanceof(t,e)};var jr=function(t){this.i=0,this.a=t,this.l=this.a.length};i["hxd.impl.ArrayIterator"]=jr,jr.__name__="hxd.impl.ArrayIterator",jr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:jr};var Hr=function(t){this.i=0,this.a=t,this.l=this.a.length};i["hxd.impl.ArrayIterator_h2d_Object"]=Hr,Hr.__name__="hxd.impl.ArrayIterator_h2d_Object",Hr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Hr};var Wr=function(t){this.i=0,this.a=t,this.l=this.a.length};i["hxd.impl.ArrayIterator_h2d_col_IPoint"]=Wr,Wr.__name__="hxd.impl.ArrayIterator_h2d_col_IPoint",Wr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Wr};var Zr=function(t){this.i=0,this.a=t,this.l=this.a.length};i["hxd.impl.ArrayIterator_h2d_col_IPolygon"]=Zr,Zr.__name__="hxd.impl.ArrayIterator_h2d_col_IPolygon",Zr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Zr};var Jr=function(t){this.i=0,this.a=t,this.l=this.a.length};i["hxd.impl.ArrayIterator_h2d_col_Point"]=Jr,Jr.__name__="hxd.impl.ArrayIterator_h2d_col_Point",Jr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Jr};var qr=function(t){this.i=0,this.a=t,this.l=this.a.length};i["hxd.impl.ArrayIterator_h2d_col_Polygon"]=qr,qr.__name__="hxd.impl.ArrayIterator_h2d_col_Polygon",qr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:qr};var Kr=function(t){this.i=0,this.a=t,this.l=this.a.length};i["hxd.impl.ArrayIterator_h2d_col_Segment"]=Kr,Kr.__name__="hxd.impl.ArrayIterator_h2d_col_Segment",Kr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Kr};var $r=function(t){this.i=0,this.a=t,this.l=this.a.length};i["hxd.impl.ArrayIterator_h3d_scene_Object"]=$r,$r.__name__="hxd.impl.ArrayIterator_h3d_scene_Object",$r.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:$r};var ta=function(t){this.i=0,this.a=t,this.l=this.a.length};i["hxd.impl.ArrayIterator_hxd_fs_FileEntry"]=ta,ta.__name__="hxd.impl.ArrayIterator_hxd_fs_FileEntry",ta.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:ta};var ea=function(t){this.i=0,this.a=t,this.l=this.a.length};i["hxd.impl.ArrayIterator_hxd_res_Any"]=ea,ea.__name__="hxd.impl.ArrayIterator_hxd_res_Any",ea.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:ea};var ia=function(t){this.i=0,this.a=t,this.l=this.a.length};i["hxd.impl.ArrayIterator_hxd_snd_Channel"]=ia,ia.__name__="hxd.impl.ArrayIterator_hxd_snd_Channel",ia.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:ia};var na=function(t,e){Lr.call(this),this.path=t,this.bytes=e};i["hxd.res._Any.SingleFileSystem"]=na,na.__name__="hxd.res._Any.SingleFileSystem",na.__super__=Lr,na.prototype=r(Lr.prototype,{getBytes:function(t){return t==this.path?this.bytes:null},__class__:na});var sa=function(t){this.entry=t};i["hxd.res.Resource"]=sa,sa.__name__="hxd.res.Resource",sa.prototype={get_name:function(){return this.entry.name},toString:function(){return this.entry.get_path()},watch:function(t){sa.LIVE_UPDATE&&this.entry.watch(t)},__class__:sa};var ra=function(t,e){sa.call(this,e),this.loader=t};i["hxd.res.Any"]=ra,ra.__name__="hxd.res.Any",ra.fromBytes=function(t,e){var i=new na(t,e);return new la(i).load(t)},ra.__super__=sa,ra.prototype=r(sa.prototype,{toModel:function(){return this.loader.loadCache(this.entry.get_path(),ua)},toTexture:function(){return this.toImage().toTexture()},toTile:function(){return this.toImage().toTile()},toText:function(){return this.entry.getBytes().toString()},toImage:function(){return this.loader.loadCache(this.entry.get_path(),oa)},toSound:function(){return this.loader.loadCache(this.entry.get_path(),xa)},toPrefab:function(){return this.loader.loadCache(this.entry.get_path(),sa)},to:function(t){return this.loader.loadCache(this.entry.get_path(),t)},iterator:function(){for(var t=[],e=this.entry.iterator();e.i<e.l;){var i=e.a[e.i++];t.push(new ra(this.loader,i))}return new ea(t)},__class__:ra});var aa={get_useAsyncDecode:function(t){return 0==t},toInt:function(t){return t}},Aa=s["hxd.res.ImageInfoFlag"]={__ename__:!0,__constructs__:null,IsCube:{_hx_name:"IsCube",_hx_index:0,__enum__:"hxd.res.ImageInfoFlag",toString:n},Dxt10Header:{_hx_name:"Dxt10Header",_hx_index:1,__enum__:"hxd.res.ImageInfoFlag",toString:n}};Aa.__constructs__=[Aa.IsCube,Aa.Dxt10Header],Aa.__empty_constructs__=[Aa.IsCube,Aa.Dxt10Header];var ha=function(){this.mipLevels=1,this.height=0,this.width=0;this.flags=0};i["hxd.res.ImageInfo"]=ha,ha.__name__="hxd.res.ImageInfo",ha.prototype={__class__:ha};var oa=function(t){sa.call(this,t)};i["hxd.res.Image"]=oa,oa.__name__="hxd.res.Image",oa.setupTextureFlags=function(t){},oa.__super__=sa,oa.prototype=r(sa.prototype,{getFormat:function(){return this.getInfo().dataFormat},getPixelFormat:function(){return this.getInfo().pixelFormat},getSize:function(){return this.getInfo()},getInfo:function(){if(null!=this.inf)return this.inf;this.inf=new ha;var t,e=new Ur(this.entry);try{t=e.readUInt16()}catch(e){if(!(kn.caught(e).unwrap()instanceof As))throw e;t=0}switch(t){case 16163:for(this.inf.dataFormat=6;""!=e.readLine(););var i=e.readLine().split(" ");this.inf.pixelFormat=$e.RGBA32F,this.inf.height=x.parseInt(i[1]),this.inf.width=x.parseInt(i[3]);break;case 17476:this.inf.dataFormat=4,e.skip(10),this.inf.height=e.readInt32(),this.inf.width=e.readInt32(),e.skip(8),this.inf.mipLevels=e.readInt32(),e.skip(48);var n=e.readInt32(),s=e.readInt32(),r=e.readInt32(),a=e.readInt32(),A=e.readInt32(),h=e.readInt32(),o=e.readInt32();e.readInt32();switch(65024==(65024&e.readInt32())&&(this.inf.flags|=1<<Aa.IsCube._hx_index),16777215&s){case 0:if(808540228==s){switch(e.skip(12),this.inf.flags|=1<<Aa.Dxt10Header._hx_index,l=e.readInt32()){case 95:c=$e.S3TC(6);break;case 98:c=$e.S3TC(7);break;default:throw kn.thrown(this.entry.get_path()+" has unsupported DXGI format "+l)}this.inf.pixelFormat=c}else if(0!=(64&n)){if(32!=r)throw kn.thrown("Unsupported RGB DDS "+r+"bits "+g.hex(a)+"/"+g.hex(A)+"/"+g.hex(h)+"/"+g.hex(o));switch(a){case 255:if(65280!=A)throw kn.thrown("Unsupported RGB DDS "+r+"bits "+g.hex(a)+"/"+g.hex(A)+"/"+g.hex(h)+"/"+g.hex(o));if(16711680!=h)throw kn.thrown("Unsupported RGB DDS "+r+"bits "+g.hex(a)+"/"+g.hex(A)+"/"+g.hex(h)+"/"+g.hex(o));if(-16777216!=o)throw kn.thrown("Unsupported RGB DDS "+r+"bits "+g.hex(a)+"/"+g.hex(A)+"/"+g.hex(h)+"/"+g.hex(o));this.inf.pixelFormat=$e.RGBA;break;case 16711680:if(65280!=A)throw kn.thrown("Unsupported RGB DDS "+r+"bits "+g.hex(a)+"/"+g.hex(A)+"/"+g.hex(h)+"/"+g.hex(o));if(255!=h)throw kn.thrown("Unsupported RGB DDS "+r+"bits "+g.hex(a)+"/"+g.hex(A)+"/"+g.hex(h)+"/"+g.hex(o));if(-16777216!=o)throw kn.thrown("Unsupported RGB DDS "+r+"bits "+g.hex(a)+"/"+g.hex(A)+"/"+g.hex(h)+"/"+g.hex(o));this.inf.pixelFormat=$e.BGRA;break;default:throw kn.thrown("Unsupported RGB DDS "+r+"bits "+g.hex(a)+"/"+g.hex(A)+"/"+g.hex(h)+"/"+g.hex(o))}}break;case 111:if(808540228==s){switch(e.skip(12),this.inf.flags|=1<<Aa.Dxt10Header._hx_index,l=e.readInt32()){case 95:c=$e.S3TC(6);break;case 98:c=$e.S3TC(7);break;default:throw kn.thrown(this.entry.get_path()+" has unsupported DXGI format "+l)}this.inf.pixelFormat=c}else this.inf.pixelFormat=$e.R16F;break;case 112:if(808540228==s){switch(e.skip(12),this.inf.flags|=1<<Aa.Dxt10Header._hx_index,l=e.readInt32()){case 95:c=$e.S3TC(6);break;case 98:c=$e.S3TC(7);break;default:throw kn.thrown(this.entry.get_path()+" has unsupported DXGI format "+l)}this.inf.pixelFormat=c}else this.inf.pixelFormat=$e.RG16F;break;case 113:if(808540228==s){switch(e.skip(12),this.inf.flags|=1<<Aa.Dxt10Header._hx_index,l=e.readInt32()){case 95:c=$e.S3TC(6);break;case 98:c=$e.S3TC(7);break;default:throw kn.thrown(this.entry.get_path()+" has unsupported DXGI format "+l)}this.inf.pixelFormat=c}else this.inf.pixelFormat=$e.RGBA16F;break;case 114:if(808540228==s){switch(e.skip(12),this.inf.flags|=1<<Aa.Dxt10Header._hx_index,l=e.readInt32()){case 95:c=$e.S3TC(6);break;case 98:c=$e.S3TC(7);break;default:throw kn.thrown(this.entry.get_path()+" has unsupported DXGI format "+l)}this.inf.pixelFormat=c}else this.inf.pixelFormat=$e.R32F;break;case 115:if(808540228==s){switch(e.skip(12),this.inf.flags|=1<<Aa.Dxt10Header._hx_index,l=e.readInt32()){case 95:c=$e.S3TC(6);break;case 98:c=$e.S3TC(7);break;default:throw kn.thrown(this.entry.get_path()+" has unsupported DXGI format "+l)}this.inf.pixelFormat=c}else this.inf.pixelFormat=$e.RG32F;break;case 116:if(808540228==s){switch(e.skip(12),this.inf.flags|=1<<Aa.Dxt10Header._hx_index,l=e.readInt32()){case 95:c=$e.S3TC(6);break;case 98:c=$e.S3TC(7);break;default:throw kn.thrown(this.entry.get_path()+" has unsupported DXGI format "+l)}this.inf.pixelFormat=c}else this.inf.pixelFormat=$e.RGBA32F;break;case 4805697:switch((s>>>24)-48){case 1:c=$e.S3TC(4);break;case 2:c=$e.S3TC(5);break;default:c=null}this.inf.pixelFormat=c;break;case 5527620:switch((s>>>24)-48){case 1:c=$e.S3TC(1);break;case 2:case 3:c=$e.S3TC(2);break;case 4:case 5:c=$e.S3TC(3);break;default:c=null}this.inf.pixelFormat=c;break;default:if(808540228==s){var l;switch(e.skip(12),this.inf.flags|=1<<Aa.Dxt10Header._hx_index,l=e.readInt32()){case 95:c=$e.S3TC(6);break;case 98:c=$e.S3TC(7);break;default:throw kn.thrown(this.entry.get_path()+" has unsupported DXGI format "+l)}this.inf.pixelFormat=c}}if(null==this.inf.pixelFormat){var u=String.fromCodePoint(255&s)+String.fromCodePoint(s>>8&255)+String.fromCodePoint(s>>16&255)+String.fromCodePoint(s>>>24);throw(255&s)==s&&(u="0x"+s),kn.thrown(this.entry.get_path()+" has unsupported 4CC "+u)}break;case 18759:this.inf.dataFormat=2,this.inf.pixelFormat=$e.BGRA,e.readInt32(),this.inf.width=e.readUInt16(),this.inf.height=e.readUInt16();break;case 20617:for(this.inf.dataFormat=1,e.set_bigEndian(!0),e.skip(6);;){var _=e.readInt32();if(1229472850==e.readInt32()){this.inf.width=e.readInt32(),this.inf.height=e.readInt32();var c,d=e.readByte();switch(d){case 8:c=$e.BGRA;break;case 16:c=$e.R16U;break;case 48:c=$e.RGB16U;break;case 64:c=$e.RGBA16U;break;default:throw kn.thrown("Unsupported png format "+d+"("+this.entry.get_path()+")")}this.inf.pixelFormat=c;break}e.skip(_+4)}break;case 55551:this.inf.dataFormat=0,this.inf.pixelFormat=$e.BGRA,e.set_bigEndian(!0);t:for(;;)switch(e.readUInt16()){case 65472:case 65473:case 65474:e.readUInt16(),e.readByte();this.inf.height=e.readUInt16(),this.inf.width=e.readUInt16();break t;default:e.skip(e.readUInt16()-2)}break;default:if("tga"==this.entry.get_extension())this.inf.dataFormat=3,this.inf.pixelFormat=$e.ARGB,e.skip(10),this.inf.width=e.readUInt16(),this.inf.height=e.readUInt16();else{if("raw"!=this.entry.get_extension())throw kn.thrown("Unsupported texture format "+this.entry.get_path());this.inf.dataFormat=5,this.inf.pixelFormat=$e.R32F;var f=0|Math.sqrt(this.entry.get_size()>>2);if(this.entry.get_size()!=f*f*4){var p=0|Math.sqrt(this.entry.get_size()>>1);if(this.entry.get_size()!=p*p*2)throw kn.thrown("RAW format does not match 32 bit per components on "+f+"x"+f);this.inf.pixelFormat=$e.R16F,f=p}this.inf.width=this.inf.height=f}}if(e.close(),null==this.inf.pixelFormat)throw kn.thrown("Unsupported internal format ("+this.entry.get_path()+")");return this.inf},getPixels:function(t,e,i){var n;switch(null==i&&(i=0),this.getInfo().dataFormat){case 0:var s=this.entry.getBytes();if(this.inf.pixelFormat!=$e.BGRA)throw kn.thrown("No support to decode "+x.string(this.inf.pixelFormat)+" on this platform ("+this.entry.get_path()+")");try{c=da.decode(s)}catch(d){var r=kn.caught(d).unwrap();throw kn.thrown("Failed to decode JPG "+this.entry.get_path()+" ("+x.string(r)+")")}n=new Ps(c.width,c.height,c.pixels,$e.BGRA);break;case 1:s=this.entry.getBytes();if(this.inf.pixelFormat!=$e.BGRA)throw kn.thrown("No support to decode "+x.string(this.inf.pixelFormat)+" on this platform ("+this.entry.get_path()+")");var a=new G(new ss(s));a.checkCRC=!1,n=Ps.alloc(this.inf.width,this.inf.height,$e.BGRA);var A=a.read();N.extract32(A,n.bytes,e),e&&(n.flags|=1<<Fs.FlipY._hx_index);break;case 2:s=this.entry.getBytes();var h=new B(new ss(s)).read();n=t==$e.RGBA?new Ps(this.inf.width,this.inf.height,C.extractFullRGBA(h,0),$e.RGBA):new Ps(this.inf.width,this.inf.height,C.extractFullBGRA(h,0),$e.BGRA);break;case 3:s=this.entry.getBytes();var o=new H(new ss(s)).read();if(o.header.imageType!=j.UncompressedTrueColor||32!=o.header.bitsPerPixel)throw kn.thrown("Not supported TGA "+x.string(o.header.imageType)+"/"+o.header.bitsPerPixel);var l=o.header.width,u=o.header.height;n=Ps.alloc(l,u,$e.ARGB);for(var _=Ts.fromPixels(n),c=0,d=0,f=u;d<f;)for(var p=d++,g=0,m=l;g<m;){var v=g++,y=o.imageData[v+p*l];_.bytes.setInt32((v+p*_.width<<2)+_.offset,y>>>24|y>>8&65280|y<<8&16711680|y<<24)}switch(o.header.imageOrigin._hx_index){case 0:n.flags|=1<<Fs.FlipY._hx_index;break;case 2:break;default:throw kn.thrown("Not supported "+x.string(o.header.imageOrigin))}break;case 4:var b=128,w=0;if(0!=(this.inf.flags&1<<Aa.Dxt10Header._hx_index)&&(b+=20),i>0){Ps.calcStride(1,this.inf.pixelFormat);var M=i/this.inf.mipLevels|0;w=i%this.inf.mipLevels;var S=0;for(d=0,f=this.inf.mipLevels;d<f;){var I=d++;if(0==(l=this.inf.width>>I)&&(l=1),0==(u=this.inf.height>>I)&&(u=1),S+=k=Ps.calcDataSize(l,u,this.inf.pixelFormat),I<w)b+=k;else if(0==M)break}b+=S*M}if(0==(l=this.inf.width>>w)&&(l=1),0==(u=this.inf.height>>w)&&(u=1),1==this.inf.mipLevels&&0==(this.inf.flags&1<<Aa.IsCube._hx_index))s=this.entry.getBytes();else{var k=Ps.calcDataSize(l,u,this.inf.pixelFormat);this.entry.open(),this.entry.skip(b),s=new Qn(new ArrayBuffer(k)),this.entry.read(s,0,k),this.entry.close(),b=0}n=new Ps(l,u,s,this.inf.pixelFormat,b);break;case 5:s=this.entry.getBytes();n=new Ps(this.inf.width,this.inf.height,s,this.inf.pixelFormat);break;case 6:var E=dr.decode(this.entry.getBytes(),!1);n=new Ps(E.width,E.height,E.bytes,this.inf.pixelFormat)}return null!=t&&n.convert(t),null!=e&&n.setFlip(e),n},toBitmap:function(){this.getInfo();var t=new ys(this.inf.width,this.inf.height),e=this.getPixels();return t.setPixels(e),e.dispose(),t},watchCallb:function(){var t=this.inf.width,e=this.inf.height;this.inf=null;var i=this.getInfo();t==i.width&&e==i.height||this.tex.resize(i.width,i.height),this.tex.realloc=null,this.loadTexture()},loadTexture:function(){var t=this;if(0==this.getInfo().dataFormat||oa.DEFAULT_ASYNC)this.tex.flags|=1<<Ye.Loading._hx_index,this.entry.loadBitmap((function(e){var i=Or.toBitmap(e);if(t.tex.alloc(),t.tex.uploadBitmap(i),i.ctx=null,i.pixel=null,t.tex.realloc=XA(t,t.loadTexture),t.tex.flags&=-1-(1<<Ye.Loading._hx_index),null!=t.tex.waitLoads){var n=t.tex.waitLoads;t.tex.waitLoads=null;for(var s=0;s<n.length;){var r=n[s];++s,r()}}oa.ENABLE_AUTO_WATCH&&t.watch(XA(t,t.watchCallb))}));else{var e=function(){t.tex.alloc();for(var e=0,i=t.tex.get_layerCount();e<i;)for(var n=e++,s=0,r=t.inf.mipLevels;s<r;){var a=s++,A=t.getPixels(t.tex.format,null,n*t.inf.mipLevels+a);t.tex.uploadPixels(A,a,n),A.dispose()}t.tex.realloc=XA(t,t.loadTexture),oa.ENABLE_AUTO_WATCH&&t.watch(XA(t,t.watchCallb))};this.entry.get_isAvailable()?e():this.entry.load(e)}},toTexture:function(){if(null!=this.tex)return this.tex;this.getInfo();var t=[Ye.NoAlloc],e=this.inf.pixelFormat;if(e!=$e.BGRA&&e!=$e.ARGB&&e!=$e.RGBA||(e=ti.nativeFormat),0!=(this.inf.flags&1<<Aa.IsCube._hx_index)&&t.push(Ye.Cube),this.inf.mipLevels>1&&(t.push(Ye.MipMapped),t.push(Ye.ManualMipMapGen)),e==$e.R16U)throw kn.thrown("Unsupported texture format "+x.string(e)+" for "+this.entry.get_path());return this.tex=new ti(this.inf.width,this.inf.height,t,e),oa.DEFAULT_FILTER!=Oe.Linear&&this.tex.set_filter(oa.DEFAULT_FILTER),this.tex.setName(this.entry.get_path()),oa.setupTextureFlags(this.tex),this.loadTexture(),this.tex},toTile:function(){return this.getInfo(),ct.fromTexture(this.toTexture()).sub(0,0,this.inf.width,this.inf.height)},__class__:oa});var la=function(t){this.fs=t,this.cache=new Kn};i["hxd.res.Loader"]=la,la.__name__="hxd.res.Loader",la.prototype={cleanCache:function(){this.cache=new Kn},dir:function(t){for(var e=[],i=this.fs.dir(t),n=0;n<i.length;){var s=i[n];++n,e.push(new ra(this,s))}return e},exists:function(t){return this.fs.exists(t)},load:function(t){return new ra(this,this.fs.get(t))},loadCache:function(t,e){var i=this.cache.h[t];if(null==i){var n=this.fs.get(t),s=la.currentInstance;la.currentInstance=this,i=m.createInstance(e,[n]),la.currentInstance=s,this.cache.h[t]=i}else if(null==(yA.__downcastCheck(i,e)?i:null))throw kn.thrown(t+" has been reintrepreted from "+x.string(yA.getClass(i))+" to "+x.string(e));return i},dispose:function(){this.cleanCache(),this.fs.dispose()},__class__:la};var ua=function(t){sa.call(this,t)};i["hxd.res.Model"]=ua,ua.__name__="hxd.res.Model",ua.__super__=sa,ua.prototype=r(sa.prototype,{toHmd:function(){var t=new Ur(this.entry),e=new Dr(t).readHeader();return t.close(),new Tr(this,e)},__class__:ua});var _a=s["hxd.res.Filter"]={__ename__:!0,__constructs__:null,Fast:{_hx_name:"Fast",_hx_index:0,__enum__:"hxd.res.Filter",toString:n},Chromatic:{_hx_name:"Chromatic",_hx_index:1,__enum__:"hxd.res.Filter",toString:n}};_a.__constructs__=[_a.Fast,_a.Chromatic],_a.__empty_constructs__=[_a.Fast,_a.Chromatic];var ca=function(){};i["hxd.res._NanoJpeg.Component"]=ca,ca.__name__="hxd.res._NanoJpeg.Component",ca.prototype={__class__:ca};var da=function(){this.comps=[new ca,new ca,new ca].slice(0);var t=new Array(64),e=new Array(64),i=new Array(64),n=new Array(64);this.qtab=[t,e,i,n].slice(0);t=new Array(16);this.counts=t;t=new Array(64);this.block=t,this.njZZ=[0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63].slice(0),this.vlctab=[null,null,null,null,null,null,null,null].slice(0)};i["hxd.res.NanoJpeg"]=da,da.__name__="hxd.res.NanoJpeg",da.CF=function(t){var e=t+64>>7;return e<0?0:e>255?255:e},da.njClip=function(t){return t<0?0:t>255?255:t},da.decode=function(t,e,i,n){return null==n&&(n=-1),null==i&&(i=0),null==da.inst&&(da.inst=new da),da.inst.njInit(t,i,n,e),da.inst.njDecode()},da.prototype={alloc:function(t){return new Qn(new ArrayBuffer(t))},free:function(t){},njInit:function(t,e,i,n){this.bytes=t,this.pos=e,this.filter=null==n?_a.Chromatic:n,i<0&&(i=t.length-e),null==this.vlctab[0]&&(this.vlctab[0]=new Qn(new ArrayBuffer(131072))),null==this.vlctab[1]&&(this.vlctab[1]=new Qn(new ArrayBuffer(131072))),null==this.vlctab[2]&&(this.vlctab[2]=new Qn(new ArrayBuffer(131072))),null==this.vlctab[3]&&(this.vlctab[3]=new Qn(new ArrayBuffer(131072))),this.size=i,this.qtused=0,this.qtavail=0,this.rstinterval=0,this.length=0,this.buf=0,this.bufbits=0,this.progressive=!1,this.comps[0].dcpred=0,this.comps[1].dcpred=0,this.comps[2].dcpred=0},cleanup:function(){this.bytes=null;for(var t=0,e=this.comps;t<e.length;){var i=e[t];++t,null!=i.pixels&&(i.pixels=null)}null!=this.vlctab[0]&&(this.vlctab[0]=null),null!=this.vlctab[1]&&(this.vlctab[1]=null),null!=this.vlctab[2]&&(this.vlctab[2]=null),null!=this.vlctab[3]&&(this.vlctab[3]=null),null!=this.vlctab[4]&&(this.vlctab[4]=null),null!=this.vlctab[5]&&(this.vlctab[5]=null),null!=this.vlctab[6]&&(this.vlctab[6]=null),null!=this.vlctab[7]&&(this.vlctab[7]=null)},njSkip:function(t){if(this.pos+=t,this.size-=t,this.length-=t,this.size<0)throw kn.thrown("Invalid JPEG file")},syntax:function(t){if(t)throw kn.thrown("Invalid JPEG file")},get:function(t){return this.bytes.b[this.pos+t]},njDecode16:function(t){return this.bytes.b[this.pos+t]<<8|this.bytes.b[this.pos+(t+1)]},njByteAlign:function(){this.bufbits&=248},njShowBits:function(t){if(0==t)return 0;for(;this.bufbits<t;)if(this.size<=0)this.buf=this.buf<<8|255,this.bufbits+=8;else{var e=this.bytes.b[this.pos];if(this.pos++,this.size--,this.bufbits+=8,this.buf=this.buf<<8|e,255==e){if(0==this.size)throw kn.thrown("Invalid JPEG file");var i=this.bytes.b[this.pos];switch(this.pos++,this.size--,i){case 217:this.size=0;break;case 0:case 255:break;default:if(208!=(248&i))throw kn.thrown("Invalid JPEG file");this.buf=this.buf<<8|i,this.bufbits+=8}}}return this.buf>>this.bufbits-t&(1<<t)-1},njSkipBits:function(t){this.bufbits<t&&this.njShowBits(t),this.bufbits-=t},njGetBits:function(t){var e=this.njShowBits(t);return this.bufbits-=t,e},njDecodeLength:function(){if(this.size<2)throw kn.thrown("Invalid JPEG file");if(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.length>this.size)throw kn.thrown("Invalid JPEG file");if(this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file")},njSkipMarker:function(){if(this.size<2)throw kn.thrown("Invalid JPEG file");if(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.length>this.size)throw kn.thrown("Invalid JPEG file");if(this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file");var t=this.length;if(this.pos+=t,this.size-=t,this.length-=t,this.size<0)throw kn.thrown("Invalid JPEG file")},njDecodeSOF:function(){if(this.size<2)throw kn.thrown("Invalid JPEG file");if(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.length>this.size)throw kn.thrown("Invalid JPEG file");if(this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file");if(this.length<9)throw kn.thrown("Invalid JPEG file");if(8!=this.bytes.b[this.pos]&&this.notSupported(),this.height=this.bytes.b[this.pos+1]<<8|this.bytes.b[this.pos+2],this.width=this.bytes.b[this.pos+3]<<8|this.bytes.b[this.pos+4],this.ncomp=this.bytes.b[this.pos+5],this.pos+=6,this.size-=6,this.length-=6,this.size<0)throw kn.thrown("Invalid JPEG file");switch(this.ncomp){case 1:case 3:break;default:this.notSupported()}if(this.length<3*this.ncomp)throw kn.thrown("Invalid JPEG file");for(var t=0,e=0,i=0,n=this.ncomp;i<n;){var s=i++;if((r=this.comps[s]).cid=this.bytes.b[this.pos],r.ssx=this.bytes.b[this.pos+1]>>4,0==r.ssx)throw kn.thrown("Invalid JPEG file");if(0!=(r.ssx&r.ssx-1)&&this.notSupported(),r.ssy=15&this.bytes.b[this.pos+1],0==r.ssy)throw kn.thrown("Invalid JPEG file");if(0!=(r.ssy&r.ssy-1)&&this.notSupported(),r.qtsel=this.bytes.b[this.pos+2],0!=(252&r.qtsel))throw kn.thrown("Invalid JPEG file");if(this.pos+=3,this.size-=3,this.length-=3,this.size<0)throw kn.thrown("Invalid JPEG file");this.qtused|=1<<r.qtsel,r.ssx>t&&(t=r.ssx),r.ssy>e&&(e=r.ssy)}1==this.ncomp&&(t=e=1,(r=this.comps[0]).ssx=r.ssy=t);this.mbsizex=t<<3,this.mbsizey=e<<3,this.mbwidth=(this.width+this.mbsizex-1)/this.mbsizex|0,this.mbheight=(this.height+this.mbsizey-1)/this.mbsizey|0;for(i=0,n=this.ncomp;i<n;){var r;s=i++;(r=this.comps[s]).width=(this.width*r.ssx+t-1)/t|0,r.stride=r.width+7&2147483640,r.height=(this.height*r.ssy+e-1)/e|0,r.stride=this.mbwidth*this.mbsizex*r.ssx/t|0,(r.width<3&&r.ssx!=t||r.height<3&&r.ssy!=e)&&this.notSupported(),r.pixels=new Qn(new ArrayBuffer(r.stride*(this.mbheight*this.mbsizey*r.ssy/e|0)))}var a=this.length;if(this.pos+=a,this.size-=a,this.length-=a,this.size<0)throw kn.thrown("Invalid JPEG file")},njDecodeDQT:function(){if(this.size<2)throw kn.thrown("Invalid JPEG file");if(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.length>this.size)throw kn.thrown("Invalid JPEG file");if(this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file");for(;this.length>=65;){var t=this.bytes.b[this.pos];if(0!=(252&t))throw kn.thrown("Invalid JPEG file");this.qtavail|=1<<t;for(var e=this.qtab[t],i=0;i<64;){var n=i++;e[n]=this.bytes.b[this.pos+(n+1)]}if(this.pos+=65,this.size-=65,this.length-=65,this.size<0)throw kn.thrown("Invalid JPEG file")}if(0!=this.length)throw kn.thrown("Invalid JPEG file")},njDecodeDHT:function(){if(this.size<2)throw kn.thrown("Invalid JPEG file");if(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.length>this.size)throw kn.thrown("Invalid JPEG file");if(this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file");for(;this.length>=17;){var t=this.bytes.b[this.pos];if(0!=(236&t))throw kn.thrown("Invalid JPEG file");if(t=t>>4&1|(3&t)<<1,this.counts[0]=this.bytes.b[this.pos+1],this.counts[1]=this.bytes.b[this.pos+2],this.counts[2]=this.bytes.b[this.pos+3],this.counts[3]=this.bytes.b[this.pos+4],this.counts[4]=this.bytes.b[this.pos+5],this.counts[5]=this.bytes.b[this.pos+6],this.counts[6]=this.bytes.b[this.pos+7],this.counts[7]=this.bytes.b[this.pos+8],this.counts[8]=this.bytes.b[this.pos+9],this.counts[9]=this.bytes.b[this.pos+10],this.counts[10]=this.bytes.b[this.pos+11],this.counts[11]=this.bytes.b[this.pos+12],this.counts[12]=this.bytes.b[this.pos+13],this.counts[13]=this.bytes.b[this.pos+14],this.counts[14]=this.bytes.b[this.pos+15],this.counts[15]=this.bytes.b[this.pos+16],this.pos+=17,this.size-=17,this.length-=17,this.size<0)throw kn.thrown("Invalid JPEG file");for(var e=this.vlctab[t],i=0,n=65536,s=65536,r=1;r<17;){var a=r++;s>>=1;var A=this.counts[a-1];if(0!=A){if(this.length<A)throw kn.thrown("Invalid JPEG file");if((n-=A<<16-a)<0)throw kn.thrown("Invalid JPEG file");for(var h=0,o=A;h<o;)for(var l=h++,u=this.bytes.b[this.pos+l],_=0,c=s;_<c;){_++;e.b[i++]=a,e.b[i++]=u}if(this.pos+=A,this.size-=A,this.length-=A,this.size<0)throw kn.thrown("Invalid JPEG file")}}for(;0!=n--;)e.b[i]=0,i+=2}if(0!=this.length)throw kn.thrown("Invalid JPEG file")},njDecodeDRI:function(){if(this.size<2)throw kn.thrown("Invalid JPEG file");if(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.length>this.size)throw kn.thrown("Invalid JPEG file");if(this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file");if(this.length<2)throw kn.thrown("Invalid JPEG file");this.rstinterval=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];var t=this.length;if(this.pos+=t,this.size-=t,this.length-=t,this.size<0)throw kn.thrown("Invalid JPEG file")},njGetVLC:function(t){var e=this.njShowBits(16),i=t.b[e<<1];if(0==i)throw kn.thrown("Invalid JPEG file");if(this.bufbits<i&&this.njShowBits(i),this.bufbits-=i,e=t.b[e<<1|1],this.vlcCode=e,0==(i=15&e))return 0;var n=this.njShowBits(i);return this.bufbits-=i,(e=n)<1<<i-1&&(e+=1+(-1<<i)),e},njRowIDCT:function(t){var e=this.block[t+4]<<11,i=this.block[t+6],n=this.block[t+2],s=this.block[t+1],r=this.block[t+7],a=this.block[t+5],A=this.block[t+3];if(0!=(e|i|n|s|r|a|A)){var h=128+(this.block[t]<<11),o=565*(s+r);s=o+2276*s,r=o-3406*r,a=(o=2408*(a+A))-799*a,A=o-4017*A,o=h+e,h-=e,i=(e=1108*(n+i))-3784*i,n=e+1568*n,e=s+a,s-=a,a=r+A,r-=A,A=o+n,o-=n,n=h+i,h-=i,i=181*(s+r)+128>>8,s=181*(s-r)+128>>8,this.block[t]=A+e>>8,this.block[t+1]=n+i>>8,this.block[t+2]=h+s>>8,this.block[t+3]=o+a>>8,this.block[t+4]=o-a>>8,this.block[t+5]=h-s>>8,this.block[t+6]=n-i>>8,this.block[t+7]=A-e>>8}else{var l=this.block[t+7]=this.block[t]<<3,u=this.block[t+6]=l;l=this.block[t+5]=u,u=this.block[t+4]=l,l=this.block[t+3]=u,u=this.block[t+2]=l,l=this.block[t+1]=u;this.block[t]=l}},njColIDCT:function(t,e,i,n){var s=this.block[t+32]<<8,r=this.block[t+48],a=this.block[t+16],A=this.block[t+8],h=this.block[t+56],o=this.block[t+40],l=this.block[t+24];if(0==(s|r|a|A|h|o|l))return s=(c=128+(this.block[t]+32>>6))<0?0:c>255?255:c,e.b[i]=s,i+=n,e.b[i]=s,i+=n,e.b[i]=s,i+=n,e.b[i]=s,i+=n,e.b[i]=s,i+=n,e.b[i]=s,i+=n,e.b[i]=s,i+=n,e.b[i]=s,void(i+=n);var u=8192+(this.block[t]<<8),_=565*(A+h)+4;A=_+2276*A>>3,h=_-3406*h>>3,o=(_=2408*(o+l)+4)-799*o>>3,l=_-4017*l>>3,_=u+s,u-=s,r=(s=1108*(a+r)+4)-3784*r>>3,a=s+1568*a>>3,s=A+o,A-=o,o=h+l,h-=l,l=_+a,_-=a,a=u+r,u-=r,r=181*(A+h)+128>>8,A=181*(A-h)+128>>8;var c=128+(l+s>>14);e.b[i]=c<0?0:c>255?255:c,i+=n;c=128+(a+r>>14);e.b[i]=c<0?0:c>255?255:c,i+=n;c=128+(u+A>>14);e.b[i]=c<0?0:c>255?255:c,i+=n;c=128+(_+o>>14);e.b[i]=c<0?0:c>255?255:c,i+=n;c=128+(_-o>>14);e.b[i]=c<0?0:c>255?255:c,i+=n;c=128+(u-A>>14);e.b[i]=c<0?0:c>255?255:c,i+=n;c=128+(a-r>>14);e.b[i]=c<0?0:c>255?255:c,i+=n;c=128+(l-s>>14);e.b[i]=c<0?0:c>255?255:c},njDecodeBlock:function(t,e){for(var i,n=t.pixels,s=0,r=0;r<64;){var a=r++;this.block[a]=0}var A,h=t,o=h.dcpred,l=this.vlctab[t.dctabsel],u=this.njShowBits(16);if(0==(f=l.b[u<<1]))throw kn.thrown("Invalid JPEG file");if(this.bufbits<f&&this.njShowBits(f),this.bufbits-=f,u=l.b[u<<1|1],this.vlcCode=u,0==(f=15&u))A=0;else{var _=this.njShowBits(f);this.bufbits-=f,(u=_)<1<<f-1&&(u+=1+(-1<<f)),A=u}h.dcpred=o+A;var c=this.qtab[t.qtsel],d=this.vlctab[t.actabsel];for(this.block[0]=t.dcpred*c[0];;){var f;u=this.njShowBits(16);if(0==(f=d.b[u<<1]))throw kn.thrown("Invalid JPEG file");if(this.bufbits<f&&this.njShowBits(f),this.bufbits-=f,u=d.b[u<<1|1],this.vlcCode=u,0==(f=15&u))i=0;else{_=this.njShowBits(f);this.bufbits-=f,(u=_)<1<<f-1&&(u+=1+(-1<<f)),i=u}if(0==this.vlcCode)break;if(0==(15&this.vlcCode)&&240!=this.vlcCode)throw kn.thrown("Invalid JPEG file");if((s+=1+(this.vlcCode>>4))>63)throw kn.thrown("Invalid JPEG file");if(this.block[this.njZZ[s]]=i*c[s],!(s<63))break}var x=0;if(0==((M=this.block[x+4]<<11)|(B=this.block[x+6])|(C=this.block[x+2])|(S=this.block[x+1])|(I=this.block[x+7])|(k=this.block[x+5])|(E=this.block[x+3]))){var p=this.block[x+7]=this.block[x]<<3,g=this.block[x+6]=p;p=this.block[x+5]=g,g=this.block[x+4]=p,p=this.block[x+3]=g,g=this.block[x+2]=p,p=this.block[x+1]=g;this.block[x]=p}else S=(w=565*(S+I))+2276*S,I=w-3406*I,k=(w=2408*(k+E))-799*k,E=w-4017*E,w=(b=128+(this.block[x]<<11))+M,b-=M,B=(M=1108*(C+B))-3784*B,C=M+1568*C,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8,this.block[x]=E+M>>8,this.block[x+1]=C+B>>8,this.block[x+2]=b+S>>8,this.block[x+3]=w+k>>8,this.block[x+4]=w-k>>8,this.block[x+5]=b-S>>8,this.block[x+6]=C-B>>8,this.block[x+7]=E-M>>8;x=8;if(0==((M=this.block[x+4]<<11)|(B=this.block[x+6])|(C=this.block[x+2])|(S=this.block[x+1])|(I=this.block[x+7])|(k=this.block[x+5])|(E=this.block[x+3]))){p=this.block[x+7]=this.block[x]<<3,g=this.block[x+6]=p,p=this.block[x+5]=g,g=this.block[x+4]=p,p=this.block[x+3]=g,g=this.block[x+2]=p,p=this.block[x+1]=g;this.block[x]=p}else S=(w=565*(S+I))+2276*S,I=w-3406*I,k=(w=2408*(k+E))-799*k,E=w-4017*E,w=(b=128+(this.block[x]<<11))+M,b-=M,B=(M=1108*(C+B))-3784*B,C=M+1568*C,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8,this.block[x]=E+M>>8,this.block[x+1]=C+B>>8,this.block[x+2]=b+S>>8,this.block[x+3]=w+k>>8,this.block[x+4]=w-k>>8,this.block[x+5]=b-S>>8,this.block[x+6]=C-B>>8,this.block[x+7]=E-M>>8;x=16;if(0==((M=this.block[x+4]<<11)|(B=this.block[x+6])|(C=this.block[x+2])|(S=this.block[x+1])|(I=this.block[x+7])|(k=this.block[x+5])|(E=this.block[x+3]))){p=this.block[x+7]=this.block[x]<<3,g=this.block[x+6]=p,p=this.block[x+5]=g,g=this.block[x+4]=p,p=this.block[x+3]=g,g=this.block[x+2]=p,p=this.block[x+1]=g;this.block[x]=p}else S=(w=565*(S+I))+2276*S,I=w-3406*I,k=(w=2408*(k+E))-799*k,E=w-4017*E,w=(b=128+(this.block[x]<<11))+M,b-=M,B=(M=1108*(C+B))-3784*B,C=M+1568*C,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8,this.block[x]=E+M>>8,this.block[x+1]=C+B>>8,this.block[x+2]=b+S>>8,this.block[x+3]=w+k>>8,this.block[x+4]=w-k>>8,this.block[x+5]=b-S>>8,this.block[x+6]=C-B>>8,this.block[x+7]=E-M>>8;x=24;if(0==((M=this.block[x+4]<<11)|(B=this.block[x+6])|(C=this.block[x+2])|(S=this.block[x+1])|(I=this.block[x+7])|(k=this.block[x+5])|(E=this.block[x+3]))){p=this.block[x+7]=this.block[x]<<3,g=this.block[x+6]=p,p=this.block[x+5]=g,g=this.block[x+4]=p,p=this.block[x+3]=g,g=this.block[x+2]=p,p=this.block[x+1]=g;this.block[x]=p}else S=(w=565*(S+I))+2276*S,I=w-3406*I,k=(w=2408*(k+E))-799*k,E=w-4017*E,w=(b=128+(this.block[x]<<11))+M,b-=M,B=(M=1108*(C+B))-3784*B,C=M+1568*C,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8,this.block[x]=E+M>>8,this.block[x+1]=C+B>>8,this.block[x+2]=b+S>>8,this.block[x+3]=w+k>>8,this.block[x+4]=w-k>>8,this.block[x+5]=b-S>>8,this.block[x+6]=C-B>>8,this.block[x+7]=E-M>>8;x=32;if(0==((M=this.block[x+4]<<11)|(B=this.block[x+6])|(C=this.block[x+2])|(S=this.block[x+1])|(I=this.block[x+7])|(k=this.block[x+5])|(E=this.block[x+3]))){p=this.block[x+7]=this.block[x]<<3,g=this.block[x+6]=p,p=this.block[x+5]=g,g=this.block[x+4]=p,p=this.block[x+3]=g,g=this.block[x+2]=p,p=this.block[x+1]=g;this.block[x]=p}else S=(w=565*(S+I))+2276*S,I=w-3406*I,k=(w=2408*(k+E))-799*k,E=w-4017*E,w=(b=128+(this.block[x]<<11))+M,b-=M,B=(M=1108*(C+B))-3784*B,C=M+1568*C,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8,this.block[x]=E+M>>8,this.block[x+1]=C+B>>8,this.block[x+2]=b+S>>8,this.block[x+3]=w+k>>8,this.block[x+4]=w-k>>8,this.block[x+5]=b-S>>8,this.block[x+6]=C-B>>8,this.block[x+7]=E-M>>8;x=40;if(0==((M=this.block[x+4]<<11)|(B=this.block[x+6])|(C=this.block[x+2])|(S=this.block[x+1])|(I=this.block[x+7])|(k=this.block[x+5])|(E=this.block[x+3]))){p=this.block[x+7]=this.block[x]<<3,g=this.block[x+6]=p,p=this.block[x+5]=g,g=this.block[x+4]=p,p=this.block[x+3]=g,g=this.block[x+2]=p,p=this.block[x+1]=g;this.block[x]=p}else S=(w=565*(S+I))+2276*S,I=w-3406*I,k=(w=2408*(k+E))-799*k,E=w-4017*E,w=(b=128+(this.block[x]<<11))+M,b-=M,B=(M=1108*(C+B))-3784*B,C=M+1568*C,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8,this.block[x]=E+M>>8,this.block[x+1]=C+B>>8,this.block[x+2]=b+S>>8,this.block[x+3]=w+k>>8,this.block[x+4]=w-k>>8,this.block[x+5]=b-S>>8,this.block[x+6]=C-B>>8,this.block[x+7]=E-M>>8;x=48;if(0==((M=this.block[x+4]<<11)|(B=this.block[x+6])|(C=this.block[x+2])|(S=this.block[x+1])|(I=this.block[x+7])|(k=this.block[x+5])|(E=this.block[x+3]))){p=this.block[x+7]=this.block[x]<<3,g=this.block[x+6]=p,p=this.block[x+5]=g,g=this.block[x+4]=p,p=this.block[x+3]=g,g=this.block[x+2]=p,p=this.block[x+1]=g;this.block[x]=p}else S=(w=565*(S+I))+2276*S,I=w-3406*I,k=(w=2408*(k+E))-799*k,E=w-4017*E,w=(b=128+(this.block[x]<<11))+M,b-=M,B=(M=1108*(C+B))-3784*B,C=M+1568*C,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8,this.block[x]=E+M>>8,this.block[x+1]=C+B>>8,this.block[x+2]=b+S>>8,this.block[x+3]=w+k>>8,this.block[x+4]=w-k>>8,this.block[x+5]=b-S>>8,this.block[x+6]=C-B>>8,this.block[x+7]=E-M>>8;x=56;if(0==((M=this.block[x+4]<<11)|(B=this.block[x+6])|(C=this.block[x+2])|(S=this.block[x+1])|(I=this.block[x+7])|(k=this.block[x+5])|(E=this.block[x+3]))){p=this.block[x+7]=this.block[x]<<3,g=this.block[x+6]=p,p=this.block[x+5]=g,g=this.block[x+4]=p,p=this.block[x+3]=g,g=this.block[x+2]=p,p=this.block[x+1]=g;this.block[x]=p}else S=(w=565*(S+I))+2276*S,I=w-3406*I,k=(w=2408*(k+E))-799*k,E=w-4017*E,w=(b=128+(this.block[x]<<11))+M,b-=M,B=(M=1108*(C+B))-3784*B,C=M+1568*C,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8,this.block[x]=E+M>>8,this.block[x+1]=C+B>>8,this.block[x+2]=b+S>>8,this.block[x+3]=w+k>>8,this.block[x+4]=w-k>>8,this.block[x+5]=b-S>>8,this.block[x+6]=C-B>>8,this.block[x+7]=E-M>>8;var m=e,v=t.stride;if(0==((M=this.block[32]<<8)|(B=this.block[48])|(C=this.block[16])|(S=this.block[8])|(I=this.block[56])|(k=this.block[40])|(E=this.block[24]))){M=(y=128+(this.block[0]+32>>6))<0?0:y>255?255:y,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v}else{S=(w=565*(S+I)+4)+2276*S>>3,I=w-3406*I>>3,k=(w=2408*(k+E)+4)-799*k>>3,E=w-4017*E>>3,w=(b=8192+(this.block[0]<<8))+M,b-=M,B=(M=1108*(C+B)+4)-3784*B>>3,C=M+1568*C>>3,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8;var y=128+(E+M>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C+B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b+S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w+k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w-k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b-S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C-B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(E-M>>14);n.b[m]=y<0?0:y>255?255:y}m=1+e,v=t.stride;if(0==((M=this.block[33]<<8)|(B=this.block[49])|(C=this.block[17])|(S=this.block[9])|(I=this.block[57])|(k=this.block[41])|(E=this.block[25]))){M=(y=128+(this.block[1]+32>>6))<0?0:y>255?255:y,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v}else{S=(w=565*(S+I)+4)+2276*S>>3,I=w-3406*I>>3,k=(w=2408*(k+E)+4)-799*k>>3,E=w-4017*E>>3,w=(b=8192+(this.block[1]<<8))+M,b-=M,B=(M=1108*(C+B)+4)-3784*B>>3,C=M+1568*C>>3,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8;y=128+(E+M>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C+B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b+S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w+k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w-k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b-S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C-B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(E-M>>14);n.b[m]=y<0?0:y>255?255:y}m=2+e,v=t.stride;if(0==((M=this.block[34]<<8)|(B=this.block[50])|(C=this.block[18])|(S=this.block[10])|(I=this.block[58])|(k=this.block[42])|(E=this.block[26]))){M=(y=128+(this.block[2]+32>>6))<0?0:y>255?255:y,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v}else{S=(w=565*(S+I)+4)+2276*S>>3,I=w-3406*I>>3,k=(w=2408*(k+E)+4)-799*k>>3,E=w-4017*E>>3,w=(b=8192+(this.block[2]<<8))+M,b-=M,B=(M=1108*(C+B)+4)-3784*B>>3,C=M+1568*C>>3,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8;y=128+(E+M>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C+B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b+S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w+k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w-k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b-S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C-B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(E-M>>14);n.b[m]=y<0?0:y>255?255:y}m=3+e,v=t.stride;if(0==((M=this.block[35]<<8)|(B=this.block[51])|(C=this.block[19])|(S=this.block[11])|(I=this.block[59])|(k=this.block[43])|(E=this.block[27]))){M=(y=128+(this.block[3]+32>>6))<0?0:y>255?255:y,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v}else{S=(w=565*(S+I)+4)+2276*S>>3,I=w-3406*I>>3,k=(w=2408*(k+E)+4)-799*k>>3,E=w-4017*E>>3,w=(b=8192+(this.block[3]<<8))+M,b-=M,B=(M=1108*(C+B)+4)-3784*B>>3,C=M+1568*C>>3,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8;y=128+(E+M>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C+B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b+S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w+k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w-k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b-S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C-B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(E-M>>14);n.b[m]=y<0?0:y>255?255:y}m=4+e,v=t.stride;if(0==((M=this.block[36]<<8)|(B=this.block[52])|(C=this.block[20])|(S=this.block[12])|(I=this.block[60])|(k=this.block[44])|(E=this.block[28]))){M=(y=128+(this.block[4]+32>>6))<0?0:y>255?255:y,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v}else{S=(w=565*(S+I)+4)+2276*S>>3,I=w-3406*I>>3,k=(w=2408*(k+E)+4)-799*k>>3,E=w-4017*E>>3,w=(b=8192+(this.block[4]<<8))+M,b-=M,B=(M=1108*(C+B)+4)-3784*B>>3,C=M+1568*C>>3,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8;y=128+(E+M>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C+B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b+S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w+k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w-k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b-S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C-B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(E-M>>14);n.b[m]=y<0?0:y>255?255:y}m=5+e,v=t.stride;if(0==((M=this.block[37]<<8)|(B=this.block[53])|(C=this.block[21])|(S=this.block[13])|(I=this.block[61])|(k=this.block[45])|(E=this.block[29]))){M=(y=128+(this.block[5]+32>>6))<0?0:y>255?255:y,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v}else{S=(w=565*(S+I)+4)+2276*S>>3,I=w-3406*I>>3,k=(w=2408*(k+E)+4)-799*k>>3,E=w-4017*E>>3,w=(b=8192+(this.block[5]<<8))+M,b-=M,B=(M=1108*(C+B)+4)-3784*B>>3,C=M+1568*C>>3,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8;y=128+(E+M>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C+B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b+S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w+k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w-k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b-S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C-B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(E-M>>14);n.b[m]=y<0?0:y>255?255:y}m=6+e,v=t.stride;if(0==((M=this.block[38]<<8)|(B=this.block[54])|(C=this.block[22])|(S=this.block[14])|(I=this.block[62])|(k=this.block[46])|(E=this.block[30]))){M=(y=128+(this.block[6]+32>>6))<0?0:y>255?255:y,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v}else{S=(w=565*(S+I)+4)+2276*S>>3,I=w-3406*I>>3,k=(w=2408*(k+E)+4)-799*k>>3,E=w-4017*E>>3,w=(b=8192+(this.block[6]<<8))+M,b-=M,B=(M=1108*(C+B)+4)-3784*B>>3,C=M+1568*C>>3,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8;y=128+(E+M>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C+B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b+S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w+k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w-k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b-S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C-B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(E-M>>14);n.b[m]=y<0?0:y>255?255:y}var b,w,M,B,C,S,I,k,E;m=7+e,v=t.stride;if(0==((M=this.block[39]<<8)|(B=this.block[55])|(C=this.block[23])|(S=this.block[15])|(I=this.block[63])|(k=this.block[47])|(E=this.block[31]))){M=(y=128+(this.block[7]+32>>6))<0?0:y>255?255:y,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v,n.b[m]=M,m+=v}else{S=(w=565*(S+I)+4)+2276*S>>3,I=w-3406*I>>3,k=(w=2408*(k+E)+4)-799*k>>3,E=w-4017*E>>3,w=(b=8192+(this.block[7]<<8))+M,b-=M,B=(M=1108*(C+B)+4)-3784*B>>3,C=M+1568*C>>3,M=S+k,S-=k,k=I+E,I-=E,E=w+C,w-=C,C=b+B,b-=B,B=181*(S+I)+128>>8,S=181*(S-I)+128>>8;y=128+(E+M>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C+B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b+S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w+k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(w-k>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(b-S>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(C-B>>14);n.b[m]=y<0?0:y>255?255:y,m+=v;y=128+(E-M>>14);n.b[m]=y<0?0:y>255?255:y}},notSupported:function(){throw kn.thrown("This JPG file is not supported")},njDecodeScan:function(){if(this.size<2)throw kn.thrown("Invalid JPEG file");if(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.length>this.size)throw kn.thrown("Invalid JPEG file");if(this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file");if(this.length<4+2*this.ncomp)throw kn.thrown("Invalid JPEG file");if(this.bytes.b[this.pos]!=this.ncomp&&this.notSupported(),this.pos+=1,this.size-=1,this.length-=1,this.size<0)throw kn.thrown("Invalid JPEG file");for(var t=0,e=this.ncomp;t<e;){var i=t++,n=this.comps[i];if(this.bytes.b[this.pos]!=n.cid)throw kn.thrown("Invalid JPEG file");if(0!=(236&this.bytes.b[this.pos+1]))throw kn.thrown("Invalid JPEG file");if(n.dctabsel=this.bytes.b[this.pos+1]>>4<<1,n.actabsel=(3&this.bytes.b[this.pos+1])<<1|1,this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file")}var s=this.bytes.b[this.pos],r=this.bytes.b[this.pos+1],a=this.bytes.b[this.pos+2];(!this.progressive&&0!=s||r!=63-s||0!=a)&&this.notSupported();r=this.length;if(this.pos+=r,this.size-=r,this.length-=r,this.size<0)throw kn.thrown("Invalid JPEG file");for(var A=0,h=0,o=this.rstinterval,l=0;;){for(t=0,e=this.ncomp;t<e;){i=t++;for(var u=0,_=(n=this.comps[i]).ssy;u<_;)for(var c=u++,d=0,f=n.ssx;d<f;){var x=d++;this.njDecodeBlock(n,(h*n.ssy+c)*n.stride+A*n.ssx+x<<3)}}if(++A>=this.mbwidth&&(A=0,++h>=this.mbheight))break;if(0!=this.rstinterval&&0==--o){this.bufbits&=248;var p=this.njShowBits(16);this.bufbits-=16;if(65488!=(65528&p)||(7&p)!=l)throw kn.thrown("Invalid JPEG file");l=l+1&7,o=this.rstinterval,this.comps[0].dcpred=0,this.comps[1].dcpred=0,this.comps[2].dcpred=0}}},njUpsampleH:function(t){for(var e=t.width-3,i=new Qn(new ArrayBuffer(t.width*t.height<<1)),n=i,s=t.pixels,r=0,a=0,A=0,h=t.height;A<h;){A++;var o=139*s.b[r]+-11*s.b[r+1]+64>>7;n.b[a]=o<0?0:o>255?255:o;var l=104*s.b[r]+27*s.b[r+1]+-3*s.b[r+2]+64>>7;n.b[a+1]=l<0?0:l>255?255:l;var u=28*s.b[r]+109*s.b[r+1]+-9*s.b[r+2]+64>>7;n.b[a+2]=u<0?0:u>255?255:u;for(var _=0,c=e;_<c;){var d=_++,f=-9*s.b[r+d]+111*s.b[r+d+1]+29*s.b[r+d+2]+-3*s.b[r+d+3]+64>>7;n.b[a+(d<<1)+3]=f<0?0:f>255?255:f;var x=-3*s.b[r+d]+29*s.b[r+d+1]+111*s.b[r+d+2]+-9*s.b[r+d+3]+64>>7;n.b[a+(d<<1)+4]=x<0?0:x>255?255:x}r+=t.stride,a+=t.width<<1;var p=28*s.b[r-1]+109*s.b[r-2]+-9*s.b[r-3]+64>>7;n.b[a-3]=p<0?0:p>255?255:p;var g=104*s.b[r-1]+27*s.b[r-2]+-3*s.b[r-3]+64>>7;n.b[a-2]=g<0?0:g>255?255:g;var m=139*s.b[r-1]+-11*s.b[r-2]+64>>7;n.b[a-1]=m<0?0:m>255?255:m}t.width<<=1,t.stride=t.width,t.pixels=i},njUpsampleV:function(t){for(var e=t.width,i=t.stride,n=i+i,s=new Qn(new ArrayBuffer(t.width*t.height<<1)),r=0,a=0,A=s,h=t.pixels,o=0,l=e;o<l;){r=a=o++;var u=139*h.b[r]+-11*h.b[r+i]+64>>7;A.b[a]=u<0?0:u>255?255:u,a+=e;var _=104*h.b[r]+27*h.b[r+i]+-3*h.b[r+n]+64>>7;A.b[a]=_<0?0:_>255?255:_,a+=e;var c=28*h.b[r]+109*h.b[r+i]+-9*h.b[r+n]+64>>7;A.b[a]=c<0?0:c>255?255:c,a+=e,r+=i;for(var d=0,f=t.height-2;d<f;){d++;var x=-9*h.b[r-i]+111*h.b[r]+29*h.b[r+i]+-3*h.b[r+n]+64>>7;A.b[a]=x<0?0:x>255?255:x,a+=e;var p=-3*h.b[r-i]+29*h.b[r]+111*h.b[r+i]+-9*h.b[r+n]+64>>7;A.b[a]=p<0?0:p>255?255:p,a+=e,r+=i}r+=i;var g=28*h.b[r]+109*h.b[r-i]+-9*h.b[r-n]+64>>7;A.b[a]=g<0?0:g>255?255:g,a+=e;var m=104*h.b[r]+27*h.b[r-i]+-3*h.b[r-n]+64>>7;A.b[a]=m<0?0:m>255?255:m,a+=e;var v=139*h.b[r]+-11*h.b[r-i]+64>>7;A.b[a]=v<0?0:v>255?255:v}t.height<<=1,t.stride=t.width,t.pixels=s},njUpsample:function(t){for(var e=0,i=0;t.width<this.width;)t.width<<=1,++e;for(;t.height<this.height;)t.height<<=1,++i;for(var n=new Qn(new ArrayBuffer(t.width*t.height)),s=t.pixels,r=0,a=n,A=0,h=t.height;A<h;)for(var o=(A++>>i)*t.stride,l=0,u=t.width;l<u;){var _=l++;a.b[r++]=s.b[(_>>e)+o]}t.stride=t.width,t.pixels=n},njConvert:function(){for(var t=0,e=this.ncomp;t<e;){var i=t++,n=this.comps[i];switch(this.filter._hx_index){case 0:(n.width<this.width||n.height<this.height)&&this.njUpsample(n);break;case 1:for(;n.width<this.width||n.height<this.height;)n.width<this.width&&this.njUpsampleH(n),n.height<this.height&&this.njUpsampleV(n)}if(n.width<this.width||n.height<this.height)throw kn.thrown("assert")}var s=new Qn(new ArrayBuffer(this.width*this.height*4));if(3!=this.ncomp)throw kn.thrown("TODO");var r=this.comps[0].pixels,a=this.comps[1].pixels,A=this.comps[2].pixels,h=s,o=0,l=0,u=0,_=0;for(t=0,e=this.height;t<e;){t++;for(var c=0,d=this.width;c<d;){c++;var f=r.b[o++]<<8,x=a.b[l++]-128,p=A.b[u++]-128,g=f+359*p+128>>8,m=g<0?0:g>255?255:g,v=f-88*x-183*p+128>>8,y=v<0?0:v>255?255:v,b=f+454*x+128>>8,w=b<0?0:b>255?255:b;h.b[_++]=w,h.b[_++]=y,h.b[_++]=m,h.b[_++]=255}o+=this.comps[0].stride-this.width,l+=this.comps[1].stride-this.width,u+=this.comps[2].stride-this.width}return s},njDecode:function(){if(this.size<2||255!=this.bytes.b[this.pos]||216!=this.bytes.b[this.pos+1])throw kn.thrown("This file is not a JPEG");if(this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file");t:for(;;){if(this.size<2||255!=this.bytes.b[this.pos])throw kn.thrown("Invalid JPEG file");if(this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file");switch(this.bytes.b[this.pos+-1]){case 192:this.njDecodeSOF();break;case 194:if(this.progressive=!0,this.progressive)throw kn.thrown("Unsupported progressive JPG");null==this.vlctab[4]&&(this.vlctab[4]=new Qn(new ArrayBuffer(131072))),null==this.vlctab[5]&&(this.vlctab[5]=new Qn(new ArrayBuffer(131072))),null==this.vlctab[6]&&(this.vlctab[6]=new Qn(new ArrayBuffer(131072))),null==this.vlctab[7]&&(this.vlctab[7]=new Qn(new ArrayBuffer(131072))),this.njDecodeSOF();break;case 195:throw kn.thrown("Unsupported lossless JPG");case 196:this.njDecodeDHT();break;case 218:this.njDecodeScan();break t;case 219:this.njDecodeDQT();break;case 221:this.njDecodeDRI();break;case 254:if(this.size<2)throw kn.thrown("Invalid JPEG file");if(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.length>this.size)throw kn.thrown("Invalid JPEG file");if(this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file");var t=this.length;if(this.pos+=t,this.size-=t,this.length-=t,this.size<0)throw kn.thrown("Invalid JPEG file");break;default:switch(240&this.bytes.b[this.pos+-1]){case 192:throw kn.thrown("Unsupported jpeg type "+(15&this.bytes.b[this.pos+-1]));case 224:if(this.size<2)throw kn.thrown("Invalid JPEG file");if(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.length>this.size)throw kn.thrown("Invalid JPEG file");if(this.pos+=2,this.size-=2,this.length-=2,this.size<0)throw kn.thrown("Invalid JPEG file");var e=this.length;if(this.pos+=e,this.size-=e,this.length-=e,this.size<0)throw kn.thrown("Invalid JPEG file");break;default:throw kn.thrown("Unsupported jpeg tag 0x"+g.hex(this.bytes.b[this.pos+-1],2))}}}var i=this.njConvert();return this.cleanup(),{pixels:i,width:this.width,height:this.height}},__class__:da};var fa=s["hxd.res.SoundFormat"]={__ename__:!0,__constructs__:null,Wav:{_hx_name:"Wav",_hx_index:0,__enum__:"hxd.res.SoundFormat",toString:n},Mp3:{_hx_name:"Mp3",_hx_index:1,__enum__:"hxd.res.SoundFormat",toString:n},OggVorbis:{_hx_name:"OggVorbis",_hx_index:2,__enum__:"hxd.res.SoundFormat",toString:n}};fa.__constructs__=[fa.Wav,fa.Mp3,fa.OggVorbis],fa.__empty_constructs__=[fa.Wav,fa.Mp3,fa.OggVorbis];var xa=function(t){this.lastPlay=0,sa.call(this,t)};i["hxd.res.Sound"]=xa,xa.__name__="hxd.res.Sound",xa.supportedFormat=function(t){switch(t._hx_index){case 0:case 1:return!0;case 2:return!1}},xa.startWorker=function(){return!1},xa.__super__=sa,xa.prototype=r(sa.prototype,{getData:function(){if(null!=this.data)return this.data;var t=this.entry.getBytes();switch(t.b[0]){case 73:case 255:this.data=new Ea(t);break;case 79:throw kn.thrown("OGG format requires -lib stb_ogg_sound (for "+this.entry.get_path()+")");case 82:this.data=new Ta(t)}if(null==this.data)throw kn.thrown("Unsupported sound format "+this.entry.get_path());return xa.ENABLE_AUTO_WATCH&&this.watch(XA(this,this.watchCallb)),this.data},dispose:function(){this.stop(),this.data=null},stop:function(){null!=this.channel&&(this.channel.stop(),this.channel=null)},play:function(t,e,i,n){return null==e&&(e=1),null==t&&(t=!1),this.lastPlay=l.now()/1e3,this.channel=ka.get().play(this,i,n),this.channel.loop=t,this.channel.set_volume(e),this.channel},watchCallb:function(){var t=this.data;this.data=null;var e=this.getData();if(null!=t&&(t.channels!=e.channels||t.samples!=e.samples||t.sampleFormat!=e.sampleFormat||t.samplingRate!=e.samplingRate))for(var i=ka.get().getAll(this);i.hasNext();){var n=i.next();n.duration=e.get_duration(),n.set_position(n.position)}},__class__:xa});var pa=function(){this.volume=1,this.bindedEffects=[],this.effects=[],this.mute=!1,this.priority=0};i["hxd.snd.ChannelBase"]=pa,pa.__name__="hxd.snd.ChannelBase",pa.prototype={getEffect:function(t){if(null==this.effects)return null;for(var e=0,i=this.effects;e<i.length;){var n=i[e];++e;var s=yA.__downcastCheck(n,t)?n:null;if(null!=s)return s}return null},set_volume:function(t){return this.currentFade=null,this.volume=t},fadeTo:function(t,e,i){null==e&&(e=1),this.currentFade={start:l.now()/1e3,duration:e,startVolume:this.volume,targetVolume:t,onEnd:i}},updateCurrentVolume:function(t){if(null!=this.currentFade){var e=this.currentFade,i=t-e.start;i>=e.duration?(this.set_volume(e.targetVolume),null!=e.onEnd&&e.onEnd()):(this.set_volume(e.startVolume+i/e.duration*(e.targetVolume-e.startVolume)),this.currentFade=e)}this.currentVolume=this.volume},addEffect:function(t){if(null==t)throw kn.thrown("Can't add null effect");if(this.effects.indexOf(t)>=0)throw kn.thrown("effect already added on this channel");return this.effects.push(t),t},removeEffect:function(t){l.remove(this.effects,t)},__class__:pa};var ga=function(){this.queue=[],this.positionChanged=!1,this.isLoading=!1,this.isVirtual=!1,this.lastStamp=0,this.audibleVolume=1,this.allowVirtual=!0,this.loop=!1,this.pause=!1,this.position=0,pa.call(this),this.id=ga.ID++};i["hxd.snd.Channel"]=ga,ga.__name__="hxd.snd.Channel",ga.__super__=pa,ga.prototype=r(pa.prototype,{onEnd:function(){},set_position:function(t){return this.lastStamp=l.now()/1e3,this.positionChanged=!0,t>this.duration?t=this.duration:t<0&&(t=0),this.position=t},set_pause:function(t){return t||(this.lastStamp=l.now()/1e3),this.pause=t},updateCurrentVolume:function(t){if(this.pause&&null!=this.currentFade){var e=this.currentFade;this.currentFade=null,this.updateCurrentVolume(t),this.currentFade=e}if(pa.prototype.updateCurrentVolume.call(this,t),this.channelGroup.updateCurrentVolume(t),this.currentVolume*=this.channelGroup.currentVolume*this.soundGroup.volume,null!=this.manager){for(var i=0,n=this.channelGroup.effects;i<n.length;){var s=n[i];++i,this.currentVolume*=s.getVolumeModifier()}for(i=0,n=this.effects;i<n.length;){s=n[i];++i,this.currentVolume*=s.getVolumeModifier()}}},calcAudibleVolume:function(t){if(this.updateCurrentVolume(t),this.audibleVolume=this.currentVolume,null!=this.manager){for(var e=0,i=this.channelGroup.effects;e<i.length;){var n=i[e];++e,this.audibleVolume=n.applyAudibleVolumeModifier(this.audibleVolume)}for(e=0,i=this.effects;e<i.length;){n=i[e];++e,this.audibleVolume=n.applyAudibleVolumeModifier(this.audibleVolume)}}},queueSound:function(t){this.queue.push(t)},stop:function(){null!=this.manager&&this.manager.releaseChannel(this)},isReleased:function(){return null==this.manager},__class__:ga});var ma=function(t){pa.call(this),this.name=t};i["hxd.snd.ChannelGroup"]=ma,ma.__name__="hxd.snd.ChannelGroup",ma.__super__=pa,ma.prototype=r(pa.prototype,{__class__:ma});var va=s["hxd.snd.SampleFormat"]={__ename__:!0,__constructs__:null,UI8:{_hx_name:"UI8",_hx_index:0,__enum__:"hxd.snd.SampleFormat",toString:n},I16:{_hx_name:"I16",_hx_index:1,__enum__:"hxd.snd.SampleFormat",toString:n},F32:{_hx_name:"F32",_hx_index:2,__enum__:"hxd.snd.SampleFormat",toString:n}};va.__constructs__=[va.UI8,va.I16,va.F32],va.__empty_constructs__=[va.UI8,va.I16,va.F32];var ya=function(){};i["hxd.snd.Data"]=ya,ya.__name__="hxd.snd.Data",ya.formatBytes=function(t){switch(t._hx_index){case 0:return 1;case 1:return 2;case 2:return 4}},ya.prototype={isLoading:function(){return!1},decode:function(t,e,i,n){var s=this.getBytesPerSample();if(i<0||n<0||e<0||e+n*s>t.length){var r="sampleStart = "+i;throw r+=" sampleCount = "+n,r+=" outPos = "+e,r+=" bpp = "+s,r+=" out.length = "+t.length,kn.thrown(r)}if(i+n>=this.samples){var a=0;return i<this.samples&&(a=this.samples-i,this.decodeBuffer(t,e,i,a)),void t.fill(e+a*s,(n-a)*s,0)}this.decodeBuffer(t,e,i,n)},resample:function(t,e,i){if(this.sampleFormat==e&&this.samplingRate==t&&this.channels==i)return this;var n=Math.ceil(this.samples*(t/this.samplingRate)),s=this.getBytesPerSample(),r=new Qn(new ArrayBuffer(s*this.samples));this.decodeBuffer(r,0,0,this.samples);var a,A=i*n;switch(e._hx_index){case 0:a=1;break;case 1:a=2;break;case 2:a=4}var h=new Qn(new ArrayBuffer(A*a));return this.resampleBuffer(h,0,r,0,t,e,i,this.samples),(r=new Ta(null)).channels=i,r.samples=n,r.sampleFormat=e,r.samplingRate=t,r.rawData=h,r},resampleBuffer:function(t,e,i,n,s,r,a,A){var h=this.getBytesPerSample(),o=Math.ceil(A*(s/this.samplingRate)),l=A!=o;if(l||this.sampleFormat!=va.I16||r!=va.I16||1!=a||2!=this.channels){var u=this.channels,_=a<u?a:u,c=a-_,d=0,f=0;for(E=0,F=o;E<F;){var x=E++/(o-1)*(A-1),p=0|x,g=x-p,m=n+p*h;p==A-1&&(l=!1);for(var v=0,y=_;v<y;){v++;var b,w=0;switch(this.sampleFormat._hx_index){case 0:b=i.b[m]/255,l&&(w=i.b[m+h]/255),++m;break;case 1:var M=i.getUInt16(m);if(b=(0==(32768&M)?M:-65536|M)/32768,l){var B=i.getUInt16(m+h);w=(0==(32768&B)?B:-65536|B)/32768}m+=2;break;case 2:b=i.getFloat(m),l&&(w=i.getFloat(m+h)),m+=4}switch(d=l?b+g*(w-b):b,r._hx_index){case 0:(f=128*(d+1)|0)>255&&(f=255),t.b[e++]=f;break;case 1:(f=32768*d|0)>32767&&(f=32767),f&=65535,t.setUInt16(e,f),e+=2;break;case 2:t.setFloat(e,d),e+=4}}for(var C=0,S=c;C<S;){C++;switch(r._hx_index){case 0:t.b[e++]=f;break;case 1:t.setUInt16(e,f),e+=2;break;case 2:t.setFloat(e,d),e+=4}}}}else for(var I=n,k=e,E=0,F=A;E<F;){E++;var T=i.getUInt16(I);I+=2;var D,P=i.getUInt16(I);I+=2,(T^P)>=32768?(0!=(32768&T)&&(T|=-65536),0!=(32768&P)&&(P|=-65536),D=T+P>>1&65535):D=T+P>>1,t.setUInt16(k,D),k+=2}},decodeBuffer:function(t,e,i,n){throw kn.thrown("Not implemented")},getBytesPerSample:function(){var t;switch(this.sampleFormat._hx_index){case 0:t=1;break;case 1:t=2;break;case 2:t=4}return this.channels*t},load:function(t){t()},get_duration:function(){return this.samples/this.samplingRate},__class__:ya};var ba=function(){};i["hxd.snd.EffectDriver"]=ba,ba.__name__="hxd.snd.EffectDriver",ba.prototype={acquire:function(){},release:function(){},update:function(t){},bind:function(t,e){},apply:function(t,e){},unbind:function(t,e){},__class__:ba};var wa=s["hxd.snd.DriverFeature"]={__ename__:!0,__constructs__:null,MasterVolume:{_hx_name:"MasterVolume",_hx_index:0,__enum__:"hxd.snd.DriverFeature",toString:n}};wa.__constructs__=[wa.MasterVolume],wa.__empty_constructs__=[wa.MasterVolume];var Ma=function(){};i["hxd.snd.Driver"]=Ma,Ma.__name__="hxd.snd.Driver",Ma.__isInterface__=!0,Ma.prototype={__class__:Ma};var Ba=function(t){this.refs=0,this.priority=0,this.retainTime=0,this.lastStamp=0;var e=ka.get().driver;null!=e&&(this.driver=e.getEffectDriver(t))};i["hxd.snd.Effect"]=Ba,Ba.__name__="hxd.snd.Effect",Ba.prototype={applyAudibleVolumeModifier:function(t){return t},getVolumeModifier:function(){return 1},__class__:Ba};var Ca=function(){this.position=new Yt,this.velocity=new Yt,this.direction=new Yt(1,0,0),this.up=new Yt(0,0,1)};i["hxd.snd.Listener"]=Ca,Ca.__name__="hxd.snd.Listener",Ca.prototype={syncCamera:function(t){var e=this.position,i=t.pos;e.x=i.x,e.y=i.y,e.z=i.z,e.w=i.w;e=this.direction;var n=t.target.x-t.pos.x,s=t.target.y-t.pos.y,r=t.target.z-t.pos.z;null==r&&(r=0),null==s&&(s=0),null==n&&(n=0),e.x=n,e.y=s,e.z=r,e.w=1;var a=(e=this.direction).x*e.x+e.y*e.y+e.z*e.z;a=a<1e-10?0:1/Math.sqrt(a),e.x*=a,e.y*=a,e.z*=a;e=this.up,i=t.up;e.x=i.x,e.y=i.y,e.z=i.z,e.w=i.w},__class__:Ca};var Sa=function(t){this.start=0,this.playing=!1,this.volume=-1,this.id=Sa.ID++,this.handle=t.createSource(),this.buffers=[]};i["hxd.snd.Source"]=Sa,Sa.__name__="hxd.snd.Source",Sa.prototype={dispose:function(){ka.get().driver.destroySource(this.handle)},__class__:Sa};var Ia=function(t){this.end=0,this.handle=t.createBuffer(),this.refs=0,this.lastStop=l.now()/1e3};i["hxd.snd.Buffer"]=Ia,Ia.__name__="hxd.snd.Buffer",Ia.prototype={dispose:function(){ka.get().driver.destroyBuffer(this.handle)},__class__:Ia};var ka=function(){this.suspended=!1,this.timeOffset=0;try{this.driver=new Oa}catch(t){if("string"!=typeof kn.caught(t).unwrap())throw t;this.driver=null}if(this.masterVolume=1,this.hasMasterVolume=null==this.driver||this.driver.hasFeature(wa.MasterVolume),this.masterSoundGroup=new Fa("master"),this.masterChannelGroup=new ma("master"),this.listener=new Ca,this.soundBufferMap=new Kn,this.soundBufferKeys=[],this.freeStreamBuffers=[],this.effectGC=[],this.soundBufferCount=0,null!=this.driver){this.sources=[];for(var t=0,e=ka.MAX_SOURCES;t<e;){t++;this.sources.push(new Sa(this.driver))}}this.cachedBytes=new Qn(new ArrayBuffer(24)),this.resampleBytes=new Qn(new ArrayBuffer(2*ka.STREAM_BUFFER_SAMPLE_COUNT))};i["hxd.snd.Manager"]=ka,ka.__name__="hxd.snd.Manager",ka.get=function(){return null==ka.instance&&(ka.instance=new ka,ka.instance.updateEvent=Tn.add(XA(e=ka.instance,e.update)),ka.instance.updateEvent.isBlocking=!1),ka.instance},ka.regEffect=function(t,e){for(var i=t;null!=i;){if(i==e)return t;i=i.next}return e.next=t,e},ka.prototype={getTmpBytes:function(t){return this.cachedBytes.length<t&&(this.cachedBytes=new Qn(new ArrayBuffer(t))),this.cachedBytes},getResampleBytes:function(t){return this.resampleBytes.length<t&&(this.resampleBytes=new Qn(new ArrayBuffer(t))),this.resampleBytes},stopAll:function(){for(;null!=this.channels;)this.channels.stop()},stopAllNotLooping:function(){for(var t=this.channels;null!=t;){var e=t.next;t.loop||t.stop(),t=e}},stopByName:function(t){for(var e=this.channels;null!=e;){var i=e.next;null!=e.soundGroup&&e.soundGroup.name==t&&e.stop(),e=i}},getAll:function(t){for(var e=this.channels,i=[];null!=e;)e.sound==t&&i.push(e),e=e.next;return new ia(i)},cleanCache:function(){for(var t=0;t<this.soundBufferKeys.length;){var e=this.soundBufferKeys[t],i=this.soundBufferMap.h[e];if(++t,!(i.refs>0)){var n=this.soundBufferMap;Object.prototype.hasOwnProperty.call(n.h,e)&&delete n.h[e],l.remove(this.soundBufferKeys,e),--t,i.dispose(),--this.soundBufferCount}}},dispose:function(){if(this.stopAll(),null!=this.driver){for(var t=0,e=this.sources;t<e.length;){var i=e[t];++t,i.dispose()}for(var n=this.soundBufferMap.h,s=n,r=Object.keys(n),a=r.length,A=0;A<a;){(h=s[r[A++]]).dispose()}for(t=0,e=this.freeStreamBuffers;t<e.length;){var h=e[t];++t,h.dispose()}for(t=0,e=this.effectGC;t<e.length;){var o=e[t];++t,o.driver.release()}this.driver.dispose()}this.sources=null,this.soundBufferMap=null,this.soundBufferKeys=null,this.freeStreamBuffers=null,this.effectGC=null,this.updateEvent.stop(),ka.instance=null},play:function(t,e,i){null==i&&(i=this.masterSoundGroup),null==e&&(e=this.masterChannelGroup);var n=t.getData();if(0==n.samples)throw kn.thrown(x.string(t)+" has no samples");var s=new ga;return s.sound=t,s.duration=n.get_duration(),s.manager=this,s.soundGroup=i,s.channelGroup=e,s.next=this.channels,s.isLoading=n.isLoading(),s.isVirtual=null==this.driver,this.channels=s,s},updateVirtualChannels:function(t){for(var e=this.channels;null!=e;)if(e.pause||!e.isVirtual||e.isLoading)e=e.next;else{var i=t-e.lastStamp;e.set_position(e.position+(i<0?0:i)),e.lastStamp=t;for(var n=e.next;e.position>=e.duration;)if(e.set_position(e.position-e.duration),e.onEnd(),null!=n&&null==n.manager&&(n=null),e.queue.length>0)e.sound=e.queue.shift(),e.duration=e.sound.getData().get_duration();else if(!e.loop){this.releaseChannel(e);break}e=n}},update:function(){if(0!=this.timeOffset){for(var t=this.channels;null!=t;)t.lastStamp+=this.timeOffset,null!=t.currentFade&&(t.currentFade.start+=this.timeOffset),t=t.next;for(var e=0,i=this.sources;e<i.length;){var n=i[e];++e;for(var s=0,r=n.buffers;s<r.length;){var a=r[s];++s,a.lastStop+=this.timeOffset}}this.timeOffset=0}if(this.now=l.now()/1e3,null!=this.driver){for(e=0,i=this.sources;e<i.length;){n=i[e];if(++e,null!=(t=n.channel))if(t.positionChanged)this.releaseSource(n);else{var A=null;for(s=0,r=this.driver.getProcessedBuffers(n.handle);s<r;){var h=s++;null!=(a=this.unqueueBuffer(n))&&(A=a,a.isEnd&&(t.sound=a.sound,t.duration=a.sound.getData().get_duration(),t.set_position(t.duration),t.positionChanged=!1,t.onEnd(),n.start=0))}if(0!=n.buffers.length){t.sound=n.buffers[0].sound,t.duration=t.sound.getData().get_duration();var o=this.driver.getPlayedSampleCount(n.handle);if(o<0&&(En.trace("playedSamples should positive : bug in driver",{fileName:"hxd/snd/Manager.hx",lineNumber:360,className:"hxd.snd.Manager",methodName:"update"}),o=0),t.set_position(o/n.buffers[0].sampleRate),t.positionChanged=!1,n.buffers.length<ka.BUFFER_QUEUE_LENGTH){var u=n.buffers[n.buffers.length-1];if(u.isEnd)if(t.queue.length>0){var _=t.queue[0];this.queueBuffer(n,_,0)&&t.queue.shift()}else t.loop&&this.queueBuffer(n,u.sound,0);else this.queueBuffer(n,u.sound,u.start+u.samples)}}else A.isEnd?t.queue.length>0?(t.sound=t.queue.shift(),t.duration=t.sound.getData().get_duration(),t.set_position(0),this.releaseSource(n)):t.loop?(t.set_position(0),this.releaseSource(n)):this.releaseChannel(t):(t.set_position((A.start+A.samples)/A.sampleRate),this.releaseSource(n))}}for(t=this.channels;null!=t;)t.calcAudibleVolume(this.now),t.isLoading&&!t.sound.getData().isLoading()&&(t.isLoading=!1),t.isVirtual=this.suspended||t.pause||t.mute||t.channelGroup.mute||t.allowVirtual&&t.audibleVolume<ka.VIRTUAL_VOLUME_THRESHOLD||t.isLoading,t=t.next;var c,d=this.channels,f=XA(this,this.sortChannel);if(null==d)c=null;else{for(var x=1,p=0,g=0;;){for(D=d,d=null,z=null,T=0;null!=D;){++T,P=D,p=0;for(e=0,i=x;e<i;){h=e++;if(++p,null==(P=P.next))break}for(g=x;p>0||g>0&&null!=P;)0==p?(M=P,P=P.next,--g):0==g||null==P||f(D,P)<=0?(M=D,D=D.next,--p):(M=P,P=P.next,--g),null!=z?z.next=M:d=M,z=M;D=P}if(z.next=null,T<=1)break;x*=2}c=d}this.channels=c;var m=0;for(t=this.channels;null!=t&&!t.isVirtual;)++m>this.sources.length?t.isVirtual=!0:t.soundGroup.maxAudible>=0&&(t.soundGroup.lastUpdate!=this.now&&(t.soundGroup.lastUpdate=this.now,t.soundGroup.numAudible=0),++t.soundGroup.numAudible>t.soundGroup.maxAudible&&(t.isVirtual=!0,--m)),t=t.next;for(e=0,i=this.sources;e<i.length;){n=i[e];++e,null!=n.channel&&n.channel.isVirtual&&this.releaseSource(n)}for(t=this.channels;null!=t;)if(null!=t.source||t.isVirtual)t=t.next;else{for(n=null,e=0,i=this.sources;e<i.length;){var v=i[e];if(++e,null==v.channel){n=v;break}}if(null==n)throw kn.thrown("could not get a source");n.channel=t,t.source=n,this.checkTargetFormat(t.sound.getData(),t.soundGroup.mono),n.start=Math.floor(t.position*this.targetRate),n.start<0&&(n.start=0),this.queueBuffer(n,t.sound,n.start),t.positionChanged=!1,t=t.next}var y=null,b=this.hasMasterVolume?1:this.masterVolume;for(e=0,i=this.sources;e<i.length;){n=i[e];if(++e,null!=(t=n.channel)){var w=t.currentVolume*b;n.volume!=w&&(w<0&&(w=0),n.volume=w,this.driver.setSourceVolume(n.handle,w)),n.playing||(this.driver.playSource(n.handle),n.playing=!0);for(h=t.bindedEffects.length;--h>=0;){var M=t.bindedEffects[h];t.effects.indexOf(M)<0&&t.channelGroup.effects.indexOf(M)<0&&this.unbindEffect(t,n,M)}for(s=0,r=t.channelGroup.effects;s<r.length;){var B=r[s];++s,t.bindedEffects.indexOf(B)<0&&this.bindEffect(t,n,B)}for(var C=0,S=t.effects;C<S.length;){var I=S[C];++C,t.bindedEffects.indexOf(I)<0&&this.bindEffect(t,n,I)}for(var k=0,E=t.bindedEffects;k<E.length;){var F=E[k];++k,y=ka.regEffect(y,F)}}}d=y,f=XA(this,this.sortEffect);if(null==d)y=null;else{var T,D,P,z;for(x=1,p=0,g=0;;){for(D=d,d=null,z=null,T=0;null!=D;){++T,P=D,p=0;for(e=0,i=x;e<i;){h=e++;if(++p,null==(P=P.next))break}for(g=x;p>0||g>0&&null!=P;)0==p?(M=P,P=P.next,--g):0==g||null==P||f(D,P)<=0?(M=D,D=D.next,--p):(M=P,P=P.next,--g),null!=z?z.next=M:d=M,z=M;D=P}if(z.next=null,T<=1)break;x*=2}y=d}for(M=y;null!=M;)M.driver.update(M),M=M.next;for(e=0,i=this.sources;e<i.length;){n=i[e];if(++e,null!=(t=n.channel))for(s=0,r=t.bindedEffects;s<r.length;){M=r[s];++s,M.driver.apply(M,n.handle)}}for(e=0,i=this.effectGC;e<i.length;){M=i[e];if(++e,this.now-M.lastStamp>M.retainTime){M.driver.release(),l.remove(this.effectGC,M);break}}if(this.updateVirtualChannels(this.now),L=(L=(V=this.listener.direction).x*V.x+V.y*V.y+V.z*V.z)<1e-10?0:1/Math.sqrt(L),V.x*=L,V.y*=L,V.z*=L,L=(L=(V=this.listener.up).x*V.x+V.y*V.y+V.z*V.z)<1e-10?0:1/Math.sqrt(L),V.x*=L,V.y*=L,V.z*=L,this.hasMasterVolume&&this.driver.setMasterVolume(this.masterVolume),this.driver.setListenerParams(this.listener.position,this.listener.direction,this.listener.up,this.listener.velocity),this.driver.update(),this.soundBufferCount>=ka.SOUND_BUFFER_CACHE_SIZE){var R=l.now()/1e3;for(h=0;h<this.soundBufferKeys.length;){var L=this.soundBufferKeys[h];if(++h,!((a=this.soundBufferMap.h[L]).refs>0||a.lastStop+60>R)){var V=this.soundBufferMap;Object.prototype.hasOwnProperty.call(V.h,L)&&delete V.h[L],l.remove(this.soundBufferKeys,L),--h,a.dispose(),--this.soundBufferCount}}}}else this.updateVirtualChannels(this.now)},progressiveDecodeBuffer:function(t,e,i){var n=e.getData(),s=Math.ceil(ka.STREAM_BUFFER_SAMPLE_COUNT/ka.BUFFER_STREAM_SPLIT);t.streamStart==i&&t.streamSound==e||(t.streamSound=e,t.streamStart=i,t.streamPos=i);var r=i+ka.STREAM_BUFFER_SAMPLE_COUNT;if(t.streamPos==r)return!0;var a=n.getBytesPerSample(),A=ka.STREAM_BUFFER_SAMPLE_COUNT*a;(null==t.streamBuffer||t.streamBuffer.length<A)&&(t.streamBuffer=new Qn(new ArrayBuffer(A)),t.streamPos=i);var h=r-t.streamPos;return h>s&&(h=s),n.decode(t.streamBuffer,(t.streamPos-i)*a,t.streamPos,h),t.streamPos+=h,t.streamPos==r},queueBuffer:function(t,e,i){var n=e.getData(),s=t.channel.soundGroup,r=null;if(n.get_duration()<=ka.STREAM_DURATION)r=this.getSoundBuffer(e,s),this.driver.queueBuffer(t.handle,r.handle,i,!0);else{if(t.buffers.length>0&&ka.BUFFER_STREAM_SPLIT>1&&!this.progressiveDecodeBuffer(t,e,i))return!1;r=this.getStreamBuffer(t,e,s,i),this.driver.queueBuffer(t.handle,r.handle,0,r.isEnd)}return t.buffers.push(r),!0},unqueueBuffer:function(t){var e=t.buffers.shift();return null==e?null:(this.driver.unqueueBuffer(t.handle,e.handle),e.isStream?this.freeStreamBuffers.unshift(e):0==--e.refs&&(e.lastStop=l.now()/1e3),e)},bindEffect:function(t,e,i){0!=i.refs||l.remove(this.effectGC,i)||i.driver.acquire(),++i.refs,i.driver.bind(i,e.handle),t.bindedEffects.push(i)},unbindEffect:function(t,e,i){i.driver.unbind(i,e.handle),l.remove(t.bindedEffects,i),0==--i.refs&&(i.lastStamp=this.now,this.effectGC.push(i))},releaseSource:function(t){if(null!=t.channel){for(var e=0,i=t.channel.bindedEffects.slice();e<i.length;){var n=i[e];++e,this.unbindEffect(t.channel,t,n)}t.channel.bindedEffects=[],t.channel.source=null,t.channel=null}for(t.playing&&(t.playing=!1,this.driver.stopSource(t.handle),t.volume=-1);t.buffers.length>0;)this.unqueueBuffer(t)},checkTargetFormat:function(t,e){var i;switch(null==e&&(e=!1),this.targetRate=t.samplingRate,this.targetChannels=e||1==t.channels?1:2,t.sampleFormat._hx_index){case 0:i=va.UI8;break;case 1:i=va.I16;break;case 2:i=va.F32}return this.targetFormat=i,this.targetChannels==t.channels&&this.targetFormat==t.sampleFormat&&this.targetRate==t.samplingRate},getSoundBuffer:function(t,e){var i=this,n=t.getData(),s=e.mono,r=t.entry.get_path();s&&1!=n.channels&&(r+="mono");var a=this.soundBufferMap.h[r];return null==a&&((a=new Ia(this.driver)).isStream=!1,a.isEnd=!0,a.sound=t,n.load((function(){i.fillSoundBuffer(a,n,s)})),this.soundBufferMap.h[r]=a,this.soundBufferKeys.push(r),++this.soundBufferCount),++a.refs,a},fillSoundBuffer:function(t,e,i){null==i&&(i=!1),this.checkTargetFormat(e,i)||(e=e.resample(this.targetRate,this.targetFormat,this.targetChannels));var n=e.samples*e.getBytesPerSample(),s=this.getTmpBytes(n);e.decode(s,0,0,e.samples),this.driver.setBufferData(t.handle,s,n,this.targetFormat,this.targetChannels,this.targetRate),t.sampleRate=this.targetRate,t.samples=e.samples},getStreamBuffer:function(t,e,i,n){var s=e.getData(),r=this.freeStreamBuffers.shift();null==r&&((r=new Ia(this.driver)).isStream=!0);var a=ka.STREAM_BUFFER_SAMPLE_COUNT;n+a>=s.samples?(a=s.samples-n,r.isEnd=!0):r.isEnd=!1,r.sound=e,r.samples=a,r.start=n;var A,h=a*s.getBytesPerSample();if(t.streamSound==e&&t.streamStart==n){for(;!this.progressiveDecodeBuffer(t,e,n););A=t.streamBuffer}else A=this.getTmpBytes(h),s.decode(A,0,n,a);if(!this.checkTargetFormat(s,i.mono)){var o,l=Math.ceil(a*(this.targetRate/s.samplingRate))*this.targetChannels;switch(this.targetFormat._hx_index){case 0:o=1;break;case 1:o=2;break;case 2:o=4}h=l*o;var u=this.getResampleBytes(h);s.resampleBuffer(u,0,A,0,this.targetRate,this.targetFormat,this.targetChannels,a),A=u}return this.driver.setBufferData(r.handle,A,h,this.targetFormat,this.targetChannels,this.targetRate),r.sampleRate=this.targetRate,r},sortChannel:function(t,e){return t.isVirtual!=e.isVirtual?t.isVirtual?1:-1:t.channelGroup.priority!=e.channelGroup.priority?t.channelGroup.priority<e.channelGroup.priority?1:-1:t.priority!=e.priority?t.priority<e.priority?1:-1:t.audibleVolume!=e.audibleVolume?t.audibleVolume<e.audibleVolume?1:-1:t.id<e.id?1:-1},sortEffect:function(t,e){return e.priority-t.priority},releaseChannel:function(t){if(null!=t.manager){if(this.channels==t)this.channels=t.next;else{for(var e=this.channels;e.next!=t;)e=e.next;e.next=t.next}for(var i=0,n=t.effects;i<n.length;){var s=n[i];++i,t.removeEffect(s)}null!=t.source&&this.releaseSource(t.source),t.next=null,t.manager=null,t.effects=null,t.bindedEffects=null,t.currentFade=null;var r=t.sound;null!=r&&r.channel==t&&(r.channel=null)}},__class__:ka};var Ea=function(t){var e=new V(new ss(t)).read();this.samples=e.sampleCount;for(var i=e.frames[0].data,n=-1,s=0,r=i.length-24;s<r;){var a=s++;if(76==i.b[a]&&65==i.b[a+1]&&77==i.b[a+2]&&69==i.b[a+3]){n=a;break}}if(n>=0){var A=i.b[n+21]<<16|i.b[n+22]<<8|i.b[n+23],h=A>>12,o=4095&A;this.samples-=h+o+1152}var l=e.frames[0].header;this.sampleFormat=va.F32,this.samplingRate=k.srEnum2Num(l.samplingRate),this.channels=l.channelMode==z.Mono?1:2;var u=Qa.get();if(null!=u){u.decodeAudioData(t.b.bufferValue,XA(this,this.processBuffer));var _=0|u.sampleRate;this.samples=Math.ceil(this.samples*_/this.samplingRate),this.samplingRate=_}};i["hxd.snd.Mp3Data"]=Ea,Ea.__name__="hxd.snd.Mp3Data",Ea.__super__=ya,Ea.prototype=r(ya.prototype,{isLoading:function(){return null==this.buffer},load:function(t){null!=this.buffer?t():this.onEnd=t},processBuffer:function(t){var e=t.getChannelData(0);if(this.samples=t.length,1!=this.channels){for(var i=t.numberOfChannels<2?e:t.getChannelData(1),n=new Float32Array(2*e.length),s=0,r=0,a=t.length;r<a;){var A=r++;n[s++]=e[A],n[s++]=i[A]}this.buffer=Qn.ofData(n.buffer),null!=this.onEnd&&(this.onEnd(),this.onEnd=null)}else this.buffer=Qn.ofData(e.buffer)},decodeBuffer:function(t,e,i,n){null==this.buffer?t.fill(e,4*n*this.channels,0):t.blit(e,this.buffer,4*i*this.channels,4*n*this.channels)},__class__:Ea});var Fa=function(t){this.name=t,this.maxAudible=-1,this.volume=1,this.mono=!1};i["hxd.snd.SoundGroup"]=Fa,Fa.__name__="hxd.snd.SoundGroup",Fa.prototype={__class__:Fa};var Ta=function(t){null!=t&&this.init(new K(new ss(t)).read())};i["hxd.snd.WavData"]=Ta,Ta.__name__="hxd.snd.WavData",Ta.__super__=ya,Ta.prototype=r(ya.prototype,{init:function(t){var e,i=t.header;switch(this.samplingRate=i.samplingRate,this.channels=i.channels,i.bitsPerSample){case 8:e=va.UI8;break;case 16:e=va.I16;break;default:throw kn.thrown("Unsupported WAV "+i.bitsPerSample+" bits")}this.sampleFormat=e,this.rawData=t.data,this.samples=this.rawData.length/this.getBytesPerSample()|0},decodeBuffer:function(t,e,i,n){var s=this.getBytesPerSample();t.blit(e,this.rawData,i*s,n*s)},__class__:Ta});var Da=function(){Ba.call(this,"lowpass"),this.priority=100,this.gainHF=1};i["hxd.snd.effect.LowPass"]=Da,Da.__name__="hxd.snd.effect.LowPass",Da.__super__=Ba,Da.prototype=r(Ba.prototype,{__class__:Da});var Pa=function(t){null==t&&(t=1),Ba.call(this,"pitch"),this.value=t};i["hxd.snd.effect.Pitch"]=Pa,Pa.__name__="hxd.snd.effect.Pitch",Pa.__super__=Ba,Pa.prototype=r(Ba.prototype,{__class__:Pa});var za=function(){Ba.call(this,"spatialization"),this.position=new Yt,this.velocity=new Yt,this.direction=new Yt,this.referenceDistance=1,this.rollOffFactor=1};i["hxd.snd.effect.Spatialization"]=za,za.__name__="hxd.snd.effect.Spatialization",za.__super__=Ba,za.prototype=r(Ba.prototype,{getVolumeModifier:function(){if(null==this.fadeDistance)return 1;var t=ka.get().listener.position,e=this.position,i=e.x-t.x,n=e.y-t.y,s=e.z-t.z,r=Math.sqrt(i*i+n*n+s*s);null!=this.maxDistance?r-=this.maxDistance:r-=this.referenceDistance;var a=1-r/this.fadeDistance;return a>1&&(a=1),a<0&&(a=0),a},applyAudibleVolumeModifier:function(t){var e,i=ka.get().listener.position,n=this.position,s=n.x-i.x,r=n.y-i.y,a=n.z-i.z,A=Math.sqrt(s*s+r*r+a*a);(A<(e=this.referenceDistance)&&(A=e),null!=this.maxDistance)&&(A>(e=this.maxDistance)&&(A=e));return t*(this.referenceDistance/(this.referenceDistance+this.rollOffFactor*(A-this.referenceDistance)))},__class__:za});var Ra=function(){};i["hxd.snd.webaudio.BufferHandle"]=Ra,Ra.__name__="hxd.snd.webaudio.BufferHandle",Ra.prototype={__class__:Ra};var La=function(){this.buffers=[],this.sampleOffset=0,this.pitch=1,this.firstPlay=!0};i["hxd.snd.webaudio.SourceHandle"]=La,La.__name__="hxd.snd.webaudio.SourceHandle",La.prototype={updateDestination:function(){this.destination=this.gain,null!=this.lowPass&&(this.lowPass.connect(this.destination),this.destination=this.lowPass),null!=this.panner&&(this.panner.connect(this.destination),this.destination=this.panner),this.gain.connect(Qa.destination);for(var t=0,e=this.buffers;t<e.length;){var i=e[t];++t,null!=i.node&&i.restart(this)}},applyPitch:function(){for(var t=0,e=0,i=this.buffers;e<i.length;){var n=i[e];++e,t=n.readjust(t,this)}},__class__:La};var Va=function(){};i["hxd.snd.webaudio.BufferPlayback"]=Va,Va.__name__="hxd.snd.webaudio.BufferPlayback",Va.prototype={get_currentSample:function(){return this.consumed?this.buffer.samples:null==this.node||!this.dirty||this.node.context.currentTime<this.lastTime?0:(this.lastSamples+=Math.floor((this.node.context.currentTime-this.lastTime)*this.buffer.inst.sampleRate*this.node.playbackRate.value),this.lastTime=this.node.context.currentTime,this.lastSamples)},set:function(t,e){this.buffer=t,this.offset=isNaN(e)?0:e,this.dirty=!1,this.consumed=!1,this.starts=0,this.ends=0},start:function(t,e,i){if(this.dirty=!0,this.consumed=!1,null!=this.node&&this.stop(),e.firstPlay&&this.buffer.samples>10){e.firstPlay=!1;for(var n=[],s=0,r=this.buffer.inst.numberOfChannels;s<r;){var a=s++;n.push(this.buffer.inst.getChannelData(a))}for(var A=n,h=0,o=0;h<10;){for(a=0;a<A.length;)A[a][h]*=o,++a;++h,(o+=.1)>1&&(o=1)}}return this.node=t.createBufferSource(),this.node.buffer=this.buffer.inst,this.node.addEventListener("ended",XA(this,this.onBufferConsumed)),this.node.connect(e.destination),this.node.playbackRate.value=e.pitch,this.node.start(i,this.offset),this.lastSamples=0,this.lastTime=i,this.starts=i,this.ends=i+(this.buffer.inst.duration-this.offset)/e.pitch},readjust:function(t,e){if(this.consumed||null==this.node)return this.ends;var i=e.driver.ctx,n=i.currentTime;this.node.playbackRate.setValueAtTime(e.pitch,n);var s=n-this.starts;return s<0?this.start(i,e,0==t?n:t):(this.starts=n-s/e.pitch,this.ends=this.starts+(this.buffer.inst.duration-this.offset)/e.pitch)},restart:function(t){if(!this.consumed&&null!=this.node){var e=Qa.get();e.currentTime>this.starts?(this.offset+=(e.currentTime-this.starts)*t.pitch,this.start(e,t,e.currentTime)):this.start(e,t,this.starts)}},stop:function(t){null==t&&(t=!0),null!=this.node&&(this.node.removeEventListener("ended",XA(this,this.onBufferConsumed)),t?this.node.disconnect():this.node.stop(),this.node=null)},onBufferConsumed:function(t){this.node.removeEventListener("ended",XA(this,this.onBufferConsumed)),this.node.disconnect(),this.node=null,this.consumed=!0},clear:function(){this.buffer=null,this.node=null},__class__:Va};var Qa=function(){};i["hxd.snd.webaudio.Context"]=Qa,Qa.__name__="hxd.snd.webaudio.Context",Qa.get=function(){if(null==Qa.ctx){try{Qa.ctx=new AudioContext}catch(t){try{Qa.ctx=new window.webkitAudioContext}catch(t){Qa.ctx=null}}if(null==Qa.ctx)throw kn.thrown("WebAudio API not available in this browser!");"suspended"==Qa.ctx.state&&Qa.waitForPageInput(),Qa.ctx.addEventListener("statechange",(function(t){"suspended"==Qa.ctx.state&&Qa.waitForPageInput()})),Qa.bufferPool=[],Qa.gainPool=[],Qa.masterGain=Qa.ctx.createGain(),Qa.masterGain.connect(Qa.ctx.destination),Qa.destination=Qa.masterGain}return Qa.ctx},Qa.getGain=function(){return 0!=Qa.gainPool.length?Qa.gainPool.pop():Qa.ctx.createGain()},Qa.putGain=function(t){Qa.gainPool.push(t),t.gain.value=1},Qa.waitForPageInput=function(){Qa.suspended||(window.document.addEventListener("click",Qa.resumeContext),window.document.addEventListener("keydown",Qa.resumeContext),window.document.body.addEventListener("keydown",Qa.resumeContext),window.document.body.addEventListener("touchend",Qa.resumeContext),Qa.suspended=!0)},Qa.resumeContext=function(t){Qa.suspended&&(null!=Qa.ctx&&Qa.ctx.resume(),window.document.removeEventListener("click",Qa.resumeContext),window.document.removeEventListener("keydown",Qa.resumeContext),window.document.body.removeEventListener("keydown",Qa.resumeContext),window.document.body.removeEventListener("touchend",Qa.resumeContext),Qa.suspended=!1)},Qa.getBuffer=function(t,e,i){for(var n=0,s=Qa.bufferPool;n<s.length;){var r=s[n];if(++n,r.channels==t&&r.samples==e&&r.rate==i)return 0!=r.pool.length?r.pool.pop():Qa.ctx.createBuffer(t,e,i)}r=new Ua(t,e,i);return Qa.bufferPool.push(r),Qa.ctx.createBuffer(t,e,i)},Qa.putBuffer=function(t){for(var e=0|t.sampleRate,i=0,n=Qa.bufferPool;i<n.length;){var s=n[i];if(++i,s.channels==t.numberOfChannels&&s.samples==t.length&&s.rate==e){s.pool.push(t);break}}};var Ua=function(t,e,i){this.pool=[],this.channels=t,this.samples=e,this.rate=i};i["hxd.snd.webaudio._Context.BufferPool"]=Ua,Ua.__name__="hxd.snd.webaudio._Context.BufferPool",Ua.prototype={__class__:Ua};var Oa=function(){this.playbackPool=[],this.ctx=Qa.get()};i["hxd.snd.webaudio.Driver"]=Oa,Oa.__name__="hxd.snd.webaudio.Driver",Oa.__interfaces__=[Ma],Oa.prototype={getBuffer:function(t,e,i){return Qa.getBuffer(t,e,i)},putBuffer:function(t){Qa.putBuffer(t)},getGain:function(){return 0!=Qa.gainPool.length?Qa.gainPool.pop():Qa.ctx.createGain()},putGain:function(t){Qa.gainPool.push(t),t.gain.value=1},hasFeature:function(t){return!0},setMasterVolume:function(t){Qa.masterGain.gain.value=t},setListenerParams:function(t,e,i,n){this.ctx.listener.setPosition(-t.x,t.y,t.z),this.ctx.listener.setOrientation(-e.x,e.y,e.z,-i.x,i.y,i.z)},createSource:function(){var t=new La;return t.driver=this,t.gain=0!=Qa.gainPool.length?Qa.gainPool.pop():Qa.ctx.createGain(),t.updateDestination(),t},playSource:function(t){if(!t.playing&&(t.playing=!0,0!=t.buffers.length))for(var e=this.ctx.currentTime,i=0,n=t.buffers;i<n.length;){var s=n[i];++i,s.consumed||(e=s.start(this.ctx,t,e))}},stopSource:function(t){t.playing=!1,t.sampleOffset=0},setSourceVolume:function(t,e){t.gain.gain.value=e},destroySource:function(t){this.stopSource(t),t.gain.disconnect(),t.driver=null;var e=t.gain;Qa.gainPool.push(e),e.gain.value=1,t.gain=null;for(var i=0,n=t.buffers;i<n.length;){var s=n[i];++i,s.stop(),s.clear(),this.playbackPool.push(s)}t.buffers=[]},createBuffer:function(){var t=new Ra;return t.samples=0,t},setBufferData:function(t,e,i,n,s,r){var a;switch(n._hx_index){case 0:a=1;break;case 1:a=2;break;case 2:a=4}var A=i/a/s|0;if(t.samples=A,0!=A)switch(null==t.inst?t.inst=Qa.getBuffer(s,A,r):t.inst.sampleRate==r&&t.inst.numberOfChannels==s&&t.inst.length==A||(Qa.putBuffer(t.inst),t.inst=Qa.getBuffer(s,A,r)),n._hx_index){case 0:var h=new Uint8Array(e.b.bufferValue);if(1==s)for(var o=t.inst.getChannelData(0),l=0,u=A;l<u;){o[p=l++]=h[p]/255}else{var _=t.inst.getChannelData(0),c=t.inst.getChannelData(1),d=0;for(l=0,u=A;l<u;){_[p=l++]=h[d]/255,c[p]=h[d+1]/255,d+=s}}break;case 1:var f=new Int16Array(e.b.bufferValue);if(1==s)for(o=t.inst.getChannelData(0),l=0,u=A;l<u;){o[p=l++]=f[p]/32768}else for(_=t.inst.getChannelData(0),c=t.inst.getChannelData(1),d=0,l=0,u=A;l<u;){_[p=l++]=f[d]/32768,c[p]=f[d+1]/32768,d+=s}break;case 2:var x=new Float32Array(e.b.bufferValue);if(1==s)for(o=t.inst.getChannelData(0),l=0,u=A;l<u;){o[p=l++]=x[p]}else for(_=t.inst.getChannelData(0),c=t.inst.getChannelData(1),d=0,l=0,u=A;l<u;){var p;_[p=l++]=x[d],c[p]=x[d+1],d+=s}}},destroyBuffer:function(t){null!=t.inst&&Qa.putBuffer(t.inst),t.inst=null},queueBuffer:function(t,e,i,n){var s=0!=this.playbackPool.length?this.playbackPool.pop():new Va;if(null!=e.inst&&(s.set(e,i/e.inst.length*e.inst.duration),e.isEnd=n,t.buffers.push(s),t.playing))if(1!=t.buffers.length){var r,a=t.buffers[t.buffers.length-2].ends,A=this.ctx;if(isFinite(a)){var h=this.ctx.currentTime;r=a<h?h:a}else r=this.ctx.currentTime;s.start(A,t,r)}else s.start(this.ctx,t,this.ctx.currentTime)},unqueueBuffer:function(t,e){for(;0<t.buffers.length;){var i=t.buffers[0];if(i.buffer==e){t.buffers.splice(0,1),i.stop(!e.isEnd),i.clear(),this.playbackPool.push(i);break}}e.isEnd||!t.playing?t.sampleOffset=0:t.sampleOffset+=e.samples},getProcessedBuffers:function(t){for(var e=0,i=0,n=t.buffers;i<n.length;){var s=n[i];++i,s.consumed&&++e}return e},getPlayedSampleCount:function(t){for(var e=0,i=null,n=0,s=t.buffers;n<s.length;){var r=s[n];if(++n,r.consumed)e+=r.buffer.samples;else if(r.dirty){i=r;break}}return null!=i?t.sampleOffset+e+i.get_currentSample():t.sampleOffset+e},update:function(){},dispose:function(){},getEffectDriver:function(t){switch(t){case"lowpass":return new Ga;case"pitch":return new Na;case"spatialization":return new Ya;default:return new ba}},get_masterGain:function(){return Qa.masterGain},set_destination:function(t){return Qa.destination=t},get_destination:function(){return Qa.destination},__class__:Oa};var Ga=function(){this.pool=[],ba.call(this)};i["hxd.snd.webaudio.LowPassDriver"]=Ga,Ga.__name__="hxd.snd.webaudio.LowPassDriver",Ga.__super__=ba,Ga.prototype=r(ba.prototype,{get:function(t){if(0!=this.pool.length)return this.pool.pop();var e=t.createBiquadFilter();return e.type="lowpass",e},bind:function(t,e){e.lowPass=this.get(e.driver.ctx),e.updateDestination(),this.apply(t,e)},apply:function(t,e){var i=e.driver.ctx.sampleRate/2,n=Math.log(i/40)/Math.LN2;e.lowPass.frequency.value=i*Math.pow(2,n*(t.gainHF-1))},unbind:function(t,e){this.pool.push(e.lowPass),e.lowPass.disconnect(),e.lowPass=null,null!=e.driver&&e.updateDestination()},__class__:Ga});var Na=function(){ba.call(this)};i["hxd.snd.webaudio.PitchDriver"]=Na,Na.__name__="hxd.snd.webaudio.PitchDriver",Na.__super__=ba,Na.prototype=r(ba.prototype,{apply:function(t,e){e.pitch!=t.value&&(e.pitch=t.value,e.applyPitch())},unbind:function(t,e){e.pitch=1,e.applyPitch()},__class__:Na});var Ya=function(){this.pool=[],ba.call(this)};i["hxd.snd.webaudio.SpatializationDriver"]=Ya,Ya.__name__="hxd.snd.webaudio.SpatializationDriver",Ya.__super__=ba,Ya.prototype=r(ba.prototype,{get:function(t){return 0!=this.pool.length?this.pool.pop():t.createPanner()},bind:function(t,e){e.panner=this.get(e.driver.ctx),e.updateDestination(),this.apply(t,e)},apply:function(t,e){e.panner.setPosition(-t.position.x,t.position.y,t.position.z),e.panner.setOrientation(-t.direction.x,t.direction.y,t.direction.z),e.panner.rolloffFactor=t.rollOffFactor,e.panner.refDistance=t.referenceDistance;var i=null==t.maxDistance?340282347e30:t.maxDistance;e.panner.maxDistance=i},unbind:function(t,e){this.pool.push(e.panner),e.panner.disconnect(),e.panner=null,null!=e.driver&&e.updateDestination()},__class__:Ya});var Xa=s["hxsl.Type"]={__ename__:!0,__constructs__:null,TVoid:{_hx_name:"TVoid",_hx_index:0,__enum__:"hxsl.Type",toString:n},TInt:{_hx_name:"TInt",_hx_index:1,__enum__:"hxsl.Type",toString:n},TBool:{_hx_name:"TBool",_hx_index:2,__enum__:"hxsl.Type",toString:n},TFloat:{_hx_name:"TFloat",_hx_index:3,__enum__:"hxsl.Type",toString:n},TString:{_hx_name:"TString",_hx_index:4,__enum__:"hxsl.Type",toString:n},TVec:(e=function(t,e){return{_hx_index:5,size:t,t:e,__enum__:"hxsl.Type",toString:n}},e._hx_name="TVec",e.__params__=["size","t"],e),TMat3:{_hx_name:"TMat3",_hx_index:6,__enum__:"hxsl.Type",toString:n},TMat4:{_hx_name:"TMat4",_hx_index:7,__enum__:"hxsl.Type",toString:n},TMat3x4:{_hx_name:"TMat3x4",_hx_index:8,__enum__:"hxsl.Type",toString:n},TBytes:(e=function(t){return{_hx_index:9,size:t,__enum__:"hxsl.Type",toString:n}},e._hx_name="TBytes",e.__params__=["size"],e),TSampler2D:{_hx_name:"TSampler2D",_hx_index:10,__enum__:"hxsl.Type",toString:n},TSampler2DArray:{_hx_name:"TSampler2DArray",_hx_index:11,__enum__:"hxsl.Type",toString:n},TSamplerCube:{_hx_name:"TSamplerCube",_hx_index:12,__enum__:"hxsl.Type",toString:n},TStruct:(e=function(t){return{_hx_index:13,vl:t,__enum__:"hxsl.Type",toString:n}},e._hx_name="TStruct",e.__params__=["vl"],e),TFun:(e=function(t){return{_hx_index:14,variants:t,__enum__:"hxsl.Type",toString:n}},e._hx_name="TFun",e.__params__=["variants"],e),TArray:(e=function(t,e){return{_hx_index:15,t:t,size:e,__enum__:"hxsl.Type",toString:n}},e._hx_name="TArray",e.__params__=["t","size"],e),TBuffer:(e=function(t,e){return{_hx_index:16,t:t,size:e,__enum__:"hxsl.Type",toString:n}},e._hx_name="TBuffer",e.__params__=["t","size"],e),TChannel:(e=function(t){return{_hx_index:17,size:t,__enum__:"hxsl.Type",toString:n}},e._hx_name="TChannel",e.__params__=["size"],e),TMat2:{_hx_name:"TMat2",_hx_index:18,__enum__:"hxsl.Type",toString:n}};Xa.__constructs__=[Xa.TVoid,Xa.TInt,Xa.TBool,Xa.TFloat,Xa.TString,Xa.TVec,Xa.TMat3,Xa.TMat4,Xa.TMat3x4,Xa.TBytes,Xa.TSampler2D,Xa.TSampler2DArray,Xa.TSamplerCube,Xa.TStruct,Xa.TFun,Xa.TArray,Xa.TBuffer,Xa.TChannel,Xa.TMat2],Xa.__empty_constructs__=[Xa.TVoid,Xa.TInt,Xa.TBool,Xa.TFloat,Xa.TString,Xa.TMat3,Xa.TMat4,Xa.TMat3x4,Xa.TSampler2D,Xa.TSampler2DArray,Xa.TSamplerCube,Xa.TMat2];var ja=s["hxsl.VecType"]={__ename__:!0,__constructs__:null,VInt:{_hx_name:"VInt",_hx_index:0,__enum__:"hxsl.VecType",toString:n},VFloat:{_hx_name:"VFloat",_hx_index:1,__enum__:"hxsl.VecType",toString:n},VBool:{_hx_name:"VBool",_hx_index:2,__enum__:"hxsl.VecType",toString:n}};ja.__constructs__=[ja.VInt,ja.VFloat,ja.VBool],ja.__empty_constructs__=[ja.VInt,ja.VFloat,ja.VBool];var Ha=s["hxsl.SizeDecl"]={__ename__:!0,__constructs__:null,SConst:(e=function(t){return{_hx_index:0,v:t,__enum__:"hxsl.SizeDecl",toString:n}},e._hx_name="SConst",e.__params__=["v"],e),SVar:(e=function(t){return{_hx_index:1,v:t,__enum__:"hxsl.SizeDecl",toString:n}},e._hx_name="SVar",e.__params__=["v"],e)};Ha.__constructs__=[Ha.SConst,Ha.SVar],Ha.__empty_constructs__=[];var Wa=function(t,e){this.msg=t,this.pos=e};i["hxsl.Error"]=Wa,Wa.__name__="hxsl.Error",Wa.t=function(t,e){throw kn.thrown(new Wa(t,e))},Wa.prototype={toString:function(){return"Error("+this.msg+")@"+x.string(this.pos)},__class__:Wa};var Za=s["hxsl.VarKind"]={__ename__:!0,__constructs__:null,Global:{_hx_name:"Global",_hx_index:0,__enum__:"hxsl.VarKind",toString:n},Input:{_hx_name:"Input",_hx_index:1,__enum__:"hxsl.VarKind",toString:n},Param:{_hx_name:"Param",_hx_index:2,__enum__:"hxsl.VarKind",toString:n},Var:{_hx_name:"Var",_hx_index:3,__enum__:"hxsl.VarKind",toString:n},Local:{_hx_name:"Local",_hx_index:4,__enum__:"hxsl.VarKind",toString:n},Output:{_hx_name:"Output",_hx_index:5,__enum__:"hxsl.VarKind",toString:n},Function:{_hx_name:"Function",_hx_index:6,__enum__:"hxsl.VarKind",toString:n}};Za.__constructs__=[Za.Global,Za.Input,Za.Param,Za.Var,Za.Local,Za.Output,Za.Function],Za.__empty_constructs__=[Za.Global,Za.Input,Za.Param,Za.Var,Za.Local,Za.Output,Za.Function];var Ja=s["hxsl.VarQualifier"]={__ename__:!0,__constructs__:null,Const:(e=function(t){return{_hx_index:0,max:t,__enum__:"hxsl.VarQualifier",toString:n}},e._hx_name="Const",e.__params__=["max"],e),Private:{_hx_name:"Private",_hx_index:1,__enum__:"hxsl.VarQualifier",toString:n},Nullable:{_hx_name:"Nullable",_hx_index:2,__enum__:"hxsl.VarQualifier",toString:n},PerObject:{_hx_name:"PerObject",_hx_index:3,__enum__:"hxsl.VarQualifier",toString:n},Name:(e=function(t){return{_hx_index:4,n:t,__enum__:"hxsl.VarQualifier",toString:n}},e._hx_name="Name",e.__params__=["n"],e),Shared:{_hx_name:"Shared",_hx_index:5,__enum__:"hxsl.VarQualifier",toString:n},Precision:(e=function(t){return{_hx_index:6,p:t,__enum__:"hxsl.VarQualifier",toString:n}},e._hx_name="Precision",e.__params__=["p"],e),Range:(e=function(t,e){return{_hx_index:7,min:t,max:e,__enum__:"hxsl.VarQualifier",toString:n}},e._hx_name="Range",e.__params__=["min","max"],e),Ignore:{_hx_name:"Ignore",_hx_index:8,__enum__:"hxsl.VarQualifier",toString:n},PerInstance:(e=function(t){return{_hx_index:9,v:t,__enum__:"hxsl.VarQualifier",toString:n}},e._hx_name="PerInstance",e.__params__=["v"],e),Doc:(e=function(t){return{_hx_index:10,s:t,__enum__:"hxsl.VarQualifier",toString:n}},e._hx_name="Doc",e.__params__=["s"],e),Borrow:(e=function(t){return{_hx_index:11,source:t,__enum__:"hxsl.VarQualifier",toString:n}},e._hx_name="Borrow",e.__params__=["source"],e),Sampler:(e=function(t){return{_hx_index:12,name:t,__enum__:"hxsl.VarQualifier",toString:n}},e._hx_name="Sampler",e.__params__=["name"],e)};Ja.__constructs__=[Ja.Const,Ja.Private,Ja.Nullable,Ja.PerObject,Ja.Name,Ja.Shared,Ja.Precision,Ja.Range,Ja.Ignore,Ja.PerInstance,Ja.Doc,Ja.Borrow,Ja.Sampler],Ja.__empty_constructs__=[Ja.Private,Ja.Nullable,Ja.PerObject,Ja.Shared,Ja.Ignore];var qa=s["hxsl.Prec"]={__ename__:!0,__constructs__:null,Low:{_hx_name:"Low",_hx_index:0,__enum__:"hxsl.Prec",toString:n},Medium:{_hx_name:"Medium",_hx_index:1,__enum__:"hxsl.Prec",toString:n},High:{_hx_name:"High",_hx_index:2,__enum__:"hxsl.Prec",toString:n}};qa.__constructs__=[qa.Low,qa.Medium,qa.High],qa.__empty_constructs__=[qa.Low,qa.Medium,qa.High];var Ka=s["hxsl.Const"]={__ename__:!0,__constructs__:null,CNull:{_hx_name:"CNull",_hx_index:0,__enum__:"hxsl.Const",toString:n},CBool:(e=function(t){return{_hx_index:1,b:t,__enum__:"hxsl.Const",toString:n}},e._hx_name="CBool",e.__params__=["b"],e),CInt:(e=function(t){return{_hx_index:2,v:t,__enum__:"hxsl.Const",toString:n}},e._hx_name="CInt",e.__params__=["v"],e),CFloat:(e=function(t){return{_hx_index:3,v:t,__enum__:"hxsl.Const",toString:n}},e._hx_name="CFloat",e.__params__=["v"],e),CString:(e=function(t){return{_hx_index:4,v:t,__enum__:"hxsl.Const",toString:n}},e._hx_name="CString",e.__params__=["v"],e)};Ka.__constructs__=[Ka.CNull,Ka.CBool,Ka.CInt,Ka.CFloat,Ka.CString],Ka.__empty_constructs__=[Ka.CNull];var $a=s["hxsl.ExprDef"]={__ename__:!0,__constructs__:null,EConst:(e=function(t){return{_hx_index:0,c:t,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EConst",e.__params__=["c"],e),EIdent:(e=function(t){return{_hx_index:1,i:t,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EIdent",e.__params__=["i"],e),EParenthesis:(e=function(t){return{_hx_index:2,e:t,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EParenthesis",e.__params__=["e"],e),EField:(e=function(t,e){return{_hx_index:3,e:t,f:e,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EField",e.__params__=["e","f"],e),EBinop:(e=function(t,e,i){return{_hx_index:4,op:t,e1:e,e2:i,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EBinop",e.__params__=["op","e1","e2"],e),EUnop:(e=function(t,e){return{_hx_index:5,op:t,e1:e,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EUnop",e.__params__=["op","e1"],e),ECall:(e=function(t,e){return{_hx_index:6,e:t,args:e,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="ECall",e.__params__=["e","args"],e),EBlock:(e=function(t){return{_hx_index:7,el:t,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EBlock",e.__params__=["el"],e),EVars:(e=function(t){return{_hx_index:8,v:t,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EVars",e.__params__=["v"],e),EFunction:(e=function(t){return{_hx_index:9,f:t,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EFunction",e.__params__=["f"],e),EIf:(e=function(t,e,i){return{_hx_index:10,econd:t,eif:e,eelse:i,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EIf",e.__params__=["econd","eif","eelse"],e),EDiscard:{_hx_name:"EDiscard",_hx_index:11,__enum__:"hxsl.ExprDef",toString:n},EFor:(e=function(t,e,i){return{_hx_index:12,v:t,loop:e,block:i,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EFor",e.__params__=["v","loop","block"],e),EReturn:(e=function(t){return{_hx_index:13,e:t,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EReturn",e.__params__=["e"],e),EBreak:{_hx_name:"EBreak",_hx_index:14,__enum__:"hxsl.ExprDef",toString:n},EContinue:{_hx_name:"EContinue",_hx_index:15,__enum__:"hxsl.ExprDef",toString:n},EArray:(e=function(t,e){return{_hx_index:16,e:t,eindex:e,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EArray",e.__params__=["e","eindex"],e),EArrayDecl:(e=function(t){return{_hx_index:17,el:t,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EArrayDecl",e.__params__=["el"],e),ESwitch:(e=function(t,e,i){return{_hx_index:18,e:t,cases:e,def:i,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="ESwitch",e.__params__=["e","cases","def"],e),EWhile:(e=function(t,e,i){return{_hx_index:19,cond:t,loop:e,normalWhile:i,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EWhile",e.__params__=["cond","loop","normalWhile"],e),EMeta:(e=function(t,e,i){return{_hx_index:20,name:t,args:e,e:i,__enum__:"hxsl.ExprDef",toString:n}},e._hx_name="EMeta",e.__params__=["name","args","e"],e)};$a.__constructs__=[$a.EConst,$a.EIdent,$a.EParenthesis,$a.EField,$a.EBinop,$a.EUnop,$a.ECall,$a.EBlock,$a.EVars,$a.EFunction,$a.EIf,$a.EDiscard,$a.EFor,$a.EReturn,$a.EBreak,$a.EContinue,$a.EArray,$a.EArrayDecl,$a.ESwitch,$a.EWhile,$a.EMeta],$a.__empty_constructs__=[$a.EDiscard,$a.EBreak,$a.EContinue];var tA=s["hxsl.FunctionKind"]={__ename__:!0,__constructs__:null,Vertex:{_hx_name:"Vertex",_hx_index:0,__enum__:"hxsl.FunctionKind",toString:n},Fragment:{_hx_name:"Fragment",_hx_index:1,__enum__:"hxsl.FunctionKind",toString:n},Init:{_hx_name:"Init",_hx_index:2,__enum__:"hxsl.FunctionKind",toString:n},Helper:{_hx_name:"Helper",_hx_index:3,__enum__:"hxsl.FunctionKind",toString:n}};tA.__constructs__=[tA.Vertex,tA.Fragment,tA.Init,tA.Helper],tA.__empty_constructs__=[tA.Vertex,tA.Fragment,tA.Init,tA.Helper];var eA=s["hxsl.TGlobal"]={__ename__:!0,__constructs__:null,Radians:{_hx_name:"Radians",_hx_index:0,__enum__:"hxsl.TGlobal",toString:n},Degrees:{_hx_name:"Degrees",_hx_index:1,__enum__:"hxsl.TGlobal",toString:n},Sin:{_hx_name:"Sin",_hx_index:2,__enum__:"hxsl.TGlobal",toString:n},Cos:{_hx_name:"Cos",_hx_index:3,__enum__:"hxsl.TGlobal",toString:n},Tan:{_hx_name:"Tan",_hx_index:4,__enum__:"hxsl.TGlobal",toString:n},Asin:{_hx_name:"Asin",_hx_index:5,__enum__:"hxsl.TGlobal",toString:n},Acos:{_hx_name:"Acos",_hx_index:6,__enum__:"hxsl.TGlobal",toString:n},Atan:{_hx_name:"Atan",_hx_index:7,__enum__:"hxsl.TGlobal",toString:n},Pow:{_hx_name:"Pow",_hx_index:8,__enum__:"hxsl.TGlobal",toString:n},Exp:{_hx_name:"Exp",_hx_index:9,__enum__:"hxsl.TGlobal",toString:n},Log:{_hx_name:"Log",_hx_index:10,__enum__:"hxsl.TGlobal",toString:n},Exp2:{_hx_name:"Exp2",_hx_index:11,__enum__:"hxsl.TGlobal",toString:n},Log2:{_hx_name:"Log2",_hx_index:12,__enum__:"hxsl.TGlobal",toString:n},Sqrt:{_hx_name:"Sqrt",_hx_index:13,__enum__:"hxsl.TGlobal",toString:n},Inversesqrt:{_hx_name:"Inversesqrt",_hx_index:14,__enum__:"hxsl.TGlobal",toString:n},Abs:{_hx_name:"Abs",_hx_index:15,__enum__:"hxsl.TGlobal",toString:n},Sign:{_hx_name:"Sign",_hx_index:16,__enum__:"hxsl.TGlobal",toString:n},Floor:{_hx_name:"Floor",_hx_index:17,__enum__:"hxsl.TGlobal",toString:n},Ceil:{_hx_name:"Ceil",_hx_index:18,__enum__:"hxsl.TGlobal",toString:n},Fract:{_hx_name:"Fract",_hx_index:19,__enum__:"hxsl.TGlobal",toString:n},Mod:{_hx_name:"Mod",_hx_index:20,__enum__:"hxsl.TGlobal",toString:n},Min:{_hx_name:"Min",_hx_index:21,__enum__:"hxsl.TGlobal",toString:n},Max:{_hx_name:"Max",_hx_index:22,__enum__:"hxsl.TGlobal",toString:n},Clamp:{_hx_name:"Clamp",_hx_index:23,__enum__:"hxsl.TGlobal",toString:n},Mix:{_hx_name:"Mix",_hx_index:24,__enum__:"hxsl.TGlobal",toString:n},Step:{_hx_name:"Step",_hx_index:25,__enum__:"hxsl.TGlobal",toString:n},Smoothstep:{_hx_name:"Smoothstep",_hx_index:26,__enum__:"hxsl.TGlobal",toString:n},Length:{_hx_name:"Length",_hx_index:27,__enum__:"hxsl.TGlobal",toString:n},Distance:{_hx_name:"Distance",_hx_index:28,__enum__:"hxsl.TGlobal",toString:n},Dot:{_hx_name:"Dot",_hx_index:29,__enum__:"hxsl.TGlobal",toString:n},Cross:{_hx_name:"Cross",_hx_index:30,__enum__:"hxsl.TGlobal",toString:n},Normalize:{_hx_name:"Normalize",_hx_index:31,__enum__:"hxsl.TGlobal",toString:n},LReflect:{_hx_name:"LReflect",_hx_index:32,__enum__:"hxsl.TGlobal",toString:n},Texture:{_hx_name:"Texture",_hx_index:33,__enum__:"hxsl.TGlobal",toString:n},TextureLod:{_hx_name:"TextureLod",_hx_index:34,__enum__:"hxsl.TGlobal",toString:n},Texel:{_hx_name:"Texel",_hx_index:35,__enum__:"hxsl.TGlobal",toString:n},TextureSize:{_hx_name:"TextureSize",_hx_index:36,__enum__:"hxsl.TGlobal",toString:n},ToInt:{_hx_name:"ToInt",_hx_index:37,__enum__:"hxsl.TGlobal",toString:n},ToFloat:{_hx_name:"ToFloat",_hx_index:38,__enum__:"hxsl.TGlobal",toString:n},ToBool:{_hx_name:"ToBool",_hx_index:39,__enum__:"hxsl.TGlobal",toString:n},Vec2:{_hx_name:"Vec2",_hx_index:40,__enum__:"hxsl.TGlobal",toString:n},Vec3:{_hx_name:"Vec3",_hx_index:41,__enum__:"hxsl.TGlobal",toString:n},Vec4:{_hx_name:"Vec4",_hx_index:42,__enum__:"hxsl.TGlobal",toString:n},IVec2:{_hx_name:"IVec2",_hx_index:43,__enum__:"hxsl.TGlobal",toString:n},IVec3:{_hx_name:"IVec3",_hx_index:44,__enum__:"hxsl.TGlobal",toString:n},IVec4:{_hx_name:"IVec4",_hx_index:45,__enum__:"hxsl.TGlobal",toString:n},BVec2:{_hx_name:"BVec2",_hx_index:46,__enum__:"hxsl.TGlobal",toString:n},BVec3:{_hx_name:"BVec3",_hx_index:47,__enum__:"hxsl.TGlobal",toString:n},BVec4:{_hx_name:"BVec4",_hx_index:48,__enum__:"hxsl.TGlobal",toString:n},Mat2:{_hx_name:"Mat2",_hx_index:49,__enum__:"hxsl.TGlobal",toString:n},Mat3:{_hx_name:"Mat3",_hx_index:50,__enum__:"hxsl.TGlobal",toString:n},Mat4:{_hx_name:"Mat4",_hx_index:51,__enum__:"hxsl.TGlobal",toString:n},Mat3x4:{_hx_name:"Mat3x4",_hx_index:52,__enum__:"hxsl.TGlobal",toString:n},Saturate:{_hx_name:"Saturate",_hx_index:53,__enum__:"hxsl.TGlobal",toString:n},Pack:{_hx_name:"Pack",_hx_index:54,__enum__:"hxsl.TGlobal",toString:n},Unpack:{_hx_name:"Unpack",_hx_index:55,__enum__:"hxsl.TGlobal",toString:n},PackNormal:{_hx_name:"PackNormal",_hx_index:56,__enum__:"hxsl.TGlobal",toString:n},UnpackNormal:{_hx_name:"UnpackNormal",_hx_index:57,__enum__:"hxsl.TGlobal",toString:n},ScreenToUv:{_hx_name:"ScreenToUv",_hx_index:58,__enum__:"hxsl.TGlobal",toString:n},UvToScreen:{_hx_name:"UvToScreen",_hx_index:59,__enum__:"hxsl.TGlobal",toString:n},DFdx:{_hx_name:"DFdx",_hx_index:60,__enum__:"hxsl.TGlobal",toString:n},DFdy:{_hx_name:"DFdy",_hx_index:61,__enum__:"hxsl.TGlobal",toString:n},Fwidth:{_hx_name:"Fwidth",_hx_index:62,__enum__:"hxsl.TGlobal",toString:n},ChannelRead:{_hx_name:"ChannelRead",_hx_index:63,__enum__:"hxsl.TGlobal",toString:n},ChannelReadLod:{_hx_name:"ChannelReadLod",_hx_index:64,__enum__:"hxsl.TGlobal",toString:n},ChannelFetch:{_hx_name:"ChannelFetch",_hx_index:65,__enum__:"hxsl.TGlobal",toString:n},ChannelTextureSize:{_hx_name:"ChannelTextureSize",_hx_index:66,__enum__:"hxsl.TGlobal",toString:n},Trace:{_hx_name:"Trace",_hx_index:67,__enum__:"hxsl.TGlobal",toString:n},VertexID:{_hx_name:"VertexID",_hx_index:68,__enum__:"hxsl.TGlobal",toString:n},InstanceID:{_hx_name:"InstanceID",_hx_index:69,__enum__:"hxsl.TGlobal",toString:n},FragCoord:{_hx_name:"FragCoord",_hx_index:70,__enum__:"hxsl.TGlobal",toString:n},FrontFacing:{_hx_name:"FrontFacing",_hx_index:71,__enum__:"hxsl.TGlobal",toString:n}};eA.__constructs__=[eA.Radians,eA.Degrees,eA.Sin,eA.Cos,eA.Tan,eA.Asin,eA.Acos,eA.Atan,eA.Pow,eA.Exp,eA.Log,eA.Exp2,eA.Log2,eA.Sqrt,eA.Inversesqrt,eA.Abs,eA.Sign,eA.Floor,eA.Ceil,eA.Fract,eA.Mod,eA.Min,eA.Max,eA.Clamp,eA.Mix,eA.Step,eA.Smoothstep,eA.Length,eA.Distance,eA.Dot,eA.Cross,eA.Normalize,eA.LReflect,eA.Texture,eA.TextureLod,eA.Texel,eA.TextureSize,eA.ToInt,eA.ToFloat,eA.ToBool,eA.Vec2,eA.Vec3,eA.Vec4,eA.IVec2,eA.IVec3,eA.IVec4,eA.BVec2,eA.BVec3,eA.BVec4,eA.Mat2,eA.Mat3,eA.Mat4,eA.Mat3x4,eA.Saturate,eA.Pack,eA.Unpack,eA.PackNormal,eA.UnpackNormal,eA.ScreenToUv,eA.UvToScreen,eA.DFdx,eA.DFdy,eA.Fwidth,eA.ChannelRead,eA.ChannelReadLod,eA.ChannelFetch,eA.ChannelTextureSize,eA.Trace,eA.VertexID,eA.InstanceID,eA.FragCoord,eA.FrontFacing],eA.__empty_constructs__=[eA.Radians,eA.Degrees,eA.Sin,eA.Cos,eA.Tan,eA.Asin,eA.Acos,eA.Atan,eA.Pow,eA.Exp,eA.Log,eA.Exp2,eA.Log2,eA.Sqrt,eA.Inversesqrt,eA.Abs,eA.Sign,eA.Floor,eA.Ceil,eA.Fract,eA.Mod,eA.Min,eA.Max,eA.Clamp,eA.Mix,eA.Step,eA.Smoothstep,eA.Length,eA.Distance,eA.Dot,eA.Cross,eA.Normalize,eA.LReflect,eA.Texture,eA.TextureLod,eA.Texel,eA.TextureSize,eA.ToInt,eA.ToFloat,eA.ToBool,eA.Vec2,eA.Vec3,eA.Vec4,eA.IVec2,eA.IVec3,eA.IVec4,eA.BVec2,eA.BVec3,eA.BVec4,eA.Mat2,eA.Mat3,eA.Mat4,eA.Mat3x4,eA.Saturate,eA.Pack,eA.Unpack,eA.PackNormal,eA.UnpackNormal,eA.ScreenToUv,eA.UvToScreen,eA.DFdx,eA.DFdy,eA.Fwidth,eA.ChannelRead,eA.ChannelReadLod,eA.ChannelFetch,eA.ChannelTextureSize,eA.Trace,eA.VertexID,eA.InstanceID,eA.FragCoord,eA.FrontFacing];var iA=s["hxsl.Component"]={__ename__:!0,__constructs__:null,X:{_hx_name:"X",_hx_index:0,__enum__:"hxsl.Component",toString:n},Y:{_hx_name:"Y",_hx_index:1,__enum__:"hxsl.Component",toString:n},Z:{_hx_name:"Z",_hx_index:2,__enum__:"hxsl.Component",toString:n},W:{_hx_name:"W",_hx_index:3,__enum__:"hxsl.Component",toString:n}};iA.__constructs__=[iA.X,iA.Y,iA.Z,iA.W],iA.__empty_constructs__=[iA.X,iA.Y,iA.Z,iA.W];var nA=s["hxsl.TExprDef"]={__ename__:!0,__constructs__:null,TConst:(e=function(t){return{_hx_index:0,c:t,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TConst",e.__params__=["c"],e),TVar:(e=function(t){return{_hx_index:1,v:t,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TVar",e.__params__=["v"],e),TGlobal:(e=function(t){return{_hx_index:2,g:t,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TGlobal",e.__params__=["g"],e),TParenthesis:(e=function(t){return{_hx_index:3,e:t,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TParenthesis",e.__params__=["e"],e),TBlock:(e=function(t){return{_hx_index:4,el:t,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TBlock",e.__params__=["el"],e),TBinop:(e=function(t,e,i){return{_hx_index:5,op:t,e1:e,e2:i,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TBinop",e.__params__=["op","e1","e2"],e),TUnop:(e=function(t,e){return{_hx_index:6,op:t,e1:e,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TUnop",e.__params__=["op","e1"],e),TVarDecl:(e=function(t,e){return{_hx_index:7,v:t,init:e,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TVarDecl",e.__params__=["v","init"],e),TCall:(e=function(t,e){return{_hx_index:8,e:t,args:e,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TCall",e.__params__=["e","args"],e),TSwiz:(e=function(t,e){return{_hx_index:9,e:t,regs:e,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TSwiz",e.__params__=["e","regs"],e),TIf:(e=function(t,e,i){return{_hx_index:10,econd:t,eif:e,eelse:i,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TIf",e.__params__=["econd","eif","eelse"],e),TDiscard:{_hx_name:"TDiscard",_hx_index:11,__enum__:"hxsl.TExprDef",toString:n},TReturn:(e=function(t){return{_hx_index:12,e:t,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TReturn",e.__params__=["e"],e),TFor:(e=function(t,e,i){return{_hx_index:13,v:t,it:e,loop:i,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TFor",e.__params__=["v","it","loop"],e),TContinue:{_hx_name:"TContinue",_hx_index:14,__enum__:"hxsl.TExprDef",toString:n},TBreak:{_hx_name:"TBreak",_hx_index:15,__enum__:"hxsl.TExprDef",toString:n},TArray:(e=function(t,e){return{_hx_index:16,e:t,index:e,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TArray",e.__params__=["e","index"],e),TArrayDecl:(e=function(t){return{_hx_index:17,el:t,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TArrayDecl",e.__params__=["el"],e),TSwitch:(e=function(t,e,i){return{_hx_index:18,e:t,cases:e,def:i,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TSwitch",e.__params__=["e","cases","def"],e),TWhile:(e=function(t,e,i){return{_hx_index:19,e:t,loop:e,normalWhile:i,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TWhile",e.__params__=["e","loop","normalWhile"],e),TMeta:(e=function(t,e,i){return{_hx_index:20,m:t,args:e,e:i,__enum__:"hxsl.TExprDef",toString:n}},e._hx_name="TMeta",e.__params__=["m","args","e"],e)};nA.__constructs__=[nA.TConst,nA.TVar,nA.TGlobal,nA.TParenthesis,nA.TBlock,nA.TBinop,nA.TUnop,nA.TVarDecl,nA.TCall,nA.TSwiz,nA.TIf,nA.TDiscard,nA.TReturn,nA.TFor,nA.TContinue,nA.TBreak,nA.TArray,nA.TArrayDecl,nA.TSwitch,nA.TWhile,nA.TMeta],nA.__empty_constructs__=[nA.TDiscard,nA.TContinue,nA.TBreak];var sA=function(){};i["hxsl.Tools"]=sA,sA.__name__="hxsl.Tools",sA.allocVarId=function(){return++sA.UID},sA.getName=function(t){if(null==t.qualifiers)return t.name;for(var e=0,i=t.qualifiers;e<i.length;){var n=i[e];if(++e,4==n._hx_index)return n.n}return t.name},sA.getDoc=function(t){if(null==t.qualifiers)return null;for(var e=0,i=t.qualifiers;e<i.length;){var n=i[e];if(++e,10==n._hx_index)return n.s}return null},sA.getConstBits=function(t){var e=t.type;switch(e._hx_index){case 1:for(var i=0,n=t.qualifiers;i<n.length;){var s=n[i];if(++i,0==s._hx_index){var r=s.max;if(null!=r){for(var a=0;r>=1<<a;)++a;return a}return 8}}break;case 2:return 1;case 17:i=e.size;return 3+sA.MAX_CHANNELS_BITS}return 0},sA.isConst=function(t){var e;if(17==(n=t.type)._hx_index){var i=n.size;e=!0}else e=!1;if(e)return!0;if(null!=t.qualifiers){var n=0;for(i=t.qualifiers;n<i.length;){var s=i[n];if(++n,0==s._hx_index){s.max;return!0}}}return!1},sA.isStruct=function(t){var e=t.type;if(13==e._hx_index){e.vl;return!0}return!1},sA.isArray=function(t){var e=t.type;if(15==e._hx_index){e.t,e.size;return!0}return!1},sA.hasQualifier=function(t,e){if(null!=t.qualifiers)for(var i=0,n=t.qualifiers;i<n.length;){var s=n[i];if(++i,s==e)return!0}return!1},sA.hasBorrowQualifier=function(t,e){if(null!=t.qualifiers)for(var i=0,n=t.qualifiers;i<n.length;){var s=n[i];if(++i,11==s._hx_index)return e==s.source}return!1},sA.isSampler=function(t){switch(t._hx_index){case 10:case 11:case 12:return!0;case 17:t.size;return!0;default:return!1}},sA.toString=function(t){switch(t._hx_index){case 5:var e,i=t.size;switch((h=t.t)._hx_index){case 0:e="I";break;case 1:e="";break;case 2:e="B"}return e+"Vec"+i;case 9:return"Bytes"+t.size;case 13:for(var n=t.vl,r=[],a=0;a<n.length;){var A=n[a];++a,r.push(A.name+" : "+sA.toString(A.type))}return"{"+r.join(",")+"}";case 15:var h=t.t,o=t.size,u=sA.toString(h)+"[";switch(o._hx_index){case 0:_=""+o.v;break;case 1:_=(A=o.v).name}return u+_+"]";case 16:var _;h=t.t,o=t.size,u="buffer "+sA.toString(h)+"[";switch(o._hx_index){case 0:_=""+o.v;break;case 1:_=(A=o.v).name}return u+_+"]";default:return l.substr(s[t.__enum__].__constructs__[t._hx_index]._hx_name,1,null)}},sA.toType=function(t){switch(t._hx_index){case 0:return Xa.TInt;case 1:return Xa.TFloat;case 2:return Xa.TBool}},sA.hasSideEffect=function(t){var e=t.e;switch(e._hx_index){case 0:var i=e.c;return!1;case 1:i=e.v;return!1;case 2:i=e.g;return!1;case 3:t=e.e;return sA.hasSideEffect(t);case 4:var n=e.el;for(i=0;i<n.length;){t=n[i];if(++i,sA.hasSideEffect(t))return!0}return!1;case 5:i=e.op;var s=e.e1,r=e.e2;switch(i._hx_index){case 4:return!0;case 20:i.op;return!0;default:var a=r;return!!sA.hasSideEffect(A=s)||sA.hasSideEffect(a)}break;case 6:i=e.op;var A=e.e1;return sA.hasSideEffect(A);case 7:i=e.v,i=e.init;return!0;case 8:t=e.e;var h,o=e.args;if(2==(i=t.e)._hx_index){s=i.g;h=!0}else h=!1;if(!h)return!0;for(i=0;i<o.length;){var l=o[i];if(++i,sA.hasSideEffect(l))return!0}return!1;case 9:i=e.regs,t=e.e;return sA.hasSideEffect(t);case 10:var u=e.econd,_=e.eif,c=e.eelse;return!(!sA.hasSideEffect(u)&&!sA.hasSideEffect(_))||null!=c&&sA.hasSideEffect(c);case 11:case 14:case 15:return!0;case 12:i=e.e;return!0;case 13:i=e.v;var d=e.it,f=e.loop;return!!sA.hasSideEffect(d)||sA.hasSideEffect(f);case 16:t=e.e;var x=e.index;return!!sA.hasSideEffect(t)||sA.hasSideEffect(x);case 17:for(n=e.el,i=0;i<n.length;){t=n[i];if(++i,sA.hasSideEffect(t))return!0}return!1;case 18:t=e.e;var p=e.cases,g=e.def;for(i=0;i<p.length;){var m=p[i];++i;for(s=0,r=m.values;s<r.length;){var v=r[s];if(++s,sA.hasSideEffect(v))return!0}if(sA.hasSideEffect(m.expr))return!0}return!!sA.hasSideEffect(t)||null!=g&&sA.hasSideEffect(g);case 19:i=e.normalWhile,t=e.e,f=e.loop;return!!sA.hasSideEffect(t)||sA.hasSideEffect(f);case 20:i=e.m,i=e.args,t=e.e;return sA.hasSideEffect(t)}},sA.iter=function(t,e){var i=t.e;switch(i._hx_index){case 0:var n=i.c;break;case 1:n=i.v;break;case 2:n=i.g;break;case 3:e(t=i.e);break;case 4:var s=i.el;for(n=0;n<s.length;){t=s[n];++n,e(t)}break;case 5:n=i.op;var r=i.e1,a=i.e2;e(r),e(a);break;case 6:n=i.op;e(r=i.e1);break;case 7:n=i.v;var A=i.init;null!=A&&e(A);break;case 8:t=i.e;var h=i.args;e(t);for(n=0;n<h.length;){var o=h[n];++n,e(o)}break;case 9:n=i.regs;e(t=i.e);break;case 10:var l=i.econd,u=i.eif,_=i.eelse;e(l),e(u),null!=_&&e(_);break;case 11:case 14:case 15:break;case 12:null!=(t=i.e)&&e(t);break;case 13:n=i.v;var c=i.it,d=i.loop;e(c),e(d);break;case 16:t=i.e;var f=i.index;e(t),e(f);break;case 17:for(s=i.el,n=0;n<s.length;){t=s[n];++n,e(t)}break;case 18:t=i.e;var x=i.cases,p=i.def;e(t);for(n=0;n<x.length;){var g=x[n];++n;for(var m=0,v=g.values;m<v.length;){var y=v[m];++m,e(y)}e(g.expr)}null!=p&&e(p);break;case 19:n=i.normalWhile,t=i.e,d=i.loop;e(t),e(d);break;case 20:n=i.m,n=i.args;e(t=i.e)}},sA.map=function(t,e){var i,n=t.e;switch(n._hx_index){case 0:var s=n.c;i=t.e;break;case 1:s=n.v;i=t.e;break;case 2:s=n.g;i=t.e;break;case 3:var r=n.e;i=nA.TParenthesis(e(r));break;case 4:for(var a=n.el,A=(s=[],0);A<a.length;){r=a[A];++A,s.push(e(r))}i=nA.TBlock(s);break;case 5:var h=n.op,o=(r=n.e1,n.e2);i=nA.TBinop(h,e(r),e(o));break;case 6:h=n.op,r=n.e1;i=nA.TUnop(h,e(r));break;case 7:var l=n.v,u=n.init;i=nA.TVarDecl(l,null!=u?e(u):null);break;case 8:r=n.e;var _=n.args,c=e(r);for(s=[],A=0;A<_.length;){var d=_[A];++A,s.push(e(d))}i=nA.TCall(c,s);break;case 9:r=n.e;var f=n.regs;i=nA.TSwiz(e(r),f);break;case 10:var x=n.econd,p=n.eif,g=n.eelse;i=nA.TIf(e(x),e(p),null!=g?e(g):null);break;case 11:case 14:case 15:i=t.e;break;case 12:r=n.e;i=nA.TReturn(null!=r?e(r):null);break;case 13:l=n.v;var m=n.it,v=n.loop;i=nA.TFor(l,e(m),e(v));break;case 16:r=n.e;var y=n.index;i=nA.TArray(e(r),e(y));break;case 17:for(a=n.el,s=[],A=0;A<a.length;){r=a[A];++A,s.push(e(r))}i=nA.TArrayDecl(s);break;case 18:r=n.e;var b=n.cases,w=n.def;for(c=e(r),s=[],A=0;A<b.length;){f=b[A];++A;for(var M=[],B=0,C=f.values;B<C.length;){l=C[B];++B,M.push(e(l))}s.push({values:M,expr:e(f.expr)})}i=nA.TSwitch(c,s,null==w?null:e(w));break;case 19:r=n.e,v=n.loop;var S=n.normalWhile;i=nA.TWhile(e(r),e(v),S);break;case 20:var I=n.m;_=n.args,r=n.e;i=nA.TMeta(I,_,e(r))}return{e:i,t:t.t,p:t.p}},sA.size=function(t){switch(t._hx_index){case 0:case 2:case 4:case 10:case 11:case 12:return 0;case 1:case 3:return 1;case 5:var e=t.t;return t.size;case 6:return 9;case 7:return 16;case 8:return 12;case 9:return n=t.size;case 13:var i=t.vl,n=0;for(e=0;e<i.length;){var s=i[e];++e,n+=sA.size(s.type)}return n;case 14:e=t.variants;return 0;case 15:e=t.t;var r=t.size;switch(r._hx_index){case 0:s=r.v;return sA.size(a=e)*s;case 1:e=r.v;return 0}break;case 16:if(0==(e=t.size)._hx_index){s=e.v;var a=t.t;return sA.size(a)*s}return 0;case 17:return t.size;case 18:return 4}},sA.evalConst=function(t){switch((s=t.e)._hx_index){case 0:var e=s.c;switch(e._hx_index){case 0:return null;case 1:return e.b;case 2:return e.v;case 3:return e.v;case 4:return e.v}break;case 8:var i=s.e,n=s.args,s=i.e;i.p,i.t;if(2!=s._hx_index)throw kn.thrown("Unhandled constant init "+SA.toString(t));switch(s.g._hx_index){case 40:case 41:case 42:var r=n;for(s=[],i=0;i<r.length;){var a=r[i];++i,s.push(sA.evalConst(a))}var A=s;return 1==A.length?new Yt(A[0],A[0],A[0],A[0]):new Yt(A[0],A[1],A[2],A[3]);default:throw kn.thrown("Unhandled constant init "+SA.toString(t))}break;default:throw kn.thrown("Unhandled constant init "+SA.toString(t))}};var rA=function(){};i["hxsl.Tools2"]=rA,rA.__name__="hxsl.Tools2",rA.toString=function(t){var e=s[t.__enum__].__constructs__[t._hx_index]._hx_name;return e.charAt(0).toLowerCase()+l.substr(e,1,null)};var aA=function(){};i["hxsl.Tools3"]=aA,aA.__name__="hxsl.Tools3",aA.toString=function(t){return SA.shaderToString(t)};var AA=function(){};i["hxsl.Tools4"]=AA,AA.__name__="hxsl.Tools4",AA.toString=function(t){return SA.toString(t)};var hA=function(){this.Batch_Count__=0,ri.call(this)};i["hxsl.BatchShader"]=hA,hA.__name__="hxsl.BatchShader",hA.__super__=ri,hA.prototype=r(ri.prototype,{get_Batch_Count:function(){return this.Batch_Count__},set_Batch_Count:function(t){return this.constModified=!0,this.Batch_Count__=t},get_Batch_Buffer:function(){return this.Batch_Buffer__},set_Batch_Buffer:function(t){return this.Batch_Buffer__=t},updateConstants:function(t){this.constBits=0;var e=this.Batch_Count__;if(e>>>17!=0)throw kn.thrown("Batch_Count is out of range "+e+">131071");this.constBits|=e,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.Batch_Count__;case 1:return this.Batch_Buffer__}return null},getParamFloatValue:function(t){return 0},clone:function(){var t=Object.create(hA.prototype);return t.shader=this.shader,t.Batch_Count__=this.Batch_Count__,t.Batch_Buffer__=this.Batch_Buffer__,t},__class__:hA});var oA=function(){};i["hxsl.SearchMap"]=oA,oA.__name__="hxsl.SearchMap",oA.prototype={__class__:oA};var lA=function(){this.constsToGlobal=!1,this.linkCache=new oA,this.linkShaders=new Kn,this.batchShaders=new Wn,this.byID=new Kn};i["hxsl.Cache"]=lA,lA.__name__="hxsl.Cache",lA.get=function(){var t=lA.INST;return null==t&&(t=new lA,lA.INST=t),t},lA.set=function(t){lA.INST=t},lA.clear=function(){lA.INST=null},lA.prototype={getLinkShader:function(t){for(var e=[],i=0;i<t.length;){var n=t[i];++i,e.push(x.string(n))}var s=e.join(","),r=this.linkShaders.h[s];if(null!=r)return r;var a=new QA(""),A=l.substr(Nn.encode(s),0,8);a.data={name:"shaderLinker_"+A,vars:[],funs:[]};var h=null,o=Object.create(null),u=0,_=Xa.TVec(4,ja.VFloat),c=function(t,e,i,n){for(var s=[],r=e,a=0,A=i.length;a<A;){var o=a++,l=n(i[i.length-1-o],r-(i.length-1-o));r-=sA.size(l.t),s.unshift(l)}return{e:nA.TCall({e:nA.TGlobal(t),t:Xa.TVoid,p:h},s),t:Xa.TVec(e,ja.VFloat),p:h}},d=function(t,e,i){var n=null==i?t:sA.getName(i)+"."+t,s=o[n];if(null!=s)return s;if(s={id:sA.allocVarId(),name:t,type:e,kind:Za.Var,parent:i},null==i)a.data.vars.push(s);else{var r=i.type;if(13!=r._hx_index)throw kn.thrown("assert");r.vl.push(s)}return o[n]=s,s},f=null;f=function(t,e){switch(t._hx_index){case 0:var i=t.v;return{e:nA.TConst(Ka.CFloat(i)),t:Xa.TFloat,p:h};case 1:var n=t.v,s=t.size;if(null!=(i=o[n]))return{e:nA.TVar(i),t:i.type,p:h};for(var r=n.split("."),a=null;r.length>1;)a=d(r.shift(),Xa.TStruct([]),a);return null!=s&&(e=s),i=d(r.shift(),1==e?Xa.TFloat:Xa.TVec(e,ja.VFloat),a),{e:nA.TVar(i),t:i.type,p:h};case 2:i=t.v;return{e:nA.TCall({e:nA.TGlobal(eA.PackNormal),t:Xa.TVoid,p:h},[f(i,3)]),t:_,p:h};case 3:i=t.v;return{e:nA.TCall({e:nA.TGlobal(eA.Pack),t:Xa.TVoid,p:h},[f(i,1)]),t:_,p:h};case 4:var A=t.a;return c(eA.Vec2,2,A,f);case 5:A=t.a;return c(eA.Vec3,3,A,f);case 6:A=t.a;return c(eA.Vec4,4,A,f);case 7:i=t.a;var l=t.swiz;return{e:nA.TSwiz(f(i,4),l),t:Xa.TVec(l.length,ja.VFloat),p:h}}};var p=function(t){u+=1;var e={id:sA.allocVarId(),type:_,name:"OUTPUT"+(u-1),kind:Za.Output};return a.data.vars.push(e),{e:nA.TBinop(_s.OpAssign,{e:nA.TVar(e),t:_,p:h},f(t,4)),t:Xa.TVoid,p:h}},g=function(t,e){for(var i={id:sA.allocVarId(),type:Xa.TFun([]),name:(""+x.string(t)).toLowerCase(),kind:Za.Function},n=[],s=0;s<e.length;){var r=e[s];++s,n.push(p(r))}var A={kind:t,ref:i,args:[],ret:Xa.TVoid,expr:{e:nA.TBlock(n),p:h,t:Xa.TVoid}};a.data.funs.push(A)};return g(tA.Vertex,[CA.Value("output.position")]),g(tA.Fragment,t),(r=Object.create(ri.prototype)).shader=a,this.linkShaders.h[s]=r,r.updateConstantsFinal(null),r},link:function(t,e){for(var i=this.linkCache,n=t;null!=n;){var s=n.s;n=n.next;var r=s.instance;null==i.next&&(i.next=new Wn);var a=i.next.h[r.id];null==a&&(a=new oA,i.next.h[r.id]=a),i=a}return null==i.linked&&(i.linked=this.compileRuntimeShader(t,e)),i.linked},compileRuntimeShader:function(t,e){for(var i=[],n=0,s=t;null!=s;){var r=s.s;s=s.next;var a=(u=r).instance;i.push({inst:a,p:u.priority,index:n++})}i.reverse(),Yn.sort(i,(function(t,e){return e.p-t.p}));for(var A=0;A<i.length;){r=i[A];++A,SA.check(r.inst.shader)}var h=new BA(e);try{A=[];for(var o=0;o<i.length;){var u=i[o];++o,A.push(u.inst.shader)}r=h.link(A)}catch(A){o=kn.caught(A).unwrap();if(o instanceof Wa){for(var _=o,c=(o=[],0);c<i.length;){u=i[c];++c,o.push(SA.shaderToString(u.inst.shader))}var d=o;throw _.msg+="\n\nin\n\n"+d.join("\n-----\n"),kn.thrown(_)}throw A}if(e){var f=null;f=function(t){if(null!=t.qualifiers&&t.qualifiers.indexOf(Ja.PerObject)>=0&&(1==t.qualifiers.length?t.qualifiers=null:(t.qualifiers=t.qualifiers.slice(),l.remove(t.qualifiers,Ja.PerObject)),t.kind!=Za.Var&&(t.kind=Za.Local)),13==(i=t.type)._hx_index)for(var e=i.vl,i=0;i<e.length;){t=e[i];++i,f(t)}};for(A=0,o=r.vars;A<o.length;){var x=o[A];++A,f(x)}}for(A=[],o=0;o<i.length;){u=i[o];++o,A.push(u.inst.shader)}SA.check(r,A);var p=new Wn;for(A=0,o=h.allVars;A<o.length;){x=o[A];if(++A,x.v.kind==Za.Param){if(13==(c=x.v.type)._hx_index){c.vl;continue}var g=i[x.instanceIndex];p.h[x.id]={instance:g.index,index:g.inst.params.h[x.merged[0].id]}}}var m=r;try{u=(new OA).split(r)}catch(A){o=kn.caught(A).unwrap();if(o instanceof Wa)throw(_=o).msg+="\n\nin\n\n"+SA.shaderToString(r),kn.thrown(_);throw A}SA.check(u.vertex,[m]),SA.check(u.fragment,[m]);m=u,r=(new fA).dce(u.vertex,u.fragment);SA.check(r.vertex,[m.vertex]),SA.check(r.fragment,[m.fragment]);for(var v=this.buildRuntimeShader(r.vertex,r.fragment,p),y=(A=[],t);null!=y;){r=y.s;y=y.next;u=r;A.push(new FA(u.shader,u.constBits))}v.spec={instances:A,signature:null};for(A=0,o=i.length;A<o;){a=A++,r=i[i.length-1-a];v.spec.instances[r.index].index=a}for(A=[],o=0,c=v.spec.instances;o<c.length;){a=c[o];++o,A.push(a.shader.data.name+"_"+a.bits+"_"+a.index)}var b=A.join(":");v.spec.signature=Nn.encode(b),v.signature=Nn.encode(SA.shaderToString(v.vertex.data)+SA.shaderToString(v.fragment.data)),v.batchMode=e;var w=this.byID.h[v.signature];return null!=w?v.id=w.id:this.byID.h[v.signature]=v,v},buildRuntimeShader:function(t,e,i){var n=new TA;return n.vertex=this.flattenShader(t,tA.Vertex,i),n.vertex.vertex=!0,n.fragment=this.flattenShader(e,tA.Fragment,i),n.globals=new Wn,this.initGlobals(n,n.vertex),this.initGlobals(n,n.fragment),SA.check(n.vertex.data,[t]),SA.check(n.fragment.data,[e]),n},initGlobals:function(t,e){for(var i=e.globals;null!=i;)t.globals.h[i.gid]=!0,i=i.next;for(i=e.params;null!=i;)null!=i.perObjectGlobal&&(t.globals.h[i.perObjectGlobal.gid]=!0),i=i.next},getPath:function(t){return null==t.parent?t.name:this.getPath(t.parent)+"."+t.name},flattenShader:function(t,e,i){var n=new mA,s=new EA,r=n.flatten(t,e,this.constsToGlobal),a=[];s.consts=n.consts,s.texturesCount=0;for(var A=n.allocData.keys();A.hasNext();){var h=A.next(),o=n.allocData.h[h.__id__];switch(h.kind._hx_index){case 0:for(var l=[],u=0;u<o.length;){var _=o[u];++u,null!=_.v&&l.push(new kA(_.pos,this.getPath(_.v),_.v.type))}for(var c=l,d=0,f=c.length-1;d<f;){c[L=d++].next=c[L+1]}var x=h.type;if(15!=x._hx_index)throw kn.thrown("assert");var p=x.t,g=x.size;if(5!=p._hx_index)throw kn.thrown("assert");if(4!=p.size)throw kn.thrown("assert");if(1!=p.t._hx_index)throw kn.thrown("assert");if(0!=g._hx_index)throw kn.thrown("assert");var m=g.v;s.globals=c[0],s.globalsSize=m;break;case 2:for(var v=[],y=0,b=0;b<o.length;){var w=o[b];if(++b,null!=w.v){var M=i.h[w.v.id];if(null!=M){var B=new IA(w.v.name,w.pos,M.instance,M.index,w.v.type),C=w.v.type;if(15==C._hx_index){C.size;var S=C.t;sA.isSampler(S)?(B.pos=-w.size,y+=w.size):++y}else++y;v.push(B)}else{var I=new IA(w.v.name,w.pos,-1,-1,w.v.type);I.perObjectGlobal=new kA(-1,this.getPath(w.v),w.v.type),v.push(I),++y}}}for(var k=0,E=v.length-1;k<E;){var F=k++;v[F].next=v[F+1]}var T=h.type;if(15!=T._hx_index)throw kn.thrown("assert");var D=T.t,P=T.size,z=D;if(sA.isSampler(z))a.push({t:z,all:v}),s.texturesCount+=y;else switch(D._hx_index){case 5:if(4!=D.size)throw kn.thrown("assert");if(1!=D.t._hx_index)throw kn.thrown("assert");if(0!=P._hx_index)throw kn.thrown("assert");var R=P.v;s.params=v[0],s.paramsSize=R;break;case 16:D.t,D.size;s.buffers=v[0],s.bufferCount=v.length;break;default:throw kn.thrown("assert")}break;default:throw kn.thrown("assert")}}if(a.length>0){a.sort((function(t,e){return t.t._hx_index-e.t._hx_index})),s.textures=a[0].all[0];for(l=1,u=a.length;l<u;){var L,V=a[(L=l++)-1].all;V[V.length-1].next=a[L].all[0]}}return null==s.globals&&(s.globalsSize=0),null==s.params&&(s.paramsSize=0),null==s.buffers&&(s.bufferCount=0),s.data=r,s},makeBatchShader:function(t){var e=this.batchShaders.h[t.id];null==e&&(e=this.createBatchShader(t),this.batchShaders.h[t.id]=e);var i=Object.create(hA.prototype);return i.shader=e,i},createBatchShader:function(t){var e=new QA(""),i=l.substr(t.spec.signature,0,8),n=function(t,e,i){return{id:sA.allocVarId(),type:e,name:t,kind:i}},s=null,r=n("Batch_Count",Xa.TInt,Za.Param),a=n("Batch_Buffer",Xa.TBuffer(Xa.TVec(4,ja.VFloat),Ha.SVar(r)),Za.Param),A=n("Batch_Offset",Xa.TInt,Za.Local),h={e:nA.TVar(a),p:s,t:a.type},o={e:nA.TVar(A),p:s,t:A.type},u=Xa.TVec(4,ja.VFloat);r.qualifiers=[Ja.Const(65536)],e.data={name:"batchShader_"+i,vars:[r,a,A],funs:[]};for(var _=t.vertex.paramsSize+t.fragment.paramsSize,c=new qn,d=[[iA.X],[iA.Y],[iA.Z],[iA.W]],f=function(t){return{e:nA.TArray(h,{e:nA.TBinop(_s.OpAdd,o,{e:nA.TConst(Ka.CInt(t)),t:Xa.TInt,p:s}),t:Xa.TInt,p:s}),t:u,p:s}},p=function(t,i){var r=n(t.name,t.type,Za.Local);if(null!=t.perObjectGlobal){var a=t.perObjectGlobal.path.split(".");a.pop();for(var A=r;a.length>0;){a.join(".");var h=a.pop(),o=c.h[a.__id__];if(null==o&&(o=n(h,Xa.TStruct([]),Za.Local),c.set(a,o)),13==(u=o.type)._hx_index)u.vl.push(A);A.parent=o,A=o}}e.data.vars.push(r);var l,u,_=(t.pos>>2)+i;switch((u=t.type)._hx_index){case 3:l={p:s,t:t.type,e:nA.TSwiz(f(_),d[3&t.pos])};break;case 5:var p=u.t;switch(u.size){case 2:if(1!=p._hx_index)throw kn.thrown("Unsupported batch var type "+x.string(t.type));var g;switch(3&t.pos){case 0:g=[iA.X,iA.Y];break;case 1:g=[iA.Y,iA.Z];break;default:g=[iA.Z,iA.W]}l={p:s,t:t.type,e:nA.TSwiz(f(_),g)};break;case 3:if(1!=p._hx_index)throw kn.thrown("Unsupported batch var type "+x.string(t.type));l={p:s,t:t.type,e:nA.TSwiz(f(_),0==(3&t.pos)?[iA.X,iA.Y,iA.Z]:[iA.Y,iA.Z,iA.W])};break;case 4:if(1!=p._hx_index)throw kn.thrown("Unsupported batch var type "+x.string(t.type));l=f(_);break;default:throw kn.thrown("Unsupported batch var type "+x.string(t.type))}break;case 7:l={p:s,t:t.type,e:nA.TCall({e:nA.TGlobal(eA.Mat4),t:Xa.TVoid,p:s},[f(_),f(_+1),f(_+2),f(_+3)])};break;default:throw kn.thrown("Unsupported batch var type "+x.string(t.type))}return{p:s,e:nA.TBinop(_s.OpAssign,{e:nA.TVar(r),p:s,t:t.type},l),t:Xa.TVoid}},g=[],m=t.vertex.params;null!=m;)g.push(p(m,0)),m=m.next;for(m=t.fragment.params;null!=m;)g.push(p(m,t.vertex.paramsSize)),m=m.next;g.unshift({p:s,e:nA.TBinop(_s.OpAssign,o,{p:s,t:Xa.TInt,e:nA.TBinop(_s.OpMult,{e:nA.TGlobal(eA.InstanceID),t:Xa.TInt,p:s},{e:nA.TConst(Ka.CInt(_)),p:s,t:Xa.TInt})}),t:Xa.TVoid});var v=n("init",Xa.TFun([]),Za.Function),y={kind:tA.Init,ref:v,args:[],ret:Xa.TVoid,expr:{e:nA.TBlock(g),p:s,t:Xa.TVoid}};return e.data.funs.push(y),e.consts=new VA(r,0,16),e.consts.globalId=0,e},__class__:lA};var uA=s["hxsl.Channel"]={__ename__:!0,__constructs__:null,Unknown:{_hx_name:"Unknown",_hx_index:0,__enum__:"hxsl.Channel",toString:n},R:{_hx_name:"R",_hx_index:1,__enum__:"hxsl.Channel",toString:n},G:{_hx_name:"G",_hx_index:2,__enum__:"hxsl.Channel",toString:n},B:{_hx_name:"B",_hx_index:3,__enum__:"hxsl.Channel",toString:n},A:{_hx_name:"A",_hx_index:4,__enum__:"hxsl.Channel",toString:n},PackedFloat:{_hx_name:"PackedFloat",_hx_index:5,__enum__:"hxsl.Channel",toString:n},PackedNormal:{_hx_name:"PackedNormal",_hx_index:6,__enum__:"hxsl.Channel",toString:n}};uA.__constructs__=[uA.Unknown,uA.R,uA.G,uA.B,uA.A,uA.PackedFloat,uA.PackedNormal],uA.__empty_constructs__=[uA.Unknown,uA.R,uA.G,uA.B,uA.A,uA.PackedFloat,uA.PackedNormal];var _A=function(){this.varMap=new Wn};i["hxsl.Clone"]=_A,_A.__name__="hxsl.Clone",_A.shaderData=function(t){return(new _A).shader(t)},_A.prototype={tvar:function(t){var e=this.varMap.h[t.id];return null!=e||(e={id:sA.allocVarId(),type:t.type,name:t.name,kind:t.kind},this.varMap.h[t.id]=e,null!=t.parent&&(e.parent=this.tvar(t.parent)),null!=t.qualifiers&&(e.qualifiers=t.qualifiers.slice()),e.type=this.ttype(t.type)),e},tfun:function(t){for(var e=this.ttype(t.ret),i=t.kind,n=this.tvar(t.ref),s=[],r=0,a=t.args;r<a.length;){var A=a[r];++r,s.push(this.tvar(A))}return{ret:e,kind:i,ref:n,args:s,expr:this.texpr(t.expr)}},ttype:function(t){switch(t._hx_index){case 13:for(var e=t.vl,i=[],n=0;n<e.length;){var s=e[n];++n,i.push(this.tvar(s))}return Xa.TStruct(i);case 14:var r=t.variants;return Xa.TFun(r);case 15:var a,A=t.t,h=t.size,o=this.ttype(A);switch(h._hx_index){case 0:i=h.v;a=h;break;case 1:s=h.v;a=Ha.SVar(this.tvar(s))}return Xa.TArray(o,a);default:return t}},texpr:function(t){var e=sA.map(t,XA(this,this.texpr));e.t=this.ttype(t.t);var i,n=e.e;switch(n._hx_index){case 1:var s=n.v;i=nA.TVar(this.tvar(s));break;case 7:s=n.v;var r=n.init;i=nA.TVarDecl(this.tvar(s),r);break;case 13:s=n.v;var a=n.it,A=n.loop;i=nA.TFor(this.tvar(s),a,A);break;default:i=e.e}return e.e=i,e},shader:function(t){for(var e=t.name,i=[],n=0,s=t.vars;n<s.length;){var r=s[n];++n,i.push(this.tvar(r))}var a=i;for(i=[],n=0,s=t.funs;n<s.length;){var A=s[n];++n,i.push(this.tfun(A))}return{name:e,vars:a,funs:i}},__class__:_A};var cA=function(){};i["hxsl._Dce.Exit"]=cA,cA.__name__="hxsl._Dce.Exit",cA.prototype={__class__:cA};var dA=function(t){this.v=t,this.used=!1,this.deps=new Wn};i["hxsl._Dce.VarDeps"]=dA,dA.__name__="hxsl._Dce.VarDeps",dA.prototype={__class__:dA};var fA=function(){};i["hxsl.Dce"]=fA,fA.__name__="hxsl.Dce",fA.prototype={debug:function(t,e){},dce:function(t,e){this.used=new Wn,this.channelVars=[];for(var i=[],n=0,s=t.vars;n<s.length;){var r=s[n];++n;var a=this.get(r);r.kind==Za.Input&&i.push(a),r.kind==Za.Output&&(a.keep=!0)}for(n=0,s=e.vars;n<s.length;){r=s[n];++n;a=this.get(r);r.kind==Za.Output&&(a.keep=!0)}for(n=0,s=t.funs;n<s.length;){var A=s[n];++n,this.check(A.expr,[],[])}for(n=0,s=e.funs;n<s.length;){A=s[n];++n,this.check(A.expr,[],[])}for(var h=[];;){for(r=this.used.iterator();r.hasNext();){(p=r.next()).keep&&this.markRec(p)}for(;i.length>1&&!i[i.length-1].used;)i.pop();for(n=0;n<i.length;){var o=i[n];++n,this.markRec(o)}h=[];s=0;for(var u=t.funs;s<u.length;){A=u[s];++s,h.push(this.mapExpr(A.expr,!1))}for(var _=0,c=e.funs;_<c.length;){var d=c[_];++_,h.push(this.mapExpr(d.expr,!1))}this.markAsKeep=!1;for(var f=0;f<h.length;){var x=h[f];++f,this.checkBranches(x)}if(!this.markAsKeep)break}for(n=0,s=t.funs;n<s.length;){A=s[n];++n,A.expr=h.shift()}for(n=0,s=e.funs;n<s.length;){A=s[n];++n,A.expr=h.shift()}for(r=this.used.iterator();r.hasNext();){var p;(p=r.next()).used||p.v.kind!=Za.Input&&(l.remove(t.vars,p.v),l.remove(e.vars,p.v))}return{fragment:e,vertex:t}},get:function(t){var e=this.used.h[t.id];return null==e&&(e=new dA(t),this.used.h[t.id]=e),e},markRec:function(t){if(!t.used){t.used=!0;for(var e=t.deps.iterator();e.hasNext();){var i=e.next();this.markRec(i)}}},link:function(t,e){for(var i=this.get(t),n=0;n<e.length;){var s=e[n];++n,null!=s?s.deps.h[t.id]=i:i.keep||(i.keep=!0,this.markAsKeep=!0)}},check:function(t,e,i){switch((xt=t.e)._hx_index){case 1:var n=xt.v;this.link(n,e);break;case 4:for(var s=xt.el,r=[],a=0,A=s.length;a<A;){var h=a++;this.check(s[h],h<s.length-1?r:e,i)}break;case 5:a=xt.op,A=xt.e1;var o=xt.e2;switch(a._hx_index){case 4:var l=A.e,u=A.p;u=A.t;switch(l._hx_index){case 1:n=l.v;var _=o,c=this.get(n);e.push(c),this.check(_,e,i),e.pop(),i.indexOf(c)<0&&i.push(c);break;case 9:u=l.e;var d=l.regs;l=u.e,d=u.p,d=u.t;if(1==l._hx_index){n=l.v,_=o,c=this.get(n);e.push(c),this.check(_,e,i),e.pop(),i.indexOf(c)<0&&i.push(c)}else{l=XA(this,this.check);var f=e,x=i;sA.iter(t,(function(t){l(t,f,x)}))}break;default:u=XA(this,this.check);var p=e,g=i;sA.iter(t,(function(t){u(t,p,g)}))}break;case 20:d=a.op,a=A.e,d=A.p,d=A.t;switch(a._hx_index){case 1:n=a.v,_=o,c=this.get(n);e.push(c),this.check(_,e,i),e.pop(),i.indexOf(c)<0&&i.push(c);break;case 9:A=a.e,d=a.regs,a=A.e,d=A.p,d=A.t;if(1==a._hx_index){n=a.v,_=o,c=this.get(n);e.push(c),this.check(_,e,i),e.pop(),i.indexOf(c)<0&&i.push(c)}else{a=XA(this,this.check);var m=e,v=i;sA.iter(t,(function(t){a(t,m,v)}))}break;default:A=XA(this,this.check);var y=e,b=i;sA.iter(t,(function(t){A(t,y,b)}))}break;default:o=XA(this,this.check);var w=e,M=i;sA.iter(t,(function(t){o(t,w,M)}))}break;case 7:n=xt.v;var B=xt.init;if(null!=B)e.push(this.get(n)),this.check(B,e,i),e.pop();else{d=XA(this,this.check);var C=e,S=i;sA.iter(t,(function(t){d(t,C,S)}))}break;case 8:var I=xt.e,k=xt.args,E=I.e,F=I.p;F=I.t;if(2==E._hx_index)switch(E.g._hx_index){case 63:if(3==k.length){I=k[0],E=k[2],F=I.e;var T=I.p;T=I.t;if(1==F._hx_index){I=E.e,T=E.p,T=E.t;if(0==I._hx_index){if(2==(E=I.c)._hx_index){var D=E.v,P=k[1],z=F.v;this.check(P,e,i),null==this.channelVars[D]?(this.channelVars[D]=z,this.link(z,e)):this.link(this.channelVars[D],e)}else{I=XA(this,this.check);var R=e,L=i;sA.iter(t,(function(t){I(t,R,L)}))}}else{E=XA(this,this.check);var V=e,Q=i;sA.iter(t,(function(t){E(t,V,Q)}))}}else{F=XA(this,this.check);var U=e,O=i;sA.iter(t,(function(t){F(t,U,O)}))}}else{T=XA(this,this.check);var G=e,N=i;sA.iter(t,(function(t){T(t,G,N)}))}break;case 64:if(4==k.length){var Y=k[0],X=k[3],j=Y.e,H=Y.p;H=Y.t;if(1==j._hx_index){Y=X.e,H=X.p,H=X.t;if(0==Y._hx_index){if(2==(X=Y.c)._hx_index){D=X.v;var W=k[2];P=k[1],z=j.v;this.check(P,e,i),this.check(W,e,i),null==this.channelVars[D]?(this.channelVars[D]=z,this.link(z,e)):this.link(this.channelVars[D],e)}else{k=XA(this,this.check);var Z=e,J=i;sA.iter(t,(function(t){k(t,Z,J)}))}}else{Y=XA(this,this.check);var q=e,K=i;sA.iter(t,(function(t){Y(t,q,K)}))}}else{X=XA(this,this.check);var $=e,tt=i;sA.iter(t,(function(t){X(t,$,tt)}))}}else{j=XA(this,this.check);var et=e,it=i;sA.iter(t,(function(t){j(t,et,it)}))}break;default:H=XA(this,this.check);var nt=e,st=i;sA.iter(t,(function(t){H(t,nt,st)}))}else{var rt=XA(this,this.check),at=e,At=i;sA.iter(t,(function(t){rt(t,at,At)}))}break;case 10:_=xt.econd;var ht=xt.eif,ot=xt.eelse,lt=[];this.check(ht,e,lt),null!=ot&&this.check(ot,e,lt);for(var ut=lt.length,_t=0;_t<e.length;){n=e[_t];++_t,lt.indexOf(n)<0&&lt.push(n)}this.check(_,lt,i);_t=0;for(var ct=ut;_t<ct;){n=lt[h=_t++];i.indexOf(n)<0&&i.push(n)}break;case 13:n=xt.v;var dt=xt.it,ft=xt.loop;lt=[];this.check(ft,e,lt),this.check(dt,lt,i);for(var xt=0;xt<lt.length;){n=lt[xt];++xt,i.indexOf(n)<0&&i.push(n)}break;default:xt=XA(this,this.check);var pt=e,gt=i;sA.iter(t,(function(t){xt(t,pt,gt)}))}},checkBranches:function(t){var e=t.e;if(10==e._hx_index){e.eif,e.eelse;var i=e.econd;this.check(i,[null],[])}sA.iter(t,XA(this,this.checkBranches))},mapExpr:function(t,e){var i=this,n=t.e;switch(n._hx_index){case 4:for(var s=n.el,r=[],a=0,A=0;A<s.length;){var h=s[A];++A;var o=e&&a==s.length-1,l=this.mapExpr(h,o);(sA.hasSideEffect(l)||o)&&r.push(l),++a}return{e:nA.TBlock(r),p:t.p,t:t.t};case 5:A=n.op;var u=n.e1,_=n.e2;switch(A._hx_index){case 4:_=u.e;var c=u.p;c=u.t;switch(_._hx_index){case 1:var d=_.v;return this.get(d).used?sA.map(t,(function(t){return i.mapExpr(t,!0)})):{e:nA.TConst(Ka.CNull),t:t.t,p:t.p};case 9:c=_.e,_.regs,_=c.e,c.p,c.t;if(1==_._hx_index){d=_.v;return this.get(d).used?sA.map(t,(function(t){return i.mapExpr(t,!0)})):{e:nA.TConst(Ka.CNull),t:t.t,p:t.p}}return sA.map(t,(function(t){return i.mapExpr(t,!0)}));default:return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}break;case 20:_=A.op,A=u.e,_=u.p,_=u.t;switch(A._hx_index){case 1:d=A.v;return this.get(d).used?sA.map(t,(function(t){return i.mapExpr(t,!0)})):{e:nA.TConst(Ka.CNull),t:t.t,p:t.p};case 9:u=A.e,_=A.regs,A=u.e,_=u.p,_=u.t;if(1==A._hx_index){d=A.v;return this.get(d).used?sA.map(t,(function(t){return i.mapExpr(t,!0)})):{e:nA.TConst(Ka.CNull),t:t.t,p:t.p}}return sA.map(t,(function(t){return i.mapExpr(t,!0)}));default:return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}break;default:return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}break;case 7:A=n.init,d=n.v;return this.get(d).used?sA.map(t,(function(t){return i.mapExpr(t,!0)})):{e:nA.TConst(Ka.CNull),t:t.t,p:t.p};case 8:A=n.e,u=n.args,_=A.e,c=A.p,c=A.t;if(2!=_._hx_index)return sA.map(t,(function(t){return i.mapExpr(t,!0)}));switch(_.g._hx_index){case 63:if(3==u.length){A=u[0],_=(A=u[2]).e,c=A.p,c=A.t;if(0==_._hx_index){if(2==(A=_.c)._hx_index){var f=A.v,x=u[1],p=this.channelVars[f];return{e:nA.TCall({e:nA.TGlobal(eA.Texture),p:t.p,t:Xa.TVoid},[{e:nA.TVar(p),t:p.type,p:t.p},this.mapExpr(x,!0)]),t:Xa.TVoid,p:t.p}}return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}return sA.map(t,(function(t){return i.mapExpr(t,!0)}));case 64:if(4==u.length){A=u[0],_=(A=u[3]).e,c=A.p,c=A.t;if(0==_._hx_index){if(2==(A=_.c)._hx_index){f=A.v;var g=u[2];x=u[1],p=this.channelVars[f];return{e:nA.TCall({e:nA.TGlobal(eA.TextureLod),p:t.p,t:Xa.TVoid},[{e:nA.TVar(p),t:p.type,p:t.p},this.mapExpr(x,!0),this.mapExpr(g,!0)]),t:Xa.TVoid,p:t.p}}return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}return sA.map(t,(function(t){return i.mapExpr(t,!0)}));case 65:switch(u.length){case 3:A=u[0],_=(A=u[2]).e,c=A.p,c=A.t;if(0==_._hx_index){if(2==(A=_.c)._hx_index){f=A.v;var m=u[1];p=this.channelVars[f];return{e:nA.TCall({e:nA.TGlobal(eA.Texel),p:t.p,t:Xa.TVoid},[{e:nA.TVar(p),t:p.type,p:t.p},this.mapExpr(m,!0)]),t:Xa.TVoid,p:t.p}}return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}return sA.map(t,(function(t){return i.mapExpr(t,!0)}));case 4:A=u[0],_=(A=u[3]).e,c=A.p,c=A.t;if(0==_._hx_index){if(2==(A=_.c)._hx_index){f=A.v,g=u[2],m=u[1],p=this.channelVars[f];return{e:nA.TCall({e:nA.TGlobal(eA.Texel),p:t.p,t:Xa.TVoid},[{e:nA.TVar(p),t:p.type,p:t.p},this.mapExpr(m,!0),this.mapExpr(g,!0)]),t:Xa.TVoid,p:t.p}}return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}return sA.map(t,(function(t){return i.mapExpr(t,!0)}));default:return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}break;case 66:switch(u.length){case 2:A=u[0],_=(A=u[1]).e,c=A.p,c=A.t;if(0==_._hx_index){if(2==(A=_.c)._hx_index){f=A.v,p=this.channelVars[f];return{e:nA.TCall({e:nA.TGlobal(eA.TextureSize),p:t.p,t:Xa.TVoid},[{e:nA.TVar(p),t:p.type,p:t.p}]),t:Xa.TVoid,p:t.p}}return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}return sA.map(t,(function(t){return i.mapExpr(t,!0)}));case 3:A=u[0],_=(A=u[2]).e,c=A.p,c=A.t;if(0==_._hx_index){if(2==(A=_.c)._hx_index){f=A.v,g=u[1],p=this.channelVars[f];return{e:nA.TCall({e:nA.TGlobal(eA.TextureSize),p:t.p,t:Xa.TVoid},[{e:nA.TVar(p),t:p.type,p:t.p},this.mapExpr(g,!0)]),t:Xa.TVoid,p:t.p}}return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}return sA.map(t,(function(t){return i.mapExpr(t,!0)}));default:return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}break;default:return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}break;case 10:h=n.econd;var v=n.eif,y=n.eelse,b=(l=this.mapExpr(h,!0),this.mapExpr(v,e)),w=null==y?null:this.mapExpr(y,e);return e||sA.hasSideEffect(b)||null!=w&&sA.hasSideEffect(w)?{e:nA.TIf(l,b,w),p:l.p,t:l.t}:{e:nA.TConst(Ka.CNull),t:l.t,p:l.p};case 13:d=n.v;var M=n.it,B=n.loop,C=this.mapExpr(M,!0),S=this.mapExpr(B,!1);return sA.hasSideEffect(S)?{e:nA.TFor(d,C,S),p:t.p,t:t.t}:{e:nA.TConst(Ka.CNull),t:t.t,p:t.p};default:return sA.map(t,(function(t){return i.mapExpr(t,!0)}))}},__class__:fA};var xA=function(){this.varMap=new qn,this.funMap=new qn,this.constants=new Wn};i["hxsl.Eval"]=xA,xA.__name__="hxsl.Eval",xA.prototype={setConstant:function(t,e){this.constants.h[t.id]=nA.TConst(e)},mapVar:function(t){var e,i=this.varMap.h[t.__id__];if(null!=i)return t==i?i:this.mapVar(i);if(null!=t.parent&&(this.mapVar(t.parent),null!=(i=this.varMap.h[t.__id__])))return t==i?i:this.mapVar(i);if(17==(l=t.type)._hx_index){var n=l.size;e=!0}else e=!1;switch(i={id:e?t.id:sA.allocVarId(),name:t.name,type:t.type,kind:t.kind},null!=t.parent&&(i.parent=this.mapVar(t.parent)),null!=t.qualifiers&&(i.qualifiers=t.qualifiers.slice()),this.varMap.set(t,i),this.varMap.set(i,i),(l=i.type)._hx_index){case 13:for(var s=l.vl,r=(n=[],0);r<s.length;){t=s[r];++r,n.push(this.mapVar(t))}i.type=Xa.TStruct(n);break;case 15:if(1==(n=l.size)._hx_index){var a=n.v,A=l.t;if(null!=(o=this.constants.h[a.id]))if(null==o)Wa.t("Integer value expected for array size constant "+a.name,null);else if(0==o._hx_index){if(2==(n=o.c)._hx_index){t=n.v;if(15==(n=i.type)._hx_index){r=n.t,r=n.size;u=!0}else u=!1;i.type=u?Xa.TArray(A,Ha.SConst(t)):Xa.TBuffer(A,Ha.SConst(t))}else Wa.t("Integer value expected for array size constant "+a.name,null)}else Wa.t("Integer value expected for array size constant "+a.name,null);else{var h=this.mapVar(a);if(15==(n=i.type)._hx_index){r=n.t,r=n.size;u=!0}else u=!1;i.type=u?Xa.TArray(A,Ha.SVar(h)):Xa.TBuffer(A,Ha.SVar(h))}}break;case 16:if(1==(n=l.size)._hx_index){var o;a=n.v,A=l.t;if(null!=(o=this.constants.h[a.id]))if(null==o)Wa.t("Integer value expected for array size constant "+a.name,null);else if(0==o._hx_index){if(2==(l=o.c)._hx_index){t=l.v;if(15==(l=i.type)._hx_index){n=l.t,n=l.size;u=!0}else u=!1;i.type=u?Xa.TArray(A,Ha.SConst(t)):Xa.TBuffer(A,Ha.SConst(t))}else Wa.t("Integer value expected for array size constant "+a.name,null)}else Wa.t("Integer value expected for array size constant "+a.name,null);else{var l,u;h=this.mapVar(a);if(15==(l=i.type)._hx_index){n=l.t,n=l.size;u=!0}else u=!1;i.type=u?Xa.TArray(A,Ha.SVar(h)):Xa.TBuffer(A,Ha.SVar(h))}}}return i},checkSamplerRec:function(t){if(sA.isSampler(t))return!0;switch(t._hx_index){case 13:for(var e=t.vl,i=0;i<e.length;){var n=e[i];if(++i,this.checkSamplerRec(n.type))return!0}return!1;case 15:i=t.size;var s=t.t;return this.checkSamplerRec(s);case 16:i=t.t,t.size;return!0}return!1},needsInline:function(t){for(var e=0,i=t.args;e<i.length;){var n=i[e];if(++e,this.checkSamplerRec(n.type))return!0}return!1},eval:function(t){for(var e=[],i=0,n=t.funs;i<n.length;){var s=n[i];++i;for(var r=s.kind,a=this.mapVar(s.ref),A=[],h=0,o=s.args;h<o.length;){var l=o[h];++h,A.push(this.mapVar(l))}var u={kind:r,ref:a,args:A,ret:s.ret,expr:s.expr};s.kind==tA.Helper&&this.inlineCalls||this.needsInline(u)?this.funMap.set(u.ref,s):e.push(u)}for(i=0,n=e.length;i<n;){var _=i++;this.curFun=e[_],this.curFun.expr=this.evalExpr(this.curFun.expr,!1)}var c=t.name;for(i=[],n=0,A=t.vars;n<A.length;){var d=A[n];++n,i.push(this.mapVar(d))}return{name:c,vars:i,funs:e}},hasReturn:function(t){return this.markReturn=!1,this.hasReturnLoop(t),this.markReturn},hasReturnLoop:function(t){var e=t.e;if(12==e._hx_index){e.e;this.markReturn=!0}else this.markReturn||sA.iter(t,XA(this,this.hasReturnLoop))},handleReturn:function(t,e){null==e&&(e=!1);var i=t.e;switch(i._hx_index){case 3:var n=i.e,s=this.handleReturn(n,e);return{e:nA.TParenthesis(s),t:s.t,p:t.p};case 4:var r=i.el,a=0,A=r.length,h=[];t:for(;a<A;){var o=r[a++];if(a==A)h.push(this.handleReturn(o,e));else{var l=o.e;switch(l._hx_index){case 10:if(null==l.eelse){var u=l.eif,_=l.econd;if(e&&this.hasReturn(u)){h.push(this.handleReturn({e:nA.TIf(_,u,{e:nA.TBlock(r.slice(a)),t:o.t,p:o.p}),t:o.t,p:o.p}));break t}h.push(this.handleReturn(o))}else h.push(this.handleReturn(o));break;case 12:var c=l.e;h.push(this.handleReturn(c,e));break t;default:h.push(this.handleReturn(o))}}}var d=e?h[h.length-1].t:t.t;return{e:nA.TBlock(h),t:d,p:t.p};case 10:var f=i.econd,x=(u=i.eif,i.eelse);if(null!=x&&e){var p=this.handleReturn(f),g=this.handleReturn(u,e);return{e:nA.TIf(p,g,this.handleReturn(x,e)),t:g.t,p:t.p}}return sA.map(t,XA(this,this.handleReturnDef));case 12:n=i.e;return e||Wa.t("Cannot inline not final return",t.p),null==n?{e:nA.TBlock([]),t:Xa.TVoid,p:t.p}:this.handleReturn(n,!0);default:return sA.map(t,XA(this,this.handleReturnDef))}},handleReturnDef:function(t){return this.handleReturn(t)},evalCall:function(t,e,i,n){switch(t._hx_index){case 38:if(1==e.length){var s=(u=e[0]).e;u.p,u.t;if(0==s._hx_index){if(2==(u=s.c)._hx_index){var r=u.v;return nA.TConst(Ka.CFloat(r))}return null}return null}return null;case 63:case 64:if(0!=(u=e[0].e)._hx_index)throw Wa.t("Cannot eval complex channel "+SA.toString(e[0],!0)+" "+this.constantsToString(),n),kn.thrown("assert");if(2!=(s=u.c)._hx_index)throw Wa.t("Cannot eval complex channel "+SA.toString(e[0],!0)+" "+this.constantsToString(),n),kn.thrown("assert");r=_=s.v;var a=i[0];if(1!=(u=a.e)._hx_index)throw kn.thrown("assert");var A,h=u.v;if(17!=(u=(a={e:nA.TVar(this.mapVar(h)),t:a.t,p:a.p}).t)._hx_index)throw kn.thrown("assert");A=_=u.size;var o=m.createEnumIndex(uA,7&r,null),l=[a],u=1;for(s=e.length;u<s;){var _=u++;l.push(e[_])}l.push({e:nA.TConst(Ka.CInt(r>>3)),t:Xa.TInt,p:n});var c={e:nA.TCall({e:nA.TGlobal(t),t:Xa.TVoid,p:n},l),t:Xa.TVoid,p:n};switch(o._hx_index){case 0:var d={e:nA.TConst(Ka.CFloat(0)),t:Xa.TFloat,p:n};return 1==A?d.e:nA.TCall({e:nA.TGlobal([eA.Vec2,eA.Vec3,eA.Vec4][A-2]),t:Xa.TVoid,p:n},[d]);case 1:case 2:case 3:case 4:var f;switch(A){case 1:switch(o._hx_index){case 1:f=[iA.X];break;case 2:f=[iA.Y];break;case 3:f=[iA.Z];break;case 4:f=[iA.W];break;default:throw kn.thrown("Invalid channel value "+x.string(o)+" for "+A+" channels")}break;case 2:switch(o._hx_index){case 1:f=[iA.X,iA.Y];break;case 2:f=[iA.Y,iA.Z];break;case 3:f=[iA.Z,iA.W];break;default:throw kn.thrown("Invalid channel value "+x.string(o)+" for "+A+" channels")}break;case 3:switch(o._hx_index){case 1:f=[iA.X,iA.Y,iA.Z];break;case 2:f=[iA.Y,iA.Z,iA.W];break;default:throw kn.thrown("Invalid channel value "+x.string(o)+" for "+A+" channels")}break;default:throw kn.thrown("Invalid channel value "+x.string(o)+" for "+A+" channels")}return nA.TSwiz(c,f);case 5:return nA.TCall({e:nA.TGlobal(eA.Unpack),t:Xa.TVoid,p:n},[c]);case 6:return nA.TCall({e:nA.TGlobal(eA.UnpackNormal),t:Xa.TVoid,p:n},[c])}break;case 67:var p=e;for(u=0;u<p.length;){var g=p[u];++u,En.trace(SA.toString(g),{fileName:g.p.file,lineNumber:0,className:null,methodName:null})}return nA.TBlock([]);default:return null}},constantsToString:function(){for(var t=[],e=this.constants.keys();e.hasNext();){var i=e.next();t.push(i+" => "+SA.toString({e:this.constants.h[i],t:Xa.TVoid,p:null},!0))}return t.toString()},ifBlock:function(t){var e;if(null!=t){var i,n=t.e;if(10==n._hx_index){n.econd,n.eif,n.eelse;i=!0}else i=!1;e=!i}else e=!0;return e?t:{e:nA.TBlock([t]),t:t.t,p:t.p}},evalExpr:function(t,e){null==e&&(e=!0);var i,n=this,s=t.e;switch(s._hx_index){case 0:var r=s.c;i=t.e;break;case 1:var a=s.v;if(null!=(w=this.constants.h[a.id]))i=w;else{var A=this.mapVar(a);i=nA.TVar(A)}break;case 2:r=s.g;i=t.e;break;case 3:var h=s.e;if(0==(r=(g=this.evalExpr(h,e)).e)._hx_index){var o=r.c;i=g.e}else i=nA.TParenthesis(g);break;case 4:var l=[],u=(Q=s.el).length-1;for(r=0,o=Q.length;r<o;){var _=r++,c=e&&_==u;switch((F=(h=this.evalExpr(Q[_],c)).e)._hx_index){case 0:var d=F.c;c&&l.push(h);break;case 1:var f=F.v;c&&l.push(h);break;default:l.push(h)}}i=1==l.length&&this.curFun.kind!=tA.Init?l[0].e:nA.TBlock(l);break;case 5:var p=s.op,g=(h=s.e1,s.e2),m=this.evalExpr(h),v=this.evalExpr(g);switch(p._hx_index){case 0:r=m.e,o=v.e;if(0==r._hx_index)switch((F=r.c)._hx_index){case 2:if(0==o._hx_index)if(2==(r=o.c)._hx_index){var y=r.v,b=F.v;i=nA.TConst(Ka.CInt(b+y|0))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;case 3:if(0==o._hx_index)if(3==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CFloat(b+y))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 1:r=m.e,o=v.e;if(0==r._hx_index)switch((F=r.c)._hx_index){case 2:if(0==o._hx_index)if(2==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CInt(b*y|0))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;case 3:if(0==o._hx_index)if(3==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CFloat(b*y))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 2:r=m.e,o=v.e;if(0==r._hx_index)switch((F=r.c)._hx_index){case 2:if(0==o._hx_index)if(2==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CInt(b/y|0))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;case 3:if(0==o._hx_index)if(3==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CFloat(b/y))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 3:r=m.e,o=v.e;if(0==r._hx_index)switch((F=r.c)._hx_index){case 2:if(0==o._hx_index)if(2==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CInt(b-y|0))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;case 3:if(0==o._hx_index)if(3==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CFloat(b-y))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 4:case 21:i=nA.TBinop(p,m,v);break;case 5:r=m.e,o=v.e;if(0==r._hx_index)switch((F=r.c)._hx_index){case 0:i=0==o._hx_index?0==o.c._hx_index?nA.TConst(Ka.CBool(!0)):nA.TConst(Ka.CBool(!1)):nA.TBinop(p,m,v);break;case 1:r=F.b;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 1:y=d.b,b=r;i=nA.TConst(Ka.CBool(0==(b==y?0:1)));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 2:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 2:y=d.v,b=r;i=nA.TConst(Ka.CBool(b-y==0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 3:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 3:y=d.v,b=r;i=nA.TConst(Ka.CBool(0==(b>y?1:b==y?0:-1)));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 4:r=F.v;if(0==o._hx_index)switch((F=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 4:y=F.v,b=r;i=nA.TConst(Ka.CBool(0==(b>y?1:b==y?0:-1)));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 6:r=m.e,o=v.e;if(0==r._hx_index)switch((F=r.c)._hx_index){case 0:i=0==o._hx_index?0==o.c._hx_index?nA.TConst(Ka.CBool(!1)):nA.TConst(Ka.CBool(!0)):nA.TBinop(p,m,v);break;case 1:r=F.b;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 1:y=d.b,b=r;i=nA.TConst(Ka.CBool(0!=(b==y?0:1)));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 2:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 2:y=d.v,b=r;i=nA.TConst(Ka.CBool(b-y!=0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 3:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 3:y=d.v,b=r;i=nA.TConst(Ka.CBool(0!=(b>y?1:b==y?0:-1)));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 4:r=F.v;if(0==o._hx_index)switch((F=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 4:y=F.v,b=r;i=nA.TConst(Ka.CBool(0!=(b>y?1:b==y?0:-1)));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 7:r=m.e,o=v.e;if(0==r._hx_index)switch((F=r.c)._hx_index){case 0:i=0==o._hx_index?(o.c._hx_index,nA.TConst(Ka.CBool(!1))):nA.TBinop(p,m,v);break;case 1:r=F.b;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 1:y=d.b,b=r;i=nA.TConst(Ka.CBool((b==y?0:1)>0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 2:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 2:y=d.v,b=r;i=nA.TConst(Ka.CBool(b-y>0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 3:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 3:y=d.v,b=r;i=nA.TConst(Ka.CBool((b>y?1:b==y?0:-1)>0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 4:r=F.v;if(0==o._hx_index)switch((F=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 4:y=F.v,b=r;i=nA.TConst(Ka.CBool((b>y?1:b==y?0:-1)>0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 8:r=m.e,o=v.e;if(0==r._hx_index)switch((F=r.c)._hx_index){case 0:i=0==o._hx_index?0==o.c._hx_index?nA.TConst(Ka.CBool(!0)):nA.TConst(Ka.CBool(!1)):nA.TBinop(p,m,v);break;case 1:r=F.b;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 1:y=d.b,b=r;i=nA.TConst(Ka.CBool((b==y?0:1)>=0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 2:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 2:y=d.v,b=r;i=nA.TConst(Ka.CBool(b-y>=0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 3:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 3:y=d.v,b=r;i=nA.TConst(Ka.CBool((b>y?1:b==y?0:-1)>=0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 4:r=F.v;if(0==o._hx_index)switch((F=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!0));break;case 4:y=F.v,b=r;i=nA.TConst(Ka.CBool((b>y?1:b==y?0:-1)>=0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 9:r=m.e,o=v.e;if(0==r._hx_index)switch((F=r.c)._hx_index){case 0:i=0==o._hx_index?0==o.c._hx_index?nA.TConst(Ka.CBool(!1)):nA.TConst(Ka.CBool(!0)):nA.TBinop(p,m,v);break;case 1:r=F.b;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 1:y=d.b,b=r;i=nA.TConst(Ka.CBool((b==y?0:1)<0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 2:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 2:y=d.v,b=r;i=nA.TConst(Ka.CBool(b-y<0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 3:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 3:y=d.v,b=r;i=nA.TConst(Ka.CBool((b>y?1:b==y?0:-1)<0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 4:r=F.v;if(0==o._hx_index)switch((F=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 4:y=F.v,b=r;i=nA.TConst(Ka.CBool((b>y?1:b==y?0:-1)<0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 10:r=m.e,o=v.e;if(0==r._hx_index)switch((F=r.c)._hx_index){case 0:i=0==o._hx_index?(o.c._hx_index,nA.TConst(Ka.CBool(!0))):nA.TBinop(p,m,v);break;case 1:r=F.b;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 1:y=d.b,b=r;i=nA.TConst(Ka.CBool((b==y?0:1)<=0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 2:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 2:y=d.v,b=r;i=nA.TConst(Ka.CBool(b-y<=0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 3:r=F.v;if(0==o._hx_index)switch((d=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 3:y=d.v,b=r;i=nA.TConst(Ka.CBool((b>y?1:b==y?0:-1)<=0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 4:r=F.v;if(0==o._hx_index)switch((F=o.c)._hx_index){case 0:i=nA.TConst(Ka.CBool(!1));break;case 4:y=F.v,b=r;i=nA.TConst(Ka.CBool((b>y?1:b==y?0:-1)<=0));break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 11:r=m.e,o=v.e;if(0==r._hx_index)if(2==(F=r.c)._hx_index)if(0==o._hx_index)if(2==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CInt(b&y))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;case 12:r=m.e,o=v.e;if(0==r._hx_index)if(2==(F=r.c)._hx_index)if(0==o._hx_index)if(2==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CInt(b|y))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;case 13:r=m.e,o=v.e;if(0==r._hx_index)if(2==(F=r.c)._hx_index)if(0==o._hx_index)if(2==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CInt(b^y))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;case 14:r=m.e,o=v.e;if(0==r._hx_index)if(1==(F=r.c)._hx_index){r=F.b;if(0==o._hx_index)if(1==(F=o.c)._hx_index){y=F.b;var b=r;i=nA.TConst(Ka.CBool(b&&y))}else{i=0==(b=r)?nA.TConst(Ka.CBool(b)):v.e}else i=0==(b=r)?nA.TConst(Ka.CBool(b)):v.e}else if(0==o._hx_index){if(1==(r=o.c)._hx_index)i=0==(b=r.b)?nA.TConst(Ka.CBool(b)):m.e;else i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);else if(0==o._hx_index){if(1==(r=o.c)._hx_index)i=0==(b=r.b)?nA.TConst(Ka.CBool(b)):m.e;else i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 15:r=m.e,o=v.e;if(0==r._hx_index)if(1==(F=r.c)._hx_index){r=F.b;if(0==o._hx_index)if(1==(F=o.c)._hx_index){y=F.b,b=r;i=nA.TConst(Ka.CBool(b||y))}else{i=1==(b=r)?nA.TConst(Ka.CBool(b)):v.e}else i=1==(b=r)?nA.TConst(Ka.CBool(b)):v.e}else if(0==o._hx_index){if(1==(r=o.c)._hx_index)i=1==(b=r.b)?nA.TConst(Ka.CBool(b)):m.e;else i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);else if(0==o._hx_index){if(1==(r=o.c)._hx_index)i=1==(b=r.b)?nA.TConst(Ka.CBool(b)):m.e;else i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 16:r=m.e,o=v.e;if(0==r._hx_index)if(2==(F=r.c)._hx_index)if(0==o._hx_index)if(2==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CInt(b<<y))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;case 17:r=m.e,o=v.e;if(0==r._hx_index)if(2==(F=r.c)._hx_index)if(0==o._hx_index)if(2==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CInt(b>>y))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;case 18:r=m.e,o=v.e;if(0==r._hx_index)if(2==(F=r.c)._hx_index)if(0==o._hx_index)if(2==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CInt(b>>>y))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;case 19:r=m.e,o=v.e;if(0==r._hx_index)switch((F=r.c)._hx_index){case 2:if(0==o._hx_index)if(2==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CInt(b%y|0))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;case 3:if(0==o._hx_index)if(3==(r=o.c)._hx_index){y=r.v,b=F.v;i=nA.TConst(Ka.CFloat(b%y))}else i=nA.TBinop(p,m,v);else i=nA.TBinop(p,m,v);break;default:i=nA.TBinop(p,m,v)}else i=nA.TBinop(p,m,v);break;case 20:r=p.op;i=nA.TBinop(p,m,v);break;case 22:case 23:throw kn.thrown("assert")}break;case 6:p=s.op,h=s.e1;if(0==(r=(g=this.evalExpr(h)).e)._hx_index){var w=r.c;switch(p._hx_index){case 2:if(1==w._hx_index){y=w.b;i=nA.TConst(Ka.CBool(!y))}else i=nA.TUnop(p,g);break;case 3:switch(w._hx_index){case 2:_=w.v;i=nA.TConst(Ka.CInt(-_));break;case 3:var M=w.v;i=nA.TConst(Ka.CFloat(-M));break;default:i=nA.TUnop(p,g)}break;default:i=nA.TUnop(p,g)}}else i=nA.TUnop(p,g);break;case 7:a=s.v;var B=s.init;i=nA.TVarDecl(this.mapVar(a),null==B?null:this.evalExpr(B));break;case 8:w=s.e;var C=s.args,S=this.evalExpr(w);for(r=[],o=0;o<C.length;){b=C[o];++o,r.push(this.evalExpr(b))}var I=r;switch((r=S.e)._hx_index){case 1:a=r.v;if(null!=this.funMap.h.__keys__[a.__id__]){for(var k=[],E=[],F=(o=0,(M=this.funMap.h[a.__id__]).args.length);o<F;){_=o++,a=[M.args[_]];switch((d=(h=I[_]).e)._hx_index){case 0:f=d.c;var T=[this.constants.h[a[0].id]];E.push(function(t,e){return function(){null==t[0]?n.constants.remove(e[0].id):n.constants.h[e[0].id]=t[0]}}(T,a)),this.constants.h[a[0].id]=h.e;break;case 1:var D=d.v;D.id,D.name,D.parent,D.qualifiers,D.type;switch(D.kind._hx_index){case 0:case 1:case 2:var P=[this.constants.h[a[0].id]];E.push(function(t,e){return function(){null==t[0]?n.constants.remove(e[0].id):n.constants.h[e[0].id]=t[0]}}(P,a)),this.constants.h[a[0].id]=h.e;break;default:var z=[this.varMap.h[a[0].__id__]];null==z[0]?E.push(function(t){return function(){n.varMap.remove(t[0])}}(a)):(this.varMap.remove(a[0]),E.push(function(t,e){return function(){n.varMap.set(e[0],t[0])}}(z,a)));A=this.mapVar(a[0]);k.push({e:nA.TVarDecl(A,h),t:Xa.TVoid,p:h.p})}break;default:var R=[this.varMap.h[a[0].__id__]];null==R[0]?E.push(function(t){return function(){n.varMap.remove(t[0])}}(a)):(this.varMap.remove(a[0]),E.push(function(t,e){return function(){n.varMap.set(e[0],t[0])}}(R,a)));var L=this.mapVar(a[0]);k.push({e:nA.TVarDecl(L,h),t:Xa.TVoid,p:h.p})}}for(h=this.handleReturn(this.evalExpr(M.expr,!1),!0),o=0;o<E.length;){var V=E[o];++o,V()}if(4==(o=h.e)._hx_index){var Q=o.el;for(o=0;o<Q.length;){g=Q[o];++o,k.push(g)}}else k.push(h);i=nA.TBlock(k)}else i=nA.TCall(S,I);break;case 2:var U=r.g;i=null!=(j=this.evalCall(U,I,C,t.p))?j:nA.TCall(S,I);break;default:i=Wa.t("Cannot eval non-static call expresssion '"+(new SA).exprString(S)+"'",S.p)}break;case 9:h=s.e;var O=s.regs;i=nA.TSwiz(this.evalExpr(h),O.slice());break;case 10:var G=s.econd,N=s.eif,Y=s.eelse,X=this.evalExpr(G);if(0==(r=X.e)._hx_index)if(1==(o=r.c)._hx_index)i=(y=o.b)?this.evalExpr(N,e).e:null==Y?nA.TConst(Ka.CNull):this.evalExpr(Y,e).e;else if(e&&null!=Y&&this.eliminateConditionals)i=nA.TCall({e:nA.TGlobal(eA.Mix),t:t.t,p:t.p},[this.evalExpr(Y,!0),this.evalExpr(N,!0),{e:nA.TCall({e:nA.TGlobal(eA.ToFloat),t:Xa.TFun([]),p:X.p},[X]),t:Xa.TFloat,p:t.p}]);else{if(N=this.evalExpr(N,e),null!=Y)0==(r=(Y=this.evalExpr(Y,e)).e)._hx_index&&0==r.c._hx_index&&(Y=null);N=this.ifBlock(N),Y=this.ifBlock(Y),i=nA.TIf(X,N,Y)}else if(e&&null!=Y&&this.eliminateConditionals)i=nA.TCall({e:nA.TGlobal(eA.Mix),t:t.t,p:t.p},[this.evalExpr(Y,!0),this.evalExpr(N,!0),{e:nA.TCall({e:nA.TGlobal(eA.ToFloat),t:Xa.TFun([]),p:X.p},[X]),t:Xa.TFloat,p:t.p}]);else{if(N=this.evalExpr(N,e),null!=Y)0==(r=(Y=this.evalExpr(Y,e)).e)._hx_index&&0==r.c._hx_index&&(Y=null);N=this.ifBlock(N),Y=this.ifBlock(Y),i=nA.TIf(X,N,Y)}break;case 11:i=nA.TDiscard;break;case 12:h=s.e;i=nA.TReturn(null==h?null:this.evalExpr(h));break;case 13:var j=s.v,H=s.it,W=s.loop,Z=(A=this.mapVar(j),this.evalExpr(H));if(5==(r=Z.e)._hx_index){o=r.e1,F=r.e2;if(21==r.op._hx_index){r=o.e,d=o.p,d=o.t;if(0==r._hx_index)if(2==(o=r.c)._hx_index){r=F.e,d=F.p,d=F.t;if(0==r._hx_index)if(2==(F=r.c)._hx_index){var J=F.v,q=o.v;if(this.unrollLoops){for(l=[],r=q,o=J;r<o;){_=r++;this.constants.h[j.id]=nA.TConst(Ka.CInt(_)),l.push(this.evalExpr(W,!1))}this.constants.remove(j.id),h=nA.TBlock(l)}else h=nA.TFor(A,Z,this.ifBlock(this.evalExpr(W,!1)))}else h=nA.TFor(A,Z,this.ifBlock(this.evalExpr(W,!1)));else h=nA.TFor(A,Z,this.ifBlock(this.evalExpr(W,!1)))}else h=nA.TFor(A,Z,this.ifBlock(this.evalExpr(W,!1)));else h=nA.TFor(A,Z,this.ifBlock(this.evalExpr(W,!1)))}else h=nA.TFor(A,Z,this.ifBlock(this.evalExpr(W,!1)))}else h=nA.TFor(A,Z,this.ifBlock(this.evalExpr(W,!1)));this.varMap.remove(j),i=h;break;case 14:i=nA.TContinue;break;case 15:i=nA.TBreak;break;case 16:h=s.e,g=s.index,m=this.evalExpr(h),v=this.evalExpr(g),r=m.e,o=v.e;if(17==r._hx_index)if(0==o._hx_index)if(2==(F=o.c)._hx_index){_=F.v,Q=r.el;i=_>=0&&_<Q.length?Q[_].e:nA.TArray(m,v)}else i=nA.TArray(m,v);else i=nA.TArray(m,v);else i=nA.TArray(m,v);break;case 17:for(Q=s.el,r=[],o=0;o<Q.length;){h=Q[o];++o,r.push(this.evalExpr(h))}i=nA.TArrayDecl(r);break;case 18:h=s.e;var K=s.cases,$=s.def;for(g=this.evalExpr(h),r=[],o=0;o<K.length;){w=K[o];++o;for(F=[],d=0,f=w.values;d<f.length;){j=f[d];++d,F.push(this.evalExpr(j))}r.push({values:F,expr:this.evalExpr(w.expr,e)})}K=r;var tt=null==$?null:this.evalExpr($,e),et=!1;if(0==(r=g.e)._hx_index){if(2!=(w=r.c)._hx_index)throw kn.thrown("Unsupported switch constant "+x.string(w));var it=w.v;for(r=0;r<K.length;){S=K[r];++r;for(o=0,F=S.values;o<F.length;){j=F[o];if(++o,0==(d=j.e)._hx_index){var nt=d.c;switch(nt._hx_index){case 2:if(nt.v==it)return S.expr;break;case 3:if(nt.v==it)return S.expr}}else et=!0}}}else et=!0;i=et?nA.TSwitch(g,K,tt):null==tt?nA.TBlock([]):tt.e;break;case 19:var st=s.e,rt=(W=s.loop,s.normalWhile),at=this.evalExpr(st),At=this.evalExpr(W,!1);i=nA.TWhile(at,this.ifBlock(At),rt);break;case 20:var ht=s.m;I=s.args,h=s.e;if("unroll"==ht){this.unrollLoops;this.unrollLoops=!0,g=this.evalExpr(h,e),this.unrollLoops=!1}else g=this.evalExpr(h,e);i=nA.TMeta(ht,I,g)}return{e:i,t:t.t,p:t.p}},__class__:xA};var pA=function(t,e,i,n){this.g=t,this.t=e,this.pos=i,this.size=n};i["hxsl._Flatten.Alloc"]=pA,pA.__name__="hxsl._Flatten.Alloc",pA.prototype={__class__:pA};var gA=s["hxsl.ARead"]={__ename__:!0,__constructs__:null,AIndex:(e=function(t){return{_hx_index:0,a:t,__enum__:"hxsl.ARead",toString:n}},e._hx_name="AIndex",e.__params__=["a"],e),AOffset:(e=function(t,e,i){return{_hx_index:1,a:t,stride:e,delta:i,__enum__:"hxsl.ARead",toString:n}},e._hx_name="AOffset",e.__params__=["a","stride","delta"],e)};gA.__constructs__=[gA.AIndex,gA.AOffset],gA.__empty_constructs__=[];var mA=function(){};i["hxsl.Flatten"]=mA,mA.__name__="hxsl.Flatten",mA.prototype={flatten:function(t,e,i){if(this.globals=[],this.params=[],this.outVars=[],i){this.consts=[];var n=t.funs[0].expr.p,s={id:sA.allocVarId(),name:"__consts__",kind:Za.Global,type:null};this.econsts={e:nA.TVar(s),t:null,p:n};for(var r=t.name,a=t.vars.slice(),A=[],h=0,o=t.funs;h<o.length;){var l=o[h];++h,A.push(this.mapFun(l,XA(this,this.mapConsts)))}t={name:r,vars:a,funs:A};for(A=0,h=t.vars;A<h.length;){var u=h[A];if(++A,9==(o=u.type)._hx_index){o.size;this.allocConst(255,n)}}this.consts.length>0&&(s.type=this.econsts.t=Xa.TArray(Xa.TFloat,Ha.SConst(this.consts.length)),t.vars.push(s))}this.varMap=new qn,this.allocData=new qn;var _;for(A=0,h=t.vars;A<h.length;){u=h[A];++A,this.gatherVar(u)}switch(e._hx_index){case 0:_="vertex";break;case 1:_="fragment";break;default:throw kn.thrown("assert")}this.pack(_+"Globals",Za.Global,this.globals,ja.VFloat),this.pack(_+"Params",Za.Param,this.params,ja.VFloat);var c=this.globals.concat(this.params);this.packTextures(_+"Textures",c,Xa.TSampler2D).concat(this.packTextures(_+"TexturesCube",c,Xa.TSamplerCube)).concat(this.packTextures(_+"TexturesArray",c,Xa.TSampler2DArray));this.packBuffers(c);for(A=[],h=0,o=t.funs;h<o.length;){l=o[h];++h,A.push(this.mapFun(l,XA(this,this.mapExpr)))}var d=A;return{name:t.name,vars:this.outVars,funs:d}},mapFun:function(t,e){return{kind:t.kind,ret:t.ret,args:t.args,ref:t.ref,expr:e(t.expr)}},mapExpr:function(t){switch((A=t.e)._hx_index){case 1:var e=A.v;null!=(s=this.varMap.h[e.__id__])&&(t=this.access(s,e.type,t.p,gA.AIndex(s)));break;case 16:var i=(h=A.e).e;h.t;if(1==i._hx_index){e=i.v;var n,s,r=h.p,a=A.index;if(0==(A=a.e)._hx_index)if(2==(h=A.c)._hx_index){var A=h.v;n=!0}else n=!1;else n=!1;if(n)t=sA.map(t,XA(this,this.mapExpr));else if(null!=(s=this.varMap.h[e.__id__])){if(15!=(A=e.type)._hx_index)throw kn.thrown("assert");var h=A.t;i=A.size;if(sA.isSampler(o=h))a=this.toInt(this.mapExpr(a)),t=this.access(s,o,r,gA.AOffset(s,1,a));else{var o=h,l=this.varSize(o,s.t);if(0==l||0!=(3&l))throw kn.thrown(new Wa("Dynamic access to an Array which size is not 4 components-aligned is not allowed",t.p));l>>=2,a=this.toInt(this.mapExpr(a)),t=this.access(s,o,r,gA.AOffset(s,l,1==l?a:{e:nA.TBinop(_s.OpMult,a,{e:nA.TConst(Ka.CInt(l)),t:Xa.TInt,p:r}),t:Xa.TInt,p:r}))}}}else t=sA.map(t,XA(this,this.mapExpr));break;default:t=sA.map(t,XA(this,this.mapExpr))}return this.optimize(t)},mapConsts:function(t){switch((A=t.e)._hx_index){case 0:var e=A.c;switch(e._hx_index){case 2:var i=e.v;return this.allocConst(i,t.p);case 3:i=e.v;return this.allocConst(i,t.p);default:return t}break;case 2:switch(A.g._hx_index){case 0:this.allocConst(Math.PI/180,t.p);break;case 1:this.allocConst(180/Math.PI,t.p);break;case 9:this.allocConst(1.4426950408889634,t.p);break;case 10:this.allocConst(.6931471805599453,t.p);break;case 24:this.allocConst(1,t.p);break;case 26:this.allocConst(2,t.p),this.allocConst(3,t.p);break;case 54:this.allocConsts([1,255,65025,16581375],t.p),this.allocConsts([.00392156862745098,.00392156862745098,.00392156862745098,0],t.p);break;case 55:this.allocConsts([1,.00392156862745098,15378700499807768e-21,6.030862941101084e-8],t.p);break;case 56:this.allocConst(1,t.p),this.allocConst(.5,t.p);break;case 57:this.allocConst(.5,t.p);break;case 58:this.allocConsts([.5,.5],t.p),this.allocConsts([.5,-.5],t.p);break;case 59:this.allocConsts([2,-2],t.p),this.allocConsts([-1,1],t.p)}break;case 5:var n=A.e1;n=A.e2;if(1==A.op._hx_index){var s=n.e;s=n.p;8==n.t._hx_index&&this.allocConst(1,t.p)}break;case 8:n=A.e,s=A.args;var r=n.e,a=n.p;a=n.t;if(2==r._hx_index&&42==r.g._hx_index&&2==s.length){n=s[0],r=s[1],s=n.e,a=n.p,a=n.t;if(1==s._hx_index){s=(n=s.v).id,s=n.name,s=n.parent,s=n.qualifiers,s=n.type;switch(n.kind._hx_index){case 0:if(5==a._hx_index&&3==a.size&&1==a.t._hx_index){n=r.e,s=r.p,s=r.t;if(0==n._hx_index)if(2==(s=n.c)._hx_index&&1==s.v)return t}break;case 1:if(5==a._hx_index&&3==a.size&&1==a.t._hx_index){n=r.e,s=r.p,s=r.t;if(0==n._hx_index)if(2==(s=n.c)._hx_index&&1==s.v)return t}break;case 2:if(5==a._hx_index&&3==a.size&&1==a.t._hx_index){n=r.e,s=r.p,s=r.t;if(0==n._hx_index)if(2==(s=n.c)._hx_index&&1==s.v)return t}break;case 3:if(5==a._hx_index&&3==a.size&&1==a.t._hx_index){n=r.e,s=r.p,s=r.t;if(0==n._hx_index)if(2==(s=n.c)._hx_index&&1==s.v)return t}}}}break;case 16:n=A.e;var A=(s=A.index).e;r=s.p,r=s.t;if(0==A._hx_index){if(2==(r=A.c)._hx_index){A=r.v;var h=s,o=n;return{e:nA.TArray(this.mapConsts(o),h),t:t.t,p:t.p}}h=s;if(15==(A=(o=n).t)._hx_index){r=A.size;var l=A.t,u=this.varSize(l,ja.VFloat)>>2;this.allocConst(u,t.p)}}else{h=s;if(15==(A=(o=n).t)._hx_index){n=A.size,l=A.t,u=this.varSize(l,ja.VFloat)>>2;this.allocConst(u,t.p)}}}return sA.map(t,XA(this,this.mapConsts))},allocConst:function(t,e){var i=this.consts.indexOf(t);return i<0&&(i=this.consts.length,this.consts.push(t)),{e:nA.TArray(this.econsts,{e:nA.TConst(Ka.CInt(i)),t:Xa.TInt,p:e}),t:Xa.TFloat,p:e}},allocConsts:function(t,e){for(var i=this,n=t.length-1&3,s=-1,r=0,a=this.consts.length-(t.length-1);r<a;){var A=r++;if(A>>2==A+n>>2){for(var h=!0,o=0,l=t.length;o<l;){var u=o++;if(this.consts[A+u]!=t[u]){h=!1;break}}if(h){s=A;break}}}if(s<0){for(;this.consts.length>>2!=this.consts.length+n>>2;)this.consts.push(0);s=this.consts.length;for(r=0;r<t.length;){var _=t[r];++r,this.consts.push(_)}}switch(t.length){case 1:return{e:nA.TArray(i.econsts,{e:nA.TConst(Ka.CInt(s)),t:Xa.TInt,p:e}),t:Xa.TFloat,p:e};case 2:return{e:nA.TCall({e:nA.TGlobal(eA.Vec2),t:Xa.TVoid,p:e},[{e:nA.TArray(i.econsts,{e:nA.TConst(Ka.CInt(s)),t:Xa.TInt,p:e}),t:Xa.TFloat,p:e},{e:nA.TArray(i.econsts,{e:nA.TConst(Ka.CInt(s+1)),t:Xa.TInt,p:e}),t:Xa.TFloat,p:e}]),t:Xa.TVec(2,ja.VFloat),p:e};case 3:return{e:nA.TCall({e:nA.TGlobal(eA.Vec3),t:Xa.TVoid,p:e},[{e:nA.TArray(i.econsts,{e:nA.TConst(Ka.CInt(s)),t:Xa.TInt,p:e}),t:Xa.TFloat,p:e},{e:nA.TArray(i.econsts,{e:nA.TConst(Ka.CInt(s+1)),t:Xa.TInt,p:e}),t:Xa.TFloat,p:e},{e:nA.TArray(i.econsts,{e:nA.TConst(Ka.CInt(s+2)),t:Xa.TInt,p:e}),t:Xa.TFloat,p:e}]),t:Xa.TVec(3,ja.VFloat),p:e};case 4:return{e:nA.TCall({e:nA.TGlobal(eA.Vec4),t:Xa.TVoid,p:e},[{e:nA.TArray(i.econsts,{e:nA.TConst(Ka.CInt(s)),t:Xa.TInt,p:e}),t:Xa.TFloat,p:e},{e:nA.TArray(i.econsts,{e:nA.TConst(Ka.CInt(s+1)),t:Xa.TInt,p:e}),t:Xa.TFloat,p:e},{e:nA.TArray(i.econsts,{e:nA.TConst(Ka.CInt(s+3)),t:Xa.TInt,p:e}),t:Xa.TFloat,p:e},{e:nA.TArray(i.econsts,{e:nA.TConst(Ka.CInt(s+4)),t:Xa.TInt,p:e}),t:Xa.TFloat,p:e}]),t:Xa.TVec(4,ja.VFloat),p:e};default:throw kn.thrown("assert")}},mkInt:function(t,e){return{e:nA.TConst(Ka.CInt(t)),t:Xa.TInt,p:e}},readIndex:function(t,e,i){var n=null==t.t?t.pos:t.pos>>2;return{e:nA.TArray({e:nA.TVar(t.g),t:t.g.type,p:i},{e:nA.TConst(Ka.CInt(n+e)),t:Xa.TInt,p:i}),t:Xa.TVec(4,t.t),p:i}},readOffset:function(t,e,i,n,s){var r=(null==t.t?t.pos:t.pos>>2)+n,a=0==r?i:{e:nA.TBinop(_s.OpAdd,i,{e:nA.TConst(Ka.CInt(r)),t:Xa.TInt,p:s}),t:Xa.TInt,p:s};return{e:nA.TArray({e:nA.TVar(t.g),t:t.g.type,p:s},a),t:Xa.TVec(4,t.t),p:s}},access:function(t,e,i,n){switch(e._hx_index){case 6:var s=this.access(t,Xa.TMat3x4,i,n);return{e:nA.TCall({e:nA.TGlobal(eA.Mat3),t:Xa.TFun([]),p:i},[s]),t:Xa.TMat3,p:i};case 7:s=nA.TGlobal(eA.Mat4);var r,a=Xa.TFun([]);switch(n._hx_index){case 0:var A=null==(h=n.a).t?h.pos:h.pos>>2;_={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},{e:nA.TConst(Ka.CInt(A)),t:Xa.TInt,p:i}),t:Xa.TVec(4,h.t),p:i};break;case 1:var h=n.a,o=n.stride,l=n.delta,u=0==(B=null==h.t?h.pos:h.pos>>2)?l:{e:nA.TBinop(_s.OpAdd,l,{e:nA.TConst(Ka.CInt(B)),t:Xa.TInt,p:i}),t:Xa.TInt,p:i};_={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},u),t:Xa.TVec(4,h.t),p:i}}switch(n._hx_index){case 0:A=null==(h=n.a).t?h.pos:h.pos>>2;c={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},{e:nA.TConst(Ka.CInt(A+1)),t:Xa.TInt,p:i}),t:Xa.TVec(4,h.t),p:i};break;case 1:h=n.a,o=n.stride,l=n.delta,u=0==(B=(null==h.t?h.pos:h.pos>>2)+1)?l:{e:nA.TBinop(_s.OpAdd,l,{e:nA.TConst(Ka.CInt(B)),t:Xa.TInt,p:i}),t:Xa.TInt,p:i};c={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},u),t:Xa.TVec(4,h.t),p:i}}switch(n._hx_index){case 0:A=null==(h=n.a).t?h.pos:h.pos>>2;d={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},{e:nA.TConst(Ka.CInt(A+2)),t:Xa.TInt,p:i}),t:Xa.TVec(4,h.t),p:i};break;case 1:h=n.a,o=n.stride,l=n.delta,u=0==(B=(null==h.t?h.pos:h.pos>>2)+2)?l:{e:nA.TBinop(_s.OpAdd,l,{e:nA.TConst(Ka.CInt(B)),t:Xa.TInt,p:i}),t:Xa.TInt,p:i};d={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},u),t:Xa.TVec(4,h.t),p:i}}switch(n._hx_index){case 0:A=null==(h=n.a).t?h.pos:h.pos>>2;r={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},{e:nA.TConst(Ka.CInt(A+3)),t:Xa.TInt,p:i}),t:Xa.TVec(4,h.t),p:i};break;case 1:h=n.a,o=n.stride,l=n.delta,u=0==(B=(null==h.t?h.pos:h.pos>>2)+3)?l:{e:nA.TBinop(_s.OpAdd,l,{e:nA.TConst(Ka.CInt(B)),t:Xa.TInt,p:i}),t:Xa.TInt,p:i};r={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},u),t:Xa.TVec(4,h.t),p:i}}return{e:nA.TCall({e:s,t:a,p:i},[_,c,d,r]),t:Xa.TMat4,p:i};case 8:var _,c,d;s=nA.TGlobal(eA.Mat3x4),a=Xa.TFun([]);switch(n._hx_index){case 0:A=null==(h=n.a).t?h.pos:h.pos>>2;_={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},{e:nA.TConst(Ka.CInt(A)),t:Xa.TInt,p:i}),t:Xa.TVec(4,h.t),p:i};break;case 1:h=n.a,o=n.stride,l=n.delta,u=0==(B=null==h.t?h.pos:h.pos>>2)?l:{e:nA.TBinop(_s.OpAdd,l,{e:nA.TConst(Ka.CInt(B)),t:Xa.TInt,p:i}),t:Xa.TInt,p:i};_={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},u),t:Xa.TVec(4,h.t),p:i}}switch(n._hx_index){case 0:A=null==(h=n.a).t?h.pos:h.pos>>2;c={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},{e:nA.TConst(Ka.CInt(A+1)),t:Xa.TInt,p:i}),t:Xa.TVec(4,h.t),p:i};break;case 1:h=n.a,o=n.stride,l=n.delta,u=0==(B=(null==h.t?h.pos:h.pos>>2)+1)?l:{e:nA.TBinop(_s.OpAdd,l,{e:nA.TConst(Ka.CInt(B)),t:Xa.TInt,p:i}),t:Xa.TInt,p:i};c={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},u),t:Xa.TVec(4,h.t),p:i}}switch(n._hx_index){case 0:A=null==(h=n.a).t?h.pos:h.pos>>2;d={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},{e:nA.TConst(Ka.CInt(A+2)),t:Xa.TInt,p:i}),t:Xa.TVec(4,h.t),p:i};break;case 1:h=n.a,o=n.stride,l=n.delta,u=0==(B=(null==h.t?h.pos:h.pos>>2)+2)?l:{e:nA.TBinop(_s.OpAdd,l,{e:nA.TConst(Ka.CInt(B)),t:Xa.TInt,p:i}),t:Xa.TInt,p:i};d={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},u),t:Xa.TVec(4,h.t),p:i}}return{e:nA.TCall({e:s,t:a,p:i},[_,c,d]),t:Xa.TMat3x4,p:i};case 15:if(0==(p=e.size)._hx_index){for(var f=p.v,x=e.t,p=(o=t.size/f|0,[]),g=0,m=f;g<m;){var v=g++;h=new pA(t.g,t.t,t.pos+o*v,o);p.push(this.access(h,x,i,gA.AIndex(h)))}var y=p;return{e:nA.TArrayDecl(y),t:x,p:i}}if(sA.isSampler(e)){switch(n._hx_index){case 0:A=null==(h=n.a).t?h.pos:h.pos>>2;M={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},{e:nA.TConst(Ka.CInt(A)),t:Xa.TInt,p:i}),t:Xa.TVec(4,h.t),p:i};break;case 1:h=n.a,o=n.stride,l=n.delta,u=0==(B=null==h.t?h.pos:h.pos>>2)?l:{e:nA.TBinop(_s.OpAdd,l,{e:nA.TConst(Ka.CInt(B)),t:Xa.TInt,p:i}),t:Xa.TInt,p:i};M={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},u),t:Xa.TVec(4,h.t),p:i}}return M.t=e,M}if((w=this.varSize(e,t.t))>4)return Wa.t("Access not supported for "+sA.toString(e),null);switch(n._hx_index){case 0:A=null==(h=n.a).t?h.pos:h.pos>>2;M={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},{e:nA.TConst(Ka.CInt(A)),t:Xa.TInt,p:i}),t:Xa.TVec(4,h.t),p:i};break;case 1:h=n.a,o=n.stride,l=n.delta,u=0==(B=null==h.t?h.pos:h.pos>>2)?l:{e:nA.TBinop(_s.OpAdd,l,{e:nA.TConst(Ka.CInt(B)),t:Xa.TInt,p:i}),t:Xa.TInt,p:i};M={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},u),t:Xa.TVec(4,h.t),p:i}}if(4==w){if(0!=(3&t.pos))throw kn.thrown("assert")}else{var b=[];for(p=0,g=w;p<g;){v=p++;b.push(sA.SWIZ[v+(3&t.pos)])}M={e:nA.TSwiz(M,b),t:e,p:i}}switch(e._hx_index){case 1:M.t=Xa.TFloat,M=this.toInt(M);break;case 5:if(0==e.t._hx_index){var w=e.size;M.t=Xa.TVec(w,ja.VFloat),M={e:nA.TCall({e:nA.TGlobal([eA.IVec2,eA.IVec3,eA.IVec4][w-2]),t:Xa.TFun([]),p:i},[M]),t:e,p:i}}}return M;default:if(sA.isSampler(e)){switch(n._hx_index){case 0:A=null==(h=n.a).t?h.pos:h.pos>>2;M={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},{e:nA.TConst(Ka.CInt(A)),t:Xa.TInt,p:i}),t:Xa.TVec(4,h.t),p:i};break;case 1:h=n.a,o=n.stride,l=n.delta,u=0==(B=null==h.t?h.pos:h.pos>>2)?l:{e:nA.TBinop(_s.OpAdd,l,{e:nA.TConst(Ka.CInt(B)),t:Xa.TInt,p:i}),t:Xa.TInt,p:i};M={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},u),t:Xa.TVec(4,h.t),p:i}}return M.t=e,M}var M;if((w=this.varSize(e,t.t))>4)return Wa.t("Access not supported for "+sA.toString(e),null);switch(n._hx_index){case 0:A=null==(h=n.a).t?h.pos:h.pos>>2;M={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},{e:nA.TConst(Ka.CInt(A)),t:Xa.TInt,p:i}),t:Xa.TVec(4,h.t),p:i};break;case 1:var B;h=n.a,o=n.stride,l=n.delta,u=0==(B=null==h.t?h.pos:h.pos>>2)?l:{e:nA.TBinop(_s.OpAdd,l,{e:nA.TConst(Ka.CInt(B)),t:Xa.TInt,p:i}),t:Xa.TInt,p:i};M={e:nA.TArray({e:nA.TVar(h.g),t:h.g.type,p:i},u),t:Xa.TVec(4,h.t),p:i}}if(4==w){if(0!=(3&t.pos))throw kn.thrown("assert")}else{for(b=[],p=0,g=w;p<g;){v=p++;b.push(sA.SWIZ[v+(3&t.pos)])}M={e:nA.TSwiz(M,b),t:e,p:i}}switch(e._hx_index){case 1:M.t=Xa.TFloat,M=this.toInt(M);break;case 5:if(0==e.t._hx_index){w=e.size;M.t=Xa.TVec(w,ja.VFloat),M={e:nA.TCall({e:nA.TGlobal([eA.IVec2,eA.IVec3,eA.IVec4][w-2]),t:Xa.TFun([]),p:i},[M]),t:e,p:i}}}return M}},toInt:function(t){return t.t==Xa.TInt?t:{e:nA.TCall({e:nA.TGlobal(eA.ToInt),t:Xa.TFun([]),p:t.p},[t]),t:Xa.TInt,p:t.p}},optimize:function(t){switch((l=t.e)._hx_index){case 8:var e=l.e,i=l.args,n=e.e;e.p,e.t;if(2==n._hx_index&&52==n.g._hx_index&&1==i.length){i=(e=i[0]).e,n=e.p,n=e.t;if(8==i._hx_index){n=(e=i.e).e,e.p,e.t;if(2==n._hx_index&&51==n.g._hx_index){for(var s=i.args,r=0,a=0;a<4;){var A=s[s.length-1-r].t;a+=this.varSize(A,ja.VFloat),++r}if(4==a){var h;for(e=0,i=r;e<i;){var o=e++;s.pop()}if(8!=(e=t.e)._hx_index)throw kn.thrown("assert");i=e.args;return h=e.e,{e:nA.TCall(h,s),t:t.t,p:t.p}}}}}break;case 16:e=l.e,i=l.index;var l=e.e;n=e.p,n=e.t;if(17==l._hx_index){e=i.e,n=i.p,n=i.t;if(0==e._hx_index)if(2==(i=e.c)._hx_index){o=i.v;var u=l.el;if(o>=0&&o<u.length)return u[o];Wa.t("Reading outside array bounds",t.p)}}}return t},packTextures:function(t,e,i){for(var n=[],s={id:sA.allocVarId(),name:t,type:i,kind:Za.Param},r=0,a=[],A=0;A<e.length;){var h=e[A];++A;var o=1;if(h.type!=i)switch((g=h.type)._hx_index){case 15:var l=g.size;if(0!=l._hx_index)continue;var u=l.v;if(g.t!=i)continue;o=u;break;case 17:g.size;if(i!=Xa.TSampler2D)continue;break;default:continue}var _=new pA(s,null,r,o);if(_.v=h,null!=h.qualifiers)for(var c=0,d=h.qualifiers;c<d.length;){var f=d[c];if(++c,12==f._hx_index){t=f.name;for(var x=0,p=o;x<p;){a[r+(m=x++)]=t}}}this.varMap.set(h,_),n.push(_),r+=o}if(s.type=Xa.TArray(i,Ha.SConst(r)),a.length>0){A=0;for(var g=r;A<g;){var m;null==a[m=A++]&&(a[m]="")}null==s.qualifiers&&(s.qualifiers=[]),s.qualifiers.push(Ja.Sampler(a.join(",")))}return n.length>0&&(this.outVars.push(s),this.allocData.set(s,n)),n},packBuffers:function(t){for(var e=[],i={id:sA.allocVarId(),name:"buffers",type:Xa.TVoid,kind:Za.Param},n=0;n<t.length;){var s=t[n];++n;var r,a=s.type;if(16==a._hx_index){a.t,a.size;r=!0}else r=!1;if(r){var A=new pA(i,null,e.length,1);A.v=s,e.push(A),this.outVars.push(s)}}i.type=Xa.TArray(Xa.TBuffer(Xa.TVoid,Ha.SConst(0)),Ha.SConst(e.length)),this.allocData.set(i,e)},pack:function(t,e,i,n){for(var s=[],r=0,a={id:sA.allocVarId(),name:t,type:Xa.TVec(0,n),kind:e},A=0;A<i.length;){var h,o=i[A];if(++A,sA.isSampler(o.type))h=!0;else{var l=o.type;if(16==l._hx_index){l.t,l.size;h=!0}else h=!1}if(!h){var u=o.type;if(15==u._hx_index){u.size;var _=u.t;if(sA.isSampler(_))continue}for(var c=this.varSize(o.type,n),d=null,f=0;f<s.length;){var x=s[f];++f,null==x.v&&x.size>=c&&(null==d||d.size>x.size)&&(d=x)}if(null!=d){var p=d.size-c;if(p>0){var g=s.indexOf(d),m=new pA(a,n,d.pos+c,p);s.splice(g+1,0,m),d.size=c}d.v=o,this.varMap.set(o,d)}else{var v=new pA(a,n,r,c);r+=c,v.v=o,this.varMap.set(o,v),s.push(v);var y=(4-c%4)%4;if(y>0){var b=new pA(a,n,r,y);r+=y,s.push(b)}}}}return a.type=Xa.TArray(Xa.TVec(4,n),Ha.SConst(r>>2)),r>0&&(this.outVars.push(a),this.allocData.set(a,s)),a},varSize:function(t,e){switch(t._hx_index){case 1:case 3:if(e==ja.VFloat)return 1;throw kn.thrown(sA.toString(t)+" size unknown for type "+x.string(e));case 5:var i=t.size;if(e==t.t)return i;throw kn.thrown(sA.toString(t)+" size unknown for type "+x.string(e));case 7:if(e==ja.VFloat)return 16;throw kn.thrown(sA.toString(t)+" size unknown for type "+x.string(e));case 6:case 8:if(e==ja.VFloat)return 12;throw kn.thrown(sA.toString(t)+" size unknown for type "+x.string(e));case 15:var n=t.size;if(0==n._hx_index){i=n.v;var s=t.t;return this.varSize(s,e)*i}throw kn.thrown(sA.toString(t)+" size unknown for type "+x.string(e));default:throw kn.thrown(sA.toString(t)+" size unknown for type "+x.string(e))}},gatherVar:function(t){if(13==(i=t.type)._hx_index)for(var e=i.vl,i=0;i<e.length;){var n=e[i];++i,this.gatherVar(n)}else switch(t.kind._hx_index){case 0:sA.hasQualifier(t,Ja.PerObject)?this.params.push(t):this.globals.push(t);break;case 2:this.params.push(t);break;default:this.outVars.push(t)}},__class__:mA};var vA=function(){this.channels=[],this.map=new Wn};i["hxsl.Globals"]=vA,vA.__name__="hxsl.Globals",vA.allocID=function(t){null==vA.MAP&&(vA.MAP=new Kn,vA.ALL=[]);var e=vA.MAP.h[t];return null==e&&(e=vA.ALL.length,vA.ALL.push(t),vA.MAP.h[t]=e),e},vA.getIDName=function(t){return vA.ALL[t]},vA.prototype={set:function(t,e){var i=this.map,n=vA.allocID(t);i.h[n]=e},get:function(t){var e=this.map,i=vA.allocID(t);return e.h[i]},fastSet:function(t,e){this.map.h[t]=e},fastGet:function(t){return this.map.h[t]},resetChannels:function(){this.maxChannels=0},allocChannelID:function(t){for(var e=0,i=this.maxChannels;e<i;){var n=e++;if(this.channels[n]==t)return n}if(this.maxChannels==1<<sA.MAX_CHANNELS_BITS)throw kn.thrown("Too many unique channels");n=this.maxChannels++;return this.channels[n]=t,n},__class__:vA};var yA=function(){};i["js.Boot"]=yA,yA.__name__="js.Boot",yA.getClass=function(t){if(null==t)return null;if(t instanceof Array)return Array;var e=t.__class__;if(null!=e)return e;var i=yA.__nativeClassName(t);return null!=i?yA.__resolveNativeClass(i):null},yA.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var i=typeof t;switch("function"==i&&(t.__name__||t.__ename__)&&(i="object"),i){case"function":return"<function>";case"object":if(t.__enum__){var n=s[t.__enum__].__constructs__[t._hx_index],r=n._hx_name;return n.__params__?(e+="\t",r+"("+function(i){for(var s=[],r=0,a=n.__params__;r<a.length;){var A=a[r];r+=1,s.push(yA.__string_rec(t[A],e))}return s}().join(",")+")"):r}if(t instanceof Array){var a="[";e+="\t";for(var A=0,h=t.length;A<h;){var o=A++;a+=(o>0?",":"")+yA.__string_rec(t[o],e)}return a+="]"}var l;try{l=t.toString}catch(A){return"???"}if(null!=l&&l!=Object.toString&&"function"==typeof l){var u=t.toString();if("[object Object]"!=u)return u}a="{\n";e+="\t";var _=null!=t.hasOwnProperty,c=null;for(c in t)_&&!t.hasOwnProperty(c)||"prototype"!=c&&"__class__"!=c&&"__super__"!=c&&"__interfaces__"!=c&&"__properties__"!=c&&(2!=a.length&&(a+=", \n"),a+=e+c+" : "+yA.__string_rec(t[c],e));return a+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},yA.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var i=t.__interfaces__;if(null!=i)for(var n=0,s=i.length;n<s;){var r=i[n++];if(r==e||yA.__interfLoop(r,e))return!0}return yA.__interfLoop(t.__super__,e)},yA.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array;case JA:return"boolean"==typeof t;case WA:return null!=t;case ZA:return"number"==typeof t;case HA:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(yA.__downcastCheck(t,e))return!0}else if("object"==typeof e&&yA.__isNativeObj(e)&&t instanceof e)return!0;return e==qA&&null!=t.__name__||(e==KA&&null!=t.__ename__||null!=t.__enum__&&s[t.__enum__]==e)}},yA.__downcastCheck=function(t,e){return t instanceof e||!!e.__isInterface__&&yA.__interfLoop(yA.getClass(t),e)},yA.__cast=function(t,e){if(null==t||yA.__instanceof(t,e))return t;throw kn.thrown("Cannot cast "+x.string(t)+" to "+x.string(e))},yA.__nativeClassName=function(t){var e=yA.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},yA.__isNativeObj=function(t){return null!=yA.__nativeClassName(t)},yA.__resolveNativeClass=function(e){return t[e]};var bA=function(){this.outIndex=0,this.uniformBuffer=0,this.exprIds=0,this.varNames=new Wn,this.allNames=new Kn};i["hxsl.GlslOut"]=bA,bA.__name__="hxsl.GlslOut",bA.compile=function(t){var e=new bA;return e.glES=1,e.version=100,e.run(t)},bA.prototype={get_isES:function(){return null!=this.glES},get_isES2:function(){return null!=this.glES&&this.glES<=2},add:function(t){this.buf.b+=x.string(t)},ident:function(t){var e=this.varName(t);this.buf.b+=x.string(e)},decl:function(t){for(var e=0,i=this.decls;e<i.length;){var n=i[e];if(++e,n==t)return}35==l.cca(t,0)?this.decls.unshift(t):this.decls.push(t)},addType:function(t){switch(t._hx_index){case 0:this.buf.b+=x.string("void");break;case 1:this.buf.b+=x.string("int");break;case 2:this.buf.b+=x.string("bool");break;case 3:this.buf.b+=x.string("float");break;case 4:this.buf.b+=x.string("string");break;case 5:var e=t.size;switch(t.t._hx_index){case 0:this.buf.b+=x.string("i");break;case 1:break;case 2:this.buf.b+=x.string("b")}this.buf.b+=x.string("vec"),this.buf.b+=x.string(e);break;case 6:this.buf.b+=x.string("mat3");break;case 7:this.buf.b+=x.string("mat4");break;case 8:this.decl(bA.MAT34),this.buf.b+=x.string("_mat3x4");break;case 9:var i=t.size;this.buf.b+=x.string("vec"),this.buf.b+=x.string(i);break;case 10:this.buf.b+=x.string("sampler2D");break;case 11:this.buf.b+=x.string("sampler2DArray"),null!=this.glES&&this.decl("precision lowp sampler2DArray;");break;case 12:this.buf.b+=x.string("samplerCube");break;case 13:var n=t.vl;this.buf.b+=x.string("struct { ");for(var s=0;s<n.length;){var r=n[s];++s,this.addVar(r),this.buf.b+=x.string(";")}this.buf.b+=x.string(" }");break;case 14:s=t.variants;this.buf.b+=x.string("function");break;case 15:var a=t.t;e=t.size;switch(this.addType(a),this.buf.b+=x.string("["),e._hx_index){case 0:if(1==(s=e.v))if(this.intelDriverFix)this.buf.b+=x.string(2);else{r=s;this.buf.b+=x.string(r)}else{r=s;this.buf.b+=x.string(r)}break;case 1:r=e.v;var A=this.varName(r);this.buf.b+=x.string(A)}this.buf.b+=x.string("]");break;case 16:s=t.t,s=t.size;throw kn.thrown("assert");case 17:i=t.size;this.buf.b+=x.string("channel"+i);break;case 18:this.buf.b+=x.string("mat2")}},addVar:function(t){var e=t.type;switch(e._hx_index){case 15:var i=e.t,n=e.size,s=t.type;switch(t.type=i,this.addVar(t),t.type=s,this.buf.b+=x.string("["),n._hx_index){case 0:var r=n.v;if(1==r)if(this.intelDriverFix)this.buf.b+=x.string(2);else{var a=r;this.buf.b+=x.string(a)}else{a=r;this.buf.b+=x.string(a)}break;case 1:var A=n.v,h=this.varName(A);this.buf.b+=x.string(h)}this.buf.b+=x.string("]");break;case 16:i=e.t,n=e.size;this.buf.b+=x.string((this.isVertex?"vertex_":"")+"uniform_buffer"+this.uniformBuffer++),this.buf.b+=x.string(" { "),t.type=Xa.TArray(i,n),this.addVar(t),t.type=Xa.TBuffer(i,n),this.buf.b+=x.string("; }");break;default:this.addType(t.type),this.buf.b+=x.string(" ");A=this.varName(t);this.buf.b+=x.string(A)}},addValue:function(t,e){var i=t.e;switch(i._hx_index){case 4:var n=i.el,s="val"+this.exprIds++,r=this.buf;this.buf=new p,this.addType(t.t),this.buf.b+=x.string(" "),this.buf.b+=x.string(s),this.buf.b+=x.string("(void)");var a=n.slice(),A=a[a.length-1];a[a.length-1]={e:nA.TReturn(A),t:t.t,p:A.p};var h={t:Xa.TVoid,e:nA.TBlock(a),p:t.p};this.addExpr(h,""),this.exprValues.push(this.buf.b),this.buf=r,this.buf.b+=x.string(s),this.buf.b+=x.string("()");break;case 10:var o=i.econd,l=i.eif,u=i.eelse;this.buf.b+=x.string("( "),this.addValue(o,e),this.buf.b+=x.string(" ) ? "),this.addValue(l,e),this.buf.b+=x.string(" : "),this.addValue(u,e);break;case 20:i.m,i.args;var _=i.e;this.addValue(_,e);break;default:this.addExpr(t,e)}},addBlock:function(t,e){this.addExpr(t,e)},getFunName:function(t,e,i){switch(t._hx_index){case 20:if(i==Xa.TInt&&null!=this.glES)return this.decl("int _imod( int x, int y ) { return int(mod(float(x),float(y))); }"),"_imod";break;case 33:switch((n=e[0].t)._hx_index){case 10:case 11:if(null!=this.glES&&this.glES<=2)return"texture2D";break;case 12:if(null!=this.glES&&this.glES<=2)return"textureCube";break;case 17:n.size;if(null!=this.glES&&this.glES<=2)return"texture2D"}break;case 34:var n;switch((n=e[0].t)._hx_index){case 10:case 11:if(null!=this.glES&&this.glES<=2)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),"texture2DLodEXT";break;case 12:if(null!=this.glES&&this.glES<=2)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),"textureCubeLodEXT";break;case 17:n.size;if(null!=this.glES&&this.glES<=2)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),"texture2DLodEXT"}break;case 35:return"texelFetch";case 36:return this.decl("vec2 _textureSize(sampler2D sampler, int lod) { return vec2(textureSize(sampler, lod)); }"),this.decl("vec3 _textureSize(sampler2DArray sampler, int lod) { return vec3(textureSize(sampler, lod)); }"),this.decl("vec2 _textureSize(samplerCube sampler, int lod) { return vec2(textureSize(sampler, lod)); }"),"_textureSize";case 50:if(e[0].t==Xa.TMat3x4)return this.decl(bA.MAT34),this.decl("mat3 _mat3( _mat3x4 v ) { return mat3(v.a.xyz,v.b.xyz,v.c.xyz); }"),"_mat3";break;case 52:if(this.decl(bA.MAT34),1==e.length)return this.decl("_mat3x4 mat_to_34( mat4 m ) { return _mat3x4(m[0],m[1],m[2]); }"),"mat_to_34";break;case 54:this.decl("vec4 pack( float v ) { vec4 color = fract(v * vec4(1, 255, 255.*255., 255.*255.*255.)); return color - color.yzww * vec4(1. / 255., 1. / 255., 1. / 255., 0.); }");break;case 55:this.decl("float unpack( vec4 color ) { return dot(color,vec4(1., 1. / 255., 1. / (255. * 255.), 1. / (255. * 255. * 255.))); }");break;case 56:this.decl("vec4 packNormal( vec3 v ) { return vec4((v + vec3(1.)) * vec3(0.5),1.); }");break;case 57:this.decl("vec3 unpackNormal( vec4 v ) { return normalize((v.xyz - vec3(0.5)) * vec3(2.)); }");break;case 58:this.decl("vec2 screenToUv( vec2 v ) { return v * vec2(0.5,-0.5) + vec2(0.5,0.5); }");break;case 59:this.decl("vec2 uvToScreen( vec2 v ) { return v * vec2(2.,-2.) + vec2(-1., 1.); }");break;case 60:case 61:case 62:this.decl("#extension GL_OES_standard_derivatives:enable")}return bA.GLOBALS.get(t)},addExpr:function(t,e){var i=t.e;switch(i._hx_index){case 0:var n=i.c;switch(n._hx_index){case 0:this.buf.b+=x.string("null");break;case 1:var s=n.b;this.buf.b+=x.string(s);break;case 2:var r=n.v;this.buf.b+=x.string(r);break;case 3:var a=""+n.v;this.buf.b+=x.string(a),-1==a.indexOf(".")&&-1==a.indexOf("e")&&(this.buf.b+=x.string("."));break;case 4:r=n.v;this.buf.b+=x.string('"'+r+'"')}break;case 1:r=i.v;var A=this.varName(r);this.buf.b+=x.string(A);break;case 2:var h=i.g;r=bA.GLOBALS.get(h);this.buf.b+=x.string(r);break;case 3:var o=i.e;this.buf.b+=x.string("("),this.addValue(o,e),this.buf.b+=x.string(")");break;case 4:var l=i.el;this.buf.b+=x.string("{\n");for(var u=e+"\t",_=0;_<l.length;){o=l[_];++_,this.buf.b+=x.string(u),this.addExpr(o,u),this.newLine(o)}this.buf.b+=x.string(e),this.buf.b+=x.string("}");break;case 5:var c=i.op,d=(o=i.e1,i.e2),f=(_=o.t,d.t);switch(c._hx_index){case 1:if(5==_._hx_index)if(3==_.size)if(1==_.t._hx_index)if(8==f._hx_index){if(this.decl(bA.MAT34),this.decl("vec3 m3x4mult( vec3 v, _mat3x4 m) { vec4 ve = vec4(v,1.0); return vec3(dot(m.a,ve),dot(m.b,ve),dot(m.c,ve)); }"),20==c._hx_index){var p=c.op;B=!0}else B=!1;B&&(this.addValue(o,e),this.buf.b+=x.string(" = ")),this.buf.b+=x.string("m3x4mult("),this.addValue(o,e),this.buf.b+=x.string(","),this.addValue(d,e),this.buf.b+=x.string(")")}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;case 5:if(5==_._hx_index){p=_.t;if(5==f._hx_index){p=f.size,p=f.t;var g=_.size;switch(this.buf.b+=x.string("vec"+g+"("),c._hx_index){case 5:r="equal";break;case 6:r="notEqual";break;case 7:r="greaterThan";break;case 8:r="greaterThanEqual";break;case 9:r="lessThan";break;case 10:r="lessThanEqual";break;default:throw kn.thrown("assert")}this.buf.b+=x.string(r),this.buf.b+=x.string("("),this.addValue(o,e),this.buf.b+=x.string(","),this.addValue(d,e),this.buf.b+=x.string("))")}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;case 6:if(5==_._hx_index){p=_.t;if(5==f._hx_index){p=f.size,p=f.t,g=_.size;switch(this.buf.b+=x.string("vec"+g+"("),c._hx_index){case 5:r="equal";break;case 6:r="notEqual";break;case 7:r="greaterThan";break;case 8:r="greaterThanEqual";break;case 9:r="lessThan";break;case 10:r="lessThanEqual";break;default:throw kn.thrown("assert")}this.buf.b+=x.string(r),this.buf.b+=x.string("("),this.addValue(o,e),this.buf.b+=x.string(","),this.addValue(d,e),this.buf.b+=x.string("))")}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;case 7:if(5==_._hx_index){p=_.t;if(5==f._hx_index){p=f.size,p=f.t,g=_.size;switch(this.buf.b+=x.string("vec"+g+"("),c._hx_index){case 5:r="equal";break;case 6:r="notEqual";break;case 7:r="greaterThan";break;case 8:r="greaterThanEqual";break;case 9:r="lessThan";break;case 10:r="lessThanEqual";break;default:throw kn.thrown("assert")}this.buf.b+=x.string(r),this.buf.b+=x.string("("),this.addValue(o,e),this.buf.b+=x.string(","),this.addValue(d,e),this.buf.b+=x.string("))")}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;case 8:if(5==_._hx_index){p=_.t;if(5==f._hx_index){p=f.size,p=f.t,g=_.size;switch(this.buf.b+=x.string("vec"+g+"("),c._hx_index){case 5:r="equal";break;case 6:r="notEqual";break;case 7:r="greaterThan";break;case 8:r="greaterThanEqual";break;case 9:r="lessThan";break;case 10:r="lessThanEqual";break;default:throw kn.thrown("assert")}this.buf.b+=x.string(r),this.buf.b+=x.string("("),this.addValue(o,e),this.buf.b+=x.string(","),this.addValue(d,e),this.buf.b+=x.string("))")}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;case 9:if(5==_._hx_index){p=_.t;if(5==f._hx_index){p=f.size,p=f.t,g=_.size;switch(this.buf.b+=x.string("vec"+g+"("),c._hx_index){case 5:r="equal";break;case 6:r="notEqual";break;case 7:r="greaterThan";break;case 8:r="greaterThanEqual";break;case 9:r="lessThan";break;case 10:r="lessThanEqual";break;default:throw kn.thrown("assert")}this.buf.b+=x.string(r),this.buf.b+=x.string("("),this.addValue(o,e),this.buf.b+=x.string(","),this.addValue(d,e),this.buf.b+=x.string("))")}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;case 10:if(5==_._hx_index){p=_.t;if(5==f._hx_index){p=f.size,p=f.t,g=_.size;switch(this.buf.b+=x.string("vec"+g+"("),c._hx_index){case 5:r="equal";break;case 6:r="notEqual";break;case 7:r="greaterThan";break;case 8:r="greaterThanEqual";break;case 9:r="lessThan";break;case 10:r="lessThanEqual";break;default:throw kn.thrown("assert")}this.buf.b+=x.string(r),this.buf.b+=x.string("("),this.addValue(o,e),this.buf.b+=x.string(","),this.addValue(d,e),this.buf.b+=x.string("))")}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;case 18:this.decl("int _ushr( int i, int j ) { return int(uint(i) >> uint(j)); }"),this.buf.b+=x.string("_ushr("),this.addValue(o,e),this.buf.b+=x.string(","),this.addValue(d,e),this.buf.b+=x.string(")");break;case 19:if(t.t!=Xa.TInt){if(20==c._hx_index){p=c.op;B=!0}else B=!1;B&&(this.addValue(o,e),this.buf.b+=x.string(" = ")),this.addExpr({e:nA.TCall({e:nA.TGlobal(eA.Mod),t:Xa.TFun([]),p:t.p},[o,d]),t:t.t,p:t.p},e)}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;case 20:switch(c.op._hx_index){case 1:if(5==_._hx_index)if(3==_.size)if(1==_.t._hx_index)if(8==f._hx_index){if(this.decl(bA.MAT34),this.decl("vec3 m3x4mult( vec3 v, _mat3x4 m) { vec4 ve = vec4(v,1.0); return vec3(dot(m.a,ve),dot(m.b,ve),dot(m.c,ve)); }"),20==c._hx_index){_=c.op;B=!0}else B=!1;B&&(this.addValue(o,e),this.buf.b+=x.string(" = ")),this.buf.b+=x.string("m3x4mult("),this.addValue(o,e),this.buf.b+=x.string(","),this.addValue(d,e),this.buf.b+=x.string(")")}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;case 19:if(t.t!=Xa.TInt){if(20==c._hx_index){_=c.op;B=!0}else B=!1;B&&(this.addValue(o,e),this.buf.b+=x.string(" = ")),this.addExpr({e:nA.TCall({e:nA.TGlobal(eA.Mod),t:Xa.TFun([]),p:t.p},[o,d]),t:t.t,p:t.p},e)}else{this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;default:this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;default:this.addValue(o,e),this.buf.b+=x.string(" ");r=SA.opStr(c);this.buf.b+=x.string(r),this.buf.b+=x.string(" "),this.addValue(d,e)}break;case 6:c=i.op,o=i.e1;switch(c._hx_index){case 0:r="++";break;case 1:r="--";break;case 2:r="!";break;case 3:r="-";break;case 4:r="~";break;default:throw kn.thrown("assert")}this.buf.b+=x.string(r),this.addValue(o,e);break;case 7:r=i.v;var m=i.init;if(this.locals.h[r.id]=r,null!=m){A=this.varName(r);this.buf.b+=x.string(A),this.buf.b+=x.string(" = "),this.addValue(m,e)}else this.buf.b+=x.string("/*var*/");break;case 8:_=i.e,f=i.args,p=_.e;var v=_.p;v=_.t;if(2==p._hx_index){switch((v=p.g)._hx_index){case 35:h=v;var y=f;r=this.getFunName(h,y,t.t);this.buf.b+=x.string(r),this.buf.b+=x.string("("),this.addValue(y[0],e),this.buf.b+=x.string(", "),this.addValue(y[1],e),2!=y.length?(this.buf.b+=x.string(", "),this.addValue(y[2],e),this.buf.b+=x.string(")")):this.buf.b+=x.string(", 0)");break;case 36:h=v,y=f,r=this.getFunName(h,y,t.t);this.buf.b+=x.string(r),this.buf.b+=x.string("("),this.addValue(y[0],e),1!=y.length?(this.buf.b+=x.string(", "),this.addValue(y[1],e),this.buf.b+=x.string(")")):this.buf.b+=x.string(", 0)");break;case 53:if(1==f.length){o=f[0];this.buf.b+=x.string("clamp("),this.addValue(o,e),this.buf.b+=x.string(", 0., 1.)")}else{y=f;if(2==(p=(r=_).e)._hx_index){h=p.g,A=this.getFunName(h,y,t.t);this.buf.b+=x.string(A)}else this.addValue(r,e);this.buf.b+=x.string("(");var b=!0;for(p=0;p<y.length;){o=y[p];++p,b?b=!1:this.buf.b+=x.string(", "),this.addValue(o,e)}this.buf.b+=x.string(")")}break;default:y=f;if(2==(p=(r=_).e)._hx_index){h=p.g,A=this.getFunName(h,y,t.t);this.buf.b+=x.string(A)}else this.addValue(r,e);this.buf.b+=x.string("(");for(b=!0,p=0;p<y.length;){o=y[p];++p,b?b=!1:this.buf.b+=x.string(", "),this.addValue(o,e)}this.buf.b+=x.string(")")}}else{y=f;if(2==(_=(r=_).e)._hx_index){h=_.g,A=this.getFunName(h,y,t.t);this.buf.b+=x.string(A)}else this.addValue(r,e);this.buf.b+=x.string("(");for(b=!0,_=0;_<y.length;){o=y[_];++_,b?b=!1:this.buf.b+=x.string(", "),this.addValue(o,e)}this.buf.b+=x.string(")")}break;case 9:o=i.e;var w=i.regs;if(3==o.t._hx_index){for(_=0;_<w.length;){var M=w[_];if(++_,M!=iA.X)throw kn.thrown("assert")}switch(w.length){case 1:this.addValue(o,e);break;case 2:this.decl("vec2 _vec2( float v ) { return vec2(v,v); }"),this.buf.b+=x.string("_vec2("),this.addValue(o,e),this.buf.b+=x.string(")");break;case 3:this.decl("vec3 _vec3( float v ) { return vec3(v,v,v); }"),this.buf.b+=x.string("_vec3("),this.addValue(o,e),this.buf.b+=x.string(")");break;case 4:this.decl("vec4 _vec4( float v ) { return vec4(v,v,v,v); }"),this.buf.b+=x.string("_vec4("),this.addValue(o,e),this.buf.b+=x.string(")");break;default:throw kn.thrown("assert")}}else{this.addValue(o,e),this.buf.b+=x.string(".");for(_=0;_<w.length;){M=w[_];++_;var B,C=this.buf,S=C.b;switch(M._hx_index){case 0:B="x";break;case 1:B="y";break;case 2:B="z";break;case 3:B="w"}C.b=S+x.string(B)}}break;case 10:var I=i.econd,k=i.eif,E=i.eelse;this.buf.b+=x.string("if( "),this.addValue(I,e),this.buf.b+=x.string(") "),this.addExpr(k,e),null!=E&&(this.isBlock(k)||(this.buf.b+=x.string(";")),this.buf.b+=x.string(" else "),this.addExpr(E,e));break;case 11:this.buf.b+=x.string("discard");break;case 12:null==(o=i.e)?this.buf.b+=x.string("return"):(this.buf.b+=x.string("return "),this.addValue(o,e));break;case 13:r=i.v;var F=i.it,T=i.loop;if(this.locals.h[r.id]=r,5!=(_=F.e)._hx_index)throw kn.thrown("assert");if(21!=_.op._hx_index)throw kn.thrown("assert");o=_.e1,d=_.e2;this.buf.b+=x.string("for("),this.buf.b+=x.string(r.name+"="),this.addValue(o,e),this.buf.b+=x.string(";"+r.name+"<"),this.addValue(d,e),this.buf.b+=x.string(";"+r.name+"++) "),this.addBlock(T,e);break;case 14:this.buf.b+=x.string("continue");break;case 15:this.buf.b+=x.string("break");break;case 16:o=i.e;var D=i.index;this.addValue(o,e),this.buf.b+=x.string("["),this.addValue(D,e),this.buf.b+=x.string("]");break;case 17:l=i.el;if(15!=(_=t.t)._hx_index)throw kn.thrown("assert");f=_.size;var P=_.t;this.addType(P),this.buf.b+=x.string("["+l.length+"]"),this.buf.b+=x.string("(");for(b=!0,_=0;_<l.length;){t=l[_];++_,b?b=!1:this.buf.b+=x.string(", "),this.addValue(t,e)}this.buf.b+=x.string(")");break;case 18:_=i.e,_=i.cases,_=i.def;this.buf.b+=x.string("switch(...)");break;case 19:_=i.e,f=i.loop;if(0==i.normalWhile){T=f,t=_;e+="\t",this.buf.b+=x.string("do "),this.addBlock(T,e),this.buf.b+=x.string(" while( "),this.addValue(t,e),this.buf.b+=x.string(" )")}else{T=f,t=_;this.buf.b+=x.string("while( "),this.addValue(t,e),this.buf.b+=x.string(" ) "),this.addBlock(T,e)}break;case 20:_=i.m,_=i.args,t=i.e;this.addExpr(t,e)}},varName:function(t){if(t.kind==Za.Output){if(this.isVertex)return"gl_Position";if(null!=this.glES&&this.glES<=2)return null==this.outIndexes?"gl_FragColor":"gl_FragData["+this.outIndexes.h[t.id]+"]"}var e=this.varNames.h[t.id];if(null!=e)return e;if(e=t.name,Object.prototype.hasOwnProperty.call(bA.KWDS.h,e)&&(e="_"+e),Object.prototype.hasOwnProperty.call(this.allNames.h,e)){var i=2;for(e+="_";Object.prototype.hasOwnProperty.call(this.allNames.h,e+i);)++i;e+=i}return this.varNames.h[t.id]=e,this.allNames.h[e]=t.id,e},newLine:function(t){this.isBlock(t)?this.buf.b+=x.string("\n"):this.buf.b+=x.string(";\n")},isBlock:function(t){var e=t.e;switch(e._hx_index){case 4:e.el;return!0;case 13:e.v,e.it;var i=e.loop;return this.isBlock(i);case 19:e.e;if(1==e.normalWhile){i=e.loop;return this.isBlock(i)}return!1;default:return!1}},initVar:function(t){switch(t.kind._hx_index){case 0:case 2:var e;if(16==(n=t.type)._hx_index){var i=n.t;i=n.size;e=!0}else e=!1;e&&(this.buf.b+=x.string("layout(std140) ")),this.buf.b+=x.string("uniform ");break;case 1:this.buf.b+=x.string(null!=this.glES&&this.glES<=2?"attribute ":"in ");break;case 3:this.buf.b+=x.string(null!=this.glES&&this.glES<=2?"varying ":this.isVertex?"out ":"in ");break;case 4:break;case 5:if(null!=this.glES&&this.glES<=2)return void(this.outIndexes.h[t.id]=this.outIndex++);if(this.isVertex)return;null!=this.glES&&(this.buf.b+=x.string("layout(location="+this.outIndex+++") ")),this.buf.b+=x.string("out ");break;case 6:return}if(null!=t.qualifiers){var n=0;for(i=t.qualifiers;n<i.length;){var s=i[n];if(++n,6==s._hx_index)switch(s.p._hx_index){case 0:this.buf.b+=x.string("lowp ");break;case 1:this.buf.b+=x.string("mediump ");break;case 2:this.buf.b+=x.string("highp ")}}}this.addVar(t),this.buf.b+=x.string(";\n")},initVars:function(t){this.outIndex=0,this.uniformBuffer=0,this.outIndexes=new Wn;for(var e=0,i=t.vars;e<i.length;){var n=i[e];++e,this.initVar(n)}this.buf.b+=x.string("\n"),this.outIndex<2?this.outIndexes=null:!this.isVertex&&null!=this.glES&&this.glES<=2&&this.decl("#extension GL_EXT_draw_buffers : enable")},run:function(t){if(this.locals=new Wn,this.decls=[],this.buf=new p,this.exprValues=[],this.decl("precision mediump float;"),1!=t.funs.length)throw kn.thrown("assert");var e=t.funs[0];this.isVertex=e.kind==tA.Vertex,this.initVars(t);var i=this.buf;if(this.buf=new p,this.buf.b+=x.string("void main(void) {\n"),4==(s=e.expr.e)._hx_index)for(var n=s.el,s=0;s<n.length;){var r=n[s];++s,this.buf.b+=x.string("\t"),this.addExpr(r,"\t"),this.newLine(r)}else this.addExpr(e.expr,"");this.isVertex&&(this.buf.b+=x.string("\tgl_Position.z += gl_Position.z - gl_Position.w;\n")),this.buf.b+=x.string("}"),this.exprValues.push(this.buf.b),this.buf=i;var a=u.array(this.locals);a.sort((function(t,e){return f.compare(t.name,e.name)}));for(s=0;s<a.length;){var A=a[s];++s,this.addVar(A),this.buf.b+=x.string(";\n")}this.buf.b+=x.string("\n");s=0;for(var h=this.exprValues;s<h.length;){r=h[s];++s,this.buf.b+=x.string(r),this.buf.b+=x.string("\n\n")}return null!=this.glES?this.decl("#version "+(this.version<100?100:this.version)+(this.version>150?" es":"")):null!=this.version?this.decl("#version "+(this.version>150?150:this.version)):this.decl("#version 130"),this.decls.push(this.buf.b),this.buf=null,this.decls.join("\n")},__class__:bA};var wA=function(){};i["hxsl._Linker.AllocatedVar"]=wA,wA.__name__="hxsl._Linker.AllocatedVar",wA.prototype={__class__:wA};var MA=function(t,e){this.name=t,this.uid=MA.UID++,this.vertex=e,this.processed=new Wn,this.usedFunctions=[],this.read=new Wn,this.write=new Wn};i["hxsl._Linker.ShaderInfos"]=MA,MA.__name__="hxsl._Linker.ShaderInfos",MA.prototype={__class__:MA};var BA=function(t){null==t&&(t=!1),this.debugDepth=0,this.batchMode=t};i["hxsl.Linker"]=BA,BA.__name__="hxsl.Linker",BA.prototype={debug:function(t,e){},error:function(t,e){return Wa.t(t,e)},mergeVar:function(t,e,i,n,s){switch(e.kind._hx_index){case 2:if(null==s||!sA.hasBorrowQualifier(i,s))throw kn.thrown("assert");break;case 0:case 1:case 3:case 4:case 5:break;case 6:throw kn.thrown("assert")}e.kind!=i.kind&&e.kind!=Za.Local&&i.kind!=Za.Local&&this.error("'"+t+"' kind does not match : "+x.string(e.kind)+" should be "+x.string(i.kind),n);var r=e.type,a=i.type;if(13==r._hx_index)if(13==a._hx_index){var A=a.vl,h=r.vl;for(r=0;r<h.length;){var o=h[r];++r;var l=null;for(a=0;a<A.length;){var u=A[a];if(++a,o.name==u.name){l=u;break}}null==l?A.push(this.allocVar(o,n,s).v):this.mergeVar(t+"."+l.name,o,l,n,s)}}else m.enumEq(e.type,i.type)||this.error("'"+t+"' type does not match : "+sA.toString(e.type)+" should be "+sA.toString(i.type),n);else m.enumEq(e.type,i.type)||this.error("'"+t+"' type does not match : "+sA.toString(e.type)+" should be "+sA.toString(i.type),n)},allocVar:function(t,e,i,n,s){if(null!=t.parent&&null==s){var r=(s=this.allocVar(t.parent,e,i)).v;for(n=r.name,r=r.parent;null!=r;)n=r.name+"."+n,r=r.parent}var a=null==n?t.name:n+"."+t.name;if(null!=t.qualifiers)for(var A=0,h=t.qualifiers;A<h.length;){var o=h[A];if(++A,4==o._hx_index)a=o.n}var l=this.varMap.h[a],u=t.name;if(null!=l){var _;for(A=0,h=l.merged;A<h.length;){var c=h[A];if(++A,c==t)return l}var d=sA.hasBorrowQualifier(l.v,i);if((t.kind!=Za.Param||d||sA.hasQualifier(t,Ja.Shared)||this.isBatchShader)&&t.kind!=Za.Function&&(t.kind!=Za.Var&&t.kind!=Za.Local||!sA.hasQualifier(t,Ja.Private))){var f=l.v;d=sA.hasBorrowQualifier(t,l.rootShaderName);_=f.kind==Za.Param&&!d&&!sA.hasQualifier(f,Ja.Shared)&&!this.isBatchShader||f.kind==Za.Function||(f.kind==Za.Var||f.kind==Za.Local)&&sA.hasQualifier(f,Ja.Private)}else _=!0;if(!(_||t.kind==Za.Param&&l.v.kind==Za.Param))return l.merged.push(t),this.mergeVar(a,t,l.v,e,l.rootShaderName),this.varIdMap.h[t.id]=l.id,l;for(var x=2;;){if(null==(p=this.varMap.h[a+x]))break;for(A=0,h=p.merged;A<h.length;){c=h[A];if(++A,c==t)return p}++x}u+=x,a+=x}var p,g=this.allVars.length+1;l={id:g,name:u,type:t.type,kind:t.kind,qualifiers:t.qualifiers,parent:null==s?null:s.v};if((p=new wA).v=l,p.merged=[t],p.path=a,p.id=g,p.parent=s,p.instanceIndex=this.curInstance,p.rootShaderName=i,this.allVars.push(p),this.varMap.h[a]=p,13==(A=l.type)._hx_index){var m=A.vl;for(A=[],h=0;h<m.length;){t=m[h];++h,A.push(this.allocVar(t,e,i,a,p).v)}l.type=Xa.TStruct(A)}return p},mapExprVar:function(t){var e=t.e;switch(e._hx_index){case 1:var i=e.v;if(!this.locals.h.hasOwnProperty(i.id)){var n=this.allocVar(i,t.p);return null==this.curShader||this.curShader.write.h.hasOwnProperty(n.id)||(this.curShader.read.h[n.id]=n,null==this.curShader.vertex&&n.v.kind==Za.Var&&(this.curShader.vertex=!1)),{e:nA.TVar(n.v),t:n.v.type,p:t.p}}break;case 5:var s=e.op,r=e.e1,a=e.e2,A=r.e;switch(s._hx_index){case 4:switch(A._hx_index){case 1:i=l=A.v;if(!this.locals.h.hasOwnProperty(i.id)){var h=this.mapExprVar(a);n=this.allocVar(i,r.p);return null!=this.curShader&&(this.curShader.write.h[n.id]=n),{e:nA.TBinop(s,{e:nA.TVar(n.v),t:n.v.type,p:t.p},h),t:t.t,p:t.p}}i=l;if(!this.locals.h.hasOwnProperty(i.id)){var o=this.mapExprVar(r);h=this.mapExprVar(a),n=this.allocVar(i,o.p);return null!=this.curShader&&(this.curShader.write.h[n.id]=n),{e:nA.TBinop(s,o,h),t:t.t,p:t.p}}break;case 9:var l=A.e,u=A.regs;u=l.e,l.p,l.t;if(1==u._hx_index){i=u.v;if(!this.locals.h.hasOwnProperty(i.id)){o=this.mapExprVar(r),h=this.mapExprVar(a),n=this.allocVar(i,o.p);return null!=this.curShader&&(this.curShader.write.h[n.id]=n),{e:nA.TBinop(s,o,h),t:t.t,p:t.p}}}}break;case 20:l=s.op;switch(A._hx_index){case 1:i=A.v;if(!this.locals.h.hasOwnProperty(i.id)){o=this.mapExprVar(r),h=this.mapExprVar(a),n=this.allocVar(i,o.p);return null!=this.curShader&&(this.curShader.write.h[n.id]=n),{e:nA.TBinop(s,o,h),t:t.t,p:t.p}}break;case 9:l=A.e,u=A.regs,A=l.e,u=l.p,u=l.t;if(1==A._hx_index){i=A.v;if(!this.locals.h.hasOwnProperty(i.id)){o=this.mapExprVar(r),h=this.mapExprVar(a),n=this.allocVar(i,o.p);return null!=this.curShader&&(this.curShader.write.h[n.id]=n),{e:nA.TBinop(s,o,h),t:t.t,p:t.p}}}}}break;case 7:A=e.init,i=e.v;this.locals.h[i.id]=!0;break;case 11:null!=this.curShader&&(this.curShader.vertex=!1,this.curShader.hasDiscard=!0);break;case 13:A=e.it,A=e.loop,i=e.v;this.locals.h[i.id]=!0}return sA.map(t,XA(this,this.mapExprVar))},addShader:function(t,e,i,n){var s=new MA(t,e);return this.curShader=s,s.priority=n,s.body=this.mapExprVar(i),this.shaders.push(s),this.curShader=null,s},sortByPriorityDesc:function(t,e){return t.priority==e.priority?t.uid-e.uid:e.priority-t.priority},buildDependency:function(t,e,i){for(var n=!i,s=0,r=this.shaders;s<r.length;){var a=r[s];if(++s,a!=t){if(n&&a.write.h.hasOwnProperty(e.id)){if(t.vertex){if(0==a.vertex)continue;null==a.vertex&&(a.vertex=!0)}if(t.deps.set(a,!0),this.debugDepth++,this.initDependencies(a),this.debugDepth--,!a.read.h.hasOwnProperty(e.id))return}}else n=!0}e.v.kind==Za.Var&&this.error("Variable "+e.path+" required by "+t.name+" is missing initializer",null)},initDependencies:function(t){if(null==t.deps){t.deps=new qn;for(var e=t.read.iterator();e.hasNext();){var i=e.next();this.buildDependency(t,i,t.write.h.hasOwnProperty(i.id))}if(null==t.vertex)for(var n=t.deps.keys();n.hasNext();){if(0==(s=n.next()).vertex){t.vertex=!1;break}}if(t.vertex)for(n=t.deps.keys();n.hasNext();){var s;null==(s=n.next()).vertex&&(s.vertex=!0)}}},collect:function(t,e,i){if(t.onStack&&this.error("Loop in shader dependencies ("+t.name+")",null),t.marked!=i){t.marked=i,t.onStack=!0;for(var n=[],s=t.deps.keys();s.hasNext();){var r=s.next();n.push(r)}var a=n;a.sort(XA(this,this.sortByPriorityDesc));for(n=0;n<a.length;){s=a[n];++n,this.collect(s,e,i)}null==t.vertex&&(t.vertex=i),t.vertex==i&&e.push(t),t.onStack=!1}},uniqueLocals:function(t,e){switch((_=t.e)._hx_index){case 4:for(var i=_.el,n=new Kn,s=e.h,r=Object.keys(s),a=r.length,A=0;A<a;){var h=r[A++];n.h[h]=!0}var o=n;for(n=0;n<i.length;){var l=i[n];++n,this.uniqueLocals(l,o)}break;case 7:n=_.init;var u=_.v;if(Object.prototype.hasOwnProperty.call(e.h,u.name)){for(h=2;Object.prototype.hasOwnProperty.call(e.h,u.name+h);)++h;u.name+=h}e.h[u.name]=!0;break;default:var _=XA(this,this.uniqueLocals);o=e;sA.iter(t,(function(t){_(t,o)}))}},link:function(t){var e=this;this.varMap=new Kn,this.varIdMap=new Wn,this.allVars=[],this.shaders=[],this.locals=new Wn;for(var i=new qn,n=[],s=0;s<t.length;){var r=t[s];++s;var a=L=r;null!=i.h.__keys__[L.__id__]&&(L=_A.shaderData(L)),i.set(L,a),n.push(L)}t=n,this.curInstance=0;var A=[];for(n=0;n<t.length;){r=t[n];++n,this.isBatchShader=this.batchMode&&g.startsWith(r.name,"batchShader_");s=0;for(var h=r.vars;s<h.length;){var o=h[s];++s;var l=this.allocVar(o,null,r.name);this.isBatchShader&&l.v.kind==Za.Param&&!g.startsWith(l.path,"Batch_")&&(l.v.kind=Za.Local),o.kind==Za.Output&&A.push(o)}for(var u=0,_=r.funs;u<_.length;){var c=_[u];++u,(F=this.allocVar(c.ref,c.expr.p)).kind=c.kind}this.curInstance++}var d=0,f=[-3e3],x=[-2e3],p=[-1e3];for(n=0;n<t.length;){r=t[n];++n;for(s=0,h=r.funs;s<h.length;){c=h[s];if(++s,null==(o=this.allocVar(c.ref,c.expr.p)).kind)throw kn.thrown("assert");switch(o.kind._hx_index){case 0:case 1:this.addShader(r.name+"."+(o.kind==tA.Vertex?"vertex":"fragment"),o.kind==tA.Vertex,c.expr,d);break;case 2:var m,v;switch(c.ref.name){case"__init__fragment":m=p,v=!1;break;case"__init__vertex":m=x,v=!0;break;default:m=f,v=null}if(4==(u=c.expr.e)._hx_index){var y=u.el,b=0;for(_=0;_<y.length;){var w=y[_];++_,this.addShader(r.name+"."+c.ref.name+b++,v,w,m[0]++)}}else this.addShader(r.name+"."+c.ref.name,v,c.expr,m[0]++);break;case 3:throw kn.thrown("Unexpected helper function in linker "+o.v.name)}}++d}this.shaders.sort(XA(this,this.sortByPriorityDesc));var M=new MA("<entry>",!1);M.deps=new qn;for(n=0;n<A.length;){o=A[n];++n,this.buildDependency(M,this.allocVar(o,null),!1)}for(n=0,s=this.shaders;n<s.length;){r=s[n];++n,r.hasDiscard&&(this.initDependencies(r),M.deps.set(r,!0))}for(n=0,s=this.shaders;n<s.length;){r=s[n];if(++n,null==r.vertex){for(var B=!0,C=r.read.iterator();C.hasNext();){if(C.next().v.kind!=Za.Param){B=!1;break}}B&&(r.vertex=!1)}}o=[],c=[];if(this.collect(M,o,!0),this.collect(M,c,!1),c.pop()!=M)throw kn.thrown("assert");for(n=0,s=this.shaders;n<s.length;){r=s[n];++n,r.marked=null}for(n=0,s=o.concat(c);n<s.length;){r=s[n];++n;for(var S=r.deps.keys();S.hasNext();){var I=S.next();null==I.marked&&this.error(I.name+" needed by "+r.name+" is unreachable",null)}r.marked=!0}A=[];var k={},E=null;E=function(t){k.hasOwnProperty(t.id)||(k[t.id]=!0,null!=t.v.parent?E(t.parent):A.push(t.v))};for(n=0,s=o.concat(c);n<s.length;){r=s[n];++n;for(var F=r.read.iterator();F.hasNext();){l=F.next();E(l)}for(var T=r.write.iterator();T.hasNext();){var D=T.next();E(D)}}var P=null;P=function(t){if(13==(n=t.type)._hx_index){var e=n.vl;if(t.kind!=Za.Input){for(var i=[],n=0;n<e.length;){var s=e[n];++n,k.hasOwnProperty(s.id)&&(P(s),i.push(s))}t.type=Xa.TStruct(i)}}};for(n=0;n<A.length;){F=A[n];++n,P(F)}var z=function(t,i,n){var s={id:sA.allocVarId(),name:i,type:Xa.TFun([{ret:Xa.TVoid,args:[]}]),kind:Za.Function};A.push(s);for(var r=[],a=0;a<n.length;){var h=n[a];++a;var o=h.body.e;if(4==o._hx_index)for(var l=o.el,u=0;u<l.length;){var _=l[u];++u,r.push(_)}else r.push(h.body)}var c={e:nA.TBlock(r),t:Xa.TVoid,p:0==r.length?null:r[0].p};return e.uniqueLocals(c,new Kn),{kind:t,ref:s,ret:Xa.TVoid,args:[],expr:c}},R=[z(tA.Vertex,"vertex",o),z(tA.Fragment,"fragment",c)];for(r=i.keys();r.hasNext();){var L;if((L=r.next())!=(a=i.h[L.__id__]))for(n=0,s=L.vars.length;n<s;){var V=n++;this.allocVar(L.vars[V],null).merged.unshift(a.vars[V])}}return{name:"out",vars:A,funs:R}},__class__:BA};var CA=s["hxsl.Output"]={__ename__:!0,__constructs__:null,Const:(e=function(t){return{_hx_index:0,v:t,__enum__:"hxsl.Output",toString:n}},e._hx_name="Const",e.__params__=["v"],e),Value:(e=function(t,e){return{_hx_index:1,v:t,size:e,__enum__:"hxsl.Output",toString:n}},e._hx_name="Value",e.__params__=["v","size"],e),PackNormal:(e=function(t){return{_hx_index:2,v:t,__enum__:"hxsl.Output",toString:n}},e._hx_name="PackNormal",e.__params__=["v"],e),PackFloat:(e=function(t){return{_hx_index:3,v:t,__enum__:"hxsl.Output",toString:n}},e._hx_name="PackFloat",e.__params__=["v"],e),Vec2:(e=function(t){return{_hx_index:4,a:t,__enum__:"hxsl.Output",toString:n}},e._hx_name="Vec2",e.__params__=["a"],e),Vec3:(e=function(t){return{_hx_index:5,a:t,__enum__:"hxsl.Output",toString:n}},e._hx_name="Vec3",e.__params__=["a"],e),Vec4:(e=function(t){return{_hx_index:6,a:t,__enum__:"hxsl.Output",toString:n}},e._hx_name="Vec4",e.__params__=["a"],e),Swiz:(e=function(t,e){return{_hx_index:7,a:t,swiz:e,__enum__:"hxsl.Output",toString:n}},e._hx_name="Swiz",e.__params__=["a","swiz"],e)};CA.__constructs__=[CA.Const,CA.Value,CA.PackNormal,CA.PackFloat,CA.Vec2,CA.Vec3,CA.Vec4,CA.Swiz],CA.__empty_constructs__=[];var SA=function(t){null==t&&(t=!1),this.varId=t};i["hxsl.Printer"]=SA,SA.__name__="hxsl.Printer",SA.opStr=function(t){switch(t._hx_index){case 0:return"+";case 1:return"*";case 2:return"/";case 3:return"-";case 4:return"=";case 5:return"==";case 6:return"!=";case 7:return">";case 8:return">=";case 9:return"<";case 10:return"<=";case 11:return"&";case 12:return"|";case 13:return"^";case 14:return"&&";case 15:return"||";case 16:return"<<";case 17:return">>";case 18:return">>>";case 19:return"%";case 20:var e=t.op;return SA.opStr(e)+"=";case 21:return"...";case 22:return"=>";case 23:return" in "}},SA.toString=function(t,e){return null==e&&(e=!1),new SA(e).exprString(t)},SA.shaderToString=function(t,e){return null==e&&(e=!1),new SA(e).shaderString(t)},SA.check=function(t,e){try{var i=new Wn,n=[],s=null;s=function(t,e){if(e){if(i.h.hasOwnProperty(t.id))throw kn.thrown("Duplicate var "+t.id);i.h[t.id]=t,n.push(t)}else i.remove(t.id);if(13==(a=t.type)._hx_index)for(var r=a.vl,a=0;a<r.length;){t=r[a];++a,s(t,e)}};var r=null;r=function(t){var e=t.e;switch(e._hx_index){case 1:var a=e.v;if(!i.h.hasOwnProperty(a.id))throw kn.thrown("Unbound var "+a.name+"@"+a.id);break;case 4:var A=e.el,h=n;n=[];for(var o=0;o<A.length;){var l=A[o];++o,r(l)}for(o=0;o<n.length;){a=n[o];++o,s(a,!1)}n=h;break;case 7:a=e.v;var u=e.init;null!=u&&r(u),s(a,!0);break;case 13:a=e.v;var _=e.it,c=e.loop;r(_),s(a,!0),r(c),s(a,!1);break;default:sA.iter(t,r)}};for(var a=0,A=t.vars;a<A.length;){var h=A[a];++a,s(h,!0)}for(a=0,A=t.funs;a<A.length;){var o=A[a];++a;for(var l=0,u=o.args;l<u.length;){h=u[l];++l,s(h,!0)}r(o.expr);for(var _=0,c=o.args;_<c.length;){var d=c[_];++_,s(d,!1)}}}catch(a){A=kn.caught(a).unwrap();if("string"==typeof A){var f=A+"\n    in\n"+SA.shaderToString(t,!0);if(null!=e){for(A=[],l=0;l<e.length;){t=e[l];++l,A.push(SA.shaderToString(t,!0))}f+="\n    from\n\n"+A.join("\n\n")}throw kn.thrown(f)}throw a}},SA.prototype={add:function(t){this.buffer.b+=x.string(t)},shaderString:function(t){this.buffer=new p;for(var e=0,i=t.vars;e<i.length;){var n=i[e];++e,this.addVar(n,null),this.buffer.b+=x.string(";\n")}t.vars.length>0&&(this.buffer.b+=x.string("\n"));for(e=0,i=t.funs;e<i.length;){var s=i[e];++e,this.addFun(s),this.buffer.b+=x.string("\n\n")}return this.buffer.b},varString:function(t){return this.buffer=new p,this.addVar(t,null),this.buffer.b},funString:function(t){return this.buffer=new p,this.addFun(t),this.buffer.b},exprString:function(t){return this.buffer=new p,this.addExpr(t,""),this.buffer.b},addVar:function(t,e,i,n){if(null==i&&(i=""),null!=t.qualifiers)for(var r=0,a=t.qualifiers;r<a.length;){var A=a[r];switch(++r,A._hx_index){case 0:var h=A.max;c="const"+(null==h?"":"("+h+")");break;case 1:c="private";break;case 2:c="nullable";break;case 3:c="perObject";break;case 4:c="name('"+A.n+"')";break;case 5:c="shared";break;case 6:var o=A.p;c=s[o.__enum__].__constructs__[o._hx_index]._hx_name.toLowerCase()+"p";break;case 7:c="range("+A.min+","+A.max+")";break;case 8:c="ignore";break;case 9:c="perInstance("+A.v+")";break;case 10:var l=A.s;c='doc("'+g.replace(l,'"','\\"')+'")';break;case 11:c="borrow("+A.source+")";break;case 12:c="sampler("+A.name+")"}this.buffer.b+=x.string("@"+c+" ")}if(t.kind!=e)switch(t.kind._hx_index){case 0:this.buffer.b+=x.string("@global ");break;case 1:this.buffer.b+=x.string("@input ");break;case 2:this.buffer.b+=x.string("@param ");break;case 3:this.buffer.b+=x.string("@varying ");break;case 4:this.buffer.b+=x.string("@local ");break;case 5:this.buffer.b+=x.string("@output ");break;case 6:this.buffer.b+=x.string("@function ")}if(this.buffer.b+=x.string("var "),t.parent==n?this.buffer.b+=x.string(t.name+(this.varId?"@"+t.id:"")):this.addVarName(t),this.buffer.b+=x.string(" : "),13==(r=t.type)._hx_index){var u=r.vl;this.buffer.b+=x.string("{");var _=!0;for(r=0;r<u.length;){var c=u[r];++r,_?_=!1:this.buffer.b+=x.string(", "),this.addVar(c,c.kind,i,c)}this.buffer.b+=x.string("}")}else{c=sA.toString(t.type);this.buffer.b+=x.string(c)}},addFun:function(t){this.buffer.b+=x.string("function "+t.ref.name+"(");for(var e=!0,i=0,n=t.args;i<n.length;){var s=n[i];++i,e?(this.buffer.b+=x.string(" "),e=!1):this.buffer.b+=x.string(", "),this.addVar(s,Za.Local)}t.args.length>0&&(this.buffer.b+=x.string(" "));var r=") : "+sA.toString(t.ret)+" ";this.buffer.b+=x.string(r),this.addExpr(t.expr,"")},addVarName:function(t){null!=t.parent&&(this.addVarName(t.parent),this.buffer.b+=x.string(".")),this.buffer.b+=x.string(t.name),this.varId&&(this.buffer.b+=x.string("@"+t.id))},addConst:function(t){var e,i=this.buffer,n=i.b;switch(t._hx_index){case 0:e="null";break;case 1:e=t.b;break;case 2:e=t.v;break;case 3:e=t.v;break;case 4:e='"'+t.v+'"'}i.b=n+x.string(e)},addExpr:function(t,e){switch((I=t.e)._hx_index){case 0:var i=I.c;this.addConst(i);break;case 1:var n=I.v;this.addVarName(n);break;case 2:var s=I.g;n=rA.toString(s);this.buffer.b+=x.string(n);break;case 3:t=I.e;this.buffer.b+=x.string("("),this.addExpr(t,e),this.buffer.b+=x.string(")");break;case 4:var r=I.el;this.buffer.b+=x.string("{"),e+="\t";for(var a=0;a<r.length;){t=r[a];++a,this.buffer.b+=x.string("\n"+e),this.addExpr(t,e),this.buffer.b+=x.string(";")}e=l.substr(e,1,null),r.length>0&&(this.buffer.b+=x.string("\n"+e)),this.buffer.b+=x.string("}");break;case 5:var A=I.op,h=I.e1,o=I.e2;this.addExpr(h,e);n=" "+SA.opStr(A)+" ";this.buffer.b+=x.string(n),this.addExpr(o,e);break;case 6:A=I.op,t=I.e1;switch(A._hx_index){case 0:n="++";break;case 1:n="--";break;case 2:n="!";break;case 3:n="-";break;case 4:n="~";break;default:throw kn.thrown("assert")}this.buffer.b+=x.string(n),this.addExpr(t,e);break;case 7:n=I.v;var u=I.init;this.addVar(n,Za.Local,e),null!=u&&(this.buffer.b+=x.string(" = "),this.addExpr(u,e));break;case 8:t=I.e,r=I.args;this.addExpr(t,e),this.buffer.b+=x.string("(");var _=!0;for(a=0;a<r.length;){t=r[a];++a,_?_=!1:this.buffer.b+=x.string(", "),this.addExpr(t,e)}this.buffer.b+=x.string(")");break;case 9:t=I.e;var c=I.regs;this.addExpr(t,e),this.buffer.b+=x.string(".");for(a=0;a<c.length;){var d=c[a];++a,this.buffer.b+=x.string(SA.SWIZ[d._hx_index])}break;case 10:var f=I.econd,p=I.eif,g=I.eelse;this.buffer.b+=x.string("if( "),this.addExpr(f,e),this.buffer.b+=x.string(" ) "),this.addExpr(p,e),null!=g&&(this.buffer.b+=x.string(" else "),this.addExpr(g,e));break;case 11:this.buffer.b+=x.string("discard");break;case 12:t=I.e;this.buffer.b+=x.string("return"),null!=t&&(this.buffer.b+=x.string(" "),this.addExpr(t,e));break;case 13:n=I.v;var m=I.it,v=I.loop;this.buffer.b+=x.string("for( "),this.addVarName(n),this.buffer.b+=x.string(" in "),this.addExpr(m,e),this.buffer.b+=x.string(" ) "),this.addExpr(v,e);break;case 14:this.buffer.b+=x.string("continue");break;case 15:this.buffer.b+=x.string("break");break;case 16:h=I.e,o=I.index;this.addExpr(h,e),this.buffer.b+=x.string("["),this.addExpr(o,e),this.buffer.b+=x.string("]");break;case 17:r=I.el;this.buffer.b+=x.string("[");for(_=!0,a=0;a<r.length;){t=r[a];++a,_?_=!1:this.buffer.b+=x.string(", "),this.addExpr(t,e)}this.buffer.b+=x.string("]");break;case 18:t=I.e;var y=I.cases,b=I.def;this.buffer.b+=x.string("switch( "),this.addExpr(t,e),this.buffer.b+=x.string(") {");var w=e;for(a=0;a<y.length;){i=y[a];++a,this.buffer.b+=x.string("\n"+e),this.buffer.b+=x.string("case ");_=!0;for(var M=0,B=i.values;M<B.length;){n=B[M];++M,_?_=!1:this.buffer.b+=x.string(", "),this.addExpr(n,e)}e+="\t",this.buffer.b+=x.string(":\n"+e),this.addExpr(i.expr,e),e=w}null!=b&&(this.buffer.b+=x.string("\n"+e),e+="\t",this.buffer.b+=x.string("default:\n"+e),this.addExpr(b,e),e=w),this.buffer.b+=x.string("\n"+e+"}");break;case 19:a=I.e,M=I.loop;if(0==I.normalWhile){v=M,t=a,w=e;e+="\t",this.buffer.b+=x.string("do {\n"+e),this.addExpr(v,e),e=w,this.buffer.b+=x.string("\n"+e+"} while( "),this.addExpr(t,e),this.buffer.b+=x.string(" )")}else{v=M,t=a;this.buffer.b+=x.string("while( "),this.addExpr(t,e);w=e;e+="\t",this.buffer.b+=x.string(" ) {\n"+e),this.addExpr(v,e),e=w,this.buffer.b+=x.string("\n"+e+"}")}break;case 20:var C=I.m,S=I.args;t=I.e;if(this.buffer.b+=x.string("@"),this.buffer.b+=x.string(C),S.length>0){this.buffer.b+=x.string("(");_=!0;for(var I=0;I<S.length;){i=S[I];++I,_?_=!1:this.buffer.b+=x.string(", "),this.addConst(i)}this.buffer.b+=x.string(")")}this.buffer.b+=x.string(" "),this.addExpr(t,e)}},__class__:SA};var IA=function(t,e,i,n,s){this.name=t,this.pos=e,this.instance=i,this.index=n,this.type=s};i["hxsl.AllocParam"]=IA,IA.__name__="hxsl.AllocParam",IA.prototype={clone:function(t){null==t&&(t=!1);var e=new IA(this.name,this.pos,this.instance,this.index,this.type);return null!=this.perObjectGlobal&&(e.perObjectGlobal=this.perObjectGlobal.clone(t)),null!=this.next&&(e.next=this.next.clone(t)),e},__class__:IA};var kA=function(t,e,i){this.pos=t,this.path=e,this.gid=vA.allocID(e),this.type=i};i["hxsl.AllocGlobal"]=kA,kA.__name__="hxsl.AllocGlobal",kA.prototype={clone:function(t){null==t&&(t=!1);var e=new kA(this.pos,this.path,this.type);return null!=this.next&&(e.next=this.next.clone(t)),t&&(e.gid=0),e},__class__:kA};var EA=function(){};i["hxsl.RuntimeShaderData"]=EA,EA.__name__="hxsl.RuntimeShaderData",EA.prototype={__class__:EA};var FA=function(t,e){this.shader=t,this.bits=e};i["hxsl.ShaderInstanceDesc"]=FA,FA.__name__="hxsl.ShaderInstanceDesc",FA.prototype={__class__:FA};var TA=function(){this.id=TA.UID++};i["hxsl.RuntimeShader"]=TA,TA.__name__="hxsl.RuntimeShader",TA.prototype={hasGlobal:function(t){return this.globals.h.hasOwnProperty(t)},__class__:TA};var DA=function(){this.tid=1,this.uid=1};i["hxsl.Serializer"]=DA,DA.__name__="hxsl.Serializer",DA.run=function(t){return(new DA).serialize(t)},DA.prototype={writeArr:function(t,e){this.writeVarInt(t.length);for(var i=0;i<t.length;){var n=t[i];++i,e(n)}},readArr:function(t){for(var e=[],i=0,n=this.readVarInt();i<n;){i++;e.push(t())}return e},readVarInt:function(){var t=this.input.readByte();return t<128?t:255==t?this.input.readInt32():(127&t)<<8|this.input.readByte()},writeVarInt:function(t){if(t<128)this.out.addByte(t);else{var e=t>>8;e>=127?(this.out.addByte(255),this.out.addInt32(e)):(this.out.addByte(128|e),this.out.addByte(255&t))}},writeID:function(t){var e=this.idMap.h[t];null==e&&(e=this.uid++,this.idMap.h[t]=e),this.writeVarInt(e)},readID:function(){return this.readVarInt()},writeTID:function(t){var e=this.typeIdMap.get(t);return null!=e?(this.writeVarInt(e),!1):(e=this.tid++,this.typeIdMap.set(t,e),this.writeVarInt(e),!0)},writeType:function(t){switch(this.out.addByte(t._hx_index),t._hx_index){case 0:case 1:case 2:case 3:case 4:case 6:case 7:case 8:case 10:case 11:case 12:case 18:break;case 5:var e=t.size,i=t.t;this.out.addByte(e|i._hx_index<<3);break;case 9:e=t.size;this.out.addInt32(e);break;case 13:var n=t.vl;if(this.writeTID(t)){var s=XA(this,this.writeVar);this.writeVarInt(n.length);for(var r=0;r<n.length;){var a=n[r];++r,s(a)}}break;case 14:t.variants;break;case 15:i=t.t,e=t.size;switch(this.writeType(i),e._hx_index){case 0:a=e.v;this.out.addByte(0),this.writeVarInt(a);break;case 1:a=e.v;this.writeVar(a)}break;case 16:i=t.t,e=t.size;switch(this.writeType(i),e._hx_index){case 0:a=e.v;this.out.addByte(0),this.writeVarInt(a);break;case 1:a=e.v;this.writeVar(a)}break;case 17:e=t.size;this.out.addByte(e)}},readType:function(){switch(this.input.readByte()){case 0:return Xa.TVoid;case 1:return Xa.TInt;case 2:return Xa.TBool;case 3:return Xa.TFloat;case 4:return Xa.TString;case 5:var t=this.input.readByte();return null==(A=DA.TVECS.h[t])&&(A=Xa.TVec(7&t,m.createEnumIndex(ja,t>>3,null)),DA.TVECS.h[t]=A),A;case 6:return Xa.TMat3;case 7:return Xa.TMat4;case 8:return Xa.TMat3x4;case 9:return Xa.TBytes(this.input.readInt32());case 10:return Xa.TSampler2D;case 11:return Xa.TSampler2DArray;case 12:return Xa.TSamplerCube;case 13:var e=this.readVarInt();if(null!=(a=this.types[e]))return a;for(var i=XA(this,this.readVar),n=[],s=0,r=this.readVarInt();s<r;){s++;n.push(i())}return a=Xa.TStruct(n),this.types[e]=a,a;case 14:return Xa.TFun(null);case 15:var a=this.readType(),A=this.readVar();return Xa.TArray(a,null==A?Ha.SConst(this.readVarInt()):Ha.SVar(A));case 16:a=this.readType(),A=this.readVar();return Xa.TBuffer(a,null==A?Ha.SConst(this.readVarInt()):Ha.SVar(A));case 17:return Xa.TChannel(this.input.readByte());case 18:return Xa.TMat2;default:throw kn.thrown("assert")}},writeString:function(t){var e=Qn.ofString(t);this.writeVarInt(e.length),this.out.add(e)},readString:function(){var t=this.readVarInt();return this.input.read(t).getString(0,t)},writeVar:function(t){if(null!=t){if(this.writeID(t.id),!this.varMap.h.hasOwnProperty(t.id))if(this.varMap.h[t.id]=t,this.writeString(t.name),this.writeType(t.type),this.out.addByte(t.kind._hx_index),this.writeVar(t.parent),null==t.qualifiers)this.out.addByte(0);else{this.out.addByte(t.qualifiers.length);for(var e=0,i=t.qualifiers;e<i.length;){var n=i[e];switch(++e,this.out.addByte(n._hx_index),n._hx_index){case 0:var s=n.max;this.out.addInt32(null==s?0:s);break;case 4:var r=n.n;this.writeString(r);break;case 1:case 2:case 3:case 5:case 8:break;case 6:var a=n.p;this.out.addByte(a._hx_index);break;case 7:var A=n.min,h=n.max;this.out.addDouble(A),this.out.addDouble(h);break;case 9:t=n.v;this.out.addInt32(t);break;case 10:var o=n.s;this.writeString(o);break;case 11:var l=n.source;this.writeString(l);break;case 12:var u=n.name;this.writeString(u)}}}}else this.out.addByte(0)},writeFun:function(t){this.out.addByte(t.kind._hx_index),this.writeVar(t.ref);var e=t.args,i=XA(this,this.writeVar);this.writeVarInt(e.length);for(var n=0;n<e.length;){var s=e[n];++n,i(s)}this.writeType(t.ret),this.writeExpr(t.expr)},writeConst:function(t){switch(this.out.addByte(t._hx_index),t._hx_index){case 0:break;case 1:var e=t.b;this.out.addByte(e?1:0);break;case 2:var i=t.v;this.out.addInt32(i);break;case 3:i=t.v;this.out.addDouble(i);break;case 4:i=t.v;this.writeString(i)}},writeExpr:function(t){var e=this;if(null!=t){switch(this.out.addByte(t.e._hx_index+1),(F=t.e)._hx_index){case 0:var i=F.c;this.writeConst(i);break;case 1:var n=F.v;this.writeVar(n);break;case 2:var s=F.g;this.out.addByte(s._hx_index);break;case 3:var r=F.e;this.writeExpr(r);break;case 4:var a=F.el,A=XA(this,this.writeExpr);this.writeVarInt(a.length);for(var h=0;h<a.length;){n=a[h];++h,A(n)}break;case 5:var o=F.op,l=(r=F.e1,F.e2);if(20==o._hx_index){var u=o.op;this.out.addByte(128|u._hx_index)}else this.out.addByte(o._hx_index);this.writeExpr(r),this.writeExpr(l);break;case 6:o=F.op,r=F.e1;this.out.addByte(o._hx_index),this.writeExpr(r);break;case 7:n=F.v;var _=F.init;this.writeVar(n),this.writeExpr(_);break;case 8:r=F.e;var c=F.args;this.writeExpr(r);A=XA(this,this.writeExpr);this.writeVarInt(c.length);for(h=0;h<c.length;){n=c[h];++h,A(n)}break;case 9:r=F.e;var d=F.regs;if(this.writeExpr(r),0==d.length)throw kn.thrown("assert");var f=d.length-1,x=2;for(h=0;h<d.length;){var p=d[h];++h,f|=p._hx_index<<x,x+=2}this.out.addByte(255&f),this.out.addByte(f>>8);break;case 10:var g=F.econd,m=F.eif,v=F.eelse;this.writeExpr(g),this.writeExpr(m),this.writeExpr(v);break;case 11:case 14:case 15:break;case 12:r=F.e;this.writeExpr(r);break;case 13:n=F.v;var y=F.it,b=F.loop;this.writeVar(n),this.writeExpr(y),this.writeExpr(b);break;case 16:r=F.e;var w=F.index;this.writeExpr(r),this.writeExpr(w);break;case 17:a=F.el,A=XA(this,this.writeExpr);this.writeVarInt(a.length);for(h=0;h<a.length;){n=a[h];++h,A(n)}break;case 18:r=F.e;var M=F.cases,B=F.def;this.writeExpr(r),this.writeVarInt(M.length);for(h=0;h<M.length;){n=M[h];++h;var C=n.values;A=XA(e,e.writeExpr);e.writeVarInt(C.length);for(var S=0;S<C.length;){var I=C[S];++S,A(I)}e.writeExpr(n.expr)}this.writeExpr(B);break;case 19:r=F.e,b=F.loop;var k=F.normalWhile;this.writeExpr(r),this.writeExpr(b),this.out.addByte(k?1:0);break;case 20:var E=F.m;c=F.args,r=F.e;this.writeString(E);A=XA(this,this.writeConst);this.writeVarInt(c.length);for(var F=0;F<c.length;){n=c[F];++F,A(n)}this.writeExpr(r)}this.writeType(t.t)}else this.out.addByte(0)},readConst:function(){switch(this.input.readByte()){case 0:return Ka.CNull;case 1:return Ka.CBool(0!=this.input.readByte());case 2:return Ka.CInt(this.input.readInt32());case 3:return Ka.CFloat(this.input.readDouble());case 4:return Ka.CString(this.readString());default:throw kn.thrown("assert")}},readExpr:function(){var t,e=this,i=this.input.readByte();if(0==i--)return null;switch(i){case 0:t=nA.TConst(this.readConst());break;case 1:t=nA.TVar(this.readVar());break;case 2:t=nA.TGlobal(DA.TGLOBALS[this.input.readByte()]);break;case 3:t=nA.TParenthesis(this.readExpr());break;case 4:for(var n=XA(this,this.readExpr),s=[],r=0,a=this.readVarInt();r<a;){var A=r++;s.push(n())}t=nA.TBlock(s);break;case 5:var h=this.input.readByte();t=nA.TBinop(h>=128?_s.OpAssignOp(DA.BOPS[127&h]):DA.BOPS[h],this.readExpr(),this.readExpr());break;case 6:t=nA.TUnop(DA.UNOPS[this.input.readByte()],this.readExpr());break;case 7:t=nA.TVarDecl(this.readVar(),this.readExpr());break;case 8:var o=this.readExpr();for(n=XA(this,this.readExpr),s=[],r=0,a=this.readVarInt();r<a;){A=r++;s.push(n())}t=nA.TCall(o,s);break;case 9:o=this.readExpr();var l=this.input.readUInt16(),u=DA.TSWIZ.h[l];if(null==u){for(s=[],r=0,a=1+(3&l);r<a;){A=r++;s.push(DA.REGS[l>>2*A+2&3])}u=s,DA.TSWIZ.h[l]=u}t=nA.TSwiz(o,u);break;case 10:t=nA.TIf(this.readExpr(),this.readExpr(),this.readExpr());break;case 11:t=nA.TDiscard;break;case 12:t=nA.TReturn(this.readExpr());break;case 13:t=nA.TFor(this.readVar(),this.readExpr(),this.readExpr());break;case 14:t=nA.TContinue;break;case 15:t=nA.TBreak;break;case 16:t=nA.TArray(this.readExpr(),this.readExpr());break;case 17:for(n=XA(this,this.readExpr),s=[],r=0,a=this.readVarInt();r<a;){A=r++;s.push(n())}t=nA.TArrayDecl(s);break;case 18:for(o=this.readExpr(),s=[],r=0,a=this.readVarInt();r<a;){A=r++,n=XA(e,e.readExpr);for(var _=[],c=0,d=e.readVarInt();c<d;){c++;_.push(n())}s.push({values:_,expr:e.readExpr()})}t=nA.TSwitch(o,s,this.readExpr());break;case 19:t=nA.TWhile(this.readExpr(),this.readExpr(),0!=this.input.readByte());break;case 20:for(o=this.readString(),n=XA(this,this.readConst),s=[],r=0,a=this.readVarInt();r<a;){A=r++;s.push(n())}t=nA.TMeta(o,s,this.readExpr());break;default:throw kn.thrown("assert")}return{e:t,t:this.readType(),p:null}},readVar:function(){var t=this.readVarInt();if(0==t)return null;var e=this.varMap.h[t];if(null!=e)return e;e={id:sA.allocVarId(),name:this.readString(),type:null,kind:null},this.varMap.h[t]=e,e.type=this.readType(),e.kind=DA.VKINDS[this.input.readByte()],e.parent=this.readVar();var i=this.input.readByte();if(i>0){e.qualifiers=[];for(var n=0,s=i;n<s;){var r;n++;switch(this.input.readByte()){case 0:var a=this.input.readInt32();r=Ja.Const(0==a?null:a);break;case 1:r=Ja.Private;break;case 2:r=Ja.Nullable;break;case 3:r=Ja.PerObject;break;case 4:r=Ja.Name(this.readString());break;case 5:r=Ja.Shared;break;case 6:r=Ja.Precision(DA.PRECS[this.input.readByte()]);break;case 7:r=Ja.Range(this.input.readDouble(),this.input.readDouble());break;case 8:r=Ja.Ignore;break;case 9:r=Ja.PerInstance(this.input.readInt32());break;case 10:r=Ja.Doc(this.readString());break;case 11:r=Ja.Borrow(this.readString());break;case 12:r=Ja.Sampler(this.readString());break;default:throw kn.thrown("assert")}e.qualifiers.push(r)}}return e},readFun:function(){for(var t=DA.FKIND[this.input.readByte()],e=this.readVar(),i=XA(this,this.readVar),n=[],s=0,r=this.readVarInt();s<r;){s++;n.push(i())}return{kind:t,ref:e,args:n,ret:this.readType(),expr:this.readExpr()}},unserialize:function(t){if(this.input=new ss(On.decode(t,!1)),this.input.readByte()!=(255&DA.SIGN)||this.input.readByte()!=(DA.SIGN>>8&255)||this.input.readByte()!=(DA.SIGN>>16&255))throw kn.thrown("Invalid HXSL data");this.varMap=new Wn,this.types=[];for(var e=this.readString(),i=XA(this,this.readVar),n=[],s=0,r=this.readVarInt();s<r;){s++;n.push(i())}var a=n;for(i=XA(this,this.readFun),n=[],s=0,r=this.readVarInt();s<r;){s++;n.push(i())}return{name:e,vars:a,funs:n}},serialize:function(t){this.varMap=new Wn,this.idMap=new Wn,this.typeIdMap=new Hn,this.out=new is,this.out.addByte(255&DA.SIGN),this.out.addByte(DA.SIGN>>8&255),this.out.addByte(DA.SIGN>>16&255),this.writeString(t.name);var e=t.vars,i=XA(this,this.writeVar);this.writeVarInt(e.length);for(var n=0;n<e.length;){var s=e[n];++n,i(s)}e=t.funs,i=XA(this,this.writeFun);this.writeVarInt(e.length);for(n=0;n<e.length;){s=e[n];++n,i(s)}return On.encode(this.out.getBytes(),!1)},__class__:DA};var PA=function(t,e){this.s=t,this.next=e};i["hxsl.ShaderList"]=PA,PA.__name__="hxsl.ShaderList",PA.addSort=function(t,e){for(var i=null,n=e;null!=n&&n.s.priority<t.priority;)i=n,n=n.next;return null==i?new PA(t,e):(i.next=new PA(t,i.next),e)},PA.prototype={clone:function(){return new PA(this.s.clone(),null==this.next?null:this.next.clone())},iterator:function(){return new zA(this,null)},iterateTo:function(t){return new zA(this,t)},__class__:PA};var zA=function(t,e){this.l=t,this.last=e};i["hxsl._ShaderList.ShaderIterator"]=zA,zA.__name__="hxsl._ShaderList.ShaderIterator",zA.prototype={hasNext:function(){return this.l!=this.last},next:function(){var t=this.l.s;return this.l=this.l.next,t},__class__:zA};var RA=function(t){this.id=sA.allocVarId(),this.shader=t,this.params=new Wn};i["hxsl.ShaderInstance"]=RA,RA.__name__="hxsl.ShaderInstance",RA.prototype={__class__:RA};var LA=function(t,e){this.v=t,this.globalId=e};i["hxsl.ShaderGlobal"]=LA,LA.__name__="hxsl.ShaderGlobal",LA.prototype={__class__:LA};var VA=function(t,e,i){this.v=t,this.pos=e,this.bits=i};i["hxsl.ShaderConst"]=VA,VA.__name__="hxsl.ShaderConst",VA.prototype={__class__:VA};var QA=function(t){this.instanceCache=new Wn,this.consts=null,this.globals=[],""!=t&&(this.data=(new DA).unserialize(t),this.initialize())};i["hxsl.SharedShader"]=QA,QA.__name__="hxsl.SharedShader",QA.prototype={initialize:function(){for(var t=0,e=this.data.vars;t<e.length;){var i=e[t];++t,this.browseVar(i)}},getInstance:function(t){var e=this.instanceCache.h[t];return null==e?this.makeInstance(t):e},makeInstance:function(t){for(var e=new xA,i=this.consts;null!=i;){var n,s=i.v;switch((A=i.v.type)._hx_index){case 1:n=Ka.CInt(t>>>i.pos&(1<<i.bits)-1);break;case 2:n=Ka.CBool(0!=(t>>>i.pos&1));break;case 17:var r=A.size;n=Ka.CInt(t>>>i.pos&(1<<i.bits)-1);break;default:throw kn.thrown("assert")}e.setConstant(s,n),i=i.next}e.inlineCalls=!0,e.unrollLoops=QA.UNROLL_LOOPS;var a=new RA(e.eval(this.data));SA.check(a.shader,[this.data]),this.paramsCount=0;var A=0;for(r=this.data.vars;A<r.length;){var h=r[A];++A,this.addParam(e,a,h)}return this.instanceCache.h[t]=a,a},addSelfParam:function(t,e){if(13==(n=e.type)._hx_index)for(var i=n.vl,n=0;n<i.length;){var s=i[n];++n,this.addSelfParam(t,s)}else e.kind==Za.Param&&(t.params.h[e.id]=this.paramsCount,this.paramsCount++)},addParam:function(t,e,i){if(13==(s=i.type)._hx_index)for(var n=s.vl,s=0;s<n.length;){var r=n[s];++s,this.addParam(t,e,r)}else i.kind==Za.Param&&(e.params.h[t.varMap.h[i.__id__].id]=this.paramsCount,this.paramsCount++)},browseVar:function(t,e){if(t.id=sA.allocVarId(),null==e?e=sA.getName(t):e+="."+t.name,13==(n=t.type)._hx_index)for(var i=n.vl,n=0;n<i.length;){var s=i[n];++n,this.browseVar(s,e)}else{var r=0;if(t.kind==Za.Global&&(r=vA.allocID(e),this.globals.push(new LA(t,r))),!sA.isConst(t))return;var a=sA.getConstBits(t);if(a>0){var A=null==this.consts?0:this.consts.pos+this.consts.bits,h=new VA(t,A,a);h.globalId=r,h.next=this.consts,this.consts=h}}},__class__:QA};var UA=function(t){this.v=t,this.read=0,this.write=0};i["hxsl._Splitter.VarProps"]=UA,UA.__name__="hxsl._Splitter.VarProps",UA.prototype={__class__:UA};var OA=function(){};i["hxsl.Splitter"]=OA,OA.__name__="hxsl.Splitter",OA.prototype={split:function(t){var e=null,i=new Wn,n=null,s=new Wn;this.varNames=new Kn,this.varMap=new qn;for(var r=0,a=t.funs;r<a.length;){var A=a[r];switch(++r,A.kind._hx_index){case 0:this.vars=i,e=A,this.checkExpr(A.expr);break;case 1:this.vars=s,n=A,this.checkExpr(A.expr);break;default:throw kn.thrown("assert")}}e={ret:e.ret,ref:e.ref,kind:e.kind,args:e.args,expr:this.mapVars(e.expr)};var r=0;for(a=u.array(i);r<a.length;){var h=a[r];switch(++r,(b=h.v).kind._hx_index){case 3:case 4:b.kind=s.h.hasOwnProperty(b.id)?Za.Var:Za.Local}switch(b.kind._hx_index){case 3:case 5:if(h.read>0||h.write>1){var o={id:sA.allocVarId(),name:b.name,kind:b.kind,type:b.type};this.vars=i;this.get(o);b.kind=Za.Local;var l=e.expr.p,_={e:nA.TBinop(_s.OpAssign,{e:nA.TVar(o),t:o.type,p:l},{e:nA.TVar(b),t:b.type,p:l}),t:o.type,p:l};if(this.addExpr(e,_),this.checkExpr(_),o.kind==Za.Var){var c=s.h[b.id];this.varMap.set(b,o),s.remove(b.id);var d=new UA(o);d.read=c.read,d.write=c.write,s.h[o.id]=d}}}}var f=[],x=[];for(h=s.iterator();h.hasNext();){var p=h.next();switch((b=p.v).kind._hx_index){case 1:o={id:sA.allocVarId(),name:b.name,kind:Za.Var,type:b.type};this.uniqueName(o);var g=i.h[b.id];null==g&&(g=new UA(b),i.h[b.id]=g),g.read++;var m=new UA(o);m.write=1,i.h[o.id]=m;var v=new UA(o);v.read=1,x.push(v),this.addExpr(e,{e:nA.TBinop(_s.OpAssign,{e:nA.TVar(o),t:b.type,p:e.expr.p},{e:nA.TVar(b),t:b.type,p:e.expr.p}),t:b.type,p:e.expr.p}),this.varMap.set(b,o),p.local=!0;break;case 3:if(p.write>0){var y={id:sA.allocVarId(),name:b.name,kind:Za.Local,type:b.type};this.uniqueName(y),f.push({e:nA.TVarDecl(y,{e:nA.TVar(b),t:b.type,p:n.expr.p}),t:Xa.TVoid,p:n.expr.p}),this.varMap.set(b,y)}}}for(r=0;r<x.length;){var b=x[r];++r,s.h[b.v.id]=b}for(b=i.iterator();b.hasNext();){var w=b.next();this.checkVar(w,!0,i,e.expr.p)}for(b=s.iterator();b.hasNext();){w=b.next();this.checkVar(w,!1,i,n.expr.p)}for(b=this.varMap.keys();b.hasNext();){w=b.next();var M=this.varMap.h[this.varMap.h[w.__id__].__id__];null!=M&&this.varMap.set(w,M)}if(4==(r=(n={ret:n.ret,ref:n.ref,kind:n.kind,args:n.args,expr:this.mapVars(n.expr)}).expr.e)._hx_index){var B=r.el;for(r=0;r<f.length;){_=f[r];++r,B.unshift(_)}}else f.push(n.expr),n.expr={e:nA.TBlock(f),t:Xa.TVoid,p:n.expr.p};for(r=[],b=i.iterator();b.hasNext();){(w=b.next()).local||r.push(w.v)}for(i=r,r=[],b=s.iterator();b.hasNext();){(w=b.next()).local||r.push(w.v)}s=r;return i.sort((function(t,e){return t.id-e.id})),s.sort((function(t,e){return t.id-e.id})),{vertex:{name:"vertex",vars:i,funs:[e]},fragment:{name:"fragment",vars:s,funs:[n]}}},addExpr:function(t,e){var i=t.expr.e;4==i._hx_index?i.el.push(e):t.expr={e:nA.TBlock([t.expr,e]),t:Xa.TVoid,p:t.expr.p}},checkVar:function(t,e,i,n){switch(t.v.kind._hx_index){case 3:if(!e){var s=i.h[t.v.id];if(null==s||0==s.write)throw kn.thrown(new Wa("Varying "+t.v.name+" is not written by vertex shader",n))}break;case 4:if(t.requireInit)throw kn.thrown(new Wa("Variable "+t.v.name+" is used without being initialized",n))}},mapVars:function(t){var e=t.e;switch(e._hx_index){case 1:var i=e.v;return null==(s=this.varMap.h[i.__id__])?t:{e:nA.TVar(s),t:t.t,p:t.p};case 7:i=e.v;var n=e.init;return null==(s=this.varMap.h[i.__id__])?sA.map(t,XA(this,this.mapVars)):{e:nA.TVarDecl(s,this.mapVars(n)),t:t.t,p:t.p};case 13:i=e.v;var s,r=e.it,a=e.loop;return null==(s=this.varMap.h[i.__id__])?sA.map(t,XA(this,this.mapVars)):{e:nA.TFor(s,this.mapVars(r),this.mapVars(a)),t:t.t,p:t.p};default:return sA.map(t,XA(this,this.mapVars))}},get:function(t){var e=this.vars.h[t.id];if(null==e){var i=this.varMap.h[t.__id__];if(null!=i)return this.get(i);var n=t.name;if(this.uniqueName(t),t.kind==Za.Local&&n!=t.name){var s={id:sA.allocVarId(),name:t.name,kind:t.kind,type:t.type};this.varMap.set(t,s),t.name=n,t=s}e=new UA(t),this.vars.h[t.id]=e}return e},uniqueName:function(t){if(t.kind!=Za.Global&&t.kind!=Za.Output&&t.kind!=Za.Input){t.parent=null;var e=this.varNames.h[t.name];if(null!=e&&e!=t){for(var i=t.name;l.cca(i,i.length-1)>=48&&l.cca(i,i.length-1)<=57;)i=l.substr(i,0,-1);for(var n=i==t.name?2:x.parseInt(l.substr(t.name,i.length,null));Object.prototype.hasOwnProperty.call(this.varNames.h,i+n);)++n;t.name=i+n}this.varNames.h[t.name]=t}},checkExpr:function(t){var e=t.e;switch(e._hx_index){case 1:var i=e.v;0==(l=this.get(i)).write&&(l.requireInit=!0),l.read++;break;case 5:var n=e.op,s=e.e1,r=e.e2;switch(n._hx_index){case 4:var a=s.e,A=s.p;A=s.t;switch(a._hx_index){case 1:i=a.v;var h=r;(l=this.get(i)).write++,this.checkExpr(h);break;case 9:A=a.e,a.regs,a=A.e,A.p,A.t;if(1==a._hx_index){i=a.v,h=r;(l=this.get(i)).write++,this.checkExpr(h)}else sA.iter(t,XA(this,this.checkExpr));break;default:sA.iter(t,XA(this,this.checkExpr))}break;case 20:a=n.op,n=s.e,a=s.p,a=s.t;switch(n._hx_index){case 1:i=n.v,h=r;0==(l=this.get(i)).write&&(l.requireInit=!0),l.read++,l.write++,this.checkExpr(h);break;case 9:s=n.e,a=n.regs,n=s.e,a=s.p,a=s.t;if(1==n._hx_index){i=n.v,h=r;0==(l=this.get(i)).write&&(l.requireInit=!0),l.read++,l.write++,this.checkExpr(h)}else sA.iter(t,XA(this,this.checkExpr));break;default:sA.iter(t,XA(this,this.checkExpr))}break;default:sA.iter(t,XA(this,this.checkExpr))}break;case 7:i=e.v;var o=e.init;(l=this.get(i)).local=!0,null!=o&&(this.checkExpr(o),l.write++);break;case 13:i=e.v;var l,u=e.it,_=e.loop;this.checkExpr(u),(l=this.get(i)).local=!0,l.write++,this.checkExpr(_);break;default:sA.iter(t,XA(this,this.checkExpr))}},__class__:OA};var GA=function(){};i["hxsl.ChannelTools"]=GA,GA.__name__="hxsl.ChannelTools",GA.isPackedFormat=function(t){return t.format==ti.nativeFormat};var NA=function(){};function YA(t){return t instanceof Array?new us(t):t.iterator()}function XA(e,i){return null==i?null:(null==i.__id__&&(i.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[i.__id__],null==n&&(n=i.bind(e),e.hx__closures__[i.__id__]=n),n);var n}i["js.html._CanvasElement.CanvasUtil"]=NA,NA.__name__="js.html._CanvasElement.CanvasUtil",NA.getContextWebGL=function(t,e){var i="webgl";if(null!=(n=t.getContext(i,e)))return n;var n;i="experimental-webgl";return null!=(n=t.getContext(i,e))?n:null},Math.__name__="Math",t.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(l.now=performance.now.bind(performance)),i.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),String.prototype.__class__=i.String=String,String.__name__="String",i.Array=Array,Array.__name__="Array",Date.prototype.__class__=i.Date=Date,Date.__name__="Date";var jA,HA={},WA={},ZA=Number,JA=Boolean,qA={},KA={};Dn.content=[{name:"R__DS_Store",data:"AAAAAUJ1ZDEAABAAAAAIAAAAEAAAAAQKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAgAAAABAAAQAABlAHIAeUdSUDB1cwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAACAAAAABAAAAQAAAAAEAAACAAAAAAQAAAQAAAAABAAACAAAAAAEAAAQAAAAAAAAAAAEAABAAAAAAAQAAIAAAAAABAABAAAAAAAEAAIAAAAAAAQABAAAAAAABAAIAAAAAAAEABAAAAAAAAQAIAAAAAAABABAAAAAAAAEAIAAAAAAAAQBAAAAAAAABAIAAAAAAAAEBAAAAAAAAAQIAAAAAAAABBAAAAAAAAAEIAAAAAAAAARAAAAAAAAABIAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAEAsAAABFAAAECgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBERTREIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAIAAAAGAAAAAAAAAAAQAAAIAAAAABAAABAAAAAAEAAAIAAAAAAAAAAAIAAAgAAAAYAAAAAAAAAAABAAAgAAAAAAEAAEAAAAAAAQAAgAAAAAABAAEAAAAAAAEAAgAAAAAAAQAEAAAAAAABAAgAAAAAAAEAEAAAAAAAAQAgAAAAAAABAEAAAAAAAAEAgAAAAAAAAQEAAAAAAAABAgAAAAAAAAEEAAAAAAAAAQgAAAAAAAABEAAAAAAAAAEgAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},{name:"R_gallery_train_moon_2_png",data:"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"},{name:"R_gallery_tiles_png",data:"iVBORw0KGgoAAAANSUhEUgAAAFQAAAA0CAYAAAAUnx+bAAAAAXNSR0IArs4c6QAACQtJREFUeJztW21MW9cZfs715WPmO0AMHhnM6bJkityEphrTKqytxau0dtJ+lEkEkK39XsVHtlVawzTyY1kFBE3qj02djChxVbpJ+zNVhbQSkaogpQnIara0VW6zhhK+cRxgNhif/bj3XN9rn2tfhwJuxCNZ59xz3vP1nvec877vOQYO8JWCAACdeQXzH68h8PYCbbrg4BI+vDqbtrLJ8XBSmts3Ssa8zTQxzkNAysO3Dm+R0sIY3L5Rk0PILogAMP/xGmwnC2nTyUJDwqJGu2EeY3ZDU35yps98Z5yOCADQ4JpA+lxtODfxpi5/zNucWIRNDtEmGk2GdmLT9SVVW6kmWwCAwNsLqtR4Xw2z34DS0bS/okY7yT9RRsSK/KS8kL+dDYCMeZvVOADyBc0nfmof8FM7/DQ+YV8s5FBbWdSozxQAXd6I80SJU82g02LM20xTrZZUbXGYrUIEALbMva+GAWAAQDcAkJqLZvuXFtpZZXGPpwNKW90A+v3U3tVCZuF0RBBcE1LWt7RG8O6nIgDgafs2yq3GvGGMG5nOMaRhK4Ixa3mDqHUuhgS8+6ncn9ZTW9xVwcDrdTcADA0NphrPV4KhoUFtO91AfNsoLYzpaDUDJZ8sCOT6rIU6iwU4iwVcn7XQTxYEsrxBiJaWB2exgD5XGx2ZzsHIdI6RpNJyK1VpNjdE6ixOPcEMiVQDbKB7CU17A2lIabmVUpWZjoj8U5habqXcZe/2jRK3b5QkljGDxDK35yzqxPEgaj9++8vc7j/9bdNUQ7uBX50JdQPo2mk9bEvpc7XB6YgYLvczVTHCljY7AJWyKsP6XG26CfpoTqCtVdvQnAc6iIB8Shc12nH828KeSyfD0NAg/uxuByAve54KBoAsbxA8bd/G9VlQSHkAgEAohuGpy2R4KnUbgVAM2jKtjm3D/TC+7+rLpIOYliJL4PaNYszbjHIrpcphQa7Pyst7eOoySaESkeUNoh4mt+cs5KM5wbQ2AMQnzIzalbUMPWRLvcdVFFK0ntoCAKSSTDYRDJXFMbRWbQOQDzgj7YAxjTExnfQzZC1Dy20WoywCIElN4klNgmGQVK7cSjOyyMwYBF8rhnIGn3aAOymnlDVNCySoTVuL/8uk7AE4UCX04dVZiBUcW/wAGUG35KNLXFVlX7A8v/1I5RKtpL32WomA7Hbjeor2EY/KUAXqycMYnG4v5Jmr+d7fobHxSdP0bt8o15bfd0yOh7Eyn6xEh/ztNORv1x3v7afP0vbTZzPSK3mocYhA3GNFY3WVuHLlg4zogSw+5XngWU/DU5e5kjcynYPWU1tqmA5FdVY0HI2b3X23n6DHilZJyN+O4pZhNT3kl6259ZiImqNRHT0A8rVhaF9TC0amk3nHbO1zE2/qMhkT0zGTMchSAlif1DjRbwM/++ZdOnMnqqt35k4UNUdFGtzMI1Xuwzp6IEFt2uG+tWOkaj+4LrvqzHqJmDMkoNjhRsitLQIA+mWkBA+vzqo/QF4RRXVWHX1RnRWT42G8dfcYTaQHFIa6faOkuGWYfBZIvzR2E58FtjA5HmYefR1qS/mOCeXaJAlMMo3yGWLrWyhqtKPzHw26ffiZe9fQdMGBlYRJXpnfRtMFB565d41bnwjE7VVkYEHsIrh9KSmIodYWTZI4o9M7IOXB6YiooRGW52MoWZqF8NM/YnL8HV15nJdw4sfFOvpDNgvGz0tyvnZPPyIHWXnK85DowWcY8zbTRJ8lEJfMdBI6f2sNk+NhxP7196S8hqZ8zN9aS6JPpWKKQOb26m4h0bm7A5iug6ln0bs3gGP6vMnxML7j1Dumy20WRdvg780CYPoGcE/A+mJ0L8STOE4a5fy4MLoMDIRiaGjKh3RHny7dkSXXyNmsqy3V5dZeILH9MW/zo/aJd93NxYN1wVAT+Otf+PNglA5kqWIfkPJgK4ui7Z9vPWoVvBFzmbpkLUfOelBtl6HuxXo4712DJOlZJEkUTkcEoSM/QGDiZjwj2w+l8Kb5rZQnYUwPTXUXDwAx6zcQctUb1rtVWaZL26osS6nbZi1DH6zzPfaJgzEanFlLKVJXjX/fWOHOXshVj1VaoEtbpQWGEwBkMUPNIhCKcQ8Is5ZSb28nHga3dHVp6iORumodvfJNojOLhEOfXXtocE0w1DcB4L/zIkl8QGYEs5aSFnUvnklK6+3t5H6//Itfc+mzSkJTnbgBKQ+1tihXiTei14ZGCPnb8T27zPRzx6dw7vgUens7SVlZacpNvPS7doCjSWSVhBrtmwzpmKOFWUspt7YIf/j5Mn3pdbv6ZLOn5xLNyckllopKw3KJksugY+g8zYXH07Evr0c8ng6s33+AgrDhM8ZdwaIUQc2P7MDrwPh5SU48YsPCwgIYQ3/yw1dM1fXehxf1DH0fFf1QXsHtBz6vLuk/+fkyN0/ZO5OWoYGD2bTOJUkU//lAAsB/ua1A3WaE0moSC96nLGTp7314kbvkuwB077WUKu9EWfs7QqaXcrekfGzc3cT3n7UhMPGlnHhETyPWPaXGN2ZuwFr3lBoy9Dx7ifb2dnI99v1DQ4N7KqVDQ4PweDr697JNhlVagIjriZQ092++ocYLq+tx/+Ybaqji6PMAFAllPsMWMgs/tXd5PB1dAAb2grEKI7sAgC135XHWbjcNIK5XiourCLnqdRrE719uBQC88NLzalpvbyd6ei6pYSLUvcaMtymTf3QYwcxJnXg/xMOYt5lmi9tRC3XJu32jpM/VRjNRhDNRY0zVpzwb3I+2D3CAAxzgAPsPAgC/aWjd737sKl6bHElLk+6qxazBIAKAo2Ib0pKFOiq2CYDHLo644NDXJkeS4gAQmBPgrIoZqoFm7rbcvlEiAMBmRMBzJzYRDgsIhx+/OAOL97nadOkAEAwTjEznqOqY1kHN0lPls2+iNJAVV8j7AWZEtJ8+C2icIOzlntlvQHbUiABwZSW4q53eLzx3qBRul/w2aWxC9rVqv7XjLhGBB9H4XxHZM8iAlCdfc0h5AGKG+QwiABwW9e93Hhc4HRHM3WNx2c+q/b6yEqfNtxDUWuUtNSDlwVkct8bYiz8WGuUfYBfwfzZG09trNKaSAAAAAElFTkSuQmCC"},{name:"R_gallery_train_barrel_png",data:"iVBORw0KGgoAAAANSUhEUgAAACcAAAArCAYAAAD7YZFOAAAAAXNSR0IArs4c6QAABLhJREFUWIXtmE9IHFccxz/RrWxaRZog2TWrVlE2Fg8mNCi42w3bRQJJSA8pJFhCD8kh8RBa6KmkNrXppaWlBw2FQKBYDNhCgxaKbIXNjpWlECFIdbG0aFZngrWlRHQxanuYfePM7szszPZQD/me3rx5f76837/ve/tO9Yz8wx5F2f9NwA7PyJWKPU3O43ZCVhkCoK6uUet79Oj3ovMyGZnmV951tZdjcoJUX9+HAITDtdq/ZHKZeHzCdv7i4gJTU58AOCbpiFxWGaKr6wSxWNSUmBPU1zdo7Yep2/iPXSo6Z1+xPCeICfgkCYAzwXIARtPb2r+EnCXi9xa0xff+jhYAVrs/Z6n/ZFGCjs2aHokbNnODhJwF4LfkLADV3c7m2ZI7+Mt3dL7oAUkibfI/MDhAm86sSnwCJdcOAgq7Jy3gr/AgXz+Jv/MS8gN787qK1rYP3geMPhcO19oGhBIKEcy19y8usJGax1/hYc3Bfrbklg6soeT8LQjE4xPEYlGSyWUah28a/M2Htc8poRCLiwsqwZzfrXefgwe3SyNnFQgDI3E+PfGC7aL58EmSRl7e3KIp3MrB8bfh+g+2gWFJ7vCflRqhhJzFV2IwmGEjNY+8uUXV029sx7muEL1ffkwg53NXMCZgEQT5bWFS5HlXe5nmuXyT6mGViJ1UCDPY5TxXJ5ceiXN5ZQqAzPBu/0x6Gx9wd0GNwfMNlYAxKNK6JOwUpuT0/mYgZ7PQ3YU1vvi1FYBrzbOcb6gsSNobKdWs8uYW/gp16x0bv3MlmawqhCDWvuRl4egfjPUf0k6x2Fw7mJ5can2e1DrM/aj615HXVH+y+mZ8mvYlL/dOZwzrXPmqxTD+574jABy/McfjHfW7B+t8Z+lzTolFItO8U1WjzTs7FuDe6Qxj/YeIRKZ57PlLG//k/jLHb8wZiO58b21WU3Idz7dw66LqH+1lNUT8Xu07Hn0JgFsX5zVlIggBBad37XCdNj4hZ2kvq0He3OJy/6qa6zotuRX3uXzZo0fP+N8kEkdN51W9Wmvqe25QlFw+ISucHQsY2k/uW4tQEanFYDoqv+Drs/6oJGnm/Lq7mkhkumD+Z5EVrS1yHlCQ55qAVRsB4CoJx2JRiEUJhGu10vXRBWyrQ0EJcwFLma4KTdWk+kxvpumcli9R8IVZ1469ZSs4XRf+xuGbgFq+RtPbnAmWa+XLSs+Z+a28uUVVkb0sA2LpwBpKKIQSChn69QJT+J4ZrCqCv8LD/o4WmsKtlJ06Z0vO8uS8vjeZnFTVSfCNGAq7iiQQriVztdd2YT3MCr6TG5itWfMFJzmCyeQy4cEBbVxbzuf0ka1HPbsB4VRoFiWXD58kMZMj2xgsJzA4oF2qY7GoaVD4JMlxrnRFbvXl1/lWCM+RuNYvfC1ztZcZnQ+mbS7VoAYBQHW//d3BETk9hN+Z6Tw76E+tKazqvVWHc4s+R4BRtutluggKEcF2TxB6PEzNOnorcXRyInIFOZGAA7mgELd+/Y0f1Eu0HlNTPwHOX5kcnZweWWVIe5u7c+c90+qgL1WCkBtSJZPTo+a5SdOHw0xGLpmQHq7Llx4rT7vw+roK+pt9/2XVXezpN+Fn5ErFvwCZOvGEkge4AAAAAElFTkSuQmCC"},{name:"R_gallery_train_Steam_locomotive_png",data:"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"},{name:"R_gallery_train_slime_png",data:"iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAA4JJREFUaIHt2j9rU1EYBvDnmphoYltCwLSxRR2COHTpB1BROnUpOLh0cVU61kGkQxEXJ/UruAqCOBXFURBE6CQdilSrqZTS1tQmpsTh5E2TN/ck59z73lOJ91nKSe6/X8+57805iXfr8kwD/1FOHPcFuE4MHvTE4EFPDB70HBt4Y7qEjemS8/MmXZ+QkNev/MB+ysN7qHZxedXJ+Z2B26HtofZbR/DIwToojyt4ZGBTKE/UcHFwUChPVHAxsBSURxoeGhwVlEcKHhgcFlrNZ5EAgK2K1X5h4dZgCSgAlC6lAQCrn9XraUdwY7A0lOIa7pks8Xy7X8KN07LQ3YM9AMDwqaGOdvlLCoA9nPLm9yjOPdKjjXrY+wDMPhkFALx8YQYnaOF8rfmKAhOMwtu0fRlqf1P47E11fa+urvXcznhILyypEz9e7A3vhqpwWL+YDnWC3psz+8dYFy0dnA/d3YOaz9720cFtoZTAjyUO//hdBkjh9zjBp8ZU2xZKCf3BY2Gpgmo+i6d3VbEhOC9GtqH9KVNj6vh3bu/jzJ/gS+liHy0fvlbQBzPh4Dro/KLIZcqA63v7rUPp4LaRhlLkJg8rdQBAcVIdcv65ev3ZnLrwd82nBe9x3o4KSpGfHq7UkRjPtNpHPZ4H0D3UKdcuqvc51NtRfxsjMtfnbIlHN9R1PUpQXTtoRMDJoUzzPu5OeVuBCjkF5PB+UOmILdMWJ5Ot+9cv5e1UCw8cwSneTm9sY0RmWIsP6fb71y+8uB2uq5GRHO69n1SObyG+CXcdsR5uH67/cuLvloKmkKu1KjHl8Gt35U6MZzqKW2Iig8SEm/sXEABXUl5Hm8P90AB6VvT2+FXnXyc9/40NEvgeJmi21gC2KthsrlCcvaCwhVwNyCXFihNVc5opEdp25mQN7oC2hSbmHK56smZc1Kg36ZnMoZSgcGOwDsqjg9Mw18H5sK3v+kN5OLxfjMH9oDy94OXtVFeBo+h6tF9o+2qf7YzAxeXV1rp0Om+3tKKD854OCqVsrW8CAEo/e9cM4x6mBW4JuIejIewKSrEuWlLwarPHXUEpgR9LMvCs9XmDQimhP0uHhZsmLJQiNnmICi4FpYjPh6Xg0lBKZGtaQeFRQSmRL+KZwqOGUpytWurgrqAUoy/Eo8jGdAmVT2vOoBTnv7WkuPptJU+8xDPoicGDnhg86PkL6OblFv0mIq0AAAAASUVORK5CYII"},{name:"R_gallery_train__DS_Store",data:"AAAAAUJ1ZDEAABAAAAAIAAAAEAAAAAAlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAgLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAACAAAAABAAAAQAAAAAEAAACAAAAAAQAAAQAAAAABAAACAAAAAAEAAAQAAAAAAAAAAAEAABAAAAAAAQAAIAAAAAABAABAAAAAAAEAAIAAAAAAAQABAAAAAAABAAIAAAAAAAEABAAAAAAAAQAIAAAAAAABABAAAAAAAAEAIAAAAAAAAQBAAAAAAAABAIAAAAAAAAEBAAAAAAAAAQIAAAAAAAABBAAAAAAAAAEIAAAAAAAAARAAAAAAAAABIAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAEAsAAABFAAAAJQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBERTREIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAYAAAAAAAAAABAAAAgAAAAAEAAAEAAAAAAQAAAgAAAAABAAAEAAAAAAIAAAgAAAAYAAAAAAAAAAABAAAgAAAAAAEAAEAAAAAAAQAAgAAAAAABAAEAAAAAAAEAAgAAAAAAAQAEAAAAAAABAAgAAAAAAAEAEAAAAAAAAQAgAAAAAAABAEAAAAAAAAEAgAAAAAAAAQEAAAAAAAABAgAAAAAAAAEEAAAAAAAAAQgAAAAAAAABEAAAAAAAAAEgAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},{name:"R_gallery_train_airship_png",data:"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"},{name:"R_gallery_train_the_qu_png",data:"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"},{name:"R_gallery_train_hermit_png",data:"iVBORw0KGgoAAAANSUhEUgAAADoAAAAnCAYAAABe81ttAAAAAXNSR0IArs4c6QAAAfNJREFUaIHtWdttwzAMVIoumAkyRRbor6fwBJ6hk6UfBQGa5eNIS7YR934CC5LJ01Ekrdxe31+vdgF8HO3AXrgM0U85sEzz6vn+fOzmzEj8ISrxLsRvWjKS5Fr7JcjHteczI1TUwjLNK3JE+qyEVaKRehZonjX/yE1QQ7e1tUKo01EoH6m6WV7IGURJmkdrLCL35wOOjt7oVkejsNXm7olSMpJJiCuJEOAb4kVOzxA3zyh3CnVAI4C+t3LmM0iHrmfQUnSZ5tW43AhLVRkpW8I9JKo5ZEFTUhuzVNcIIyGOAFIUCRsvbD2y2nv4L5+7hWyXrBs1Cdb5sxTkv3x8C9kSUe0sZZsBL2l5ZxZJdBpgoh4ZNMt6G2TZ1Oyg9Zpjc+hmSoq1NppDqJJsDaijlmFptEqy0v9W1qaJkiEyUD0z8j1yjEPrxLKbXCJqOZldX8mkWvgiPmw6oz1I8jF0LX8Hurb7LWBkFFVD1l+tHmeOTZmolvm0rgZZpwG94UAjoaui0Yd3a3Y/LN9hPcux4Ypa8D63ohroEUA+ADyUbwHJWHROqt1M7xuIIX9JaApGXytbMLy8kBGk+UZ72myiQtFFUXkDwBXMOIWWi0rrWO6MNFR2OqumXIOiK1HCSIerGEKUY/Q1JorhRM+Cy/zj/U/03fADBLbevvqPh44AAAAASUVORK5CYII"},{name:"R_gallery_train_cancer_png",data:"iVBORw0KGgoAAAANSUhEUgAAAG4AAAA0CAYAAABrTg1qAAAAAXNSR0IArs4c6QAAAvtJREFUeJztm2FuwyAMhem0a/X0HGz7xYQ8Gz8bN4HgT4q6RpASXmxsk71KKT8l2Y6vuweQ+EjhNiWF25QUblNSuE2ZEq7WWmqtUWNJDHxHXISK936//51v55IYXsWRx6FW1otVa03xAoEtjloPIl5rk4LFA61xvQCICLRNWls8cHBC3R53vn3nrDGDmFhU4bQJp9aUAl0DZHGam0PXshQ1jrAEvLnIXMuuYSicVQgk2nyy1V15by6La2L2UWZfRUHEflrV5ep7CamcIJZ2SjVFmgcugJu5f3MCzlVDuE+uf993R9HoHFisjHtgZ2ICd3BCB08/ufYrusbmstG0h963Z+Ij5gG2uFkLWVU0Tz01wtXNzodYZKbuzzoIycJWcZEjt97gxhpRcIiwWtFVjm6KupbmQvpok36uIlgP4h77NlF5Kv1dj/jDNa5NODd46Qakp2ml5Nw6FsvEog/prHjmdICzRG6gq4hEQUXr71NaMrh5oH0+hWkjFc3VuD53CzkK5UfhPSoa13Zm/dOA0wHNRbY21j5XYhn7CMlqEdGi5sKcx6FR5kprGsWbBtBrSOdncln0AYJcJRICU/++Eqiro2jpkDVosfyuxlSRuf++soVR7igGWAvwGibhRu7B80TfRVQU7HGvUfNiEo4Wian77OuVq1gf+v4LkuJYQIKyUS6sCQy/uiAljFzVZGXRStFF0apGGtYczuMBHv2/A0iFh0ML95E9RTSC9D4k5jVO2pdbyT0iaOOdKZBb1jJrkbsR8gr6DoJ5w/qZHRLuOhroXLqE2xHEvUntrPt0Eoh44SWvneknXltTZoIra0kQ7ccR8rLQ6iCiaf0tazhSJeHyXot4RwiHIpXtLG8D0Ou1/vRcjzcp/zntqLX+HUi7/vunxmPtc0xwQvFGeNFpj7cwf6xwDc/ESX28hWTvg3C761rhaO4KcZ+Wv7VreI/jLc6DtNNtzQ9nSOGcSNGnRPSeZQp3AZ94MyCF25QjSl5PJIXblBRuU1K4TfkFsZVjqi9cwXgAAAAASUVORK5CYII"},{name:"R_gallery_train_nimbatus_png",data:"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"},{name:"R_gallery_train_x_mas_tree_png",data:"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"},{name:"R_gallery__DS_Store",data:"AAAAAUJ1ZDEAABAAAAAIAAAAEAAAAAIJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAABAAAQAABuYndzcGJsb2IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAFAHQAcgBhAGkAbmJ3c3BibG9iAAAA9WJwbGlzdDAw2AECAwQFBgcICQoJCQkOCRBdU2hvd1N0YXR1c0Jhcl8QHFNpZGViYXJXaWR0aFRlbkVsZXZlbk9yTGF0ZXJbU2hvd1Rvb2xiYXJbU2hvd1RhYlZpZXdfEBRDb250YWluZXJTaG93U2lkZWJhclxXaW5kb3dCb3VuZHNbU2hvd1NpZGViYXJbU2hvd1BhdGhiYXIJI0BoIAAAAAAACQkJXxAYe3syNzUsIDIzMH0sIHs3NzAsIDQ0Mn19CQgIGSdGUl51go6am6SlpqfCwwAAAAAAAAEBAAAAAAAAABEAAAAAAAAAAAAAAAAAAADEAAAABQB0AHIAYQBpAG5sZzFTY29tcAAAAAAAANPPAAAABQB0AHIAYQBpAG5tb0REZHV0YwAA306NkkDfAAAABQB0AHIAYQBpAG5tb2REZHV0YwAA306NkkDfAAAABQB0AHIAYQBpAG5waDFTY29tcAAAAAAAAiAAAAAABQB0AHIAYQBpAG52U3JubG9uZwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAgLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAACAAAAABAAAAQAAAAAEAAACAAAAAAQAAAQAAAAABAAACAAAAAAEAAAQAAAAAAAAAAAEAABAAAAAAAQAAIAAAAAABAABAAAAAAAEAAIAAAAAAAQABAAAAAAABAAIAAAAAAAEABAAAAAAAAQAIAAAAAAABABAAAAAAAAEAIAAAAAAAAQBAAAAAAAABAIAAAAAAAAEBAAAAAAAAAQIAAAAAAAABBAAAAAAAAAEIAAAAAAAAARAAAAAAAAABIAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAEAsAAABFAAACCQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBERTREIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAIAAAAGAAAAAAAAAAAQAAAIAAAAABAAABAAAAAAAAAAABAAAEAAAAAAIAAAgAAAAYAAAAAAAAAAABAAAgAAAAAAEAAEAAAAAAAQAAgAAAAAABAAEAAAAAAAEAAgAAAAAAAQAEAAAAAAABAAgAAAAAAAEAEAAAAAAAAQAgAAAAAAABAEAAAAAAAAEAgAAAAAAAAQEAAAAAAAABAgAAAAAAAAEEAAAAAAAAAQgAAAAAAAABEAAAAAAAAAEgAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},{name:"R_gallery_train_taurus_png",data:"iVBORw0KGgoAAAANSUhEUgAAAGkAAABxCAYAAADWB43MAAAAAXNSR0IArs4c6QAABF5JREFUeJztm1mO4zAMRNmDuUpfqA+aC+UwmY+GMIKghbIlVVXCBxCzOIvtUtEUpXyZ2csCav6gTyAYEyIJECIJECIJECIJECIJECIJECIJECLd4PV4HvmeEOkmr8dzu1h/t376B/D1833ke14R8/F6PI99V6Q7EeCjUi1OusjCSTrAR6ZSnHaRhZN0gI9OlUC4yMJJOsBHqEKgXGThJA22tYXyftap1skuXo8n9BrCSQKESAPQLjLbmO7KC0vpD33BM5xaLxpxbKkiiaMoFpov+y3zjsMuFtP5wRb9wll+YE4qYRKL6VzMiJbPw1l94C2XWrweT1grBtkCagT8BKjEIhToRZPuWkQa/AU+UmZip7MYXWQKTioJJ4nFSlexusgs1pNkgI8UdDC7yN7JSSwd613AR8qquOIIdhfZXSed+NnHDF8/31Tns4pl6Y5FsBmhGFZdvWxJO8jeWzqHFa9hiO1LFeWoZhm5Si7a3nFo7XVoHV/NO/T8jreFeqId+2mjkIvMCBb9doumJEYLmuXzGjtSo5qLzAic1KN1Mz0ltpoQPaidlDObBt9pL7oZwTygF575lue4ypyoEfATcN/81o32CqAqFGUX/M7cpve8KvdLKAEfKXlcSW3v2v1OQeWkk+WxUsecRqRcIM/NS1339NorXXgloeB2rkWvSPAWFGxxdXWAwkm10VyO8uSUmXTodZeCm+Cja3R8xTxp5jx2br684iTqtlCPK67yvj53cf6cHL1/VP7fKYqoXdR6rXfkzzhk9BxMx/N/X3XH5OvxIrUuclQg5O/3vP7OjVudAmc+jyLdtUrvMj2kNORtsK5c2lg9f5v9PKiLese9vbqVJfmJAsJzjXlQlOAl5egtS+n8wV77Mx+lLFvN7tBNd635y2lq6bDWLUgCjdaSvKlw97V6P3/6mbRiVF69+NIhNRSXx0dd/2mRVt6A3g29Mxi8XQYVMeFOupNSW+fimXQyCTQ6F6iTVpCX5WURkY6r0xWJ7QKvzKPurPKyQDGZLRmtLfXWgUqh3kEw6JaunjNGIuR/bzmoVX73vpNRQLiTesLU5jzewsUrXMtdTK6DizR701v/Tp+V31RPr691jEGcBFSkkTNGz6bZ7+jdeO+cDSEeZe/OQ6/jUIPJGbPARRqlotQgzRuuqzdNshYMCZoN+6OiIf//8vWtpipLg/gu8MKhxsyzKn9P73jrGLuLzIhEqrV3elwtzdN7Z1Z50cCfSTknd5SqCGRGJpKZr5DwcHV+xAhNusvZ+RMVJXESdE7KQe/QYYGmBB/Rc9UoDaqKk5ARKceTBmsNU2WxIPvuTkVrd6tYwE8ghBoEdeEQ/Ac+Uk6EspvCSSLAR8qpUHVTOEkE+Eg5GYpuCieJAB8pp0PNTeEkEeAjBRFKbgonCSDZBV/F6FcaLHysk5R+7PyxItVgFS5EEuBjRao9f1ifSZS7hU7DKk7io6s7FT423SkRIgkQIgkQIgkQIgnwD5WYFjQxoZhkAAAAAElFTkSuQmCC"},{name:"R_gallery_train_torus_world_png",data:"iVBORw0KGgoAAAANSUhEUgAAADQAAAAvCAYAAACsaemzAAAAAXNSR0IArs4c6QAABTJJREFUaIHtmu9LW1cYx79xtpR2amKWQDWYpnYDpbANKUvIi0nnYFAcjHbYvWlf9w8QoS9k0DEopRQKg71a0TepEN84AkIxWIYko4RNkCioi4aqzGDmjLUyQm5fZOfm3HPPr5tkrJR+4UJyzz0/Pnme85znucQVCHxg4A1Sy/+9gGbrLdDrrtZGBwj6wlrPbRbSjU6lJcdA3ZFIteNaNZa4+4fRcuWatE8lEQey1c/lCy7z/lYq5XR6pVxOolx3JILrdytIpieVz5795rnl+04sAAC4HL5h3ns81oLWNaOp1tMCIlZRwbAQrG7hPgBgPrcHAOZYxXs3ATTHLZUu1x2J4MSXHlyN7gmfUYGwGgx5AQDJf9ffOTpR/dAEMGmUIzBEm9tXbM84hZH17RydQOfohHag4UkIRMMQ66znR6QL2okFzIvVTiyA+dyeeYnGAIBr0wa6IxHT1Z2o4bANQAgg03xuD324jeXQ9ybULdw3Ya/frQAAHo9FHEXDd9rbvd+yN3nWYYMB/cseLrVrTdbS8g/cbauWe779Ofj25/C153cAwDnPaWzsvzTbL35uIL/Sg9JzPddu2EIqS+iKdsPBkBfjsQfmd/9XQOvaTa1goZ360OeHSkZuFZVE3HIZuVXbHhRpPPaAGzB0gkXduZzIMpVEHEZ20XbfyC6ikohjesErHZcXSYl0oJRA9AJUVqok4tL2v79YMMcUgREr1uvKNiD/+T6cPOvhPQugCtXbM2VOyrpGeSPDvXiSgQH8kK6yUl1BIdiVQLArAQBIxqzR7/Bom9vn3Q3A9QwwLtnbphe8uBrds0VSkZXc/cNAlp9R2HI5//k+nPkoZJtYlvoAVd9fz4+gfWAfTz/7xNYe9IVRvuAyrc+O3zEbVWbttIr3+FGvKQcrULPaRX8bnnLaNwtpoFBLdE8+88C4VAUhMnKrcIXet/Qj+5a1nshK2lFOFZ2IlnZLeLQyJGzfSqWwlUqh8ksRZ348ZWnjRUdRdi+yZtNL8GR6Eg9nfsCnc79Kn9sspHF4tC0MGOyYurIB7f6xjBdPlm2/HqC2Ej3xQcbdVCjdg11qoY7ZqMXHgSpUMj1pOwB5ByKBkoHRUO5xvquyMOS7u3/YFsK1XI6A0YDr+RGLRdbzI9xz4yDjNsEerQwJ99d7P43hIOMWwvDcjrePpFGuvJFB67kB2/1KIm4ZTMfHDzJuLJ0oAQAX6uGMHkxvz5Q0PeIC7ZZyAABf58fCjiTE0pPRmYMsdVnaLQnbVAp2JaQ/oPIcElnJyC7azgygBsWCkV+bvE8gImXD5fANc6GkL5uFkJRLJiEQbSVd12Oh6MUNgh8hacDlUG0P8ixM0i2g6iF/xb9zdrDulnIoFH8DAGFoFWXYoncLMpHXXGy/3p4pW6TjHcKAhsvp7CeRpdiF6qgvdxt94doxQFsFkNdLgMNcTuR6QM1SLNhOLID5sLW8pkWX3rRYEKL1/Ii07tIC0tlPRGQyV/+H3KAhAtBRMj2pLCIdvdv2t4VM15NBsRq6M6P9LE/TC15bxrKf/VmvHlKpHihSegPquooWyR11YYA6gAArFKAHRkPpigUB5DBAnQUe2VOA3r5yIh4EkQoGaKBi5UEBzvYWKxlMeSODl8d/KsdouAQXgQGNwQG1w5wc7vRcItW1h0Tyt4XMz7yD+GjgGAD/zU/HbNSWjTgBIWoqEC0aDqgBEihWpzOnTAAiJyBETXvrw0q4mCcAfPby/kXxuC4AVv8ZECvLYusvh5R64/548RboddcreI2Z7U52UC0AAAAASUVORK5CYII"},{name:"R_gallery_train_nautilus_png",data:"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"},{name:"R_gallery_train_blaauw_observatory_png",data:"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"},{name:"R_gallery_train_joust_png",data:"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"},{name:"R_gallery_train_char_png",data:"iVBORw0KGgoAAAANSUhEUgAAACUAAAAuCAYAAACvWdDAAAAAAXNSR0IArs4c6QAABHRJREFUWIXtmF9IW1ccxz+mxokzxnQL0dWNCdq6VWZXESOy4uhSh9X1QcdAZI7RPbUdzGJBFELAMlhZ91ALg0hBCduDe9nMWv90XXELZh1dHaRUNlkDyxJCwOiSDuufbQ8395hobO/Nn60P/cKFnN/53XM++f1+55x7b87BQ8f+4RGT5v8GSKbHUEqVm7GRQiubv435aQ2VGajQCqUHj4tm4KfhtMDSh4oBaY52CFNpmmDpQcUB/f31F8KsOdqRFljqhR6Xsq/0HwDg7HQltFNVWqtv3XtTpE0Gcna6aP2skXXvTQk6fgH8F1C5z9eyerGPN5Y/SbB/WjQGpJ6+nHSOmc6cIqbX9wBw7Ilfhf3L+5WEFm9h3P0yocVbqsFSjlRnThFvvXgfaitYz79D275d4lrPv4PR8ibDL/1Gdf7TqsdOafV15hRx+sxTAJgwEwTeuT1OY2MTLtd1cve3YWo2U4aHkVboHgCPLpo9qHvBAFfK4Mr5PwHY0wOmZjN/3B7H5bougTabAXjt/F3ppt1wzxfgSVOpojlUp6++oJKrPeWiXdGyREXLUoLPVtvVnnLqCyoVz5FyTV3tKSd3fxsAC5eLt/UvXC5Go92X8AeyAlUdKeSseQ0An9OPqdksgHy+gLhkW+mpt+keCAFw1rxGdaQw81AAZa3PANDv1hKcdAMwtPxRgo/cDlwY3XafEqW0+nxOP6AVBQ1gt9vjHD4GpEgx8CE+pz/7UPEaqXHQ0BEgHH4Pg0EPQDi8zPw3Drp/7kppTMXpi6+nfrcWBvtEXzi8DMDU+9KSNxj0RGb8Uudgn+SP8rpK6+wbqXFQdfgaBoMeg0FPnW1eQNbZ5hmpcYi6UyNVUDvVhRwpWXIaIzP+hLpTWleqakoqcACtiFI8BEgplCNWZ5uXamvLvRmD8uii9Ltj9TDYBzi2AckpNBj0CdELvvIq/d99K8Z5mFSlz6OLEix4NiFKW1Mn22TYqsPXGDPPKAZSDWXceAFqKxJs8ZGS9aO1KgFWd0j5HqUaSpZY7iQvcjmFyfyVSPXmOXFmgSPHS4D5pFGSlSytWYOS/nUJz5U3MXVqVdiPXMhDs3cvALPNHmF/fbKa9tFf6D3gxTFXmNlC31pPl8q94vfmct/eHl6bUjqFkOJImf76nSGzn/bRkk1jSz8A9h8ccDcgzHZjA7aW2LnnPKEaSlWhu6c33+HsxgZF99iNDSKtWYEyW5K/Ks3eCNBb6hX70eyNQFI/pVL13lcdKaTrgPSkYLl0Udin3z2BY046PoZ6d+GeXknoj3x+mpPnNhRvnqpWn0cXxTEnHTWWmM1qdeCd04oJT54rBLR8b3Vgs3XFbMqBIIXN06OL4tlYxGqVzj7n2ETChB5dFI8uinNsQkB7NhZVzZHy85S33iLAdpLV6sBbb3mgT2agllYxNrULMLQ7DKHVCCBjUzssrSb3SxsqBiQ/uAUn3VCcl9y3OE88dZqazarAUnpxkCcLzY0/0O9h/TsprU9B2dIj+R39MZRS/Qv/oao1s6Jz5AAAAABJRU5ErkJggg"},{name:"R_gallery_train_boba_fett_png",data:"iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAApxJREFUSIm9lkFIU3EYwH9P3kxcsKW2cG7OEUIMAiEo0REa3aqLhw5eYiDhqTxEUIfEy4xuJkQHoYuNCDyFhySmdKhOSWDr0MDG7NnmXHqYiZuuw9v/+aZ729sUPxj73vf/eL//9/2/7/896eaDL3lOUOpOEgYgGy38fHdP0ztvPT82YMkI/y2OYz3Xqv308KOKYYQAmcQqcLwRGgIzidVjBZUFut1eenv7+LpVbF/79ULTs8lNAJyXHx0deFAEyHK9SbNZUHUlNF4VWDLqw5bUG9rbPbyPLBaBAEiClFLVfEthU68/mTqCsn2ohwV9AYK+AFJEhfXbPfTbPUgp9dlsNZdNqRZZEj4oYeY3YiX9dpQ0sA8tF2nlm6aQvoOwsbsJ5jdifHzYQDa5ycKwrQhaFVCZHSXarer69Onl6rNtZrvTXBr8wcKwjb6Xmzw9f6ri/o1TmlT/+u0e/PHPAPiBaGxXc5legiFZZnoqQ+Ogl+jbOEOyzEQtwCfLSuHlcaIF24yUAwlWVlY1v/ttbkK33VxTPECcqVyutghDeSdxaVl71kMAJns6iMZ2mcrlaATCcozBwpr94gXD4jEE7n1bg6Zi0GRPB6CmVcAsDhtSZL8fK0nJonHeGGNpO0Vb+vShiARIpK7eWWgdB/zx+xmSy19epgewKBb9GVm7vEU+Ybl0n9YE1MMsDhvWLi8DI+vkfeqaFDH3jqqAAlTvbGJgZJ2ZuWYADSrSWhNQnOOVxk4AJn7HuZPOqIAWmJlrJugLaP6iaMJyjOz3hOH1Zmo8lZKgL8DjyKt9gwO2QsvaZo3ENNDlagUxyBxoMAEBczPRFNDlaj1k06KpcuIbDmAhyuwomb2/AFjrzsDZhppAQipGWO48apET//L+D2MV+gdIIc+LAAAAAElFTkSuQmCC"},{name:"R_gallery_train_leo_png",data:"iVBORw0KGgoAAAANSUhEUgAAAHwAAAB9CAYAAABgQgcbAAAAAXNSR0IArs4c6QAABRhJREFUeJztnW1y4yAMhunOnqLXyRF6zhyh18k1ur/cpRQJAQIk631nNE6IYxsehPiInbeU0leCwujP6QuA9grAgwnAgwnAgwnAgwnAgwnAgwnAgwnABXo9H9UttZ91fcF+2+v56Np6sbe0eWr19Xyk94/PZprGeUpx55B65/vH5/f1llsP2g6cElWI0sLVbk6pSlmen3pvtRIcBd4qrHyrLU0YUrhWKoHLWLkqdlLHRQwfFBfDtTxgZW95JNxY0vEYzsVkqjB3NPGjfQnrOg48JR7u9XlL0o7cCKSRDqXlCnEkZlPpVse9Vq5Dwc6d3Drk0XwYt7OFJIVvxaxel9RMxHBon7YtnrQWHFoLE15k/frh4cF0ZHnUkhdYupYdOgLc6vg0gvADiBTLy0PHcAr0nVugv6cvoEerF1fuDPqSK+Baqs3TR4CdksMY/no+vk1DUUBfcuHhJVxvkKytnB2f3+0xr3PYVsxdk+5RloZ97oBbaho9yh1waE4AHkwAvljWln0BfLGs9TkAfLGsePal0IsnK8WBPun1AD4hzXvfdt3cAOCLBA8Pqhy8hQ4cOm3BBOCbZMG7UwLw5Vp5x+uIAHyT4OHQEQF4MAF4MGEcHkzw8A2y0kNPCR4eTvDwYALwYALwYALwYALwYALwYALwYALwYALwYAJww1p118rxe5Zh/23Dg4bPZxJGQ79MEfr5DMJ+wuYgK0A/n0lYHXbt80nYAG7FaqCptBno6KVvVM/tR/nz48rHlM3e03a8dsN+emyro8Y1+wI7n9koxkEqgfZsewxN+mJR//jA/UOE5O84Z24tPl7zo1ir9329lng0Om0O1PNnei0Pn9Hxmj9q3h7DKR1fc1v3wzJLv9leLYmHczFc64bEbTVbyyPzGanJIYoJG/XwwXyfzUTr+7P7WDcKosu59IVLfLcAXnqpSw/vraGLFwrMV44WXBcergVd83qsxvpWc841+Vs8vNczax2snuEFPFzXSbqHZdfQgBpiUJMFte/V9qudT2PoZuUZK5yo8uDSR7Sspo70Oms116p3apfXSPkN2JpMzA4xas3/3YyLz1wlKF8vBV6eRFozuf0p6BHA9zhFnv+jHr6yGboj5DxvvR4+W57dwCW985mLp1qEu9qIh0+2droXzcGmIN4dKlduMx6+FXhP7N6YGXc26uHbgZcXTUHtgR3NqI7Ywg7b/Hr4q1infRGTLi/iN13UNj/eXSWdvJL+UkaiKeAtuLX3pfIZuFrmPMyQjYorP2rG8npd+w90icTAawctIUlhUy2C5vShB7WmUfPP8zKbcQIx8Fbzk7+/9qdgcWGAmoO/o8pyyB+mL/1ZU69DqHr4tZ9kwaMFvTzvHT2dq+S18sjTLrskLZ+pZ61KYjglaSYjiIvLNaco9ynVKjvxEIJLrw3BKGt9r+f8Xq019Grtn6f3lI2ah/euW0uasyjiOmh5Wq1cestq+vHZI806YP8W5zSt8XhPeamNw7lYk6s2CZOna99W40W1IW4tvfa9Xi2JRZLYXe6fp0exWkxeWQ4q/4ggieXSGbmIzfluTdXIMj3/fMSzqRoPU7P5g0hgtuADriPgEojwcDOmdzDp5IkUNsw4cA4+14sH7BsAl8IHbKfAtWM3zDhwaSVAM37c5mC20kd75agMxoD3VAo046ZsHiaXDtjmTP+g6JWbNsAOZvoHBWTTtubAgG3TVNbDIT86/qxVaK8APJgAPJgAPJgAPJj+AU2X1YH58OpMAAAAAElFTkSuQmCC"},{name:"R_gallery_train_char_side_png",data:"iVBORw0KGgoAAAANSUhEUgAAACIAAAAuCAYAAABNhcu5AAAAAXNSR0IArs4c6QAAAsZJREFUWIXtmM9LVFEUxz/+SKFxmnmYTi9auCgLKoXCnFqIq4J+UKAgSSD4BwQmCTaKDBnRWC5CaFEIgRCSQZSKGZQY0bSQrGYhIiklM0wDvjEN1NRa6HszThG9e1+jC8/qnvt4hw/fc+55576UQyVnf7IBLHW9AXTbBEm0dEuiRBdia2fGOoFEF1APVhtu6GO7EIwcSBxE6qlyAFRBGOka0QGWe7pY7ukCIMdeuDZd/xukUtnOE0cN3ZWv1+yn5x02HcuyUxMPszgxlFyQD9+WmewOAnDn1hcWJ4ZYnBgSUkSqWAP2WTz+LPBHcCux/aQrAhBYmqJgWypn9qbRd2WOewWfhOJIH99z7z3c3XeJrnkHvNMA0LQX2FyqqVDiiqxCjPU6KW5tJ38+13hUvHWP6XBCinwPh1AUx2/7bxr3AzDZHcTjzyJgn/3nmFI1MtbrjDnN9VQ1RADYdXqn6VhCIDaXiqZNi7xqLYhuo1druF/YAUCB7wbX3D8AjN6SNBCf7+YaX0+Jx7/FVH0ApIjMrPHFWp65A4DaumxAL1TzIFJ9JH8+l9rGbMM3IJamgCSPAYkQNNcLvS+lyGjmV6oadC8GkVNaRmTgkanhSFiR/ouqAdN2OU1YCWmQIu+IsT5+O0TbtA+A8DN/ckHiTdOmsZeY76aWgejpURQHM4NBYTWkQBTFYaTHinYvnRodosg7Ql/dmHAcoeNrc6lo4RAAI63HgJU+MjMYBHYLgUgpUlFxHk56AKgez8P/fE44ljWddRWmJZTHQ/fgOoIAR4+snCBRVYRBbC6Vzs4Hhu/1XhANJQfyN3O9epn8S3hTU4ex/jw+QMew+VnEEpBEIBEIkBwDbJnZvI3aqeoNE3jcb/pSFW9SF6wD11twnXADKzOI2X8i8SamSHSBnNIyqY+cNSDODCLDT/+4L2ob5vfmJkiibRiQX7xD6mGWPhXxAAAAAElFTkSuQmCC"},{name:"R_gallery_train_tanjiro_kamado_png",data:"iVBORw0KGgoAAAANSUhEUgAAACUAAAA0CAYAAAANFPE9AAAAAXNSR0IArs4c6QAAA8JJREFUWIXtmV9IW2cYxn8JmQMjQjA5I/5hNUNKdlFaXKHdCIOxdo6xhGkGuzOByQa7qGzQCx3BivFirKU3RYohUTqGF0vBSBFiNzZCwFEKpRfNRaQO7AxqXYtMSUPQXYQTc5JUv3NO2grLc5XznZzn+/G87/edkxPDw4vX9jhiMr5qgGqqQ4mqDiWqFwL18ey0ruv/P0nNe/p1pXUkkzLV2tAXjel2rmlSvmiMY81W3O0Sb+QtmktYk6TkdNztEve3dnX76U7KF43hbpeKQCeajdzf2sXdLmn21JWUXK7SdErBtEp3UieajUz7zEyP2Zges9G7Z+C7iy0AmvtKN1R5Ip6gldnhx7o8dUFN9bk5Y8lWjHuCVs5Yskz1uV8+lHcxTiifZ2J2E5Z2iuMTl1cI5fOafQ1aH4f7s2l6Bze5ebXQP4ZbqeK5zxYKK++Gb4vttQwX2jroeecDYW9Nq08GiiZb4DQY7ijPR5MFUPPJFu5+1AlLO0zM/iYMpglq+94y0WTngd9xXNkofHjLrNpfc/m8czEah5yKMeNIimPNVsXYnzvpl1O+anJc2YASoIff2gCQ7tgILaToUeGlafV552KYzzkreknWX1uvcJ+C/SY/FTXyLPuUZ9mn2BtM7EwuA7B3GsznnHjnYsKeqssnpwQQ9PpxuVoBSCRW6b5O8bj7/S/VWmuHkhX0+gH44m2fYvz7XB57gwls+9a9g5vcWHhBUN7FOI1DToJv+oW+3/feJouf/MPg1228bm8SnkdXT137akhxnMnt31qa/s5y82oLMz92qfYVTsq7GKdxoJPxQ1KyNygtJy6vAKjapzQndVBKUIAz3Erxs7+DUOZfVd7CUJbXODSl50ntliAENbqe5vbtUHG5V0tpLPIDDpfytrM7ojwWVc1uM5cuBXj0KMNJo63i3PZCil8+FX/gOzSp0fU0kcgwUNggy5XJ5VkzPWGy+zzznn7u7W4oJxhJVVyjG6pc5aWrJrnp28bT2BtMNOXUvYk5tHwBqQu/PwjAysoypQ8mckrznv7iWPHlRs5SsT2ISiipgNRFQFJugtWASsHWTE8qtomaQsnq6Ojkm+vjzDyYwuFyVgUqBXO4nMw8mOKPpZ84e/bd2kPJDe9ytVZt+OcpkVglkVglEhlmdD1dW6jSCcLhSEU5qykgdREOR4r7m6hUdaJsHg6rmkNVsiD4w2HgbhzraqFpH7eamOw+r2oStdcLJ3X88w8LpsnfVQGVX38cGEjGDwQz/NozWv/DSER1KFHVoUR1JKH+A/LnV8/KMvGEAAAAAElFTkSuQmCC"},{name:"R_gallery_train_hazmatSuit_png",data:"iVBORw0KGgoAAAANSUhEUgAAAB8AAAAtCAYAAABWHLCfAAAAAXNSR0IArs4c6QAAAstJREFUWIXtmE1IVFEUx/8TM+DmDbRIZQyxWcQLwWoKknBmYGYEDQU3ETaCrmpjEPPcuGjAXSBjKxczuBGy1hHpwlFynKRFjX3S0MJqnI+wongPIs2PFsO7Op/v3KcPF3ZWd87/3PM7575775sZUzB4bweHZMcOC3y04WY9k4bEZTaOhPNbRnY7jIcPicsQekPss+TKj0P+BHcBXHAGzoTg6//A/NHJM5CmGrgL4IJHwjuQXHlwNHCK+UXvPJJzHp5UADg33IxZLgD7xj4BAJJjlyF65zFjlo2DA0A6nSsAi4El3hT64J2bViTnPAysmhhYQnLOg85Nq3FwAPgeeItbP4QCX/zsCTzqSvOmosOHxGVIT8fw7OPxEk31SVMNsC4kyHAT5cWy94gBwOJKL6LReaaPjPQxDQBC/gzpyOm6Xp32h/D5PGXBPKYJL+6aYi32ddLya8Ij4Z2yYNZ9Ga21vYZUJNeyK7FsVX32zgpPuupw60ICLfb1irrTaSvrF1w20tJrdk5dQj2mCRdcu931BHMV45RYFncXf7IxpWiuZ36loV5TV2LZgoL3BVc3mdZmU01w2cixpGXn6YYK1oTLbgc6ru0mnc58LQwoOuN79Z5gTvOKJT1zPybR+6QbvyyF4cVdWuouVIzVDTfKyPBcYgIvZ89XjZFOr2BjfPjg4Je8ddgYH8b12toS7fnsHzYWXDa0tteg7vcqcokJdF3t2D9cLaDYqu1qCpgMr2T3X1n2M50Gty4kcOOmiZSw79xffH784uDgRhkZTr3heN6CujpXYlkMjm6hqfsiQv6MnhT64ZUKMhxeDqIHTIbLbgf6u1cZRF1yVRsc3WKxezUtI/9ETitriITr2biJqFWFp1JfNINS8ffsW8wbeTvvqzDvpFCL+INpNLY1a8OJRTJwWlkrSdzY1ox3ALZff+NJB9PAwO3/fwIeLfg/QXoUyIAlv9YAAAAASUVORK5CYII"},{name:"R_gallery_train_puffbird_png",data:"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"},{name:"R_gallery_train_gemini_png",data:"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"},{name:"R_gallery_train_buffalo_skull_png",data:"iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAAAXNSR0IArs4c6QAAAgJJREFUOI2llLFrE2EYxn8NaS458AQPuSWEQKGGDrYQdLGgIMbJDlI6dHI5hHKDoRTd6yAUyXJL6R/gLHRpgkKhOCiB6BCyhCbxlhtaMchpQqAOaS539L5Lrnng4z7e93ue73l57/3mNne3LsyMw/fGPwAO5FtEhe6cA7CcS2J0ZGKjxHXEvPDy46ONmXGAJCbONST9vDiA0ZEBKDRsyjktsqTunPucxkLOCrFwJoXm48JMzYaVoevVSt0NnzxZoqn2WDiTaKq9QGqw05qNaZagZpM9bmElZHetVupQsym+LgodC8tvn9YxzRKtmynfOrmtsrOt0z6t0/zZCeQGl7+isff+AIDCowesra/70oZRdM9N7bTQsNEX59EX530ihlHkT/e3mxv+hlM6Lec0ssctqnaXd/svWM4vAbCzrfO5XOHDoUVeU4QDI+4+kNcU3rx8y/3H94AjAL5++kZeU0j3HVoCXqhouu9gpSSebzx1Y+0vP0j3w6dOKGp1e6STkFYkSq/2xhcpEtblhZFF7b89LGVYJorsOqfvYCVkPv4aoEYVBajaXdCUsfuE7Ma1lMRAwJs4+62HWap21/edhFBRLRU8hqL4RFF14+6VvTc2eHYnumgYMUwQLhvljlvmBmszvvxGRx533+jIV17waTHijczFvIlZ4OXPbe5uXcykFoD/vpi1uyMtM+wAAAAASUVORK5CYII"},{name:"R_gallery_train_blackhole_png",data:"iVBORw0KGgoAAAANSUhEUgAAAFgAAAAmCAYAAABAvVyFAAAAAXNSR0IArs4c6QAAApRJREFUaIHtmrFOwzAQhn8QEhkZyoQ6VpkimFjKxhMw9C2QeIDOPABS3yIDT8AGe1EnxIiYyMBYJhiqU+yL7dhpnJyQvwWlbZrw5Xy+s3uQ55e/SETjcOwb+O8kwZFJgiOTBEcmCY7M0dg34OLubAoAWEy2xvfLKgMAPHx+DHZPoRxILNPuzqYNqbcb4GZ6jMePHwDAqtDPKatMpGhxgp/PT7Xjp++dVC6UhF+f/GivX71+xb7FIEQJVuXebnZ/uViO6QFIkixGMJerCiurDPdvG+3zy7zQ0gg/R4pkEYJtclWxy1wPZfV1Ei1R8qiC+WSmCrp4eQdQC6RjYj2faQ9gPZ81vgMYf/IbRbCtSuBy1/NZQyxH/YxNMjCe6MEEm6QST991NRAil/CVTAwpO5pgl1CCl1o05Jd50ZjU2qBzeE42lXKcmML3EkydFmDvtkzYSrAu0UuYorjtei6oSwT26xSDWuVmVPpLBbr9o31A1/ONaEAPmMWkrnJCo90rgnl31QVXTiTKKjNWDL5QZeGTmvp4yD5loDOCffKoL6uijmA65iwmW21ohuKS23btLjyfn7ZG9GARzKHhSvBha+rebPCujr5fJUZa8ongoEmuz4jmuCLMFtUuqbHyfJQc7KJtzbYLoZNhjMmzr7XmQRsNwvdh8GFO68GUWmxrwzb6Kr1CELHYo8onQkeEKY1IWIAXsWXEV8PKKgsu1WiiU0uwh8++7zQcEZueFH2rYrcusZhsG92Yi/V81pC7T7nXJyJSBFCXgqYdCp8Fd3XBCJCxFgwIEgy4dzVc8BZYilxAmGAgbF/O9L4kuYBAwUCzoaG0Adi37sfeubAhUjCRfniSaEVEmfafSYIjkwRHJgmOTBIcmT8mAoS+Ps819gAAAABJRU5ErkJggg"},{name:"R_gallery_train_virgo_png",data:"iVBORw0KGgoAAAANSUhEUgAAAHIAAABACAYAAADGbyPbAAAAAXNSR0IArs4c6QAABPJJREFUeJztnWtu3DAMhJWiJ8gFA+RgBvaCe4X0R+HCUUjODPWw1jUBYxvLlih+HErZ3bhvpZSvctvL26+zHbitj90gL2I3yIvYDfIi9vtsB2ba9ny4bZ/vHxM96W9v5T/dtUZQLVsd9MuBrAH0CvCx38/3j7I9Hz9ee4/Z05YHqSqnlO+BroGoY74K1CVBWvBaAtaiYg9aJkFG2lIgW8tmJqj7mMx9kVK9PmaBXgJkz3UPBdUbJwOUgTlTsV9nHtvz8e9ouca7Z/+398qMq/hlXa/4nT1OVWSmJGU3P9aGZe8fqRFtbmpfLd9nKHOK6qxz9XlPMXXmo1dvLK8fz1/LP0+ldb/R/AYdY6BFwYrOWQFn4GXhsvNA5y2Y3rxGgBxSWqOteXROKXEZi0p1VDK90unNZe8vU8ZbbEiGsJmnbnbYchiVZ2VDwipTKauDVHkORCawailSyi2zbqtraX2v9/PLgESTZzcNTBK0wGXUyfjCJMvgjU4epOoYysioHLEBYTM+KntMX5HaonsVtU8DqQCOQCBVREGxkgOVTxYYkzzIx6ifAWptB8U6xCgOBSgCxK5pKkwWaka9p4BsGbAXRNQ/ClJmPMUHBJNZl5Oxboc4Q4lecKxNS1Ru0bjK+snGwlsGvPuS62cbyFEQETwPJguRXVuVdU8BqfbbBWRWjSrEaFJRwC2wFuhsMkX+qSAjZTaW1zlqbIFo9RFBi671rmd9sJKLjeFIRVLfa828L7hV7y9671myY2/Pn9+X2duP/R6v2YyPn6w+GD8YY/rZqvdiPUPttXX9grI1MILY8rmd8sUopl019eshx3vQPJU4lNIA0gKDFKMG66iselLow2JPeXV7dL3nj9eGPtWp/Y8sUwWlWlyCGm6tg965lrXR6tdaC70j8jnakGQ3Q/W42T0HOPqAjCZsXctMHt2LkiTa6DCv6Byb0NF8OsIdq0jrmkgZKIAqDCaplERh46KoVx0jDVKdCKsYbwykbrYcZl4ZXyN4TKWKkrUh9v0UyTqvqBkpsm5DkBB8NYAKRKU8ixA5kCMUyWYumwgMTORfpJDIZxViElQ7yGhwtkyiiaEgRkkQJYkCUwn4DIjdFYmCYgUzgsOsDSgwkYKjdg98puq0QlxCkYyCEExmbWAUHZXClmCxJVaB6LV1gJqH6DnRuuYwfbCqQ36wgVagqxCng8xAQSC865jJoj69NmvczLy9MVHZHwBRB8lmGVtemVcEjoVgwWRKZVTeWYgoGZYAqcBkYSvZywBVlI+u9xIA+T4QYn+QyjrntaFyFJ1jxmCVb8FDc1dKZ0eI/UBGAUbOZ9ZYr2927WUVFwVbSR4036VAtsBkzrPqRMmglNloXVXLORqr5Rj6Z3XROesa1Gcp3z8AzjwDwPNjEz/0Vh71gr7y0sOG/en5CJj7Pbuxf5re80/YszYSYimDn+rBZGPLxBQVZkx9wgdqHwWxlAmPZ2Fh7hZNODq/34t88az383nq9pEQSznhOTsKzOPP9XU9H06EynWmr2gOo6zr7ok5vF1otDtV+8/04f0qoozZw//MsdSTr7wHJ+xtLX175pV9Vt3s5mq0LQFyN1Q2j9YzWJkdJbsuz7KlQO7GKLHX+pNV4CoAd1sS5NFG/aJ+NVseJLKev1K8sr08yNv+2v3fRVzEbpAXsRvkRewGeRG7QV7E/gDImb5uz7STkwAAAABJRU5ErkJggg"},{name:"R_gallery_train_lavander_png",data:"iVBORw0KGgoAAAANSUhEUgAAABYAAAAZCAYAAAA14t7uAAAAAXNSR0IArs4c6QAAAOtJREFUSIntlDEKwkAQRb+yh0ghqTxCqghpFnIAra1zCUvF0jp3EA+wsE3ArXKEYJEqjTcIaBE3qEXylxhI4S+X4c3nz+zMTrftAyNoPgZ0OuAqSlBFye/BABDEPhb7Q2+dcIGaWgNKAgC8XXct7dhGYGrdNOgR7djCQiFfL0VnPeW4ipI3ICdnx6bWWJtutwDp2MtShEI6uaajCGIfQJMxs270VuSqbOPIVTkcfAmXHxthag0vS4eDv8UMjgKvTYFQSASxT30MGmyVq5IeHA32shTX47ltwMjpCDFDs5rGof+DAQCb1X0csKueW7FJLYBpa0AAAAAASUVORK5CYII"},{name:"R_gallery_train_aerial_screw_png",data:"iVBORw0KGgoAAAANSUhEUgAAAEYAAAA2CAYAAAB6DO9FAAAAAXNSR0IArs4c6QAABRRJREFUaIHtm09rG0cYxh9rZUuGCoJLA5KwsYVzCjQn4UDjmjr2IQkp0VU2PYQS40Ohn0CUfgmjEEJoHEFPLTGWDpFVkIiJySkGnSx2g8QqIBJdHGo7rJwe1rPalVb7Z2Ykrd08YLzrnZl957fvzLzv7HrkxtNfP+OLuuQbtgFelWfApKUG0lJj2GZo8gQYAkSWFKw+8wYcT4CRJWXYJnTJE2C8KE+CyQrNYZsA/7ANMFOtoiA728RYNILA9CRO3tYAAEvV44HZ4EkwRIHpScPv0nT72snbWl9BeQ5M8ifVpNB3c5blAtOTfQXlKTDXl4Pa8HErAooXoKGDyU8FEfhtgVt7j8vXgNAeczsDBZOfClJ5gxtlQntIHs4hwwinL2DyU0EA6DsEos7hwwMOM5jS91dYmwAAbGxP4P7VN9q5k3nCqvOscKjBlH4IAi2jR2xsT2D9ThOHL9vGZP6wD/djYQWIJ1B8IkJ850csrCC7HMTt1gSteeq9GeBQg5n/5xirz15q56c/3oXv+RY2cBe+5+y5z6sXx8gud0fAY9GIq1WHFg7TUNpcuQxA59Irl5E8bP/dqVKFuuOyn+Q6ssLZ/dFOH6yA0cBhzpV4rACVeAIL77cAnA0rqDGNnVYv5bRjFVgTWaGpTf56EThOxeQxPKDoFZ1RzZmcpTeLRMxmUbEbz6G2wOwGLKBoYYxFIwCsQwNj+tAEtu3tpLKGFkCv7YTNjnPSWb14xkTrd+zhuAZjB8XpXgrp/OPyNdVQOB//PGQHxzGY/FRQ68Q6rmh7JJ9k3YpyKWd42o6ectmpBfx1/+obZKrm10zBmOU0JHgj6twrOY+yioc0MFYJXieUi6D54oHldT/w/4FClu3k4RwQsi7rB1SXyqNmO3x4q9/ts2xaaUNpqXoMVA807zkvnkIWAYA9I9era/IlgJKYw3zxwBBe93ui1Xey+EQEAPy+2F7leEfaVuq5XJPweamqM6RqPWER2XUgLTXUt4/xBOaLB0gV6ojO+CFLCsR3fjUJXYwgVagjVagb4LDIDVjLJNJt4nWRZJtd08CxqkO8xYkXkDKpQp15GA1824FFXvZIR2B4dcCNtxCRsrOv/6K+L423OfYYt3C84g20Q9DVUGLpLI23EFXiCa2NQcmTn4Hw0kBfn7jZHiRlF95vobQLbK5E2jHMmSrx7nqdm+OVuLrtWdoF0mhgbcbdZjuNqHbw7ODoO6/v+L1HHyDHnL9a2RcD6oGYRQ4CvhpvATCCi874TUGxLu/UQ8lsviGRqt4jiLd8PBK62tgXA/j3z6w2hxDlyqPIlUe7ysfCCkq77U1zAMjtCLj36IOrVzBOxG2OcWLYt7ET7IsB7cdO8tEp5KNTrW6nSBvkGrGBR07FBIZ4TS8oZF4g3uIEhqH+uA/RcZ+hrpnX6MXLc5g9JhPa6xoKZjJ74mb6eCQYgLhttxJPcMnAuQylXlGpLCmIhRXNeCs4uR3B0qP0dWNhBbKkmLbHEiHrxeX7mOvLQbx64WynTN8Zu6Hl1Mv0ypVHgUXX1brE7cMhN3CISMcroIPQKbOVjFZcwNxuTSArNLUX8bWKMrDP4I1ed4rXv3zDpd0Rnv+vlJYaPd9B1yptUG6h7YsB3LrZQm5HwIO1ETxMt03Wn//989cUVpuLKxgiK0Bu9DD9GQ/WRgzHBAI5vnWz1ZcUoS9gOtWZFdtB0wMBjN42iDwJGBCY86gLve3Aoi9geug/TmqAnT6QyoAAAAAASUVORK5CYII"},{name:"R_gallery_train_wolf_png",data:"iVBORw0KGgoAAAANSUhEUgAAADoAAABNCAYAAAD3nHdRAAAAAXNSR0IArs4c6QAABCZJREFUeJztW71qG0EQHkcpgsAYF0EI1BmEevkB3Klza/IMh5sUqpIXCDiN0TMIpVSnzn1QLwTuBEKlEag7kiLMMR7vz8ze3t7J0dfc797Ot7M7OzO7d9b+1PkD/wE+1C1AKpyIvjeciNqQ5TuYd/eQ5bsq5KlMBjXRUa8Nt9tzGPXa2qLRECKDmuhic4B5dw+LzUFbtFacneZRD+oYq1jnvLtXlxUT5RXUMVaxToSmsVUapZXUhXl3X8ihaWzxGEVthpDN8h2Mem1YbA4waXWK69Dv2b7rglejtLvahPKNGd7yti7Iv4PX+Jxj0urA7fbcSxJA0XUlLY/CSIyFqQuavmV7rq0ziQuIQtKjiRjeo+f4foilpRARlVaCAmnHHSeOTgmt3+agSB2YqA5DCMlUEBEtY3GrhMZ6i6wudq2y4yQ2XEaK42PFslSKxeYA857s3aPuugiJbRBptKkEAYhFbpUYo9QzodcupM48RPWMNBFK6syD1ECKrW7TLC6FJFTzEuXumw3U8U4dkEtCNSdRTs5GFknxRqkzU8gRxakf9dowaXVgOx3D5fUAAP6FUGXG63Y6hu107H1P2uOCfV3qfiEurwfw+eEnXCyX8Pvr91fPJMExYjsdw8twCBfLJXS//AgR7w2cRKW+JJ2wUchB/y7YyV+tZwAAMOjfqcva4CRKLa5LYByLk1aneJfeSwGfjOLpxQUkw6P9VCQliJ7ArismLaXRJjsJHL4MgyoL2GSUTndq3b86Fp8kmcDTQjCA3OuoG5JMoDjD0HSyPoiNURONkm2pwoRoYVod0GQBj9oY8Yy+C0e5tB9iM9QabdJY1ciiItokw6TVatDSfhMMk9Zjq8QYSVIgZcqHNLiaKF2spUeO1XoG2+m4yBZk+c6ZLOPvcyRZCNaC53lQ+G+/HopzJEaf28rHsA3BRCX+JRV40urAy3AIj1c3sFrPYNC/g5fh0Po+RQzbEEyU7wjhrf14dVOc+5Jc+DzLd6/OYybCo3Zdn2BIgh9N4Ft2ylr6aJ6RNGMohWazlATRNYpjlmrW1/1M04lms5QE0YjiPgcUDJcoAADun58gy3ewWs/eHAGgMEpl518Xjjp60SBJ9JLlu0LDOMXcPz9FXVvxIemuFCSVAZl+yBjEBqkCybsuJZNyySIaUZObRv1bPHetmVZJPApROnfS1W5Oil7bFqa4RxQrBq5Mo77NyDZUtVc/6jzqAk9k0X0PtEfwYCHWfzZJpxfTvVTJ8SRW12VkUqVljjLdGYKoGqV/O1BH3nbPVM73rVBEI0qNi2lD1WJzMFpSXg6v0frGimCiEcVNVQi+oQqfce2YyiFC/0MzIakLaNOqDabfRkIRjehic3gTbPO5z6RVU7kqEI0odelc+4y418PL4TU6CrGM0Wl6eW84EX1v+AvBMuYZa5vAVwAAAABJRU5ErkJggg"},{name:"R_gallery_train_desertRainFrog_png",data:"iVBORw0KGgoAAAANSUhEUgAAABkAAAAVCAYAAACzK0UYAAAAAXNSR0IArs4c6QAAAgBJREFUSIm1lTFoE1EYx3+JhmQ5l+rWIpUsQomBDh64dLnJ5cYOgXTKgWYQRMjeRTgcBClctkIpji5ONwvnUKhHwEVSSrs0NUu7XAmmDsl7ee/ea6JiPzju47uX7/f/f+/epbC19eqaW47ibQMA7v7pwrWjobXeW136d0i+aSsoyDyJM1yvAkA3Gi6EFfJ7Ipq3ggJJnAHgehUtt0U3uia9GFN88mC+k7WjoVSsqrWF+jyJM1pBhSQesXd4boCMjd/YPmNj+8zIVRfClc1doz5i/O1c6ynHpbr428i72jssaW6sG+/4gbXZ5afIaJoHTeqZNjYN4vgBzWc7EO7I2u6XFwbc82dQxw9wieY61Z2cfGb348NJvvJcc+D4gbznoWotfvnegMiN760u0dw81oDiso1PjC4v0utU8TpVO0T++OB0purtDw3orC9Pcpv6aT3fA3KHUbx6H97cmTRaX5YL37VOAHjdXTEdKKK8TpXm5vH8t6tRH9EOmcJmimqPrkj7ZS4PTkniTI5EhbtexXBhhQDU7hXZHwxoh/clOO2XSS/GUwEl3GkzFd4OfwEYJ96ApP0y+4MBtaePAbTT28t+yno7FPUSjfoV3aisPVfD2Pg8QLhQ66raRn1kG4YWxldYDeHiJoUA6dfvMr9pzdw/LaG2hvn5XtRY67NwxX+I37Uw8iYQrgwVAAAAAElFTkSuQmCC"},{name:"R_gallery_train_bill_cipher_gif",data:"R0lGODdhKwArAHcAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQECgAAACwAAAAAKwArAIMAAAB1BQAHfSK8IQrNVTIon09OxYDxr43i4sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEvBDISau9OOvNu/9gKI5kaZ7AgI7qChJuLM90HdRbi1+qvk+BGyHgc+laN8lhUJwNghMCoRmTFgmH31MCAxBXhsuXgBggYMFmuGMwCC5dRFkuIRYF7Q7+TQl0yWZdT0wTex94bgB4WRRdEwNTA4h8IIgGfhtDUokmhIVhnEpSKJA6lm2UQysHjBKGho8rWx5fJnZMUktMQbdSqjFrFcE1wxPFMwIFFQWUOMoUzz/MhdE/lM0/2drb3N3e3yERACH5BAUKAAAALAoABQAVABkAggAAAAAAAHUFALwhCs1VMk7FgPGvjQAAAANuCLo6/BCaSGGoGNzMu8/C9xCiYhgBCThdCBAhyw1X4KiPu+grgVe2jYaWsfEAAhlFQBAqLoJjA4CKOB8DJUTbcFwZhRtjAMtMmgtCFZMqFHbSCGwTEHytskF8OYn5slk+BoCEcwGHhwWIi4qLAQkAIfkEBQoAAAAsBQAGAB8AFwCDAAAAAAAAdQUAB30ivCEKzVUyTsWA8a+N4uLAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIsQyElpqDjrzbv/YPgRIkiWHVEc0olWxWsCqrwFl5gDQksJO5MLELO1CKcisWSg1CYFBAGhHEqaAINhQCmeEBPwEjPQBspcyaEgSEIlhUIQfTlruWUXTp4LFLYAZVs7OIIGPRVBNAJag4oAOHsUZVlpEkCRIpRNgJchVoFnRhY4kKVdICxOKnFrE6ARACH5BAUKAAAALAsABQAUACAAggAAAAAAAHUFAAd9IrwhCs1VMiifT/GvjQNUCLog/DDKSauV5MKQNStKZwUA6AEc0JEnylYmJbJxyxwRaYpfVOAH3uK3eWGMrgrBYRMqahqcRQjF2IbXw69QEHFVGeJ1TC6bNwvkxPBgXwYLeCQBACH5BAUKAAAALAoABQAVAB0AggAAAAAAAHUFAAd9IrwhCs1VMk7FgPGvjQNyCLoa/BCSSGW9gEwcSeFQ8YFP4AAC2aTASQaE+y4yJ0wEC8pFTeW63ObhcYweB0/EBBDpFKzn4xYpSBk+Ro9C/V0Bg2ElPD1SrBoaSTTsYqyZlhizgQlM+Lw+kOIXNBoif0CAbDkqiIkGNQEGHAMRkA8JADs"}],qn.count=0,Tn.add(Os.updateCursor,-1),yA.__toStr={}.toString,d.maxHeight=80,d.xOffset=100,d.xSpacing=5,d.railY=(d.middleY=52)-Math.floor(d.maxHeight/2)-4-3,d.trackY=d.middleY+Math.floor(d.maxHeight/2)+2+2,C.LN2=Math.log(2),k.V1=3,k.V2=2,k.V25=0,k.Reserved=1,k.V1_Bitrates=[[I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad],[I.BR_Free,I.BR_32,I.BR_40,I.BR_48,I.BR_56,I.BR_64,I.BR_80,I.BR_96,I.BR_112,I.BR_128,I.BR_160,I.BR_192,I.BR_224,I.BR_256,I.BR_320,I.BR_Bad],[I.BR_Free,I.BR_32,I.BR_48,I.BR_56,I.BR_64,I.BR_80,I.BR_96,I.BR_112,I.BR_128,I.BR_160,I.BR_192,I.BR_224,I.BR_256,I.BR_320,I.BR_384,I.BR_Bad],[I.BR_Free,I.BR_32,I.BR_64,I.BR_96,I.BR_128,I.BR_160,I.BR_192,I.BR_224,I.BR_256,I.BR_288,I.BR_320,I.BR_352,I.BR_384,I.BR_416,I.BR_448,I.BR_Bad]],k.V2_Bitrates=[[I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad,I.BR_Bad],[I.BR_Free,I.BR_8,I.BR_16,I.BR_24,I.BR_32,I.BR_40,I.BR_48,I.BR_56,I.BR_64,I.BR_80,I.BR_96,I.BR_112,I.BR_128,I.BR_144,I.BR_160,I.BR_Bad],[I.BR_Free,I.BR_8,I.BR_16,I.BR_24,I.BR_32,I.BR_40,I.BR_48,I.BR_56,I.BR_64,I.BR_80,I.BR_96,I.BR_112,I.BR_128,I.BR_144,I.BR_160,I.BR_Bad],[I.BR_Free,I.BR_32,I.BR_48,I.BR_56,I.BR_64,I.BR_80,I.BR_96,I.BR_112,I.BR_128,I.BR_144,I.BR_160,I.BR_176,I.BR_192,I.BR_224,I.BR_256,I.BR_Bad]],k.SamplingRates=[[S.SR_11025,S.SR_12000,S.SR_8000,S.SR_Bad],[S.SR_Bad,S.SR_Bad,S.SR_Bad,S.SR_Bad],[S.SR_22050,S.SR_24000,S.SR_12000,S.SR_Bad],[S.SR_44100,S.SR_48000,S.SR_32000,S.SR_Bad]],E.LReserved=0,E.LLayer3=1,E.LLayer2=2,E.LLayer1=3,F.CStereo=0,F.CJointStereo=1,F.CDualChannel=2,F.CMono=3,T.ENone=0,T.EMs50_15=1,T.EReserved=2,T.ECCIT_J17=3,ht.BUFFERING=!1,Bt.tmp=new Bt,Rt.GUID=0,Ut.SOFTWARE_DRIVER=!1,Ut.ANTIALIASING=0,Gt.tmp=new Gt,Gt.lumR=.212671,Gt.lumG=.71516,Gt.lumB=.072169,Gt.SQ13=.5773502691896257,jt.EPSILON=1e-6,le.TMP_RAY=new oe,le.TMP_MAT=new Gt,ye.UID=0,ye.CACHE=new Kn,Ce.UID=0,Ce.ALLOW_WEBGL2=!0,Ce.BLACK=new Yt(0,0,0,0),Ce.outOfMemoryCheck=!1,Ce.STREAM_POS=1,Ce.TFILTERS=[[[9728,9728],[9729,9729]],[[9728,9984],[9729,9985]],[[9728,9986],[9729,9987]]],Ce.TWRAP=[33071,10497],Ce.FACES=[0,1028,1029,1032],Ce.BLEND=[1,0,770,768,772,774,771,769,773,775,32769,32771,32770,32772,776],Ce.COMPARE=[519,512,514,517,516,518,513,515],Ce.STENCIL_OP=[7680,0,7681,7682,34055,7683,34056,5386],Ce.OP=[32774,32778,32779,32775,32776],Ce.CUBE_FACES=[34069,34070,34071,34072,34073,34074],Ce.CBUFFERS=function(t){for(var e=[],i=0;i<32;){for(var n=[],s=0,r=i++;s<r;){var a=s++;n.push(36064+a)}e.push(n)}return e}(),Ee.MAX_MEMORY=4294967296,Ee.MAX_BUFFERS=65536,Ee.SIZE=65533,Ee.ALL_FLAGS=zt.__empty_constructs__.slice(),Xe.defaultKillAlphaThreshold=.5,Xe.loadingTextureColor=-65281,Je.current=new Je("Default"),qe.enableLights_bits=1,qe.enableLights_offset=0,qe.enableLights_mask=1,qe.dynamicParameters_bits=1,qe.dynamicParameters_offset=1,qe.dynamicParameters_mask=2,qe.isStatic_bits=1,qe.isStatic_offset=2,qe.isStatic_mask=4,qe.batchMode_bits=1,qe.batchMode_offset=3,qe.batchMode_mask=8,qe.culling_bits=2,qe.culling_offset=0,qe.culling_mask=3,qe.depthWrite_bits=1,qe.depthWrite_offset=2,qe.depthWrite_mask=4,qe.depthTest_bits=3,qe.depthTest_offset=3,qe.depthTest_mask=56,qe.blendSrc_bits=4,qe.blendSrc_offset=6,qe.blendSrc_mask=960,qe.blendDst_bits=4,qe.blendDst_offset=10,qe.blendDst_mask=15360,qe.blendAlphaSrc_bits=4,qe.blendAlphaSrc_offset=14,qe.blendAlphaSrc_mask=245760,qe.blendAlphaDst_bits=4,qe.blendAlphaDst_offset=18,qe.blendAlphaDst_mask=3932160,qe.blendOp_bits=3,qe.blendOp_offset=22,qe.blendOp_mask=29360128,qe.blendAlphaOp_bits=3,qe.blendAlphaOp_offset=25,qe.blendAlphaOp_mask=234881024,qe.wireframe_bits=1,qe.wireframe_offset=28,qe.wireframe_mask=268435456,qe.reserved_bits=1,qe.reserved_offset=29,qe.reserved_mask=536870912,Ke.readMask_bits=8,Ke.readMask_offset=0,Ke.readMask_mask=255,Ke.writeMask_bits=8,Ke.writeMask_offset=8,Ke.writeMask_mask=65280,Ke.reference_bits=8,Ke.reference_offset=16,Ke.reference_mask=16711680,Ke.frontTest_bits=3,Ke.frontTest_offset=0,Ke.frontTest_mask=7,Ke.frontPass_bits=3,Ke.frontPass_offset=3,Ke.frontPass_mask=56,Ke.frontSTfail_bits=3,Ke.frontSTfail_offset=6,Ke.frontSTfail_mask=448,Ke.frontDPfail_bits=3,Ke.frontDPfail_offset=9,Ke.frontDPfail_mask=3584,Ke.backTest_bits=3,Ke.backTest_offset=12,Ke.backTest_mask=28672,Ke.backPass_bits=3,Ke.backPass_offset=15,Ke.backPass_mask=229376,Ke.backSTfail_bits=3,Ke.backSTfail_offset=18,Ke.backSTfail_mask=1835008,Ke.backDPfail_bits=3,Ke.backDPfail_offset=21,Ke.backDPfail_mask=14680064,ti.UID=0,ti.PREVENT_AUTO_DISPOSE=2147483647,ti.nativeFormat=$e.RGBA,ti.checkerTextureKeys=new Wn,ti.noiseTextureKeys=new Wn,ti.genTextureKeys=new Kn,si.__meta__={obj:{ignore:["shader"]}},ai.SRC="HXSLF2gzZC5zaGFkZXIuU2NyZWVuU2hhZGVyBwEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACghfX2luaXRfXw4GAAALBnZlcnRleA4GAAACAgoAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAALAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAA",Ai.SRC="HXSLHWgzZC5wYXNzLl9Cb3JkZXIuQm9yZGVyU2hhZGVyCQEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACgVjb2xvcgUMAgAACwhfX2luaXRfXw4GAAAMBnZlcnRleA4GAAANCGZyYWdtZW50DgYAAAMCCwAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAAwAAAUBBgQCBgUMCQMqDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAAQ0AAAUBBgQCCAUMAgoFDAUMAA",oi.SRC="HXSLHmgzZC5wYXNzLl9Db3B5LkFycmF5Q29weVNoYWRlcgoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoHdGV4dHVyZQsCAAALBWxheWVyAQIAAAwIX19pbml0X18OBgAADQZ2ZXJ0ZXgOBgAADghmcmFnbWVudA4GAAADAgwAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAANAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEOAAAFAQYEAggFDAkDIQ4CAgoLCQMpDgICCQUKCQMmDgECCwEDBQsFDAUMAA",ui.SRC="HXSLGWgzZC5wYXNzLl9Db3B5LkNvcHlTaGFkZXIJAQVpbnB1dA0BAgIIcG9zaXRpb24FCgEBAAMCdXYFCgEBAAEAAAQFZmxpcFkDAgAABQZvdXRwdXQNAgIGCHBvc2l0aW9uBQwEBQAHBWNvbG9yBQwEBQAEAAAICnBpeGVsQ29sb3IFDAQAAAkMY2FsY3VsYXRlZFVWBQoEAAAKB3RleHR1cmUKAgAACwhfX2luaXRfXw4GAAAMBnZlcnRleA4GAAANCGZyYWdtZW50DgYAAAMCCwAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAAwAAAUBBgQCBgUMCQMqDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAAQ0AAAUBBgQCCAUMCQMhDgICCgoCCQUKBQwFDAA",ci.SRC="HXSLIWgzZC5wYXNzLl9DdWJlQ29weS5DdWJlQ29weVNoYWRlcgoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoHdGV4dHVyZQwCAAALA21hdAYCAAAMCF9faW5pdF9fDgYAAA0GdmVydGV4DgYAAA4IZnJhZ21lbnQOBgAAAwIMAAAFAgYEAgcFDAIIBQwFDAYEAgkFCgIDBQoFCgAADQAABQEGBAIGBQwJAyoOBAoCAgUKAAADBgEKAgIFCgQAAwIEAwMBAwAAAAAAAAAAAwEDAAAAAAAA8D8DBQwFDAABDgAABQIIDwJ1dgUKBAAABgMGAQIJBQoBAwAAAAAAAABAAwUKAQMAAAAAAADwPwMFCgAGBAIIBQwJAyEOAgIKDAkDHw4BBgEJAykOAgIPBQoBAwAAAAAAAPA/AwULAgsGBQsFCwUMBQwA",fi.__meta__={fields:{cameraView:{global:["camera.view"]},cameraNear:{global:["camera.zNear"]},cameraFar:{global:["camera.zFar"]},cameraProj:{global:["camera.proj"]},cameraPos:{global:["camera.position"]},cameraProjDiag:{global:["camera.projDiag"]},cameraProjFlip:{global:["camera.projFlip"]},cameraViewProj:{global:["camera.viewProj"]},cameraInverseViewProj:{global:["camera.inverseViewProj"]},globalTime:{global:["global.time"]},pixelSize:{global:["global.pixelSize"]},globalModelView:{global:["global.modelView"]},globalModelViewInverse:{global:["global.modelViewInverse"]}}},mi.SRC="HXSLIWgzZC5wYXNzLl9IYXJkd2FyZVBpY2suRml4ZWRDb2xvcgUBB2NvbG9ySUQFDAIAAAIIdmlld3BvcnQFDAIAAAMGb3V0cHV0DQECBAhwb3NpdGlvbgUMBAMABQdjb2xvcklEBQwEAwAEAAAGBnZlcnRleA4GAAAHCGZyYWdtZW50DgYAAAIABgAABQEGBAIEBQwGAQQGAAIEBQwGAQkDKg4DCgICBQwRAAUKAQMAAAAAAAAAAAMBAwAAAAAAAAAAAwUMCgIEBQwMAAMFDAUMBQwJAyoOAwoCAgUMOQAFCgEDAAAAAAAA8D8DAQMAAAAAAADwPwMFDAUMBQwAAQcAAAUBBgQCBQUMAgEFDAUMAA",Mi.STRICT=!0,Ri.ROT2RAD=-.017453292519943295,Ri.tmpMat=new Gt,Ri.tmpVec=new Yt,Ni.FPosChanged=1,Ni.FVisible=2,Ni.FCulled=4,Ni.FFollowPositionOnly=8,Ni.FLightCameraCenter=16,Ni.FAllocated=32,Ni.FAlwaysSync=64,Ni.FInheritCulled=128,Ni.FNoSerialize=256,Ni.FIgnoreBounds=512,Ni.FIgnoreCollide=1024,Ni.FIgnoreParentTransform=2048,Ni.FCullingColliderInherited=4096,qi.TMP_MAT=new Gt,nn.SRC="HXSLF2gzZC5zaGFkZXIuQW1iaWVudExpZ2h0CgEGZ2xvYmFsDQECAgxhbWJpZW50TGlnaHQFCwABAAMQcGVyUGl4ZWxMaWdodGluZwIAAQEAAAAAAAAAAAQKcGl4ZWxDb2xvcgUMBAAABQ9saWdodFBpeGVsQ29sb3IFCwQAAAYKbGlnaHRDb2xvcgULBAAABwhhZGRpdGl2ZQICAAEAAAAAAAgIX19pbml0X18OBgAACRBfX2luaXRfX2ZyYWdtZW50DgYAAAoJY2FsY0xpZ2h0DgYAAAsGdmVydGV4DgYAAAwIZnJhZ21lbnQOBgAABQIIAAAFAQYEAgYFCwsCBwICAgULCQMpDgEBAwAAAAAAAAAAAwULBQsFCwACCQAABQEGBAIFBQsLAgcCAgIFCwkDKQ4BAQMAAAAAAAAAAAMFCwULBQsAAwoBDQpsaWdodENvbG9yBQsEAAAFCwUBDQsCBwICDQULBAYAAgIFCwYBCQMWDgIEBgMBAwAAAAAAAPA/AwICBQsFCwULAQMAAAAAAAAAAAMFCwINBQsFCwULBQsFCwAAAAsAAAUBCwcCAgMCAgaBCgIEBQySAAULCQIKDgECBgULBQsFCwAAAAEMAAAFAQsCAwIGgQoCBAUMkgAFCwkCCg4BAgUFCwULBQsAAAA",sn.SRC="HXSLEWgzZC5zaGFkZXIuQmFzZTJkGwEFaW5wdXQNAQMCCHBvc2l0aW9uBQoBAQADAnV2BQoBAQAEBWNvbG9yBQwBAQABAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgEdGltZQMAAAAJBnpWYWx1ZQMCAAAKB3RleHR1cmUKAgAACw5zcHJpdGVQb3NpdGlvbgUMBAAADBBhYnNvbHV0ZVBvc2l0aW9uBQwEAAANCnBpeGVsQ29sb3IFDAQAAA4MdGV4dHVyZUNvbG9yBQwEAAAPDGNhbGN1bGF0ZWRVVgUKAwAAEAppc1JlbGF0aXZlAgIAAQAAAAAAEQVjb2xvcgUMAgAAEg9hYnNvbHV0ZU1hdHJpeEEFCwIAABMPYWJzb2x1dGVNYXRyaXhCBQsCAAAUDWZpbHRlck1hdHJpeEEFCwIAABUNZmlsdGVyTWF0cml4QgULAgAAFghoYXNVVlBvcwICAAEAAAAAABcFdXZQb3MFDAIAABgJa2lsbEFscGhhAgIAAQAAAAAAGQpwaXhlbEFsaWduAgIAAQAAAAAAGhBoYWxmUGl4ZWxJbnZlcnNlBQoCAAAbCXZpZXdwb3J0QQULAgAAHAl2aWV3cG9ydEIFCwIAAB0Ob3V0cHV0UG9zaXRpb24FDAQAAB4IX19pbml0X18OBgAAHwZ2ZXJ0ZXgOBgAAIAhmcmFnbWVudA4GAAADAh4AAAUGBgQCCwUMCQMqDgMCAgUKAgkDAQMAAAAAAADwPwMFDAUMCwIQAgUDBgQKAgwFDAAAAwkDHQ4CCQMpDgIKAgsFDBEABQoBAwAAAAAAAPA/AwULAhIFCwMDBgQKAgwFDAQAAwkDHQ4CCQMpDgIKAgsFDBEABQoBAwAAAAAAAPA/AwULAhMFCwMDBgQKAgwFDDkABQoKAgsFDDkABQoFCgAGBAIMBQwCCwUMBQwABgQCDwUKCwIWAgYABgECAwUKCgIXBQw5AAUKBQoKAhcFDBEABQoFCgIDBQoFCgUKBgQCDQUMCwIQAgYBAhEFDAIEBQwFDAIEBQwFDAUMBgQCDgUMCQMhDgICCgoCDwUKBQwFDAaBAg0FDAIOBQwFDAAAHwAABQUIIQN0bXAFCwQAAAkDKQ4CCgIMBQwRAAUKAQMAAAAAAADwPwMFCwAGBAIhBQsJAykOAwkDHQ4CAiEFCwIUBQsDCQMdDgICIQULAhUFCwMBAwAAAAAAAPA/AwULBQsGBAIdBQwJAyoOAwkDHQ4CAiEFCwIbBQsDCQMdDgICIQULAhwFCwMKAgwFDDkABQoFDAUMCwIZAgaDCgIdBQwRAAUKAhoFCgUKAAAGBAIGBQwCHQUMBQwAASAAAAUCCwYOAhgCBgkKAg0FDAwAAwED/Knx0k1iUD8DAgIMAAAABgQCBwUMAg0FDAUMAA",rn.SRC="HXSLE2gzZC5zaGFkZXIuQmFzZU1lc2gXAQZjYW1lcmENAQoCBHZpZXcHAAEAAwRwcm9qBwABAAQIcG9zaXRpb24FCwABAAUIcHJvakZsaXADAAEABghwcm9qRGlhZwULAAEABwh2aWV3UHJvagcAAQAID2ludmVyc2VWaWV3UHJvagcAAQAJBXpOZWFyAwABAAoEekZhcgMAAQALA2RpcgULAwEAAAAADAZnbG9iYWwNAgQNBHRpbWUDAAwADglwaXhlbFNpemUFCgAMAA8JbW9kZWxWaWV3BwAMAQMQEG1vZGVsVmlld0ludmVyc2UHAAwBAwAAABEFaW5wdXQNAwISCHBvc2l0aW9uBQsBEQATBm5vcm1hbAULAREAAQAAFAZvdXRwdXQNBAUVCHBvc2l0aW9uBQwEFAAWBWNvbG9yBQwEFAAXBWRlcHRoAwQUABgGbm9ybWFsBQsEFAAZCXdvcmxkRGlzdAMEFAAEAAAaEHJlbGF0aXZlUG9zaXRpb24FCwQAABsTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAHBhwaXhlbFRyYW5zZm9ybWVkUG9zaXRpb24FCwQAAB0RdHJhbnNmb3JtZWROb3JtYWwFCwQAAB4RcHJvamVjdGVkUG9zaXRpb24FDAQAAB8KcGl4ZWxDb2xvcgUMBAAAIAVkZXB0aAMEAAAhCHNjcmVlblVWBQoEAAAiCXNwZWNQb3dlcgMEAAAjCXNwZWNDb2xvcgULBAAAJAl3b3JsZERpc3QDBAAAJQVjb2xvcgUMAgAAJg1zcGVjdWxhclBvd2VyAwIAAQcAAAAAAAAAAAAAAAAAAFlAJw5zcGVjdWxhckFtb3VudAMCAAEHAAAAAAAAAAAAAAAAAAAkQCgNc3BlY3VsYXJDb2xvcgULAgAAKQhfX2luaXRfXw4GAAAqEF9faW5pdF9fZnJhZ21lbnQOBgAAKwZ2ZXJ0ZXgOBgAALAhmcmFnbWVudA4GAAAEAikAAAULBgQCGgULAhIFCwULBgQCGwULBgECGgULCQM0DgECDwcIBQsFCwYEAh4FDAYBCQMqDgICGwULAQMAAAAAAADwPwMFDAIHBwUMBQwGBAIdBQsJAx8OAQQGAQITBQsJAzIOAQIPBwYFCwULBQsFCwYEAgsFCwkDHw4BBAYDAgQFCwIbBQsFCwULBQsFCwYEAh8FDAIlBQwFDAYEAiIDAiYDAwYEAiMFCwYBAigFCwInAwULBQsGBAIhBQoJAzoOAQYCCgIeBQwRAAUKCgIeBQwMAAMFCgUKBQoGBAIgAwYCCgIeBQwIAAMKAh4FDAwAAwMDBgQCJAMGAgkDGw4BBgMCGwULAgQFCwULAwIKAwMDAAIqAAAFBQYEAh0FCwkDHw4BAh0FCwULBQsGBAIhBQoJAzoOAQYCCgIeBQwRAAUKCgIeBQwMAAMFCgUKBQoGBAIgAwYCCgIeBQwIAAMKAh4FDAwAAwMDBgQCIgMCJgMDBgQCIwULBgECKAULAicDBQsFCwAAKwAABQIGBAIVBQwGAQIeBQwJAyoOBAEDAAAAAAAA8D8DAgUDAQMAAAAAAADwPwMBAwAAAAAAAPA/AwUMBQwFDAYEAhwFCwIbBQsFCwABLAAABQQGBAIWBQwCHwUMBQwGBAIXAwIgAwMGBAIYBQsCHQULBQsGBAIZAwIkAwMA",an.SRC="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",on.SRC="HXSLE2gzZC5zaGFkZXIuQ29sb3JBZGQDAQpwaXhlbENvbG9yBQwEAAACBWNvbG9yBQsCAAADCGZyYWdtZW50DgYAAAEBAwAABQEGgAoCAQUMkgAFCwICBQsFCwA",ln.SRC="HXSLE2gzZC5zaGFkZXIuQ29sb3JLZXkDAQhjb2xvcktleQUMAgAAAgx0ZXh0dXJlQ29sb3IFDAQAAAMIZnJhZ21lbnQOBgAAAQEDAAAFAggEBWNkaWZmBQwEAAAGAwICBQwCAQUMBQwACwYJCQMdDgICBAUMAgQFDAMBA/Fo44i1+OQ+AwIMAAAAAA",un.SRC="HXSLFmgzZC5zaGFkZXIuQ29sb3JNYXRyaXgDAQpwaXhlbENvbG9yBQwEAAACBm1hdHJpeAcCAAADCGZyYWdtZW50DgYAAAEBAwAABQEGBAIBBQwJAyoOAgoEBgEJAyoOAgoCAQUMkgAFCwEDAAAAAAAA8D8DBQwCAgcFDAUMkgAFCwoEBgECAQUMAgIHBQwFDAwAAwUMBQwA",_n.SRC="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",cn.SRC="HXSLFWgzZC5zaGFkZXIuR2VuVGV4dHVyZQoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoEbW9kZQECAAEAAAAAAAsFY29sb3IFDAIAAAwIX19pbml0X18OBgAADQZ2ZXJ0ZXgOBgAADghmcmFnbWVudA4GAAADAgwAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAANAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEOAAAFARMEAgoBAQEBAQIAAAAAAQUBBgQCCAUMCwYHCQMbDgEKAgYFDBEABQoDAQMAAAAAAADwPwMCCQMqDgEBAwAAAAAAAAAAAwUMAgsFDAUMBQwAAAAA",dn.SRC="HXSLFWgzZC5zaGFkZXIuTGluZVNoYWRlcgwBBmNhbWVyYQ0BAwIEdmlldwcAAQADBHByb2oHAAEABAh2aWV3UHJvagcAAQAAAAAFBmdsb2JhbA0CAgYJcGl4ZWxTaXplBQoABQAHCW1vZGVsVmlldwcABQEDAAAACAVpbnB1dA0DAwkIcG9zaXRpb24FCwEIAAoGbm9ybWFsBQsBCAALAnV2BQoBCAABAAAMBm91dHB1dA0EAQ0IcG9zaXRpb24FDAQMAAQAAA4RdHJhbnNmb3JtZWROb3JtYWwFCwQAAA8TdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAEBFwcm9qZWN0ZWRQb3NpdGlvbgUMBAAAEQtsZW5ndGhTY2FsZQMCAAASBXdpZHRoAwIAABMEcGRpcgUMBAAAFAhfX2luaXRfXw4GAAAVBnZlcnRleA4GAAACAhQAAAUBBQUIFgNkaXIFCwQAAAYBAgoFCwkDMg4BAgcHBgULAAYEAhMFDAYBCQMqDgIGAQIWBQsJAzIOAQICBwYFCwEDAAAAAAAA8D8DBQwCAwcFDAUMBoEKAhMFDBEABQoGAgEDAAAAAAAA8D8DCQMNDgEGAAYBCgITBQwAAAMKAhMFDAAAAwMGAQoCEwUMBAADCgITBQwEAAMDAwMDBQoGgAIPBQsGAQYBAhYFCwoCCwUKAAADBQsCEQMFCwULBgQCDgULCQMfDgECFgULBQsFCwAAABUAAAUBBoAKAhAFDBEABQoGAQYBBgEGAQQGAQoCEwUMBQAFCgkDKA4CAQMAAAAAAADwPwMBAwAAAAAAAPC/AwUKBQoFCgQGAwoCCwUKBAADAQMAAAAAAADgPwMDAwUKCgIQBQwIAAMFCgIGBQoFCgISAwUKBQoA",fn.SRC="HXSLF2gzZC5zaGFkZXIuTWluTWF4U2hhZGVyCwEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACgR0ZXhBCgIAAAsEdGV4QgoCAAAMBWlzTWF4AgIAAQAAAAAADQhfX2luaXRfXw4GAAAOBnZlcnRleA4GAAAPCGZyYWdtZW50DgYAAAMCDQAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAA4AAAUBBgQCBgUMCQMqDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAAQ8AAAUDCBABYQUMBAAACQMhDgICCgoCCQUKBQwACBEBYgUMBAAACQMhDgICCwoCCQUKBQwABgQCCAUMCwIMAgkDFg4CAhAFDAIRBQwFDAkDFQ4CAhAFDAIRBQwFDAUMBQwA",xn.SRC="HXSLG2gzZC5zaGFkZXIuQ3ViZU1pbk1heFNoYWRlcgwBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoEdGV4QQwCAAALBHRleEIMAgAADAVpc01heAICAAEAAAAAAA0DbWF0BgIAAA4IX19pbml0X18OBgAADwZ2ZXJ0ZXgOBgAAEAhmcmFnbWVudA4GAAADAg4AAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAAPAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEQAAAFBQgRAnV2BQoEAAAGAwYBAgkFCgEDAAAAAAAAAEADBQoBAwAAAAAAAPA/AwUKAAgSA2RpcgULBAAABgEJAykOAgIRBQoBAwAAAAAAAPA/AwULAg0GBQsACBMBYQUMBAAACQMhDgICCgwCEgULBQwACBQBYgUMBAAACQMhDgICCwwCEgULBQwABgQCCAUMCwIMAgkDFg4CAhMFDAIUBQwFDAkDFQ4CAhMFDAIUBQwFDAUMBQwA",pn.SRC="HXSLFGgzZC5zaGFkZXIuTm9ybWFsTWFwCgEGY2FtZXJhDQECAghwb3NpdGlvbgULAAEAAwNkaXIFCwMBAAAAAAQGZ2xvYmFsDQIBBQltb2RlbFZpZXcHAAQBAwAAAAYFaW5wdXQNAwIHBm5vcm1hbAULAQYACAd0YW5nZW50BQsBBgABAAAJB3RleHR1cmUKAgAACgxjYWxjdWxhdGVkVVYFCgQAAAsTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAADBF0cmFuc2Zvcm1lZE5vcm1hbAULBAAADRJ0cmFuc2Zvcm1lZFRhbmdlbnQFDAMAAA4OX19pbml0X192ZXJ0ZXgOBgAADwhmcmFnbWVudA4GAAACAg4AAAUBBgQCDQUMCQMqDgIGAQIIBQsJAzIOAQIFBwYFCwsGBwkDHQ4CAggFCwIIBQsDAQMAAAAAAADgPwMCAQMAAAAAAADwPwMBAwAAAAAAAPC/AwMFDAUMAAEPAAAFBQgQAW4FCwQAAAIMBQsACBECbmYFCwQAAAkDOQ4BCQMhDgICCQoCCgUKBQwFCwAIEgR0YW5YBQsEAAAJAx8OAQoCDQUMkgAFCwULAAgTBHRhblkFCwQAAAYBCQMeDgICEAULAhIFCwULBwMKAg0FDAwAAwMFCwAGBAIMBQsJAx8OAQQGAAYABgEKAhEFCwAAAwISBQsFCwYBCgIRBQsEAAMCEwULBQsFCwYBCgIRBQsIAAMCEAULBQsFCwULBQsFCwA",gn.SRC="HXSLEWgzZC5zaGFkZXIuU2hhZG93BgEGc2hhZG93DQEFAgNtYXARAQABAAMEcHJvaggAAQAEBWNvbG9yBQsAAQAFBXBvd2VyAwABAAYEYmlhcwMAAQAAAAAHCnBpeGVsQ29sb3IFDAQAAAgTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAACRhwaXhlbFRyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAoJc2hhZG93UG9zBQsEAAEBCwhmcmFnbWVudA4GAAABAQsAAAUGCAwJc2hhZG93UG9zBQsEAAAGAQIJBQsCAwgFCwAIDQVkZXB0aAMEAAAJAz8OAgICEQEJAzoOAQoCDAULEQAFCgUKAwAIDgR6TWF4AwQAAAkDNQ4BCgIMBQsIAAMDAAgPBWRlbHRhAwQAAAYDCQMVDgIEBgACDQMCBgMDAwIOAwMCDgMDAAgQBXNoYWRlAwQAAAkDNQ4BCQMJDgEGAQIFAwIPAwMDAwAGgQoCBwUMkgAFCwYABgEEBgMBAwAAAAAAAPA/AwIQAwMDCgIEBQuSAAULBQsCEAMFCwULAA",mn.SRC="HXSLE2gzZC5zaGFkZXIuU2tpbkJhc2UFARByZWxhdGl2ZVBvc2l0aW9uBQsEAAACE3RyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAMRdHJhbnNmb3JtZWROb3JtYWwFCwQAAAQITWF4Qm9uZXMBAgABAAAAAAAFDWJvbmVzTWF0cml4ZXMPCAQCAAEIAA",vn.SRC="HXSLD2gzZC5zaGFkZXIuU2tpbggBEHJlbGF0aXZlUG9zaXRpb24FCwQAAAITdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAAxF0cmFuc2Zvcm1lZE5vcm1hbAULBAAABAhNYXhCb25lcwECAAEAAAAAAAUNYm9uZXNNYXRyaXhlcw8IBAIAAQgGBWlucHV0DQEEBwhwb3NpdGlvbgULAQYACAZub3JtYWwFCwEGAAkHd2VpZ2h0cwULAQYACgdpbmRleGVzCQQAAAABBgABAAALEnRyYW5zZm9ybWVkVGFuZ2VudAUMBAAADAZ2ZXJ0ZXgOBgAAAQAMAAAFAgYEAgIFCwYABgAGAQQGAQIBBQsRAgUPCAQJAyUOAQoCCgkEAAAAAAADAQgFCwULCgIJBQsAAAMFCwYBBAYBAgEFCxECBQ8IBAkDJQ4BCgIKCQQAAAAEAAMBCAULBQsKAgkFCwQAAwULBQsGAQQGAQIBBQsRAgUPCAQJAyUOAQoCCgkEAAAACAADAQgFCwULCgIJBQsIAAMFCwULBQsGBAIDBQsJAx8OAQYABgAGAQQGAQIIBQsJAzIOARECBQ8IBAkDJQ4BCgIKCQQAAAAAAAMBCAYFCwULCgIJBQsAAAMFCwYBBAYBAggFCwkDMg4BEQIFDwgECQMlDgEKAgoJBAAAAAQAAwEIBgULBQsKAgkFCwQAAwULBQsGAQQGAQIIBQsJAzIOARECBQ8IBAkDJQ4BCgIKCQQAAAAIAAMBCAYFCwULCgIJBQsIAAMFCwULBQsFCwA",yn.SRC="HXSLFmgzZC5zaGFkZXIuU2tpblRhbmdlbnQIARByZWxhdGl2ZVBvc2l0aW9uBQsEAAACE3RyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAMRdHJhbnNmb3JtZWROb3JtYWwFCwQAAAQITWF4Qm9uZXMBAgABAAAAAAAFDWJvbmVzTWF0cml4ZXMPCAQCAAEIBgVpbnB1dA0BBQcIcG9zaXRpb24FCwEGAAgGbm9ybWFsBQsBBgAJB3RhbmdlbnQFCwEGAAoHd2VpZ2h0cwULAQYACwdpbmRleGVzCQQAAAABBgABAAAMEnRyYW5zZm9ybWVkVGFuZ2VudAUMBAAADQZ2ZXJ0ZXgOBgAAAQANAAAFAwYEAgIFCwYABgAGAQQGAQIBBQsRAgUPCAQJAyUOAQoCCwkEAAAAAAADAQgFCwULCgIKBQsAAAMFCwYBBAYBAgEFCxECBQ8IBAkDJQ4BCgILCQQAAAAEAAMBCAULBQsKAgoFCwQAAwULBQsGAQQGAQIBBQsRAgUPCAQJAyUOAQoCCwkEAAAACAADAQgFCwULCgIKBQsIAAMFCwULBQsGBAIDBQsJAx8OAQYABgAGAQQGAQIIBQsJAzIOARECBQ8IBAkDJQ4BCgILCQQAAAAAAAMBCAYFCwULCgIKBQsAAAMFCwYBBAYBAggFCwkDMg4BEQIFDwgECQMlDgEKAgsJBAAAAAQAAwEIBgULBQsKAgoFCwQAAwULBQsGAQQGAQIIBQsJAzIOARECBQ8IBAkDJQ4BCgILCQQAAAAIAAMBCAYFCwULCgIKBQsIAAMFCwULBQsFCwYEAgwFDAkDKg4CCQMfDgEGAAYABgEEBgEKAgkFC5IABQsJAzIOARECBQ8IBAkDJQ4BCgILCQQAAAAAAAMBCAYFCwULCgIKBQsAAAMFCwYBBAYBCgIJBQuSAAULCQMyDgERAgUPCAQJAyUOAQoCCwkEAAAABAADAQgGBQsFCwoCCgULBAADBQsFCwYBBAYBCgIJBQuSAAULCQMyDgERAgUPCAQJAyUOAQoCCwkEAAAACAADAQgGBQsFCwoCCgULCAADBQsFCwULCgIMBQwMAAMFDAUMAA",bn.SRC="HXSLGmgzZC5zaGFkZXIuU3BlY3VsYXJUZXh0dXJlBAEHdGV4dHVyZQoCAAACDGNhbGN1bGF0ZWRVVgUKBAAAAwlzcGVjQ29sb3IFCwQAAAQIZnJhZ21lbnQOBgAAAQEEAAAFAQaBAgMFCwoJAyEOAgIBCgICBQoFDJIABQsFCwA",wn.SRC="HXSLEmgzZC5zaGFkZXIuVGV4dHVyZQsBBWlucHV0DQEBAgJ1dgUKAQEAAQAAAwhhZGRpdGl2ZQICAAEAAAAAAAQJa2lsbEFscGhhAgIAAQAAAAAABQ1zcGVjdWxhckFscGhhAgIAAQAAAAAABhJraWxsQWxwaGFUaHJlc2hvbGQDAgABBwAAAAAAAAAAAAAAAAAA8D8HB3RleHR1cmUKAgAACAxjYWxjdWxhdGVkVVYFCgQAAAkKcGl4ZWxDb2xvcgUMBAAACglzcGVjQ29sb3IFCwQAAAsGdmVydGV4DgYAAAwIZnJhZ21lbnQOBgAAAgALAAAFAQYEAggFCgICBQoFCgABDAAABQQIDQFjBQwEAAAJAyEOAgIHCgIIBQoFDAALBg4CBAIGCQYDCgINBQwMAAMCBgMDAQMAAAAAAAAAAAMCAgwAAAALAgMCBoACCQUMAg0FDAUMBoECCQUMAg0FDAUMAAsCBQIGgQIKBQsKAg0FDP4ABQsFCwAAAA",Mn.SRC="HXSLEmgzZC5zaGFkZXIuVVZEZWx0YQQBB3V2RGVsdGEFCgIAAAIHdXZTY2FsZQUKAgAAAwxjYWxjdWxhdGVkVVYFCgQAAAQGdmVydGV4DgYAAAEABAAABQEGBAIDBQoGAAYBAgMFCgICBQoFCgIBBQoFCgUKAA",Bn.SRC="HXSLG2gzZC5zaGFkZXIuVmVydGV4Q29sb3JBbHBoYQQBBWlucHV0DQEBAgVjb2xvcgUMAQEAAQAAAwpwaXhlbENvbG9yBQwEAAAECGFkZGl0aXZlAgIAAQAAAAAABQhmcmFnbWVudA4GAAABAQUAAAUBCwIEAgaAAgMFDAICBQwFDAaBAgMFDAICBQwFDAAA",Cn.SRC="HXSLFmgzZC5zaGFkZXIuVm9sdW1lRGVjYWwYAQZjYW1lcmENAQoCBHZpZXcHAAEAAwRwcm9qBwABAAQIcG9zaXRpb24FCwABAAUIcHJvakZsaXADAAEABghwcm9qRGlhZwULAAEABwh2aWV3UHJvagcAAQAID2ludmVyc2VWaWV3UHJvagcAAQAJBXpOZWFyAwABAAoEekZhcgMAAQALA2RpcgULAwEAAAAADAZnbG9iYWwNAgQNBHRpbWUDAAwADglwaXhlbFNpemUFCgAMAA8JbW9kZWxWaWV3BwAMAQMQEG1vZGVsVmlld0ludmVyc2UHAAwBAwAAABEFaW5wdXQNAwISCHBvc2l0aW9uBQsBEQATBm5vcm1hbAULAREAAQAAFAZvdXRwdXQNBAUVCHBvc2l0aW9uBQwEFAAWBWNvbG9yBQwEFAAXBWRlcHRoAwQUABgGbm9ybWFsBQsEFAAZCXdvcmxkRGlzdAMEFAAEAAAaEHJlbGF0aXZlUG9zaXRpb24FCwQAABsTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAHBhwaXhlbFRyYW5zZm9ybWVkUG9zaXRpb24FCwQAAB0RdHJhbnNmb3JtZWROb3JtYWwFCwQAAB4RcHJvamVjdGVkUG9zaXRpb24FDAQAAB8KcGl4ZWxDb2xvcgUMBAAAIAVkZXB0aAMEAAAhCHNjcmVlblVWBQoEAAAiCXNwZWNQb3dlcgMEAAAjCXNwZWNDb2xvcgULBAAAJAl3b3JsZERpc3QDBAAAJQhkZXB0aE1hcBEBAAAAJgVzY2FsZQUKAgAAJwZub3JtYWwFCwIAACgHdGFuZ2VudAULAgAAKQppc0NlbnRlcmVkAgIAAQAAAAAAKgxjYWxjdWxhdGVkVVYFCgQAACsSdHJhbnNmb3JtZWRUYW5nZW50BQwEAAAsDl9faW5pdF9fdmVydGV4DgYAAC0IZnJhZ21lbnQOBgAAAgIsAAAFAgYEAh0FCwkDHw4BBAYBAicFCwkDMg4BAg8HBgULBQsFCwULBgQCKwUMCQMqDgIJAx8OAQQGAQIoBQsJAzIOAQIPBwYFCwULBQsBAwAAAAAAAPA/AwUMBQwAAS0AAAUJCC4GbWF0cml4BwQAAAYBAggHAhAHBwAILwlzY3JlZW5Qb3MFCgQAAAYCCgIeBQwRAAUKCgIeBQwMAAMFCgAIMANydXYFDAQAAAkDKg4DAi8FCgkDPw4CAiURAQkDOg4BAi8FCgUKAwEDAAAAAAAA8D8DBQwACDEEd3BvcwUMBAAABgECMAUMAi4HBQwACDIEcHBvcwUMBAAABgECMAUMAggHBQwABgQCHAULBgIKAjIFDJIABQsKAjIFDAwAAwULBQsGBAIqBQoGAQImBQoEBgIKAjEFDBEABQoKAjEFDAwAAwUKBQoFCgUKCwIpAgaAAioFCgEDAAAAAAAA4D8DBQoAAAsGCQkDFQ4CCQMVDgIKAioFCgAAAwoCKgUKBAADAwkDFQ4CBgMBAwAAAAAAAPA/AwoCKgUKAAADAwYDAQMAAAAAAADwPwMKAioFCgQAAwMDAwEDAAAAAAAAAAADAgwAAAAA",In.pending=[],In.threadCount=0,Rn.DEFAULT_RESOLVER=new zn,Rn.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",On.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",On.BYTES=Qn.ofString(On.CHARS),os.helper=new DataView(new ArrayBuffer(8)),ms.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1],ms.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ms.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1],ms.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ms.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ks.BACKSPACE=8,ks.TAB=9,ks.ENTER=13,ks.SHIFT=16,ks.CTRL=17,ks.ALT=18,ks.ESCAPE=27,ks.SPACE=32,ks.PGUP=33,ks.PGDOWN=34,ks.END=35,ks.HOME=36,ks.LEFT=37,ks.UP=38,ks.RIGHT=39,ks.DOWN=40,ks.INSERT=45,ks.DELETE=46,ks.QWERTY_EQUALS=187,ks.QWERTY_MINUS=189,ks.QWERTY_TILDE=192,ks.QWERTY_BRACKET_LEFT=219,ks.QWERTY_BRACKET_RIGHT=221,ks.QWERTY_SEMICOLON=186,ks.QWERTY_QUOTE=222,ks.QWERTY_BACKSLASH=220,ks.QWERTY_COMMA=188,ks.QWERTY_PERIOD=190,ks.QWERTY_SLASH=191,ks.INTL_BACKSLASH=226,ks.LEFT_WINDOW_KEY=91,ks.RIGHT_WINDOW_KEY=92,ks.CONTEXT_MENU=93,ks.PAUSE_BREAK=19,ks.CAPS_LOCK=20,ks.NUM_LOCK=144,ks.SCROLL_LOCK=145,ks.NUMBER_0=48,ks.NUMBER_1=49,ks.NUMBER_2=50,ks.NUMBER_3=51,ks.NUMBER_4=52,ks.NUMBER_5=53,ks.NUMBER_6=54,ks.NUMBER_7=55,ks.NUMBER_8=56,ks.NUMBER_9=57,ks.NUMPAD_0=96,ks.NUMPAD_1=97,ks.NUMPAD_2=98,ks.NUMPAD_3=99,ks.NUMPAD_4=100,ks.NUMPAD_5=101,ks.NUMPAD_6=102,ks.NUMPAD_7=103,ks.NUMPAD_8=104,ks.NUMPAD_9=105,ks.A=65,ks.B=66,ks.C=67,ks.D=68,ks.E=69,ks.F=70,ks.G=71,ks.H=72,ks.I=73,ks.J=74,ks.K=75,ks.L=76,ks.M=77,ks.N=78,ks.O=79,ks.P=80,ks.Q=81,ks.R=82,ks.S=83,ks.T=84,ks.U=85,ks.V=86,ks.W=87,ks.X=88,ks.Y=89,ks.Z=90,ks.F1=112,ks.F2=113,ks.F3=114,ks.F4=115,ks.F5=116,ks.F6=117,ks.F7=118,ks.F8=119,ks.F9=120,ks.F10=121,ks.F11=122,ks.F12=123,ks.F13=124,ks.F14=125,ks.F15=126,ks.F16=127,ks.F17=128,ks.F18=129,ks.F19=130,ks.F20=131,ks.F21=132,ks.F22=133,ks.F23=134,ks.F24=135,ks.NUMPAD_MULT=106,ks.NUMPAD_ADD=107,ks.NUMPAD_ENTER=108,ks.NUMPAD_SUB=109,ks.NUMPAD_DOT=110,ks.NUMPAD_DIV=111,ks.MOUSE_LEFT=0,ks.MOUSE_RIGHT=1,ks.MOUSE_MIDDLE=2,ks.MOUSE_BACK=3,ks.MOUSE_FORWARD=4,ks.MOUSE_WHEEL_UP=5,ks.MOUSE_WHEEL_DOWN=6,ks.LOC_LEFT=256,ks.LOC_RIGHT=512,ks.LSHIFT=272,ks.RSHIFT=528,ks.LCTRL=273,ks.RCTRL=529,ks.LALT=274,ks.RALT=530,ks.initDone=!1,ks.keyPressed=[],ks.ALLOW_KEY_REPEAT=!1,Es.PI=3.141592653589793,Es.EPSILON=1e-10,Ds.R=0,Ds.G=1,Ds.B=2,Ds.A=3,Qs.wantedFPS=60,Qs.maxDeltaTime=.5,Qs.smoothFactor=.95,Qs.lastTimeStamp=l.now()/1e3,Qs.elapsedTime=0,Qs.frameCount=0,Qs.dt=1/Qs.wantedFPS,Qs.currentDT=1/Qs.wantedFPS,Os.setCursor=Os.setNativeCursor,Os.loopInit=!1,Os.fpsLimit=-1,ir.HORIZONTAL=-9007199254740992,ir.TOLERANCE=1e-20,ir.SKIP=-2,ir.UNASSIGNED=-1,fr.DFloat=1,fr.DVec2=2,fr.DVec3=3,fr.DVec4=4,fr.DBytes4=9,pr.QTMP=new Nt,kr.CURRENT_VERSION=3,Dr.BLEND=et.__empty_constructs__.slice(),Dr.CULLING=Re.__empty_constructs__.slice(),Qr.invalidChars=new a("[^A-Za-z0-9_]","g"),Nr.Dynamic=0,Nr.UniformDynamic=1,Nr.RawFormat=2,Nr.RawQuads=3,sa.LIVE_UPDATE=!0,aa.Jpg=0,aa.Png=1,aa.Gif=2,aa.Tga=3,aa.Dds=4,aa.Raw=5,aa.Hdr=6,oa.DEFAULT_FILTER=Oe.Linear,oa.DEFAULT_ASYNC=!1,oa.ENABLE_AUTO_WATCH=!0,da.BLOCKSIZE=64,da.W1=2841,da.W2=2676,da.W3=2408,da.W5=1609,da.W6=1108,da.W7=565,da.CF4A=-9,da.CF4B=111,da.CF4C=29,da.CF4D=-3,da.CF3A=28,da.CF3B=109,da.CF3C=-9,da.CF3X=104,da.CF3Y=27,da.CF3Z=-3,da.CF2A=139,da.CF2B=-11,xa.ENABLE_AUTO_WATCH=!0,ga.ID=0,Sa.ID=0,ka.STREAM_DURATION=5,ka.STREAM_BUFFER_SAMPLE_COUNT=44100,ka.BUFFER_QUEUE_LENGTH=2,ka.MAX_SOURCES=16,ka.SOUND_BUFFER_CACHE_SIZE=256,ka.VIRTUAL_VOLUME_THRESHOLD=1e-5,ka.BUFFER_STREAM_SPLIT=16,Va.FADE_SAMPLES=10,sA.UID=0,sA.SWIZ=iA.__empty_constructs__.slice(),sA.MAX_CHANNELS_BITS=3,hA.SRC="HXSLEGh4c2wuQmF0Y2hTaGFkZXICAQtCYXRjaF9Db3VudAECAAEAAAABAAIMQmF0Y2hfQnVmZmVyEAUMAQIAAAA",bA.KWD_LIST=["input","output","discard","dvec2","dvec3","dvec4","hvec2","hvec3","hvec4","fvec2","fvec3","fvec4","int","float","bool","long","short","double","half","fixed","unsigned","superp","lowp","mediump","highp","precision","invariant","discard","struct","asm","union","template","this","packed","goto","sizeof","namespace","noline","volatile","external","flat","input","output","out","attribute","const","uniform","varying","inout","void"],bA.KWDS=function(t){for(var e=new Kn,i=0,n=bA.KWD_LIST;i<n.length;){var s=n[i];++i,e.h[s]=!0}return e}(),bA.GLOBALS=function(t){for(var e=new Hn,i=0,n=eA.__empty_constructs__.slice();i<n.length;){var s=n[i];++i;var r=""+x.string(s);r=r.charAt(0).toLowerCase()+l.substr(r,1,null),e.set(s,r)}e.set(eA.ToInt,"int"),e.set(eA.ToFloat,"float"),e.set(eA.ToBool,"bool"),e.set(eA.LReflect,"reflect"),e.set(eA.Mat3x4,"_mat3x4"),e.set(eA.VertexID,"gl_VertexID"),e.set(eA.InstanceID,"gl_InstanceID"),e.set(eA.IVec2,"ivec2"),e.set(eA.IVec3,"ivec3"),e.set(eA.IVec4,"ivec4"),e.set(eA.BVec2,"bvec2"),e.set(eA.BVec3,"bvec3"),e.set(eA.BVec4,"bvec4"),e.set(eA.FragCoord,"gl_FragCoord"),e.set(eA.FrontFacing,"gl_FrontFacing");for(s=e.iterator();s.hasNext();){var a=s.next();bA.KWDS.h[a]=!0}return e}(),bA.MAT34="struct _mat3x4 { vec4 a; vec4 b; vec4 c; };",MA.UID=0,SA.SWIZ=["x","y","z","w"],TA.UID=0,DA.TVECS=new Wn,DA.BOPS=((jA=_s.__empty_constructs__.slice()).splice(_s.OpAssignOp(null)._hx_index,0,null),jA),DA.UNOPS=cs.__empty_constructs__.slice(),DA.TGLOBALS=eA.__empty_constructs__.slice(),DA.TSWIZ=new Wn,DA.REGS=[iA.X,iA.Y,iA.Z,iA.W],DA.VKINDS=Za.__empty_constructs__.slice(),DA.PRECS=qa.__empty_constructs__.slice(),DA.FKIND=tA.__empty_constructs__.slice(),DA.SIGN=9139229,QA.UNROLL_LOOPS=!1,d.main(),In.run()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);